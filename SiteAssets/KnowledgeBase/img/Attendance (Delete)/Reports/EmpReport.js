var a0_0x7125ea=a0_0x3757;(function(_0x333f03,_0x190b88){var _0x398e4c=a0_0x3757,_0x2ca30b=_0x333f03();while(!![]){try{var _0x2c624b=-parseInt(_0x398e4c(0x225))/0x1*(parseInt(_0x398e4c(0x18f))/0x2)+parseInt(_0x398e4c(0x19e))/0x3+parseInt(_0x398e4c(0x1f9))/0x4+parseInt(_0x398e4c(0x16a))/0x5+-parseInt(_0x398e4c(0x1f4))/0x6+parseInt(_0x398e4c(0x218))/0x7+-parseInt(_0x398e4c(0x1bb))/0x8*(-parseInt(_0x398e4c(0x174))/0x9);if(_0x2c624b===_0x190b88)break;else _0x2ca30b['push'](_0x2ca30b['shift']());}catch(_0x290fb5){_0x2ca30b['push'](_0x2ca30b['shift']());}}}(a0_0x184b,0x6d326));var Totaldays=0x0,CompanyID='',GstartDate='',GEmpID=0x0;$(document)[a0_0x7125ea(0x16b)](function(){var _0x270fca=a0_0x7125ea;ValidateHrAdmin(),initializePeoplePicker(_0x270fca(0x1eb)),CompanyID=titanForWork['getQueryStringParameter'](_0x270fca(0x211));var _0x4f6f3f=$[_0x270fca(0x1c5)](_0x270fca(0x1ce)),_0x4a835c=$[_0x270fca(0x1c5)](_0x270fca(0x1ee)),_0x3ca3ac=$[_0x270fca(0x1c5)](_0x270fca(0x165));if(_0x4f6f3f!=null){GEmpID=_0x4f6f3f;var _0xbf9c2=_0x4a835c[_0x270fca(0x150)](0x0,0x4)+'-'+_0x4a835c[_0x270fca(0x150)](0x4,0x6)+'-'+_0x4a835c[_0x270fca(0x150)](0x6,0x8),_0x17ff57=_0x3ca3ac['slice'](0x0,0x4)+'-'+_0x3ca3ac['slice'](0x4,0x6)+'-'+_0x3ca3ac[_0x270fca(0x150)](0x6,0x8),_0x17867d=new Date(_0x17ff57);_0x17867d['setDate'](_0x17867d[_0x270fca(0x1c0)]()+0x1);var _0x67c7ce=_0x17867d['toISOString'](),_0xc697db=_0x67c7ce[_0x270fca(0x206)]('T');GstartDate=_0xbf9c2,$(_0x270fca(0x167))[_0x270fca(0x1c6)]({'dateFormat':_0x270fca(0x193),'maxDate':new Date()})[_0x270fca(0x1c6)]('setDate',new Date(_0xbf9c2)),$(_0x270fca(0x16e))[_0x270fca(0x1c6)]({'dateFormat':_0x270fca(0x193),'maxDate':new Date()})[_0x270fca(0x1c6)](_0x270fca(0x1d7),new Date(_0x17ff57));var _0x2c4bd9=$(_0x270fca(0x167))[_0x270fca(0x1c6)](_0x270fca(0x1c0)),_0x26ed63=$(_0x270fca(0x16e))['datepicker'](_0x270fca(0x1c0));days=(_0x26ed63-_0x2c4bd9)/(0x3e8*0x3c*0x3c*0x18),Totaldays=Math['round'](days)+0x1,$(_0x270fca(0x18d))['text'](formatDateReportEmp(ConvertDateTimeFormat($(_0x270fca(0x167))[_0x270fca(0x1d5)](),'/'))),$(_0x270fca(0x1ad))[_0x270fca(0x16c)](formatDateReportEmp(ConvertDateTimeFormat($('#EmpreportTo')[_0x270fca(0x1d5)](),'/')));var _0x17581d=_spPageContextInfo['webAbsoluteUrl']+_0x270fca(0x1e0)+_0x4f6f3f+_0x270fca(0x1cd)+CompanyID+'\x27';EmployeeListDat(_0x17581d),LoadAllHolidays();var _0x12b23e=_spPageContextInfo[_0x270fca(0x199)]+_0x270fca(0x180)+_0xbf9c2+_0x270fca(0x1d9)+_0xc697db+_0x270fca(0x1bc)+_0x4f6f3f+'\x27\x20';EmpReportUsageUrl=_0x12b23e,getFileData();var _0x17581d=_spPageContextInfo[_0x270fca(0x199)]+_0x270fca(0x1e0)+_0x4f6f3f+_0x270fca(0x1cd)+CompanyID+'\x27';EmployeeListDat(_0x17581d),LoadAllHolidays();}});function a0_0x184b(){var _0x32d4b3=['EID','MM/DD/YYYY','</tr>','SearchPrincipalSource','<br\x20/>Please\x20wait!!','table','ProcessApprovers','val','data:application/vnd.ms-excel;base64,','setDate','/_api/lists/getbytitle(\x27EmpAttendance\x27)/items?$select=HrAction,ID,Title,WorkHours,AttendanceDate,AttendanceType,Employee/Title,Employee/ID&$Expand=Employee&$top=2000','\x27\x20and\x20AttendanceDate\x20le\x20\x27','<a\x20class=\x27LinkBtn\x27\x20href=\x27','AttendanceItemId','asc','css','SPClientPeoplePickerDict','#Att','/_api/web/lists/GetByTitle(\x27Employees\x27)/items?$top=5000&$select=ID,FullName,Designation,LogonName/ID,LogonName/Title,Department/DepartmentName,Company/CompanyName,Company/ID,OfficeLocation/ID,OfficeLocation/OfficeName&$orderby=FullName&$expand=LogonName,OfficeLocation,Company,Department&$filter=LogonName\x20eq\x20\x27','<td><div\x20class=\x27attendance-report-edit-lock-btn-box\x20text-center\x27\x20style=\x27display:\x20','selectedrow','Worksheet','\x27\x20class=\x27employee-report-holiday\x27></span></div></td>','replace','<td><div\x20class=\x27attendance-report-edit-lock-btn-box\x20text-center\x27><a\x20href=\x27#\x27\x20class=\x27custom-edit-btn\x27\x20data-toggle=\x27modal\x27\x20data-target=\x27#attendance-reportEdit\x27\x20onclick=\x27attendanceEditModal(','DD/MM/YYYY','\x27\x20and\x20ContributorsId\x20eq\x20\x27','This\x20is\x20a\x20Holiday,\x20are\x20you\x20sure\x20to\x20submit\x20your\x20attendance.','AttendanceDate','EmployeeName','empty','round','start','Emptotalrecords','#attendance-reportEdit','#EmpRow','EmpReportTableData','\x27\x20and\x20(WebPartName\x20eq\x20\x27HR\x20Admin\x27)','4874970TGAsEl','</div></td>','Error\x20in\x20getFileData.','#EmpReportTable','\x27\x20and\x20Holiday_start\x20ge\x20\x27','1339720hSyFPr','<td\x20class=\x27text-left\x27><div\x20class=\x27attendance-report-table-ellipsis-2\x27\x20id=Att','#EdateTH','\x27>Fill</span></a>','getElementById','Empcurrentpage','ajax','#__REQUESTDIGEST','Apr','color','/_api/web/ensureuser','block','On-Leave','split','An\x20error\x20occurred.\x20Please\x20try\x20again.','none','MaximumEntitySuggestions','Holiday_start','<a\x20href=\x27','#Total-Leave-Absent','Holiday','&Mode=','\x20\x27><label><i\x20class=\x27fa\x20fa-check\x27\x20aria-hidden=\x27true\x27\x20style=\x27color:\x20red;\x27></i></label></div></td>','#HolidayMessage','CompanyId','\x27\x20and\x20Holiday_start\x20le\x20\x27','Width','close','</span><span\x20id=\x27H','<td><div\x20class=\x27checkbox\x20m-0\x27></div></td>','getFullYear','1641535qTndOF','sorter',')\x27><i\x20class=\x27fa\x20fa-pencil\x27></i></a></div></td>','#FdateTH',',0,','Hdate','SP.Data.EmpAttendanceListItem','message','><span>','it\x20exceeds\x20the\x20list\x20view','abs','showWaitScreenWithNoClose','Nov','1bYEKLU','slice','#EmployeeName','WorkHours','.NoRecordFound','#HoliaysTotal','Unauthorized\x20access!','userId','Emppagedropdown','[?&]','OfficeName','Friday','<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27\x20id=Time','#EmpTotalItemscount','red','join','Wednesday','PrincipalAccountType','Jun','&sourcelocation=../Pages/Myworkplace.aspx\x27>','ResolvePrincipalSource','<tr\x20class=\x27text-center\x27\x20>','end','Loading...','#EmpreportFrom','Plese\x20select\x20proper\x20attandence.','nodeType','4161590oRretu','ready','text','map','#EmpreportTo','\x27\x20and\x20CompanyID\x20eq\x20\x27','getTime','toISOString','Employee','grep','9jSfSNv','format','View','/_api/web/lists/getbytitle(\x27','<td><div\x20class=\x27checkbox\x20m-0\x27\x20style=\x27display:\x20','MERGE','includes','SPClientPeoplePicker_InitStandaloneControlWrapper','Error!\x20Something\x20went\x20wrong.','#HolidaysTH','#Timeview','AttendanceType','/_api/lists/getbytitle(\x27EmpAttendance\x27)/items?$select=HrAction,ID,Title,WorkHours,AttendanceDate,AttendanceType,Employee/Title,Employee/ID&$Expand=Employee&$top=5000&$filter=AttendanceDate\x20ge\x20\x27','HrAction','#HolidayMessagediv','getDay','#EmpName','#Total-Attendance','getMonth','results','btoa','EmpWorkHours','oddrow','Jan','evenrow','#StartDate','GetAllUserInfo','758730zVSAsn','get','AllowMultipleValues','responseJSON','dd/mm/yy','error','hide','\x27)/items?$select=*,Department/DepartmentName,Department/ID&$expand=Department&$filter=CompanyId\x20eq\x20\x27','floor','Emptotalpages','webAbsoluteUrl','log','Mar','location','<td\x20class=\x27text-left\x27><div\x20class=\x27attendance-report-table-ellipsis-2\x27\x20id=','456858aoLgwl','#Workingdays','__next','/Pages/TimeSheetEntry.aspx?WebAppId=2&Recall=','\x27)and\x20Holiday_start\x20eq\x20\x27','YYYY-MM-DD','Key','Saturday','Sunday','#AttendanceDDL','POST','#OfficeLoc','Title','LogonName','attr','#EndDate','Thursday','desc','modal','display','filter','indexOf','getQueryStringParameter','href','innerHTML','OfficeLocation','></div></td>','length','\x20\x27><a\x20href=\x27#\x27\x20class=\x27custom-edit-btn\x27\x20data-toggle=\x27modal\x27\x20data-target=\x27#attendance-reportEdit\x27\x20onclick=\x27attendanceEditModal(','680728cmnKxq','\x27\x20and\x20Employee\x20eq\x20\x27','Oct','</a>','evenselected','getDate','#officeLocTH','\x27&$top=200&$orderby=Holiday_start\x20asc','push','#EmpTitle','urlParam','datepicker','children','stringify','application/json;odata=verbose','User,DL,SecGroup,SPGroup','&sourcelocation=../Pages/Myworkplace.aspx\x27\x20><span\x20id=\x27Timeview','value','\x27\x20and\x20Company/ID\x20\x20eq\x20\x27'];a0_0x184b=function(){return _0x32d4b3;};return a0_0x184b();}var EmployeeID='',ItemID='',SelectedDate='',TDID='';function attendanceEditModal(_0x5f57eb,_0x513d8e,_0x197c02){var _0x138bc1=a0_0x7125ea;EmployeeID=0x0,ItemID=0x0,SelectedDate='',TDID=_0x197c02,EmployeeID=_0x5f57eb,ItemID=_0x513d8e;var _0x32b164=_0x197c02['toString'](),_0x455379=_0x32b164[_0x138bc1(0x150)](0x0,0x4)+'-'+_0x32b164[_0x138bc1(0x150)](0x4,0x6)+'-'+_0x32b164[_0x138bc1(0x150)](0x6,0x8),_0x25e960=new Date(_0x455379);SelectedDate=_0x25e960[_0x138bc1(0x171)]()[_0x138bc1(0x206)]('T')[0x0];var _0x27e549=formatDateReportEmp(_0x25e960);$('#SelDate')[_0x138bc1(0x16c)](_0x27e549),GetHolidays(_0x455379);}function a0_0x3757(_0x315708,_0x4a677c){var _0x184b4a=a0_0x184b();return a0_0x3757=function(_0x375707,_0x247049){_0x375707=_0x375707-0x150;var _0x4d4ca3=_0x184b4a[_0x375707];return _0x4d4ca3;},a0_0x3757(_0x315708,_0x4a677c);}function UpdateAttendance(){var _0x1d9bb0=a0_0x7125ea;ItemID==0x0?(G_Validateholiday==!![]?confirm(_0x1d9bb0(0x1e9))&&PushNewAttendance():PushNewAttendance(),Applyfilter(),LoadAllHolidays()):(G_Validateholiday==!![]?confirm(_0x1d9bb0(0x1e9))&&ModifyAttendance():ModifyAttendance(),Applyfilter(),LoadAllHolidays());}function PushNewAttendance(){var _0x441237=a0_0x7125ea;$(_0x441237(0x1a7))[_0x441237(0x1d5)]()!=_0x441237(0x20d)||G_Validateholiday==!![]?$[_0x441237(0x1ff)]({'url':_spPageContextInfo['webAbsoluteUrl']+'/_api/web/lists/GetByTitle(\x27EmpAttendance\x27)/items','type':'POST','async':![],'data':JSON[_0x441237(0x1c8)]({'__metadata':{'type':_0x441237(0x21e)},'AttendanceDate':SelectedDate,'EmployeeId':EmployeeID,'AttendanceType':$('#AttendanceDDL')[_0x441237(0x1d5)]()}),'headers':{'Accept':_0x441237(0x1c9),'Content-Type':_0x441237(0x1c9),'X-RequestDigest':$(_0x441237(0x200))['val'](),'X-HTTP-Method':_0x441237(0x1a8)},'success':function(_0x33d938,_0x25986f,_0x886d48){var _0x26a698=_0x441237;$(_0x26a698(0x1df)+TDID)[_0x26a698(0x16c)]($(_0x26a698(0x1a7))['val']()),alert('Data\x20has\x20been\x20saved.'),$('#attendance-reportEdit')['modal'](_0x26a698(0x195)),GetAttendanceorLeaves();},'error':function(_0x22e61d,_0x34e182,_0x3e0a68){var _0x4ff74e=_0x441237;alert(_0x4ff74e(0x17c));}}):alert('Plese\x20select\x20proper\x20attandence.');}function ModifyAttendance(){var _0x139294=a0_0x7125ea;$(_0x139294(0x1a7))[_0x139294(0x1d5)]()!=_0x139294(0x20d)||G_Validateholiday==!![]?$[_0x139294(0x1ff)]({'url':_spPageContextInfo['webAbsoluteUrl']+'/_api/web/lists/GetByTitle(\x27EmpAttendance\x27)/items('+ItemID+')','type':_0x139294(0x1a8),'async':![],'data':JSON[_0x139294(0x1c8)]({'__metadata':{'type':_0x139294(0x21e)},'AttendanceType':$(_0x139294(0x1a7))[_0x139294(0x1d5)]()}),'headers':{'Accept':_0x139294(0x1c9),'Content-Type':_0x139294(0x1c9),'X-RequestDigest':$('#__REQUESTDIGEST')[_0x139294(0x1d5)](),'IF-MATCH':'*','X-HTTP-Method':_0x139294(0x179)},'success':function(_0x5b0dcf,_0x5a555e,_0x271b47){var _0x8484ad=_0x139294;$(_0x8484ad(0x1df)+TDID)[_0x8484ad(0x16c)]($('#AttendanceDDL')[_0x8484ad(0x1d5)]()),$(_0x8484ad(0x17e)+TDID)[_0x8484ad(0x16c)]('00:00'),alert('Data\x20has\x20been\x20saved.'),$(_0x8484ad(0x1f0))[_0x8484ad(0x1b0)](_0x8484ad(0x195)),GetAttendanceorLeaves();},'error':function(_0x16abc3,_0x38ae29,_0x4c8a1d){var _0x1fb30c=_0x139294;alert(_0x1fb30c(0x17c));}}):alert(_0x139294(0x168));}function initializePeoplePicker(_0x3154b0){var _0x4f6051=a0_0x7125ea,_0x20daa6={};_0x20daa6[_0x4f6051(0x160)]=_0x4f6051(0x1ca),_0x20daa6[_0x4f6051(0x1d1)]=0xf,_0x20daa6[_0x4f6051(0x163)]=0xf,_0x20daa6[_0x4f6051(0x191)]=![],_0x20daa6[_0x4f6051(0x209)]=0x32,_0x20daa6[_0x4f6051(0x213)]='280px',this[_0x4f6051(0x17b)](_0x3154b0,null,_0x20daa6);}function Applyfilter(){var _0x16fa57=a0_0x7125ea;OpenMyCustomLoader(),EmpReportData=[];var _0x4169b0=$[_0x16fa57(0x1c5)](_0x16fa57(0x1ce)),_0xc4212e=$(_0x16fa57(0x167))[_0x16fa57(0x1c6)](_0x16fa57(0x1c0)),_0x17b783=$('#EmpreportTo')[_0x16fa57(0x1c6)](_0x16fa57(0x1c0));days=(_0x17b783-_0xc4212e)/(0x3e8*0x3c*0x3c*0x18),Totaldays=Math[_0x16fa57(0x1ed)](days)+0x1,$(_0x16fa57(0x18d))[_0x16fa57(0x16c)](formatDateReportEmp(ConvertDateTimeFormat($(_0x16fa57(0x167))[_0x16fa57(0x1d5)](),'/'))),$(_0x16fa57(0x1ad))[_0x16fa57(0x16c)](formatDateReportEmp(ConvertDateTimeFormat($('#EmpreportTo')['val'](),'/')));var _0x2cf913=moment($(_0x16fa57(0x167))[_0x16fa57(0x1d5)](),_0x16fa57(0x1e7))[_0x16fa57(0x175)](_0x16fa57(0x1a3)),_0x266890=moment($('#EmpreportTo')['val'](),_0x16fa57(0x1e7))['format'](_0x16fa57(0x1a3)),_0x52ab63=new Date(_0x266890);_0x52ab63[_0x16fa57(0x1d7)](_0x52ab63[_0x16fa57(0x1c0)]()+0x1);var _0xcb0087=_0x52ab63[_0x16fa57(0x171)](),_0x243268=_0xcb0087[_0x16fa57(0x206)]('T');GstartDate=_0x2cf913;var _0x1a9a1d=ensureUser($(_0x16fa57(0x151))[_0x16fa57(0x1c7)]()[_0x16fa57(0x1c7)]()['attr']('id'));if(_0x1a9a1d==0x0){_0x4169b0=_0x4169b0,GEmpID=_0x4169b0;var _0x10571f=_spPageContextInfo[_0x16fa57(0x199)]+'/_api/lists/getbytitle(\x27EmpAttendance\x27)/items?$select=HrAction,ID,Title,WorkHours,AttendanceDate,AttendanceType,Employee/Title,Employee/ID&$Expand=Employee&$top=5000&$orderby\x20=\x20AttendanceDate\x20asc&$filter=AttendanceDate\x20ge\x20\x27'+_0x2cf913+'\x27\x20and\x20AttendanceDate\x20le\x20\x27'+_0x243268+_0x16fa57(0x1bc)+_0x4169b0+'\x27\x20';EmpReportUsageUrl=_0x10571f,getFileData();var _0x135261=_spPageContextInfo[_0x16fa57(0x199)]+_0x16fa57(0x1e0)+_0x4169b0+_0x16fa57(0x1cd)+CompanyID+'\x27';EmployeeListDat(_0x135261);}else{if(ISHRADMIN==!![]){_0x4169b0=_0x1a9a1d,GEmpID=_0x1a9a1d;var _0x10571f=_spPageContextInfo[_0x16fa57(0x199)]+'/_api/lists/getbytitle(\x27EmpAttendance\x27)/items?$select=HrAction,ID,Title,WorkHours,AttendanceDate,AttendanceType,Employee/Title,Employee/ID&$Expand=Employee&$top=5000&$orderby\x20=\x20AttendanceDate\x20asc&$filter=AttendanceDate\x20ge\x20\x27'+_0x2cf913+_0x16fa57(0x1d9)+_0x243268+_0x16fa57(0x1bc)+_0x4169b0+'\x27\x20';EmpReportUsageUrl=_0x10571f,getFileData();var _0x135261=_spPageContextInfo[_0x16fa57(0x199)]+_0x16fa57(0x1e0)+_0x4169b0+'\x27\x20and\x20Company/ID\x20\x20eq\x20\x27'+CompanyID+'\x27';EmployeeListDat(_0x135261);}else alert(_0x16fa57(0x155));}LoadAllHolidays();}var DataIdList=[],EmpAttendanceData=[],TotalLeavesorAbsent=[],EmpReportUsageUrl='',EmpReportData=EmpReportData||[];function getFileData(){var _0x1c43be=a0_0x7125ea;jQuery[_0x1c43be(0x1ff)]({'url':EmpReportUsageUrl,'headers':{'Accept':_0x1c43be(0x1c9)},'async':!![],'success':function(_0x55bdea){var _0x24639e=_0x1c43be;EmpReportData=EmpReportData['concat'](_0x55bdea['d'][_0x24639e(0x187)]);if(_0x55bdea['d']['__next'])EmpReportUsageUrl=_0x55bdea['d'][_0x24639e(0x1a0)],getFileData();else{if(EmpReportData[_0x24639e(0x1b9)]>0x0){var _0x115373=ensureUser($(_0x24639e(0x151))[_0x24639e(0x1c7)]()['children']()[_0x24639e(0x1ac)]('id')),_0x438e6f=$['urlParam'](_0x24639e(0x1ce));_0x115373!=0x0?EmpReportData=$[_0x24639e(0x173)](EmpReportData,function(_0x172b1e){var _0x401f0b=_0x24639e;return _0x172b1e[_0x401f0b(0x172)]['ID']==_0x115373;}):EmpReportData=$[_0x24639e(0x173)](EmpReportData,function(_0x1a6b42){var _0x43e421=_0x24639e;return _0x1a6b42[_0x43e421(0x172)]['ID']==_0x438e6f;});var _0x29db01=moment(ConvertDateTimeFormat($(_0x24639e(0x167))[_0x24639e(0x1d5)](),'/'))['format'](_0x24639e(0x1cf)),_0x3eb77d=moment(ConvertDateTimeFormat($('#EmpreportTo')[_0x24639e(0x1d5)](),'/'))['format'](_0x24639e(0x1cf)),_0x450ce9=EmpReportData[_0x24639e(0x1b2)](function(_0x120f9d){return Created=moment(_0x120f9d['AttendanceDate'])['format']('MM/DD/YYYY'),(_0x29db01==''?Created!='':Created>=_0x29db01)&&(_0x3eb77d==''?Created!='':Created<=_0x3eb77d);});GenerateEmpReport(_0x450ce9);}else{var _0x450ce9=[];GenerateEmpReport(_0x450ce9);}CloseMyCustomLoader();}},'error':function(_0x7f89bc,_0x231c38,_0x8aecf3){var _0x33733c=_0x1c43be;console['log'](_0x33733c(0x1f6)),console[_0x33733c(0x19a)](_0x7f89bc['responseJSON']['error'][_0x33733c(0x21f)][_0x33733c(0x1cc)]);var _0x579ba8=_0x7f89bc['responseJSON'][_0x33733c(0x194)][_0x33733c(0x21f)][_0x33733c(0x1cc)],_0x21d139=_0x579ba8[_0x33733c(0x17a)](_0x33733c(0x221));if(_0x21d139==!![]){EmpReportData=[];var _0x5341fc=_spPageContextInfo[_0x33733c(0x199)]+_0x33733c(0x1d8);EmpReportUsageUrl=_0x5341fc,getFileData();}}});}function GenerateEmpReport(_0x1184e2){var _0x19119c=a0_0x7125ea;EmpAttendanceData=[],DataIdList=[];var _0x3446df=[];TotalLeavesorAbsent=[];for(var _0x3508ec=0x0;_0x3508ec<_0x1184e2[_0x19119c(0x1b9)];_0x3508ec++){if(_0x1184e2[_0x3508ec][_0x19119c(0x17f)]!='On-Leave'&&_0x1184e2[_0x3508ec]['AttendanceType']!=_0x19119c(0x20d))_0x3446df[_0x19119c(0x1c3)](_0x1184e2[_0x3508ec][_0x19119c(0x17f)]);else{if(_0x1184e2[_0x3508ec][_0x19119c(0x17f)]==_0x19119c(0x205))TotalLeavesorAbsent['push'](_0x1184e2[_0x3508ec]['AttendanceType']);else _0x1184e2[_0x3508ec][_0x19119c(0x17f)]==_0x19119c(0x20d)&&TotalLeavesorAbsent[_0x19119c(0x1c3)](_0x1184e2[_0x3508ec][_0x19119c(0x17f)]);}var _0x993cc9=_0x1184e2[_0x3508ec]['ID'],_0x60a978=_0x1184e2[_0x3508ec][_0x19119c(0x172)]['Title'],_0x228430=_0x1184e2[_0x3508ec][_0x19119c(0x172)]['ID'],_0x57ee4b=formatDateReportEmp(_0x1184e2[_0x3508ec][_0x19119c(0x1ea)]),_0x2d33d4=_0x1184e2[_0x3508ec][_0x19119c(0x17f)],_0x29e310=_0x1184e2[_0x3508ec][_0x19119c(0x152)],_0x11e2e0=_0x1184e2[_0x3508ec]['HrAction'];EmpAttendanceData['push']({'UserId':_0x228430,'EmpName':_0x60a978,'AttendanceDate':_0x57ee4b,'AttendanceType':_0x2d33d4,'AttendanceItemId':_0x993cc9,'EmpWorkHours':_0x29e310,'HrAction':_0x11e2e0});}var _0x5cb543='';$(_0x19119c(0x1f7))[_0x19119c(0x1ec)]();var _0x1b6e05=0x0,_0xf62779=0x0;for(var _0x252d98=0x0;_0x252d98<Totaldays;_0x252d98++){var _0x4c9dfc=new Date(GstartDate);_0x4c9dfc[_0x19119c(0x1d7)](_0x4c9dfc[_0x19119c(0x1c0)]()+_0x252d98);var _0x5e7c02=moment(_0x4c9dfc,_0x19119c(0x1e7))[_0x19119c(0x175)]('YYYY-MM-DD'),_0x5e7c02=_0x5e7c02[_0x19119c(0x206)]('-')[_0x19119c(0x15e)]('');DataIdList[_0x19119c(0x1c3)](_0x5e7c02);var _0x22e2f7=formatDateReportEmp(_0x4c9dfc),_0x3f412d=EmpAttendanceData[_0x19119c(0x16d)](function(_0x4205b2){var _0x1f54db=_0x19119c;return _0x4205b2[_0x1f54db(0x1ea)];})['indexOf'](_0x22e2f7);if(_0x3f412d!=-0x1){var _0x3c2328=EmpAttendanceData[_0x3f412d][_0x19119c(0x17f)],_0x1ea4af=EmpAttendanceData[_0x3f412d]['EmpWorkHours'],_0x11e2e0=EmpAttendanceData[_0x3f412d][_0x19119c(0x181)],_0x2d4a6d=EmpAttendanceData[_0x3f412d]['UserId'],_0x846e5f=EmpAttendanceData[_0x3f412d]['AttendanceItemId'],_0x299acd=_0x19119c(0x208),_0x5f08d2='block';_0x11e2e0==!![]&&(_0x299acd='block',_0x5f08d2=_0x19119c(0x208));if(_0x3c2328!='On-Leave'&&_0x3c2328!=_0x19119c(0x20d)){if(_0x1ea4af==null)var _0x1d0de0=_0x19119c(0x1da)+_spPageContextInfo['webAbsoluteUrl']+_0x19119c(0x1a1)+_0x5e7c02+_0x19119c(0x20e)+window[_0x19119c(0x188)](_0x19119c(0x176))+_0x19119c(0x1cb)+_0x5e7c02+'\x27>Fill</span></a>';else var _0x1d0de0=_0x19119c(0x20b)+_spPageContextInfo[_0x19119c(0x199)]+_0x19119c(0x1a1)+_0x5e7c02+_0x19119c(0x20e)+window[_0x19119c(0x188)](_0x19119c(0x176))+_0x19119c(0x162)+ConvertHHMM(_0x1ea4af)+_0x19119c(0x1be);}else var _0x1d0de0='';_0xf62779=_0xf62779+0x1,_0x5cb543+=_0x19119c(0x164),_0x5cb543+=_0x19119c(0x19d)+_0x5e7c02+_0x19119c(0x220)+formatDateReportEmp(_0x4c9dfc)+_0x19119c(0x215)+_0x5e7c02+_0x19119c(0x1e4),_0x5cb543+=_0x19119c(0x1fa)+_0x5e7c02+'>'+_0x3c2328+_0x19119c(0x1f5),_0x5cb543+='<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27\x20id=Time'+_0x5e7c02+'>'+_0x1d0de0+_0x19119c(0x1f5),_0x5cb543+=_0x19119c(0x178)+_0x299acd+_0x19119c(0x20f),_0x5cb543+=_0x19119c(0x1e1)+_0x5f08d2+_0x19119c(0x1ba)+GEmpID+','+_0x846e5f+','+_0x5e7c02+_0x19119c(0x21a),_0x5cb543+='</tr>';}else{_0x1b6e05=_0x1b6e05+0x1;var _0x5fe223=_0x19119c(0x1da)+_spPageContextInfo[_0x19119c(0x199)]+_0x19119c(0x1a1)+_0x5e7c02+'&Mode='+window[_0x19119c(0x188)]('View')+_0x19119c(0x1cb)+_0x5e7c02+_0x19119c(0x1fc);_0x5cb543+='<tr\x20class=\x27text-center\x27\x20>',_0x5cb543+=_0x19119c(0x19d)+_0x5e7c02+_0x19119c(0x220)+formatDateReportEmp(_0x4c9dfc)+'</span><span\x20id=\x27H'+_0x5e7c02+'\x27\x20class=\x27employee-report-holiday\x27></span></div></td>',_0x5cb543+='<td\x20class=\x27text-left\x27><div\x20class=\x27attendance-report-table-ellipsis-2\x27\x20id=Att'+_0x5e7c02+_0x19119c(0x1b8),_0x5cb543+=_0x19119c(0x15b)+_0x5e7c02+_0x19119c(0x1b8),_0x5cb543+=_0x19119c(0x216),_0x5cb543+=_0x19119c(0x1e6)+GEmpID+_0x19119c(0x21c)+_0x5e7c02+_0x19119c(0x21a),_0x5cb543+=_0x19119c(0x1d0);}}var _0x7016d8=parseInt(TotalLeavesorAbsent[_0x19119c(0x1b9)])+parseInt(_0x1b6e05)-parseInt($('#HoliaysTotal')[_0x19119c(0x16c)]());_0x7016d8<0x0&&(_0x7016d8=0x0);$(_0x19119c(0x153))[_0x19119c(0x195)](),$('#EmpTotalItemscount')[_0x19119c(0x16c)](Totaldays);var _0xb299f9=parseInt(_0xf62779)-parseInt(TotalLeavesorAbsent[_0x19119c(0x1b9)]);$(_0x19119c(0x185))[_0x19119c(0x16c)](Math[_0x19119c(0x222)](_0xb299f9)),$(_0x19119c(0x1f7))['append'](_0x5cb543),EmpTableConfiguration();}function ConvertDateTimeFormat(_0x396553,_0x5822bd){var _0xcba33c=a0_0x7125ea;return _0x396553['split'](_0x5822bd)[0x1]+''+_0x5822bd+''+_0x396553[_0xcba33c(0x206)](_0x5822bd)[0x0]+''+_0x5822bd+''+_0x396553[_0xcba33c(0x206)](_0x5822bd)[0x2];}var GEmployeeID=0x0,LocID=0x0;function EmployeeListDat(_0x948b29){var _0xbe934c=a0_0x7125ea;GEmployeeID=0x0,$[_0xbe934c(0x1ff)]({'url':_0x948b29,'headers':{'Accept':_0xbe934c(0x1c9)},'async':![],'success':function(_0x2de9a3){var _0x25840c=_0xbe934c,_0x25003f=_0x2de9a3['d'][_0x25840c(0x187)];_0x25003f[_0x25840c(0x1b9)]>0x0?($(_0x25840c(0x184))[_0x25840c(0x16c)](_0x25003f[0x0][_0x25840c(0x1ab)][_0x25840c(0x1aa)]),GEmployeeID=_0x25003f[0x0][_0x25840c(0x1ab)]['ID'],$(_0x25840c(0x1c4))[_0x25840c(0x16c)](_0x25003f[0x0][_0x25840c(0x1ab)][_0x25840c(0x1aa)]),$(_0x25840c(0x1a9))['text'](_0x25003f[0x0][_0x25840c(0x1b7)][_0x25840c(0x159)]),$(_0x25840c(0x1c1))[_0x25840c(0x16c)](_0x25003f[0x0][_0x25840c(0x1b7)]['OfficeName']),LocID=_0x25003f[0x0][_0x25840c(0x1b7)]['ID']):($(_0x25840c(0x184))['text'](''),$('#OfficeLoc')[_0x25840c(0x16c)](''),LocID=0x0);},'error':function(_0x296872){var _0x5e5c54=_0xbe934c;console[_0x5e5c54(0x19a)](_0x296872);}});}function EmpTableConfiguration(){var _0x371858=a0_0x7125ea;sorter=new TINY[(_0x371858(0x1d3))][(_0x371858(0x219))](_0x371858(0x219),_0x371858(0x1f2),{'ascclass':_0x371858(0x1dc),'descclass':_0x371858(0x1af),'evenclass':_0x371858(0x18c),'oddclass':_0x371858(0x18a),'evenselclass':_0x371858(0x1bf),'oddselclass':'oddselected','paginate':!![],'size':0xa,'colddid':'columns','currentid':_0x371858(0x1fe),'totalid':_0x371858(0x198),'startingrecid':'Empstartrecord','endingrecid':'Empendrecord','totalrecid':_0x371858(0x1ef),'hoverid':_0x371858(0x1e2),'pageddid':_0x371858(0x157),'navid':'tablenav','sortdir':0x1,'init':!![]});}$[a0_0x7125ea(0x1c5)]=function(_0x474473){var _0x2a7d1f=a0_0x7125ea,_0x47a313=new RegExp(_0x2a7d1f(0x158)+_0x474473+'=([^&#]*)')['exec'](window[_0x2a7d1f(0x19c)]['href']);if(_0x47a313==null)return null;return decodeURI(_0x47a313[0x1])||0x0;};function formatDateReportEmp(_0x170d5a){var _0x12c231=a0_0x7125ea,_0x49f57f=[_0x12c231(0x1a6),'Monday','Tuesday',_0x12c231(0x15f),_0x12c231(0x1ae),_0x12c231(0x15a),_0x12c231(0x1a5)],_0x10ebb3=new Date(_0x170d5a);if(isNaN(_0x10ebb3[_0x12c231(0x170)]()))return _0x170d5a;else{var _0x84d1cf=new Array();return _0x84d1cf[0x0]=_0x12c231(0x18b),_0x84d1cf[0x1]='Feb',_0x84d1cf[0x2]=_0x12c231(0x19b),_0x84d1cf[0x3]=_0x12c231(0x201),_0x84d1cf[0x4]='May',_0x84d1cf[0x5]=_0x12c231(0x161),_0x84d1cf[0x6]='Jul',_0x84d1cf[0x7]='Aug',_0x84d1cf[0x8]='Sept',_0x84d1cf[0x9]=_0x12c231(0x1bd),_0x84d1cf[0xa]=_0x12c231(0x224),_0x84d1cf[0xb]='Dec',day=_0x10ebb3[_0x12c231(0x1c0)](),day<0xa&&(day='0'+day),day+'\x20'+_0x84d1cf[_0x10ebb3['getMonth']()]+'\x20'+_0x10ebb3[_0x12c231(0x217)]()+',\x20'+_0x49f57f[_0x10ebb3[_0x12c231(0x183)]()];}}function ConvertHHMM(_0x264945){var _0x35bffd=a0_0x7125ea;if(_0x264945!=null){var _0x5657f9=Math[_0x35bffd(0x197)](_0x264945/0x3c),_0x27db2e=_0x264945%0x3c;_0x5657f9<0xa&&(_0x5657f9='0'+_0x5657f9);_0x27db2e<0xa&&(_0x27db2e='0'+_0x27db2e);var _0x51ea67=_0x5657f9+':'+_0x27db2e;}else var _0x51ea67='';return _0x51ea67;}var AttandenceOnHolidays=0x0,HolidaysListDTL=[];function LoadAllHolidays(){var _0x356c41=a0_0x7125ea;TotalOfficeDays=0x0,HolidaysListDTL=[];var _0x2077be=new Date(ConvertDateTimeFormat($(_0x356c41(0x167))[_0x356c41(0x1d5)](),'/')),_0x1fcba0=_0x2077be[_0x356c41(0x217)]()+'-'+(_0x2077be[_0x356c41(0x186)]()+0x1)+'-'+_0x2077be[_0x356c41(0x1c0)](),_0x3f914f=new Date(ConvertDateTimeFormat($('#EmpreportTo')[_0x356c41(0x1d5)](),'/')),_0x183d15=_0x3f914f['getFullYear']()+'-'+(_0x3f914f[_0x356c41(0x186)]()+0x1)+'-'+_0x3f914f[_0x356c41(0x1c0)](),_0x5c7431=_spPageContextInfo[_0x356c41(0x199)]+'/_api/web/lists/getbytitle(\x27CompanyHoliday\x27)/items?select=*,ID,Title&$filter=OfficeLocationID\x20eq\x20\x27'+LocID+_0x356c41(0x16f)+CompanyID+_0x356c41(0x1f8)+_0x1fcba0+_0x356c41(0x212)+_0x183d15+'\x27';$['ajax']({'url':_0x5c7431,'headers':{'Accept':'application/json;odata=verbose'},'async':![],'success':function(_0xb6e444){var _0x53895d=_0x356c41,_0x5ad1a9=_0xb6e444['d'][_0x53895d(0x187)]['length'],_0x141812=0x0;for(var _0x563fa8=0x0;_0x563fa8<_0x5ad1a9;_0x563fa8++){var _0x1a4d33=new Date(_0xb6e444['d'][_0x53895d(0x187)][_0x563fa8][_0x53895d(0x20a)]),_0x3a97ff=moment(_0x1a4d33,_0x53895d(0x1e7))['format'](_0x53895d(0x1a3)),_0x3a97ff=_0x3a97ff[_0x53895d(0x206)]('-')[_0x53895d(0x15e)](''),_0x57f299=_0xb6e444['d'][_0x53895d(0x187)][_0x563fa8][_0x53895d(0x1aa)];HolidaysListDTL['push']({'Hdate':_0x3a97ff,'Title':_0x57f299}),$('#'+_0x3a97ff)[_0x53895d(0x1dd)](_0x53895d(0x202),_0x53895d(0x15d)),$('#H'+_0x3a97ff)['text'](_0x57f299),$('#Att'+_0x3a97ff)[_0x53895d(0x16c)]()!=''&&(_0x141812=_0x141812+0x1);}AttandenceOnHolidays=0x0;for(var _0x38370f=0x0;_0x38370f<HolidaysListDTL[_0x53895d(0x1b9)];_0x38370f++){var _0x50dfaf=$(_0x53895d(0x1df)+HolidaysListDTL[_0x38370f][_0x53895d(0x21d)])[_0x53895d(0x16c)]();_0x50dfaf!=''&&_0x50dfaf!=_0x53895d(0x205)&&_0x50dfaf!='Holiday'&&(AttandenceOnHolidays=AttandenceOnHolidays+0x1);}var _0x2a2fc1=0x0,_0x3a4b4f=0x0,_0x181dc3=0x0;for(var _0x145052=0x0;_0x145052<DataIdList[_0x53895d(0x1b9)];_0x145052++){var _0x333b11=$('#Att'+DataIdList[_0x145052])['text']();(_0x333b11==''||_0x333b11==_0x53895d(0x205))&&(_0x3a4b4f=_0x3a4b4f+0x1),_0x333b11==_0x53895d(0x205)&&(_0x181dc3=_0x181dc3+0x1),_0x333b11==_0x53895d(0x20d)&&(_0x2a2fc1=_0x2a2fc1+0x1);}var _0x2aecdb=_0x3a4b4f+AttandenceOnHolidays-(_0x5ad1a9-_0x2a2fc1);_0x2aecdb<0x0&&(_0x2aecdb=0x0),_0x2aecdb!='0'?$(_0x53895d(0x20c))[_0x53895d(0x16c)](_0x2aecdb):_0x181dc3>0x0&&$('#Total-Leave-Absent')['text'](_0x181dc3),$(_0x53895d(0x154))[_0x53895d(0x16c)](_0x5ad1a9),$(_0x53895d(0x19f))[_0x53895d(0x16c)](parseInt(Totaldays)-parseInt(_0x5ad1a9)),$(_0x53895d(0x21b))['text'](formatDateReportEmp(ConvertDateTimeFormat($('#EmpreportFrom')[_0x53895d(0x1d5)](),'/'))),$(_0x53895d(0x1fb))[_0x53895d(0x16c)](formatDateReportEmp(ConvertDateTimeFormat($(_0x53895d(0x16e))[_0x53895d(0x1d5)](),'/'))),$('#TotalWorkdayTH')[_0x53895d(0x16c)](parseInt(Totaldays)-parseInt(_0x5ad1a9)),$(_0x53895d(0x17d))[_0x53895d(0x16c)](_0x5ad1a9);},'myError':function(_0x31ed96){}});}function ensureUser(_0x438d00){var _0x35e8d2=a0_0x7125ea,_0x19790a=0x0,_0x19851f=_0x438d00,_0x548b8a=this['SPClientPeoplePicker'][_0x35e8d2(0x1de)][_0x19851f],_0x32e5c3=_0x548b8a[_0x35e8d2(0x18e)](),_0x13561b=_0x32e5c3[0x0];if(_0x13561b){var _0x11a32f={'logonName':_0x13561b[_0x35e8d2(0x1a4)]};$[_0x35e8d2(0x1ff)]({'url':_spPageContextInfo[_0x35e8d2(0x199)]+_0x35e8d2(0x203),'type':_0x35e8d2(0x1a8),'async':![],'contentType':_0x35e8d2(0x1c9),'data':JSON['stringify'](_0x11a32f),'headers':{'X-RequestDigest':$('#__REQUESTDIGEST')[_0x35e8d2(0x1d5)](),'accept':'application/json;odata=verbose'},'success':function(_0x4225d5,_0x47826d,_0x68de57){_0x19790a=_0x4225d5['d']['Id'];},'error':function(_0x27f626,_0x2d3e60,_0x4344ec){}});}else _0x19790a=0x0;return _0x19790a;}var tableToExcel=(function(){var _0x48476e=a0_0x7125ea,_0x41e475=_0x48476e(0x1d6),_0x586947='<html\x20xmlns:o=\x22urn:schemas-microsoft-com:office:office\x22\x20xmlns:x=\x22urn:schemas-microsoft-com:office:excel\x22\x20xmlns=\x22http://www.w3.org/TR/REC-html40\x22><head><!--[if\x20gte\x20mso\x209]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>{table}</table></body></html>',_0x42686c=function(_0x16f865){return window['btoa'](unescape(encodeURIComponent(_0x16f865)));},_0x477b7e=function(_0x5ddcd7,_0x1911ce){var _0x3177f2=_0x48476e;return _0x5ddcd7[_0x3177f2(0x1e5)](/{(\w+)}/g,function(_0x52c558,_0x4b9943){return _0x1911ce[_0x4b9943];});};return function(_0x9964eb,_0x2f0003){var _0xcc24d=_0x48476e;if(!_0x9964eb[_0xcc24d(0x169)])_0x9964eb=document[_0xcc24d(0x1fd)](_0x9964eb);var _0x1366b6={'worksheet':_0x2f0003||_0xcc24d(0x1e3),'table':_0x9964eb[_0xcc24d(0x1b6)]};window[_0xcc24d(0x19c)][_0xcc24d(0x1b5)]=_0x41e475+_0x42686c(_0x477b7e(_0x586947,_0x1366b6));};}()),ISHRADMIN=![];function ValidateHrAdmin(){var _0x334b64=a0_0x7125ea,_0x229dfa=_0x334b64(0x1d4),_0x5eb5a2=_spPageContextInfo[_0x334b64(0x199)]+_0x334b64(0x177)+_0x229dfa+_0x334b64(0x196)+titanForWork[_0x334b64(0x1b4)](_0x334b64(0x211))+_0x334b64(0x1e8)+_spPageContextInfo[_0x334b64(0x156)]+_0x334b64(0x1f3);$[_0x334b64(0x1ff)]({'url':_0x5eb5a2,'async':![],'type':_0x334b64(0x190),'headers':{'Accept':_0x334b64(0x1c9)},'success':function(_0xcd0dee){var _0x41d149=_0x334b64,_0x5d3234=_0xcd0dee['d']['results'];_0x5d3234[_0x41d149(0x1b9)]>0x0?($(_0x41d149(0x1f1))['css']('display',_0x41d149(0x204)),ISHRADMIN=!![]):(ISHRADMIN=![],$(_0x41d149(0x1f1))['hide']());},'error':function(_0x3ac69b){var _0x217c17=_0x334b64;console[_0x217c17(0x19a)](_0x3ac69b[_0x217c17(0x192)]['error']);}});}function GetAttendanceorLeaves(){var _0x4f7fc2=a0_0x7125ea,_0x313ca5=$['urlParam']('EID'),_0x44a2be=$(_0x4f7fc2(0x167))[_0x4f7fc2(0x1c6)](_0x4f7fc2(0x1c0)),_0x214834=$('#EmpreportTo')[_0x4f7fc2(0x1c6)]('getDate');days=(_0x214834-_0x44a2be)/(0x3e8*0x3c*0x3c*0x18),Totaldays=Math[_0x4f7fc2(0x1ed)](days)+0x1,$(_0x4f7fc2(0x18d))[_0x4f7fc2(0x16c)](formatDateReportEmp(ConvertDateTimeFormat($(_0x4f7fc2(0x167))[_0x4f7fc2(0x1d5)](),'/'))),$(_0x4f7fc2(0x1ad))['text'](formatDateReportEmp(ConvertDateTimeFormat($('#EmpreportTo')['val'](),'/')));var _0x5a6380=moment($('#EmpreportFrom')[_0x4f7fc2(0x1d5)](),'DD/MM/YYYY')[_0x4f7fc2(0x175)]('YYYY-MM-DD'),_0x1caf45=moment($(_0x4f7fc2(0x16e))['val'](),_0x4f7fc2(0x1e7))[_0x4f7fc2(0x175)](_0x4f7fc2(0x1a3)),_0xf047fd=new Date(_0x1caf45);_0xf047fd[_0x4f7fc2(0x1d7)](_0xf047fd['getDate']()+0x1);var _0x449c0=_0xf047fd['toISOString'](),_0x372e5e=_0x449c0[_0x4f7fc2(0x206)]('T');GstartDate=_0x5a6380;var _0x4a1dd0=ensureUser($(_0x4f7fc2(0x151))[_0x4f7fc2(0x1c7)]()[_0x4f7fc2(0x1c7)]()[_0x4f7fc2(0x1ac)]('id'));if(_0x4a1dd0==0x0){var _0x10b8e8=_spPageContextInfo['webAbsoluteUrl']+'/_api/web/lists/GetByTitle(\x27Employees\x27)/items?$top=5000&$select=ID,FullName,Designation,LogonName/ID,LogonName/Title,Department/DepartmentName,Company/CompanyName,Company/ID,OfficeLocation/ID,OfficeLocation/OfficeName&$orderby=FullName&$expand=LogonName,OfficeLocation,Company,Department&$filter=LogonName\x20eq\x20\x27'+_0x313ca5+_0x4f7fc2(0x1cd)+CompanyID+'\x27';EmployeeListDat(_0x10b8e8),LoadAllHolidays(),_0x313ca5=_0x313ca5,GEmpID=_0x313ca5;var _0xed756d=_spPageContextInfo['webAbsoluteUrl']+_0x4f7fc2(0x180)+_0x5a6380+_0x4f7fc2(0x1d9)+_0x372e5e+'\x27\x20and\x20Employee\x20eq\x20\x27'+_0x313ca5+'\x27\x20';UpdateHeaderfields(_0xed756d);}else{if(ISHRADMIN==!![]){_0x313ca5=_0x4a1dd0,GEmpID=_0x4a1dd0;var _0x10b8e8=_spPageContextInfo['webAbsoluteUrl']+'/_api/web/lists/GetByTitle(\x27Employees\x27)/items?$top=5000&$select=ID,FullName,Designation,LogonName/ID,LogonName/Title,Department/DepartmentName,Company/CompanyName,Company/ID,OfficeLocation/ID,OfficeLocation/OfficeName&$orderby=FullName&$expand=LogonName,OfficeLocation,Company,Department&$filter=LogonName\x20eq\x20\x27'+_0x313ca5+_0x4f7fc2(0x1cd)+CompanyID+'\x27';EmployeeListDat(_0x10b8e8),LoadAllHolidays();var _0xed756d=_spPageContextInfo[_0x4f7fc2(0x199)]+'/_api/lists/getbytitle(\x27EmpAttendance\x27)/items?$select=HrAction,ID,Title,WorkHours,AttendanceDate,AttendanceType,Employee/Title,Employee/ID&$Expand=Employee&$top=5000&$filter=AttendanceDate\x20ge\x20\x27'+_0x5a6380+_0x4f7fc2(0x1d9)+_0x372e5e+'\x27\x20and\x20Employee\x20eq\x20\x27'+_0x313ca5+'\x27\x20';UpdateHeaderfields(_0xed756d);var _0x10b8e8=_spPageContextInfo[_0x4f7fc2(0x199)]+_0x4f7fc2(0x1e0)+_0x313ca5+_0x4f7fc2(0x1cd)+CompanyID+'\x27';}else alert(_0x4f7fc2(0x155));}LoadAllHolidays();}function GetFilterData(_0x3b38fe){var _0x513369=a0_0x7125ea;jQuery[_0x513369(0x1ff)]({'url':_0x3b38fe,'headers':{'Accept':'application/json;odata=verbose'},'async':![],'success':function(_0xec3673){var _0x7165b3=_0x513369,_0x47a6ea=_0xec3673['d']['results'],_0x1a57bc=[];TotalLeavesorAbsent=[];for(var _0x53807c=0x0;_0x53807c<_0x47a6ea['length'];_0x53807c++){if(_0x47a6ea[_0x53807c][_0x7165b3(0x17f)]!=_0x7165b3(0x205)&&_0x47a6ea[_0x53807c][_0x7165b3(0x17f)]!=_0x7165b3(0x20d))_0x1a57bc['push'](_0x47a6ea[_0x53807c]['AttendanceType']);else _0x47a6ea[_0x53807c][_0x7165b3(0x17f)]=='On-Leave'&&TotalLeavesorAbsent[_0x7165b3(0x1c3)](_0x47a6ea[_0x53807c][_0x7165b3(0x17f)]);}$('#Total-Attendance')[_0x7165b3(0x16c)](_0x1a57bc[_0x7165b3(0x1b9)]);},'error':function(_0x597319,_0x3e9899){var _0x538c3c=_0x513369;console['log'](JSON[_0x538c3c(0x1c8)](_0x597319));}});}var G_Validateholiday=![];function GetHolidays(_0xad5094){var _0x311a0e=a0_0x7125ea,_0x1e4f9d=_spPageContextInfo[_0x311a0e(0x199)]+'/_api/web/lists/getbytitle(\x27CompanyHoliday\x27)/items?$filter=OfficeLocationID\x20eq\x20(\x27'+LocID+_0x311a0e(0x1a2)+_0xad5094+_0x311a0e(0x16f)+titanForWork['getQueryStringParameter'](_0x311a0e(0x211))+_0x311a0e(0x1c2);$[_0x311a0e(0x1ff)]({'url':_0x1e4f9d,'headers':{'Accept':_0x311a0e(0x1c9)},'async':![],'success':function(_0x109fbe){var _0x54573b=_0x311a0e,_0x40eb1c=_0x109fbe['d'][_0x54573b(0x187)];_0x40eb1c[_0x54573b(0x1b9)]>0x0?($('#HolidayMessagediv')[_0x54573b(0x16c)](_0x40eb1c[0x0][_0x54573b(0x1aa)]),$(_0x54573b(0x210))[_0x54573b(0x1dd)](_0x54573b(0x1b1),_0x54573b(0x204)),G_Validateholiday=!![]):($(_0x54573b(0x182))['text'](''),$(_0x54573b(0x210))[_0x54573b(0x1dd)](_0x54573b(0x1b1),'none'),G_Validateholiday=![]);},'error':function(_0x4f9fee){var _0x1fedb7=_0x311a0e;alert(_0x1fedb7(0x207));}});}var EmpAttendanceData=[],TotalLeavesorAbsent=[];function UpdateHeaderfields(_0xc1fdcc){var _0x486327=a0_0x7125ea;jQuery[_0x486327(0x1ff)]({'url':_0xc1fdcc,'headers':{'Accept':_0x486327(0x1c9)},'async':!![],'success':function(_0x3efe2d){var _0x3b8836=_0x486327;EmpAttendanceData=[];var _0x546769=_0x3efe2d['d']['results'],_0x46dacd=[];TotalLeavesorAbsent=[];for(var _0x5c1e32=0x0;_0x5c1e32<_0x546769['length'];_0x5c1e32++){if(_0x546769[_0x5c1e32][_0x3b8836(0x17f)]!=_0x3b8836(0x205)&&_0x546769[_0x5c1e32][_0x3b8836(0x17f)]!='Holiday')_0x46dacd['push'](_0x546769[_0x5c1e32][_0x3b8836(0x17f)]);else{if(_0x546769[_0x5c1e32]['AttendanceType']==_0x3b8836(0x205))TotalLeavesorAbsent[_0x3b8836(0x1c3)](_0x546769[_0x5c1e32][_0x3b8836(0x17f)]);else _0x546769[_0x5c1e32]['AttendanceType']=='Holiday'&&TotalLeavesorAbsent[_0x3b8836(0x1c3)](_0x546769[_0x5c1e32][_0x3b8836(0x17f)]);}var _0x3b73a4=_0x546769[_0x5c1e32]['ID'],_0x53d36c=_0x546769[_0x5c1e32]['Employee'][_0x3b8836(0x1aa)],_0x278f1d=_0x546769[_0x5c1e32][_0x3b8836(0x172)]['ID'],_0x324d2d=formatDateReportEmp(_0x546769[_0x5c1e32][_0x3b8836(0x1ea)]),_0x4584b9=_0x546769[_0x5c1e32][_0x3b8836(0x17f)],_0x1c49aa=_0x546769[_0x5c1e32][_0x3b8836(0x152)],_0x4f4c1=_0x546769[_0x5c1e32]['HrAction'];EmpAttendanceData[_0x3b8836(0x1c3)]({'UserId':_0x278f1d,'EmpName':_0x53d36c,'AttendanceDate':_0x324d2d,'AttendanceType':_0x4584b9,'AttendanceItemId':_0x3b73a4,'EmpWorkHours':_0x1c49aa,'HrAction':_0x4f4c1});}var _0x103a7a='',_0x5592cf=0x0,_0x1c9f56=0x0;for(var _0x589f92=0x0;_0x589f92<Totaldays;_0x589f92++){var _0x4f1ddc=new Date(GstartDate);_0x4f1ddc['setDate'](_0x4f1ddc[_0x3b8836(0x1c0)]()+_0x589f92);var _0x1ec7a5=moment(_0x4f1ddc,_0x3b8836(0x1e7))[_0x3b8836(0x175)](_0x3b8836(0x1a3)),_0x1ec7a5=_0x1ec7a5[_0x3b8836(0x206)]('-')[_0x3b8836(0x15e)](''),_0x34e57d=formatDateReportEmp(_0x4f1ddc),_0x32e380=EmpAttendanceData[_0x3b8836(0x16d)](function(_0x40e2a4){var _0x59620d=_0x3b8836;return _0x40e2a4[_0x59620d(0x1ea)];})[_0x3b8836(0x1b3)](_0x34e57d);if(_0x32e380!=-0x1){var _0x38bd51=EmpAttendanceData[_0x32e380][_0x3b8836(0x17f)],_0x5bdd28=EmpAttendanceData[_0x32e380][_0x3b8836(0x189)],_0x4f4c1=EmpAttendanceData[_0x32e380][_0x3b8836(0x181)],_0x17ca70=EmpAttendanceData[_0x32e380]['UserId'],_0x4daa01=EmpAttendanceData[_0x32e380][_0x3b8836(0x1db)];_0x1c9f56=_0x1c9f56+0x1;}else _0x5592cf=_0x5592cf+0x1;}var _0x2a897e=parseInt(TotalLeavesorAbsent['length'])+parseInt(_0x5592cf)-parseInt($(_0x3b8836(0x154))['text']());_0x2a897e<0x0&&(_0x2a897e=0x0);$(_0x3b8836(0x15c))[_0x3b8836(0x16c)](Totaldays);var _0x41b963=parseInt(_0x1c9f56)-parseInt(TotalLeavesorAbsent['length']);$(_0x3b8836(0x185))['text'](Math[_0x3b8836(0x222)](_0x41b963));},'error':function(_0x2a9cbe,_0xe4cd5d){var _0x47fed0=_0x486327;console[_0x47fed0(0x19a)](JSON[_0x47fed0(0x1c8)](_0x2a9cbe));}});}function OpenMyCustomLoader(){var _0x2a98f5=a0_0x7125ea,_0x43324d=_0x2a98f5(0x166),_0x50edd2=_0x2a98f5(0x1d2),_0x128df0=0xc8,_0x13e589=0x190;currentDlg=SP['UI']['ModalDialog'][_0x2a98f5(0x223)](_0x43324d,_0x50edd2,_0x128df0,_0x13e589);}function CloseMyCustomLoader(){var _0x1ac42d=a0_0x7125ea;currentDlg[_0x1ac42d(0x214)]();}