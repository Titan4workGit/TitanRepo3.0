var a0_0x5f55b1=a0_0x4abb;(function(_0x30de33,_0x3c6a2f){var _0x1c517c=a0_0x4abb,_0x2ddb5b=_0x30de33();while(!![]){try{var _0xd24401=-parseInt(_0x1c517c(0x265))/0x1+parseInt(_0x1c517c(0x2a7))/0x2+-parseInt(_0x1c517c(0x275))/0x3*(-parseInt(_0x1c517c(0x1cb))/0x4)+-parseInt(_0x1c517c(0x2c7))/0x5*(parseInt(_0x1c517c(0x1df))/0x6)+parseInt(_0x1c517c(0x2ed))/0x7*(-parseInt(_0x1c517c(0x2d4))/0x8)+-parseInt(_0x1c517c(0x1f5))/0x9*(-parseInt(_0x1c517c(0x2da))/0xa)+-parseInt(_0x1c517c(0x251))/0xb*(-parseInt(_0x1c517c(0x29c))/0xc);if(_0xd24401===_0x3c6a2f)break;else _0x2ddb5b['push'](_0x2ddb5b['shift']());}catch(_0x1b8b13){_0x2ddb5b['push'](_0x2ddb5b['shift']());}}}(a0_0x2e05,0xd94e2));var token,ClientId='',ClentSecret='',ClientUrl='',DeferredObj=$[a0_0x5f55b1(0x233)](),color_red='',Error=0x0,Ready=0x0,Exits=0x0,lblUpdate=0x0,ErrorUser='',alluserdata,contributersGroupId='',counusers=0x0,excelRows,AllCompanies,AllDepartments,AllOfficeLocation,tabledata,pageIndex,UserEmailId,warningmessage='',userfullname='',AvilableLicenses,ReadySelected=[],MiisingSelected=[],AddedEmployeeList=[],IsMiisingSelect,isReadeySelect,peoplePickerDiv='',IsaddedNewEmployee=![],EmployeeId='',EmployeeDepartment='',EmployeeOfficeLocation='',checkedAudience='',IsNotification=![];$(document)[a0_0x5f55b1(0x1c0)](function(){var _0xb5af4e=a0_0x5f55b1;GraphAccessTokenTogetUserDetails(),GetCompanies(),GetOfficeLocation(),GetDepartments(),LoadShowUser([]),GetAllUserId(),GetEmployees(),AvilableLicenses==NaN&&GetEmployees(),$(_0xb5af4e(0x208))[_0xb5af4e(0x1c4)](AvilableLicenses);});function initializePeoplePicker(_0x5481cb){var _0x1c171d=a0_0x5f55b1,_0x4b2f7c={};_0x4b2f7c['PrincipalAccountType']=_0x1c171d(0x2e5),_0x4b2f7c['SearchPrincipalSource']=0xf,_0x4b2f7c[_0x1c171d(0x293)]=0xf,_0x4b2f7c[_0x1c171d(0x2dc)]=![],_0x4b2f7c['MaximumEntitySuggestions']=0x32,_0x4b2f7c['Width']='251px',this['SPClientPeoplePicker_InitStandaloneControlWrapper'](_0x5481cb,null,_0x4b2f7c),$('.sp-peoplepicker-editorInput')['width'](0xfa);}function GetSelectItem(){var _0x538072=a0_0x5f55b1;IsaddedNewEmployee=![];if(contributersGroupId!==''){var _0x5d9d38=tabledata[_0x538072(0x1da)]();counusers=0x0;for(var _0xc9cf6f=0x0;_0xc9cf6f<_0x5d9d38['length'];_0xc9cf6f++){var _0x150480=alluserdata['filter'](function(_0x436b3d){var _0x790431=_0x538072;return _0x436b3d[_0x790431(0x235)]==_0x5d9d38[_0xc9cf6f][_0x790431(0x205)]['data'][_0x790431(0x235)];});AvilableLicenses>0x0?_0x150480[0x0][_0x538072(0x1be)]=='Ready'?(AddNewEmployeeAllocated(_0x150480,'Employees'),IsaddedNewEmployee=!![]):_0x150480[0x0]['Status']==_0x538072(0x211)&&UpdateExistingEmployeeAllocated(_0x150480,_0x538072(0x27f)):($(_0x538072(0x1cf))['text'](counusers),alert(_0x538072(0x1f6)),_0xc9cf6f=_0x5d9d38[_0x538072(0x1d3)]);}warningmessage!=''&&(warningmessage+=userfullname,alert(warningmessage)),$(_0x538072(0x1cf))['text'](counusers),showmessage(),tabledata['setData'](excelRows),tabledata[_0x538072(0x27e)](pageIndex),IsaddedNewEmployee&&($(_0x538072(0x24f))[_0x538072(0x25b)]({'backdrop':_0x538072(0x23d),'keyboard':![]},_0x538072(0x2f7)),AddedEmployeeList['length']>0x0?$(_0x538072(0x28e))['show']():$(_0x538072(0x28e))[_0x538072(0x1f0)]());}else GetGroupIDByGroupName(),GetSelectItem();}var Temparray=[];$(a0_0x5f55b1(0x2a2))['click'](function(){var _0x2f78a4=a0_0x5f55b1;debugger;Temparray=alluserdata;let _0x5ed8d2=[...new Set(Temparray[_0x2f78a4(0x243)](_0x3a4f8f=>_0x3a4f8f[_0x2f78a4(0x1e3)]))];var _0x11052d=document['getElementById'](_0x2f78a4(0x1f4));_0x11052d[_0x2f78a4(0x229)]='',opt['value']='0',opt[_0x2f78a4(0x1c4)]=_0x2f78a4(0x1c2),_0x11052d[_0x2f78a4(0x1eb)](opt);for(var _0x406fb0=0x0;_0x406fb0<_0x5ed8d2[_0x2f78a4(0x1d3)];_0x406fb0++){opt=document[_0x2f78a4(0x2c1)](_0x2f78a4(0x24a)),opt[_0x2f78a4(0x1cc)]=_0x5ed8d2[_0x406fb0],opt[_0x2f78a4(0x1c4)]=_0x5ed8d2[_0x406fb0],_0x11052d[_0x2f78a4(0x1eb)](opt);}Temparray=alluserdata;var _0x2e375e=[...new Set(Temparray['map'](_0x3336b3=>_0x3336b3[_0x2f78a4(0x264)]))],_0x11052d=document[_0x2f78a4(0x200)](_0x2f78a4(0x2b1)),_0x54b593=_0x2f78a4(0x201);for(var _0x406fb0=0x0;_0x406fb0<_0x2e375e['length'];_0x406fb0++){_0x54b593+=_0x2f78a4(0x298)+_0x2e375e[_0x406fb0]+'\x22>'+_0x2e375e[_0x406fb0]+_0x2f78a4(0x1c1);}$('#ddlfilterOfficeLocation')['html'](_0x54b593),Temparray=alluserdata;let _0x513f24=[...new Set(Temparray[_0x2f78a4(0x243)](_0x32a936=>_0x32a936[_0x2f78a4(0x2d5)]))];var _0x11052d=document[_0x2f78a4(0x200)](_0x2f78a4(0x1ff));_0x11052d['innerHTML']='',opt['value']='0',opt[_0x2f78a4(0x1c4)]=_0x2f78a4(0x25d),_0x11052d[_0x2f78a4(0x1eb)](opt);for(var _0x406fb0=0x0;_0x406fb0<_0x513f24[_0x2f78a4(0x1d3)];_0x406fb0++){opt=document[_0x2f78a4(0x2c1)](_0x2f78a4(0x24a)),opt[_0x2f78a4(0x1cc)]=_0x513f24[_0x406fb0],opt[_0x2f78a4(0x1c4)]=_0x513f24[_0x406fb0],_0x11052d[_0x2f78a4(0x1eb)](opt);}}),$(a0_0x5f55b1(0x2b2))['click'](function(){var _0x5ca129=a0_0x5f55b1;let _0x5456f2;var _0x4343d0='',_0x198513=!![];$(_0x5ca129(0x273))[_0x5ca129(0x26f)]()!='0'&&(_0x198513=![]);if($(_0x5ca129(0x25f))[_0x5ca129(0x26f)]()!='0')_0x198513=![];else return alert(_0x5ca129(0x28f)),![];if($(_0x5ca129(0x1f2))[_0x5ca129(0x26f)]()!='0')_0x198513=![];else return alert(_0x5ca129(0x2a4)),![];_0x5456f2=alluserdata['filter'](function(_0x1e6bdf){var _0x443193=_0x5ca129;return _0x1e6bdf['Location\x20*']==$('option:selected',$(_0x443193(0x1f2)))[_0x443193(0x26f)]()&&_0x1e6bdf[_0x443193(0x2d5)]==$(_0x443193(0x23a),$(_0x443193(0x25f)))['val']()&&_0x1e6bdf[_0x443193(0x1e3)]==$(_0x443193(0x23a),$(_0x443193(0x273)))[_0x443193(0x26f)]();});var _0x22f3a7=alluserdata[_0x5ca129(0x253)](_0x227a7c=>_0x227a7c['Location\x20*']===$(_0x5ca129(0x23a),$(_0x5ca129(0x1f2)))[_0x5ca129(0x26f)]()&&_0x227a7c[_0x5ca129(0x2d5)]==$(_0x5ca129(0x23a),$(_0x5ca129(0x25f)))['val']()&&_0x227a7c[_0x5ca129(0x1e3)]==$(_0x5ca129(0x23a),$(_0x5ca129(0x273)))[_0x5ca129(0x26f)]());_0x198513?LoadShowUser(alluserdata):LoadShowUser(_0x5456f2);}),$('.searching')[a0_0x5f55b1(0x20d)](function(_0x20ff0d){var _0x1602e1=a0_0x5f55b1;LoadShowUser(search($(_0x1602e1(0x1d7))[_0x1602e1(0x26f)]()));});function search(_0x488c84){var _0x445e2d=a0_0x5f55b1;return alluserdata[_0x445e2d(0x289)](function(_0x1819d5){var _0x6a4605=_0x445e2d;return _0x1819d5[_0x6a4605(0x2d0)][_0x6a4605(0x266)]()[_0x6a4605(0x2f9)](_0x488c84[_0x6a4605(0x266)]())>-0x1||_0x1819d5[_0x6a4605(0x235)][_0x6a4605(0x266)]()[_0x6a4605(0x2f9)](_0x488c84[_0x6a4605(0x266)]())>-0x1;});}$(a0_0x5f55b1(0x22a))['change'](function(){var _0x1c8dc2=a0_0x5f55b1;checkedAudience=this[_0x1c8dc2(0x1cc)];}),$(a0_0x5f55b1(0x2d6))['on'](a0_0x5f55b1(0x2f1),function(){var _0x702fa0=a0_0x5f55b1;$[_0x702fa0(0x2ce)]({'cache':![],'beforeSend':function(){var _0x4de3b4=_0x702fa0;$(_0x4de3b4(0x214))[_0x4de3b4(0x2ca)]();},'success':function(_0xd7d98c){var _0x243ed8=_0x702fa0;AddedEmployeeList=[],SubmitReady(),$(_0x243ed8(0x214))[_0x243ed8(0x28a)]();}});}),$(a0_0x5f55b1(0x26c))['on'](a0_0x5f55b1(0x2f1),function(){$['ajax']({'cache':![],'beforeSend':function(){var _0x1b7dd2=a0_0x4abb;$(_0x1b7dd2(0x214))['fadeIn']();},'success':function(_0x6c7f94){var _0x412500=a0_0x4abb;if(AddedEmployeeList['length']>0x0&&checkedAudience!='NotSave')for(var _0x2d20df=0x0;_0x2d20df<AddedEmployeeList[_0x412500(0x1d3)];_0x2d20df++){var _0x54011d=new Date(AddedEmployeeList[_0x2d20df][_0x412500(0x1e0)][_0x412500(0x294)]),_0x3f871c=new Date();_0x3f871c['setMonth'](_0x54011d[_0x412500(0x299)]()+0x3),_0x54011d=$['datepicker'][_0x412500(0x257)](_0x412500(0x2a6),_0x54011d),_0x3f871c=$['datepicker'][_0x412500(0x257)](_0x412500(0x2a6),_0x3f871c);var _0xc6b219=new Date(AddedEmployeeList[_0x2d20df]['Metadata'][_0x412500(0x294)]);_0xc6b219=$[_0x412500(0x2ee)][_0x412500(0x257)]('dd\x20M\x20yy',_0xc6b219);var _0x362c72=[],_0x2805fb=[],_0x381323=[];_0x381323['push'](Logged_CompanyId);var _0x23bf7b;_0x23bf7b={'__metadata':{'type':'SP.Data.AnnouncementsListItem'}},(_0x23bf7b[_0x412500(0x21d)]=_0x412500(0x285),_0x23bf7b[_0x412500(0x2ec)]=AddedEmployeeList[_0x2d20df]['EmployeeId'][_0x412500(0x2d9)](),_0x23bf7b[_0x412500(0x27c)]=_0x412500(0x27b),_0x23bf7b[_0x412500(0x2c3)]=AddedEmployeeList[_0x2d20df][_0x412500(0x1e0)][_0x412500(0x292)],_0x23bf7b[_0x412500(0x24b)]=AddedEmployeeList[_0x2d20df][_0x412500(0x1e0)][_0x412500(0x24b)],_0x23bf7b[_0x412500(0x29d)]=AddedEmployeeList[_0x2d20df]['EmployeeDepartment'],_0x23bf7b[_0x412500(0x1ce)]=AddedEmployeeList[_0x2d20df][_0x412500(0x1c6)],_0x23bf7b[_0x412500(0x241)]=_0x412500(0x28c),_0x23bf7b['WebPartName']=_0x412500(0x285),_0x23bf7b[_0x412500(0x260)]=checkedAudience,_0x23bf7b['ApprovalStatus']=_0x412500(0x2ac),_0x23bf7b[_0x412500(0x25c)]=_0x54011d,_0x23bf7b[_0x412500(0x238)]=_0x3f871c,_0x23bf7b[_0x412500(0x2b3)]=_0x412500(0x218)+_0xc6b219);if(checkedAudience==_0x412500(0x296))_0x381323=[0x0],_0x362c72=[0x0],_0x2805fb=[0x0],_0x23bf7b[_0x412500(0x2bb)]={'results':_0x381323},_0x23bf7b[_0x412500(0x271)]={'results':_0x2805fb},_0x23bf7b[_0x412500(0x215)]={'results':_0x362c72};else{if(checkedAudience==_0x412500(0x2a0))_0x381323[_0x412500(0x1d2)](AddedEmployeeList[_0x2d20df][_0x412500(0x1e0)][_0x412500(0x2bb)]),_0x362c72=[0x0],_0x2805fb=[0x0],_0x23bf7b[_0x412500(0x2bb)]={'results':_0x381323},_0x23bf7b[_0x412500(0x271)]={'results':_0x2805fb},_0x23bf7b[_0x412500(0x215)]={'results':_0x362c72};else{if(checkedAudience==_0x412500(0x29d))_0x381323=[0x0],_0x362c72=[0x0],_0x2805fb[_0x412500(0x1d2)](AddedEmployeeList[_0x2d20df][_0x412500(0x1e0)]['DepartmentId']),_0x23bf7b[_0x412500(0x2bb)]={'results':_0x381323},_0x23bf7b[_0x412500(0x271)]={'results':_0x2805fb},_0x23bf7b['OfficeLocationsId']={'results':_0x362c72};else checkedAudience==_0x412500(0x2b7)&&(_0x381323=[0x0],_0x362c72[_0x412500(0x1d2)](AddedEmployeeList[_0x2d20df][_0x412500(0x1e0)][_0x412500(0x225)]),_0x2805fb=[0x0],_0x23bf7b[_0x412500(0x2bb)]={'results':_0x381323},_0x23bf7b[_0x412500(0x271)]={'results':_0x2805fb},_0x23bf7b[_0x412500(0x215)]={'results':_0x362c72});}}InsertWelcomeInAnnouncementList(_0x23bf7b);}$(_0x412500(0x214))[_0x412500(0x28a)]();}});});function a0_0x2e05(){var _0x8ef303=['#chkManager','change','Home\x20Address','390kVyUge','Metadata','getRow','Sate','Company\x20*','application/json','LogonNameId','chkTopExecutive','EmployeeSyncReport.xlsx','EntityData','ddlDepartment','&$top=1','appendChild','round','read','Invalid\x20Profile','download','hide','onload','#ddlfilterOfficeLocation','application/json;\x20odata=verbose','ddlfilterAllCompanies','36WbhFJX','Your\x20License\x20limit\x20has\x20been\x20ended','Total\x20Row\x20Count:\x20','done',',roleDefId=','Bearer\x20','charAt','html','chkGroup','Please\x20upload\x20a\x20valid\x20Excel\x20file.','ddlfilterDepartments','getElementById','<option\x20value=\x220\x22><strong>All</strong></option>','message','#UploadedItems','/_api/SP.OAuth.Token/Acquire','_row','sheet_to_row_object_array','chkDepartment','#AvilableLicenses','/_api/web/sitegroups(','readAsArrayBuffer','remove','utils','keyup','append','#ddlOfficeLocation','<input\x20type=\x22checkbox\x22\x20id=\x22IsMiisingSelected\x22\x20onclick=\x22IsMiisingSelecteds()\x22\x20/>','Already\x20Exist','DepartmentId','\x27)\x20and\x20(Status\x20eq\x20\x27Active\x27)','#overlaysearch','OfficeLocationsId','stringify','Country','DOJ:\x20','getValue','center','target','#upload','Announcement_Type','GET','byteLength','15%','https://graph.microsoft.com/.default','Chief\x20Executive','OfficeName','close','OfficeLocationId','webAbsoluteUrl','after','Mobile','innerHTML','input[type=radio][name=datasend]','mail','_cell','when','color-red','<input\x20type=\x22checkbox\x22\x20class=\x22\x22\x20disabled\x20/>','chkDesignation','<h3\x20class=\x27m-0\x27>','Postal\x20Address','Deferred','Date\x20Of\x20Joining','Email\x20*','[id$=\x27AssaginTomanager_TopSpan\x27]','PATCH','Expires','setHours','option:selected','resolve','/_api/web/lists/GetByTitle(\x27','static','ClientName','Departments','Data\x20Send\x20to\x20Announcements','UserType','application/json;odata=nometadata','map','Gender','displayName','EmpUserId','results','Manager','deselect','option','Designation','Updated','City','select','#successfully_notifications','files','440wIFjMA','toUpperCase','find','/_api/web/lists/getByTitle(\x27DepartmentalDMS\x27)/roleassignments/addroleassignment(principalid=','SiteURL','Not\x20SP\x20Permission','formatDate','This\x20browser\x20does\x20not\x20support\x20HTML5.','AssaginTomanager','SP.Data.','modal','Publish_Date','All','#lblUpdate','#ddlfilterDepartments','Audience','prop','Email','__next','Location\x20*','1638340xNiqOD','toLowerCase','IsMiisingSelected','Required\x20Value\x20Missing','fitColumns','reject','#__REQUESTDIGEST','#btnAudience','ListItem','\x20,\x20','val','chkOfficeLocation','DepartmentsId','toISOString','#ddlfilterAllCompanies','ChangeFileName','1907382bAIdPX','split','findIndex','select#dropDownId\x20option:selected','Worng\x20Manager','SP.User','New\x20Joinee','Title','access_token','setPage','Employees','json','promise','User\x20has\x20been\x20assigned\x20permission\x20.','/_api/web/lists/getbytitle(\x27','#btnmissingrequedvalue','Welcome','/_api/web/lists/GetByTitle(\x27Employees\x27)/items?$top=999&$select=ID,AttachmentFiles,FullName,Designation,Manager,MobileNumber,ExtensionName,Email,LogonName/UserName,Department/DepartmentName,Company/CompanyName,Company/ID,OfficeLocation/ID,OfficeLocation/OfficeName&$orderby=FullName&$expand=LogonName,OfficeLocation,Company,Department,AttachmentFiles\x20&$filter=\x20PrimaryCompany\x20eq\x20\x27Primary\x27\x20and\x20Status\x20eq\x20\x27Active\x27\x20','.select-row_isReadeySelected','application/json;odata=verbose','filter','fadeOut','#Ready','Internal\x20Users','selectRow','#divAudience','Please\x20select\x20Department','/_api/web/lists/getbytitle(\x27ExternalUsers\x27)/items?$select=*,InternalStakeholders/Title,Supervisor_Guest/Title,Client_Name/Title,LoginName/Title\x20&$expand=\x20LoginName,Client_Name,Supervisor_Guest,InternalStakeholders\x20&$filter=(ValidUpto\x20ge\x20\x27','Date\x20Of\x20Marriage','FullName','ResolvePrincipalSource','JoiningDate','concat','Corporate','.select-row_IsMiisingSelected','<option\x20value=\x22','getMonth','#dvExcel','\x27)/items?$select=ID&$filter=ID\x20eq\x20','540564IHxEcd','Department','row','#UploadExcel','Company','https://graph.microsoft.com/v1.0/users?$filter=mail\x20eq\x20\x27','#btnFilter','Sheets','Please\x20select\x20Location','setData','mm/dd/yy','2233900nVZfId','onclick','.form-check-input','#Error','10%','Approved','Primary','Type','POST','Ready','ddlfilterOfficeLocation','#btnfiltervalue','Description','/_api/web/sitegroups/getbyname(\x27Contributors\x27)?$select=id','/_api/web/lists/GetByTitle(\x27Announcements\x27)/items','i:0#.f|membership|','Location','SheetNames','<span\x20class=\x27breakpoint\x27></span>','#btnUploadExcel','CompanyId','ddlOfficeLocation','.breakpoint','exceltble','test','Company\x20Id\x20is\x20not\x20Correct','createElement','DepartmentName','EmployeeName','CompanyIDId','#isReadeySelected','checked','2675cZAxKZ','slice','removeProp','fadeIn','Office\x20Location\x20Id\x20is\x20not\x20Correct','\x20<span\x20style=\x27color:red;\x20font-weight:bold;\x27>','chkManager','ajax','result','Name','Employee\x20Code','User\x20Added','@odata.nextLink','9496152LYANqg','Department\x20*','#btnsubmitready','data','empty','toString','488980YaVuzO','binary','AllowMultipleValues','Designation\x20*','application/x-www-form-urlencoded','The\x20following\x20users\x20failed\x20to\x20sync\x20due\x20to\x20wrong\x20manager\x20defined!.\x0a','join','readAsBinaryString','ddlAllCompanies','\x27)/items','log','User,DL,SecGroup,SPGroup','\x20<span\x20style=\x27color:blue;\x20font-weight:bold;\x27>','.tabulator-page-size','#txtGroup','/_api/web/siteusers(@v)?@v=\x27','getElement','deselectRow','EmployeeID','7toKptM','datepicker','Manager\x20*','/_api/web/lists/getByTitle(\x27OfficeLocation\x27)/items?$select=*&$top=4900','click','fromCharCode','#Rowcount','undefined','Added','responseText','show','/_api/web/lists/getByTitle(\x27','indexOf','Department\x20Id\x20is\x20not\x20Correct','Status','#chkTopExecutive','ready','</option>','Select\x20Company','#txtDesignation','text','isReadeySelected','EmployeeOfficeLocation','#ddlDepartment','/_api/web/lists/getByTitle(\x27Departments\x27)/items?$select=*&$top=4900','siteAbsoluteUrl','<input\x20type=\x22checkbox\x22\x20id=\x22isReadeySelected\x22\x20onclick=\x22isReadeySelecteds()\x22\x20/>','4liuCIL','value','GetAllUserInfo','OfficeLocation','#added','OfficeNameDetail','PIN/ZIP','push','length','#Exits','DepartmentNameDetail','EnvironmentalSettings','.searching','Group\x20Name','Data\x20Send\x20to\x20Announcements\x20Failed','getSelectedRows','#txtmanager'];a0_0x2e05=function(){return _0x8ef303;};return a0_0x2e05();}function SubmitReady(){var _0x45e18a=a0_0x5f55b1;if(contributersGroupId!==''){var _0x10d9a6=tabledata[_0x45e18a(0x1da)]();counusers=0x0,IsaddedNewEmployee=![];for(var _0x2b6768=0x0;_0x2b6768<_0x10d9a6[_0x45e18a(0x1d3)];_0x2b6768++){var _0x5a455e=alluserdata[_0x45e18a(0x289)](function(_0x13bf20){var _0x3408f4=_0x45e18a;return _0x13bf20['Email\x20*']==_0x10d9a6[_0x2b6768][_0x3408f4(0x205)][_0x3408f4(0x2d7)][_0x3408f4(0x235)];});if(AvilableLicenses>0x0)_0x5a455e[0x0][_0x45e18a(0x1be)]==_0x45e18a(0x2b0)?(AddNewEmployeeAllocated(_0x5a455e,'Employees'),IsaddedNewEmployee=!![]):_0x5a455e[0x0][_0x45e18a(0x1be)]=='Already\x20Exist'&&UpdateExistingEmployeeAllocated(_0x5a455e,_0x45e18a(0x27f));else return alert(_0x45e18a(0x1f6)),![];}warningmessage!=''&&(warningmessage+=userfullname,alert(warningmessage)),$(_0x45e18a(0x1cf))[_0x45e18a(0x1c4)](counusers),showmessage(),tabledata[_0x45e18a(0x2a5)](excelRows),tabledata['setPage'](pageIndex),IsaddedNewEmployee&&($(_0x45e18a(0x24f))[_0x45e18a(0x25b)]({'backdrop':_0x45e18a(0x23d),'keyboard':![]},'show'),AddedEmployeeList['length']>0x0?$('#divAudience')['show']():$('#divAudience')[_0x45e18a(0x1f0)]());}else GetGroupIDByGroupName(),GetSelectItem();}function isReadeySelecteds(){var _0x2f25af=a0_0x5f55b1;isReadeySelect=document[_0x2f25af(0x200)](_0x2f25af(0x1c5));if(isReadeySelect[_0x2f25af(0x2c6)]){tabledata[_0x2f25af(0x2eb)](MiisingSelected),$('.select-row_IsMiisingSelected')[_0x2f25af(0x261)](_0x2f25af(0x2c6),![]),$('#IsMiisingSelected')['prop'](_0x2f25af(0x2c6),![]),ReadySelected=[];for(var _0x1808ed=0x0;_0x1808ed<excelRows[_0x2f25af(0x1d3)];_0x1808ed++){(excelRows[_0x1808ed][_0x2f25af(0x1be)]==_0x2f25af(0x2b0)||excelRows[_0x1808ed][_0x2f25af(0x1be)]==_0x2f25af(0x211))&&ReadySelected[_0x2f25af(0x1d2)](_0x1808ed);}$(_0x2f25af(0x287))[_0x2f25af(0x261)]('checked',!![]),tabledata[_0x2f25af(0x28d)](ReadySelected);}else tabledata[_0x2f25af(0x2eb)](ReadySelected),$(_0x2f25af(0x287))['prop'](_0x2f25af(0x2c6),![]);}function IsMiisingSelecteds(){var _0x2062ce=a0_0x5f55b1;IsMiisingSelect=document[_0x2062ce(0x200)](_0x2062ce(0x267));if(IsMiisingSelect[_0x2062ce(0x2c6)]){tabledata[_0x2062ce(0x2eb)](ReadySelected),$(_0x2062ce(0x2c5))[_0x2062ce(0x261)]('checked',![]),$('.select-row_isReadeySelected')[_0x2062ce(0x261)](_0x2062ce(0x2c6),![]),MiisingSelected=[];for(var _0x1c3348=0x0;_0x1c3348<excelRows['length'];_0x1c3348++){(excelRows[_0x1c3348][_0x2062ce(0x1be)]==_0x2062ce(0x268)||excelRows[_0x1c3348][_0x2062ce(0x1be)]=='Already\x20Exist'||excelRows[_0x1c3348][_0x2062ce(0x1be)]==_0x2062ce(0x2b0))&&(MiisingSelected[_0x2062ce(0x1d2)](_0x1c3348),$(_0x2062ce(0x297))[_0x2062ce(0x261)](_0x2062ce(0x2c6),!![]));}tabledata[_0x2062ce(0x28d)](MiisingSelected);}else tabledata[_0x2062ce(0x2eb)](MiisingSelected),$(_0x2062ce(0x297))[_0x2062ce(0x261)]('checked',![]);}function AssignPermissiononDMSLibary(_0x5e7605,_0x12841d,_0xb73e45){var _0x1bde1a=a0_0x5f55b1,_0x2a418c={'Accept':'application/json;odata=verbose','content-Type':'application/json;odata=verbose','X-RequestDigest':jQuery('#__REQUESTDIGEST')[_0x1bde1a(0x26f)]()},_0x3d0f9a=_0xb73e45+_0x1bde1a(0x254)+_0x5e7605+_0x1bde1a(0x1f9)+_0x12841d+')';$[_0x1bde1a(0x2ce)]({'url':_0x3d0f9a,'type':_0x1bde1a(0x2af),'headers':_0x2a418c,'dataType':_0x1bde1a(0x280),'async':![],'success':function(_0x3c9547){var _0x58724b=_0x1bde1a;console[_0x58724b(0x2e4)](_0x58724b(0x282));},'error':function(_0x358687){var _0xbcbfe1=_0x1bde1a;console[_0xbcbfe1(0x2e4)](JSON[_0xbcbfe1(0x216)](_0x358687)),Permissionloder[_0xbcbfe1(0x224)]();}});}function GetGroupIDByGroupName(){var _0x51ffd0=a0_0x5f55b1,_0x2c2bac=_spPageContextInfo[_0x51ffd0(0x226)]+_0x51ffd0(0x2b4);$[_0x51ffd0(0x2ce)]({'url':_0x2c2bac,'method':'GET','async':![],'headers':{'Accept':_0x51ffd0(0x1f3)},'success':function(_0x29abd3){contributersGroupId=_0x29abd3['d']['Id'];},'error':function(_0x328a2a){var _0x327ccc=_0x51ffd0;console[_0x327ccc(0x2e4)](_0x328a2a);}});}function GetListItems(_0x4508de,_0x3bd014){var _0x44d7f8=a0_0x5f55b1,_0x5ba8b7,_0xa68046=_spPageContextInfo[_0x44d7f8(0x226)]+_0x44d7f8(0x2f8)+_0x4508de+_0x44d7f8(0x29b)+_0x3bd014+_0x44d7f8(0x1ea);return $[_0x44d7f8(0x2ce)]({'url':_0xa68046,'method':_0x44d7f8(0x21e),'async':![],'headers':{'Accept':'application/json;\x20odata=verbose'},'success':function(_0xdedce){var _0xe66a7c=_0x44d7f8;_0xdedce['d'][_0xe66a7c(0x247)][_0xe66a7c(0x1d3)]>0x0?_0x5ba8b7=![]:_0x5ba8b7=!![];},'error':function(_0x2d4921){var _0x4ae4f4=_0x44d7f8;console[_0x4ae4f4(0x2e4)](_0x2d4921);}}),_0x5ba8b7;}function GetCompanies(){var _0xdeaa6d=a0_0x5f55b1,_0x1b3cee=_spPageContextInfo[_0xdeaa6d(0x226)]+'/_api/web/lists/getByTitle(\x27Companies\x27)/items?$select=*&$top=4900';$[_0xdeaa6d(0x2ce)]({'url':_0x1b3cee,'method':'GET','async':![],'headers':{'Accept':_0xdeaa6d(0x1f3)},'success':function(_0x391b00){var _0x34fcb7=_0xdeaa6d;AllCompanies=_0x391b00['d'][_0x34fcb7(0x247)];},'error':function(_0x1f0dcc){var _0x4a1713=_0xdeaa6d;console[_0x4a1713(0x2e4)](_0x1f0dcc);}});}function GetDepartments(){var _0x539eb5=a0_0x5f55b1,_0x2695d1=_spPageContextInfo['webAbsoluteUrl']+_0x539eb5(0x1c8);$[_0x539eb5(0x2ce)]({'url':_0x2695d1,'method':_0x539eb5(0x21e),'async':![],'headers':{'Accept':_0x539eb5(0x1f3)},'success':function(_0x4c7a5e){AllDepartments=_0x4c7a5e['d']['results'];},'error':function(_0x3a55d3){var _0x234567=_0x539eb5;console[_0x234567(0x2e4)](_0x3a55d3);}});}function GetOfficeLocation(){var _0x2d535f=a0_0x5f55b1,_0x39499=_spPageContextInfo[_0x2d535f(0x226)]+_0x2d535f(0x2f0);$[_0x2d535f(0x2ce)]({'url':_0x39499,'method':_0x2d535f(0x21e),'async':![],'headers':{'Accept':_0x2d535f(0x1f3)},'success':function(_0x1ba220){var _0x33052e=_0x2d535f;AllOfficeLocation=_0x1ba220['d'][_0x33052e(0x247)];},'error':function(_0x39bff7){var _0x15a3a8=_0x2d535f;console[_0x15a3a8(0x2e4)](_0x39bff7);}});}function GetSubSiteUrl(_0x5436cb,_0x347615){var _0x1ca851=a0_0x5f55b1,_0x1c8677,_0x1a1cfd=_spPageContextInfo[_0x1ca851(0x226)]+'/_api/web/lists/getByTitle(\x27'+_0x5436cb+'\x27)/items?$select=ID,SiteURL&$filter=ID\x20eq\x20'+_0x347615+'&$top=1';return $[_0x1ca851(0x2ce)]({'url':_0x1a1cfd,'method':_0x1ca851(0x21e),'async':![],'headers':{'Accept':_0x1ca851(0x1f3)},'success':function(_0x2948f2){var _0x35359b=_0x1ca851;_0x1c8677=_0x2948f2['d'][_0x35359b(0x247)][0x0][_0x35359b(0x255)];},'error':function(_0x3fd0f9){var _0x3dbe06=_0x1ca851;console[_0x3dbe06(0x2e4)](_0x3fd0f9);}}),_0x1c8677;}function AddUserinSharePointGroup(_0x56c318){var _0x43a60d=a0_0x5f55b1,_0x15cc93=$[_0x43a60d(0x233)](),_0x128ad4=_0x43a60d(0x2b6),_0x51715a=_0x128ad4+_0x56c318,_0x3af21d=_spPageContextInfo['webAbsoluteUrl']+_0x43a60d(0x209)+contributersGroupId+')/users';$[_0x43a60d(0x2ce)]({'url':_0x3af21d,'type':_0x43a60d(0x2af),'async':![],'data':JSON['stringify']({'__metadata':{'type':_0x43a60d(0x27a)},'LoginName':_0x51715a}),'headers':{'accept':_0x43a60d(0x288),'content-type':_0x43a60d(0x288),'X-RequestDigest':$('#__REQUESTDIGEST')[_0x43a60d(0x26f)]()},'success':_0x7a16c2,'error':_0x2d33c8});function _0x7a16c2(_0x28167a){var _0x1c05a4=_0x43a60d;_0x15cc93[_0x1c05a4(0x23b)](_0x28167a['d']['Id']),console[_0x1c05a4(0x2e4)](_0x1c05a4(0x2d2));}function _0x2d33c8(_0x3cbb4d){var _0x440ab4=_0x43a60d;console[_0x440ab4(0x2e4)](JSON[_0x440ab4(0x216)](_0x3cbb4d));}return _0x15cc93[_0x43a60d(0x281)]();}function GetUserId(_0x6a0606){var _0xc23bdc=a0_0x5f55b1,_0x45dd06='',_0x517288=_0xc23bdc(0x2b6),_0x5ee187=_spPageContextInfo[_0xc23bdc(0x1c9)],_0x1ffc3b=_0x517288+_0x6a0606;return $[_0xc23bdc(0x2ce)]({'url':_0x5ee187+_0xc23bdc(0x2e9)+encodeURIComponent(_0x1ffc3b)+'\x27','method':_0xc23bdc(0x21e),'headers':{'Accept':_0xc23bdc(0x1f3)},'async':![],'success':function(_0x914fd1){_0x45dd06=_0x914fd1['d']['Id'];},'error':function(_0x10892d){var _0x4ba872=_0xc23bdc;console[_0x4ba872(0x2e4)](JSON[_0x4ba872(0x216)](_0x10892d));}}),_0x45dd06;}var GetAllGroupsUser=[],GroupUrl=_spPageContextInfo[a0_0x5f55b1(0x1c9)]+'/_api/web/siteusers?$top=1000&$select=*,Id';function GetAllUserId(){var _0xe1260e=a0_0x5f55b1;$['ajax']({'url':GroupUrl,'method':_0xe1260e(0x21e),'headers':{'Accept':_0xe1260e(0x1f3)},'async':![],'success':function(_0x20fa72){var _0x40e522=_0xe1260e;GetAllGroupsUser=GetAllGroupsUser[_0x40e522(0x295)](_0x20fa72['d']['results']),_0x20fa72['d'][_0x40e522(0x263)]!=null&&(GroupUrl=_0x20fa72['d'][_0x40e522(0x263)],GetAllUserId());},'error':function(_0x1cc75b){var _0x4aba44=_0xe1260e;console[_0x4aba44(0x2e4)](JSON[_0x4aba44(0x216)](_0x1cc75b));}});}var LoginName;function UpdateExistingEmployeeAllocated(_0x2d79c3,_0x5d4222){var _0x26ee25=a0_0x5f55b1;try{UserEmailId=_0x2d79c3[0x0][_0x26ee25(0x235)],LoginName=_0x26ee25(0x2b6)+_0x2d79c3[0x0]['Email\x20*'];var _0x108376,_0x3655f0,_0x35a92a=GetAllGroupsUser['filter'](function(_0x5abf56){var _0x266ac3=_0x26ee25;return _0x5abf56[_0x266ac3(0x262)][_0x266ac3(0x266)]()==_0x2d79c3[0x0][_0x266ac3(0x235)][_0x266ac3(0x266)]();});if(_0x35a92a['length']>0x0)var _0x5c9d53=_0x35a92a[0x0]['Id'];else{}if(TopExecutive==_0x26ee25(0x222)||_0x2d79c3[0x0][_0x26ee25(0x2ef)]==undefined)_0x2d79c3[0x0]['Manager\x20*']=_0x26ee25(0x222),_0x108376=-0x1;else{var _0x1f7545=EmployeeListUsers[_0x26ee25(0x289)](function(_0x586ed9){var _0x3bbc70=_0x26ee25,_0x4f6eda;if(_0x586ed9[_0x3bbc70(0x248)]!=null)return _0x4f6eda=_0x586ed9['Email']['toLowerCase'](),_0x4f6eda==_0x2d79c3[0x0]['Manager\x20*']['toLowerCase']();});if(_0x1f7545[_0x26ee25(0x1d3)]>0x0){_0x3655f0=_0x1f7545[0x0]['FullName'];var _0x35a92a=GetAllGroupsUser['filter'](function(_0x1e8f05){var _0x58ada8=_0x26ee25;return _0x1e8f05[_0x58ada8(0x262)][_0x58ada8(0x266)]()==_0x2d79c3[0x0][_0x58ada8(0x2ef)][_0x58ada8(0x266)]();});if(_0x35a92a[_0x26ee25(0x1d3)]>0x0)_0x108376=_0x35a92a[0x0]['Id'];else{}}else{IsManager=![],_0x108376='';var _0x445f88=excelRows[_0x26ee25(0x277)](_0x7eba24=>_0x7eba24[_0x26ee25(0x235)][_0x26ee25(0x266)]()==_0x2d79c3[0x0][_0x26ee25(0x235)][_0x26ee25(0x266)]());excelRows[_0x445f88][_0x26ee25(0x1be)]=_0x26ee25(0x279);}}var _0x48d898,_0x554677=GetItemTypeForListName(_0x5d4222);_0x48d898={'__metadata':{'type':_0x554677},'Designation':_0x2d79c3[0x0][_0x26ee25(0x2dd)],'GroupName':_0x2d79c3[0x0][_0x26ee25(0x1d8)],'Manager':_0x3655f0,'ManagerLoginNameId':_0x108376},$[_0x26ee25(0x22d)](updateItemExitUser(_0x5d4222,_0x48d898,_0x2d79c3[0x0][_0x26ee25(0x246)]))[_0x26ee25(0x1f8)](function(_0x5b08e4){var _0x1b6e15=_0x26ee25,_0xa40ad3=_0x5b08e4;if(_0xa40ad3){lblUpdate=lblUpdate+0x1,Exits=Exits-0x1;var _0x3ab033=excelRows[_0x1b6e15(0x277)](_0x3a71d0=>_0x3a71d0['Email\x20*']==UserEmailId);excelRows[_0x3ab033][_0x1b6e15(0x1be)]=_0x1b6e15(0x24c),showmessage();}});}catch(_0x135c9d){console[_0x26ee25(0x2e4)](_0x135c9d[_0x26ee25(0x202)]);}}var IsManager=!![];function AddNewEmployeeAllocated(_0x14e3e4,_0x3e379f){var _0x527fe6=a0_0x5f55b1;try{if(GetListItems(_0x527fe6(0x23f),parseInt(_0x14e3e4[0x0][_0x527fe6(0x2d5)])))return alert(_0x527fe6(0x1bd)),![];if(GetListItems('Companies',parseInt(_0x14e3e4[0x0]['Company\x20*'])))return alert(_0x527fe6(0x2c0)),![];else{if(GetListItems(_0x527fe6(0x1ce),parseInt(_0x14e3e4[0x0][_0x527fe6(0x264)])))return alert(_0x527fe6(0x2cb)),![];else{LoginName=_0x14e3e4[0x0][_0x527fe6(0x235)][_0x527fe6(0x266)]();var _0x320e89,_0x2b60fe,_0x416d28=GetAllGroupsUser[_0x527fe6(0x289)](function(_0x3fffe2){var _0x1eb594=_0x527fe6;return _0x3fffe2[_0x1eb594(0x262)]['toLowerCase']()==_0x14e3e4[0x0][_0x1eb594(0x235)][_0x1eb594(0x266)]();}),_0xda5aa;if(_0x416d28[_0x527fe6(0x1d3)]>0x0)var _0xda5aa=_0x416d28[0x0]['Id'];else $['when'](AddUserinSharePointGroup(LoginName))[_0x527fe6(0x1f8)](function(_0x363630){_0xda5aa=_0x363630;});if(TopExecutive==_0x527fe6(0x222)||_0x14e3e4[0x0][_0x527fe6(0x2ef)]==undefined)_0x14e3e4[0x0]['Manager\x20*']='Chief\x20Executive',_0x320e89=-0x1;else{var _0x115259=EmployeeListUsers['filter'](function(_0x2ed500){var _0x59b191=_0x527fe6,_0x141b4e;if(_0x2ed500[_0x59b191(0x262)]!=null)return _0x141b4e=_0x2ed500[_0x59b191(0x262)][_0x59b191(0x266)](),_0x141b4e==_0x14e3e4[0x0]['Manager\x20*'][_0x59b191(0x266)]();});if(_0x115259[_0x527fe6(0x1d3)]>0x0){_0x2b60fe=_0x115259[0x0][_0x527fe6(0x292)];var _0x416d28=GetAllGroupsUser[_0x527fe6(0x289)](function(_0x54bfbc){var _0x3bb56c=_0x527fe6;return _0x54bfbc[_0x3bb56c(0x262)][_0x3bb56c(0x266)]()==_0x14e3e4[0x0][_0x3bb56c(0x2ef)][_0x3bb56c(0x266)]();});_0x416d28[_0x527fe6(0x1d3)]>0x0?_0x320e89=_0x416d28[0x0]['Id']:_0x320e89=AddUserinSharePointGroup(_0x14e3e4[0x0][_0x527fe6(0x2ef)][_0x527fe6(0x266)]());}else{IsManager=![],_0x320e89='';var _0x23033a=excelRows[_0x527fe6(0x277)](_0x1643ff=>_0x1643ff[_0x527fe6(0x235)][_0x527fe6(0x266)]()==LoginName);excelRows[_0x23033a][_0x527fe6(0x1be)]='Wrong\x20Manager';}}var _0x2eccf7,_0x4ba06a=GetItemTypeForListName(_0x3e379f);_0x2eccf7={'__metadata':{'type':_0x4ba06a},'CompanyId':parseInt(_0x14e3e4[0x0][_0x527fe6(0x1e3)]),'DepartmentId':parseInt(_0x14e3e4[0x0]['Department\x20*']),'FullName':_0x14e3e4[0x0]['Name'],'Title':_0x14e3e4[0x0]['Name'],'ParentId':'-1','Email':_0x14e3e4[0x0]['Email\x20*'],'LogonNameId':_0xda5aa,'Manager':_0x14e3e4[0x0][_0x527fe6(0x2ef)],'ManagerLoginNameId':_0x320e89,'OfficeLocationId':parseInt(_0x14e3e4[0x0][_0x527fe6(0x264)]),'MobileNumber':_0x14e3e4[0x0][_0x527fe6(0x228)],'DateOfBirth':_0x14e3e4[0x0]['Date\x20Of\x20Birth'],'Gender':_0x14e3e4[0x0][_0x527fe6(0x244)],'DateOfAnniversary':_0x14e3e4[0x0][_0x527fe6(0x291)],'JoiningDate':_0x14e3e4[0x0]['Date\x20Of\x20Joining'],'Designation':_0x14e3e4[0x0][_0x527fe6(0x2dd)],'PrimaryCompany':_0x527fe6(0x2ad),'EmployeeID':_0x14e3e4[0x0][_0x527fe6(0x2d1)],'GroupName':_0x14e3e4[0x0][_0x527fe6(0x1d8)],'Status':'Active','PostalAddresses':_0x14e3e4[0x0][_0x527fe6(0x232)],'City':_0x14e3e4[0x0][_0x527fe6(0x24d)],'StateProvince':_0x14e3e4[0x0][_0x527fe6(0x1e2)],'ZIPPostalCode':_0x14e3e4[0x0][_0x527fe6(0x1d1)],'Country':_0x14e3e4[0x0][_0x527fe6(0x217)],'HomePhone':_0x14e3e4[0x0]['Home\x20Phone'],'OtherEMailAddress':_0x14e3e4[0x0]['Email(Other)'],'HomeAddress':_0x14e3e4[0x0][_0x527fe6(0x1de)]},AddItemToList(_0x3e379f,_0x2eccf7);var _0x48cdfc=new Date(),_0x3349dc=new Date(_0x14e3e4[0x0][_0x527fe6(0x234)]),_0x50ba43=daysDifference(_0x3349dc,_0x48cdfc);if(_0x50ba43<=0xf)AddedEmployeeList['push']({'Metadata':_0x2eccf7,'EmployeeId':EmployeeId,'EmployeeOfficeLocation':_0x14e3e4[0x0][_0x527fe6(0x1d0)],'EmployeeDepartment':_0x14e3e4[0x0][_0x527fe6(0x1d5)]});else{}}}}catch(_0x594aa8){console[_0x527fe6(0x2e4)](_0x594aa8[_0x527fe6(0x202)]);}}function daysDifference(_0x5eafd4,_0x1d4024){var _0x1a6d35=a0_0x5f55b1,_0x199663=new Date(+_0x1d4024)[_0x1a6d35(0x239)](0xc)-new Date(+_0x5eafd4)[_0x1a6d35(0x239)](0xc);return Math[_0x1a6d35(0x1ec)](_0x199663/0x5265c00);}function updateItemExitUser(_0x1be3ad,_0x8ba452,_0x47ea16){var _0x4c4619=a0_0x5f55b1,_0x17d8d5=$[_0x4c4619(0x233)]();return $[_0x4c4619(0x2ce)]({'url':_spPageContextInfo[_0x4c4619(0x226)]+_0x4c4619(0x283)+_0x1be3ad+'\x27)/GetItemById(\x27'+_0x47ea16+'\x27)','type':_0x4c4619(0x2af),'headers':{'accept':_0x4c4619(0x288),'X-RequestDigest':$(_0x4c4619(0x26b))[_0x4c4619(0x26f)](),'content-Type':_0x4c4619(0x288),'X-Http-Method':_0x4c4619(0x237),'If-Match':'*'},'data':JSON[_0x4c4619(0x216)](_0x8ba452),'async':![],'success':function(_0x328757){var _0x47a369=_0x4c4619;_0x17d8d5[_0x47a369(0x23b)](!![]);},'error':function(_0x2e3318){_0x17d8d5['reject'](_0x2e3318);}}),_0x17d8d5['promise']();}function AddItemToList(_0x613b3c,_0x2a411b){var _0x5768e1=a0_0x5f55b1;UserEmailId=_0x2a411b[_0x5768e1(0x262)];var _0x2a733a=_0x2a411b[_0x5768e1(0x292)];EmployeeId='';var _0x2dcfa6=$[_0x5768e1(0x233)]();return $['ajax']({'url':_spPageContextInfo[_0x5768e1(0x226)]+'/_api/web/lists/getbytitle(\x27'+_0x613b3c+_0x5768e1(0x2e3),'type':_0x5768e1(0x2af),'async':![],'headers':{'accept':'application/json;odata=verbose','X-RequestDigest':$('#__REQUESTDIGEST')[_0x5768e1(0x26f)](),'content-Type':_0x5768e1(0x288)},'data':JSON['stringify'](_0x2a411b),'success':function(_0x364e45){var _0x30e96e=_0x5768e1;EmployeeId=_0x364e45['d']['Id'],counusers=counusers+0x1,AvilableLicenses=AvilableLicenses-0x1,Ready=Ready-0x1;var _0x228276=excelRows[_0x30e96e(0x277)](_0x1e316d=>_0x1e316d['Email\x20*']==UserEmailId);excelRows[_0x228276][_0x30e96e(0x1be)]=_0x30e96e(0x2f5),showmessage();var _0x305ab7=GetSubSiteUrl(_0x30e96e(0x23f),_0x364e45['d'][_0x30e96e(0x212)]);AssignPermissiononDMSLibary(_0x364e45['d'][_0x30e96e(0x1e5)],'1073741826',_0x305ab7),_0x2dcfa6[_0x30e96e(0x23b)](_0x364e45);},'error':function(_0x3bdc10){var _0x508ac2=_0x5768e1;if(IsManager){var _0x252964=excelRows[_0x508ac2(0x277)](_0x12b55d=>_0x12b55d[_0x508ac2(0x235)]==UserEmailId);excelRows[_0x252964]['Status']=_0x508ac2(0x256);}userfullname==''?(userfullname+=_0x2a733a,warningmessage=_0x508ac2(0x2df)):userfullname+=_0x508ac2(0x26e)+_0x2a733a,Ready=Ready-0x1,Error=Error+0x1,console['log'](JSON[_0x508ac2(0x216)](_0x3bdc10)),_0x2dcfa6['reject'](JSON[_0x508ac2(0x216)](_0x3bdc10));}}),_0x2dcfa6[_0x5768e1(0x281)]();}function LoadShowUser(_0x2612e6){var _0x470754=a0_0x5f55b1;tabledata=new Tabulator('#example-table',{'height':'','pagination':'local','paginationSize':0xa,'layout':_0x470754(0x269),'paginationSizeSelector':[0xa,0x19,0x32,0x64],'placeholder':'Please\x20upload\x20xlsx\x20file','data':_0x2612e6,'pageLoaded':function(_0x18962a){var _0x1ebdd0=_0x470754;_0x18962a>=0x1?pageIndex=_0x18962a:pageIndex=_0x18962a,IsMiisingSelect=document['getElementById'](_0x1ebdd0(0x267)),IsMiisingSelect[_0x1ebdd0(0x2c6)]&&$(_0x1ebdd0(0x297))['prop'](_0x1ebdd0(0x2c6),!![]),isReadeySelect=document[_0x1ebdd0(0x200)]('isReadeySelected'),isReadeySelect[_0x1ebdd0(0x2c6)]&&$(_0x1ebdd0(0x287))[_0x1ebdd0(0x261)](_0x1ebdd0(0x2c6),!![]);},'columns':[{'formatter':function(_0x1d3483,_0x30e097){var _0x45da10=_0x470754,_0x51975b=_0x1d3483[_0x45da10(0x22c)][_0x45da10(0x29e)][_0x45da10(0x2d7)][_0x45da10(0x1be)];return _0x51975b==_0x45da10(0x1ee)||_0x51975b==_0x45da10(0x268)||_0x51975b=='Added'||_0x51975b==_0x45da10(0x24c)?_0x45da10(0x22f):'<input\x20type=\x22checkbox\x22\x20class=\x22select-row_isReadeySelected\x22\x20aria-label=\x22select\x20this\x20row\x22\x20/>';},'title':_0x470754(0x1ca),'field':'ID','width':'1%','headerSort':![],'cellClick':function(_0x3c39ec,_0x1a9e01){var _0x4dd2a1=_0x470754,_0x24fdf6=$(_0x1a9e01[_0x4dd2a1(0x2ea)]()),_0x1aa0f4=_0x24fdf6['find']('.select-row_isReadeySelected');_0x1aa0f4[0x0][_0x4dd2a1(0x2c6)]==![]&&$(_0x1a9e01['getRow']()[_0x4dd2a1(0x2ea)]())[_0x4dd2a1(0x253)]('.select-row_IsMiisingSelected')[0x0][_0x4dd2a1(0x2c6)]==![]?_0x1a9e01[_0x4dd2a1(0x1e1)]()['deselect']():_0x1a9e01[_0x4dd2a1(0x1e1)]()[_0x4dd2a1(0x24e)]();}},{'formatter':function(_0x43dd20,_0x48f40c){var _0x161202=_0x470754,_0x2ec02b=_0x43dd20[_0x161202(0x22c)][_0x161202(0x29e)][_0x161202(0x2d7)][_0x161202(0x1be)];return _0x2ec02b==_0x161202(0x268)||_0x2ec02b=='Already\x20Exist'||_0x2ec02b==_0x161202(0x2b0)?'<input\x20type=\x22checkbox\x22\x20class=\x22select-row_IsMiisingSelected\x22\x20aria-label=\x22select\x20this\x20row\x22\x20/>':_0x161202(0x22f);},'title':_0x470754(0x210),'hozAlign':_0x470754(0x21a),'field':'ID','headerSort':![],'width':'1%','cellClick':function(_0x215da7,_0x146a1f){var _0x534631=_0x470754,_0x32cf4e=$(_0x146a1f['getElement']()),_0x11178d=_0x32cf4e[_0x534631(0x253)](_0x534631(0x297));_0x11178d[0x0]['checked']==![]&&$(_0x146a1f[_0x534631(0x1e1)]()[_0x534631(0x2ea)]())[_0x534631(0x253)](_0x534631(0x287))[0x0][_0x534631(0x2c6)]==![]?_0x146a1f[_0x534631(0x1e1)]()[_0x534631(0x249)]():_0x146a1f[_0x534631(0x1e1)]()[_0x534631(0x24e)]();}},{'title':_0x470754(0x1be),'field':_0x470754(0x1be),'width':'8%','formatter':function(_0x105348,_0x75f6e6){var _0x251538=_0x470754,_0x3dc952=_0x105348[_0x251538(0x219)]();if(_0x3dc952==_0x251538(0x1ee)||_0x3dc952==_0x251538(0x268)||_0x3dc952==_0x251538(0x256)||_0x3dc952==_0x251538(0x279))return _0x251538(0x2cc)+_0x3dc952+'</span>';else return _0x3dc952==_0x251538(0x211)?_0x251538(0x2e6)+_0x3dc952+'</span>':'\x20<span\x20style=\x27color:green;\x20font-weight:bold;\x27>'+_0x3dc952+'</span>';}},{'title':'Type','field':_0x470754(0x2ae),'width':_0x470754(0x2ab)},{'title':_0x470754(0x2d0),'field':_0x470754(0x2d0),'width':_0x470754(0x2ab)},{'title':_0x470754(0x262),'field':_0x470754(0x235),'align':'left','width':_0x470754(0x220)},{'title':_0x470754(0x2a0),'field':_0x470754(0x1e3),'width':_0x470754(0x2ab),'align':'center'},{'title':'Department','field':_0x470754(0x2d5),'width':_0x470754(0x2ab),'align':_0x470754(0x21a)},{'title':'Location','field':'Location\x20*','width':'8%','align':_0x470754(0x21a)},{'title':'Designation','field':_0x470754(0x2dd),'width':_0x470754(0x2ab)},{'title':_0x470754(0x248),'field':'Manager\x20*','width':'10%'},{'title':_0x470754(0x234),'field':_0x470754(0x234),'width':_0x470754(0x2ab)},{'title':_0x470754(0x1d8),'field':_0x470754(0x1d8),'width':_0x470754(0x2ab)}]}),showmessage(),$(_0x470754(0x2f3))[_0x470754(0x1fc)](_0x470754(0x1f7)),$(_0x470754(0x2bd))[_0x470754(0x20b)](),$(_0x470754(0x2e7))[_0x470754(0x227)](_0x470754(0x2b9));}function showmessage(){var _0x17c0d7=a0_0x5f55b1;$(_0x17c0d7(0x28b))[_0x17c0d7(0x1c4)](Ready),$('#Error')[_0x17c0d7(0x1c4)](Error),$(_0x17c0d7(0x1d4))[_0x17c0d7(0x1c4)](Exits),$(_0x17c0d7(0x25e))[_0x17c0d7(0x1c4)](lblUpdate),$('#AvilableLicenses')[_0x17c0d7(0x1c4)](AvilableLicenses);}function requestToken(){var _0x1fdb66=a0_0x5f55b1;$[_0x1fdb66(0x2ce)]({'async':!![],'crossDomain':!![],'url':ClientUrl,'method':'POST','headers':{'content-type':_0x1fdb66(0x2de)},'data':{'grant_type':'client_credentials','client_id\x20':ClientId,'client_secret':ClentSecret,'scope\x20':_0x1fdb66(0x221)},'success':function(_0x30bea4){var _0x4a7953=_0x1fdb66;console['log'](_0x30bea4),token=_0x30bea4[_0x4a7953(0x27d)];},'error':function(_0x2ecd13){var _0x18c464=_0x1fdb66;console[_0x18c464(0x2e4)](JSON['stringify'](_0x2ecd13));}});}function GraphAccessTokenTogetUserDetails(){var _0x1414af=a0_0x5f55b1,_0x580653=new jQuery[(_0x1414af(0x233))](),_0x358733={'X-RequestDigest':$(_0x1414af(0x26b))[_0x1414af(0x26f)](),'accept':_0x1414af(0x242),'content-type':_0x1414af(0x242)},_0x4da2cc={'resource':'https://graph.microsoft.com'};return $[_0x1414af(0x2ce)]({'url':_spPageContextInfo['webAbsoluteUrl']+_0x1414af(0x204),'headers':_0x358733,'type':_0x1414af(0x2af),'async':![],'data':JSON[_0x1414af(0x216)](_0x4da2cc),'success':function(_0x4cf652){var _0x14ecf2=_0x1414af;token=_0x4cf652[_0x14ecf2(0x27d)],_0x580653[_0x14ecf2(0x23b)](token);},'error':function(_0x5da779,_0x38d8a2,_0x5ea06e){var _0xd75b3b=_0x1414af;console[_0xd75b3b(0x2e4)](_0x5da779[_0xd75b3b(0x2f6)]),_0x580653['reject'](_0x5da779['responseText']);}}),_0x580653['promise']();}var employeehtml='',userName='',AzureUsrlist=[],AdusersUrl='https://graph.microsoft.com/beta/users?$top=100&$select=mail,displayName,userPrincipalName';function GetAzureUsrlist(_0x45dace,_0x386482){var _0x25230e=a0_0x5f55b1;return DeferredObj=$[_0x25230e(0x233)](),$[_0x25230e(0x2ce)]({'method':_0x25230e(0x21e),'url':_0x45dace,'headers':{'Authorization':_0x25230e(0x1fa)+_0x386482,'Content-Type':_0x25230e(0x1e4)},'async':![],'success':function(_0x135b5d){var _0x4359e3=_0x25230e;AzureUsrlist=AzureUsrlist['concat'](_0x135b5d[_0x4359e3(0x1cc)]),_0x135b5d[_0x4359e3(0x2d3)]!=null&&(AdusersUrl=_0x135b5d[_0x4359e3(0x2d3)],GetAzureUsrlist(AdusersUrl,_0x386482));},'error':function(_0x2aa21f){var _0x441754=_0x25230e;DeferredObj[_0x441754(0x26a)](_0x2aa21f),alert('error1'+JSON[_0x441754(0x216)](_0x2aa21f));}}),DeferredObj[_0x25230e(0x281)]();}function getEmployee(_0x25f115){var _0x9a7762=a0_0x5f55b1,_0x3b0cc7=_0x9a7762(0x2a1)+_0x25f115+'\x27';return DeferredObj=$[_0x9a7762(0x233)](),$[_0x9a7762(0x2ce)]({'method':'GET','url':_0x3b0cc7,'headers':{'Authorization':'Bearer\x20'+token,'Content-Type':_0x9a7762(0x1e4)},'async':![],'success':function(_0x402935){var _0x2be742=_0x9a7762;_0x402935['value'][_0x2be742(0x1d3)]>0x0?DeferredObj[_0x2be742(0x23b)](_0x402935[_0x2be742(0x1cc)][0x0][_0x2be742(0x245)]):DeferredObj[_0x2be742(0x23b)]('Invalid\x20Profile');},'error':function(_0x2eb0b4){var _0x5b6827=_0x9a7762;DeferredObj['reject'](_0x2eb0b4),alert('error1'+JSON[_0x5b6827(0x216)](_0x2eb0b4));}}),DeferredObj['promise']();}function ClientCredentials(){var _0x32ef60=a0_0x5f55b1,_0x547648=_0x32ef60(0x1d6),_0x3e5e1e=titanForWork['getQueryStringParameter']('CompanyId'),_0x49e701=_spPageContextInfo[_0x32ef60(0x226)]+_0x32ef60(0x23c)+_0x547648+'\x27)/items?$filter=Title\x20eq\x20\x27Client_Credentials\x27\x20';$[_0x32ef60(0x2ce)]({'url':_0x49e701,'headers':{'Accept':_0x32ef60(0x288)},'async':![],'success':function(_0x56a754){var _0x13ddfd=_0x32ef60,_0x8d3765=_0x56a754['d'][_0x13ddfd(0x247)];ClientId=_0x8d3765[0x0][_0x13ddfd(0x23e)],ClentSecret=_0x8d3765[0x0][_0x13ddfd(0x274)],ClientUrl=_0x8d3765[0x0][_0x13ddfd(0x2b3)];},'error':function(_0x5986f8){console['log'](_0x5986f8);}});}var EmployeeListUsers=[],GetQueryURL=_spPageContextInfo['webAbsoluteUrl']+'/_api/web/lists/GetByTitle(\x27Employees\x27)/items?$top=999&$select=ID,AttachmentFiles,FullName,Designation,Manager,MobileNumber,ExtensionName,Email,LogonName/UserName,Department/DepartmentName,Company/CompanyName,Company/ID,OfficeLocation/ID,OfficeLocation/OfficeName&$orderby=FullName&$expand=LogonName,OfficeLocation,Company,Department,AttachmentFiles\x20&$filter=\x20PrimaryCompany\x20eq\x20\x27Primary\x27\x20and\x20Status\x20eq\x20\x27Active\x27\x20';function GetEmployees(){var _0x3bd157=a0_0x5f55b1;$[_0x3bd157(0x2ce)]({'url':GetQueryURL,'headers':{'Accept':_0x3bd157(0x288)},'async':![],'beforeSend':function(){},'success':function(_0x2f3ac7){var _0x21d0b7=_0x3bd157;EmployeeListUsers=EmployeeListUsers['concat'](_0x2f3ac7['d'][_0x21d0b7(0x247)]);if(_0x2f3ac7['d'][_0x21d0b7(0x263)]!=null)GetQueryURL=_0x2f3ac7['d']['__next'],GetEmployees();else{GetQueryURL=_spPageContextInfo[_0x21d0b7(0x226)]+_0x21d0b7(0x286);var _0x57f68b=0x0,_0x1c3415=_spPageContextInfo[_0x21d0b7(0x226)]+_0x21d0b7(0x290)+new Date()[_0x21d0b7(0x272)]()+_0x21d0b7(0x213);extdfds=$[_0x21d0b7(0x233)](),$['when'](getItems(_0x1c3415,extdfds))[_0x21d0b7(0x1f8)](function(_0x190151){response=[],_0x57f68b=_0x190151['length'];});}_0x57f68b!=undefined?AvilableLicenses=parseInt(UsersLicenceRequired)-(parseInt(EmployeeListUsers[_0x21d0b7(0x1d3)])+parseInt(_0x57f68b)):AvilableLicenses=parseInt(UsersLicenceRequired)-parseInt(EmployeeListUsers[_0x21d0b7(0x1d3)]);},'error':function(_0x43696b){var _0xc8cd70=_0x3bd157;console[_0xc8cd70(0x2e4)](_0x43696b);}});}var fileUploadevent=document[a0_0x5f55b1(0x200)]('fileUpload');fileUploadevent[a0_0x5f55b1(0x2a8)]=function(){EmployeeListUsers=[],AvilableLicenses=0x0,this['value']=null;},fileUploadevent['onchange']=function(){$['ajax']({'cache':![],'beforeSend':function(){var _0x2fca3f=a0_0x4abb;$(_0x2fca3f(0x214))[_0x2fca3f(0x2ca)]();},'success':function(_0x1aafb7){var _0x5e547c=a0_0x4abb,_0x5c1bdc=document['getElementById']('fileUpload');AzureUsrlist[_0x5e547c(0x1d3)]==0x0&&GetAzureUsrlist(AdusersUrl,token);AvilableLicenses=0x0,GetEmployees(),LoadShowUser([]),Ready=0x0,Error=0x0,lblUpdate=0x0,counusers=0x0,Exits=0x0,$('#Ready')['text'](0x0),$(_0x5e547c(0x2aa))['text'](0x0),$(_0x5e547c(0x1cf))[_0x5e547c(0x1c4)](0x0),$('#lblUpdate')[_0x5e547c(0x1c4)](0x0),$('#Exits')[_0x5e547c(0x1c4)](0x0);var _0xeefb80=/^([a-zA-Z0-9\s_\\.\-:])+(.xls|.xlsx)$/;if(_0xeefb80[_0x5e547c(0x2bf)](_0x5c1bdc[_0x5e547c(0x1cc)][_0x5e547c(0x266)]())){if(typeof FileReader!='undefined'){var _0xead351=new FileReader();_0xead351[_0x5e547c(0x2e1)]?(_0xead351['onload']=function(_0x297b5c){var _0x210768=_0x5e547c;ProcessExcel(_0x297b5c[_0x210768(0x21b)]['result']);},_0xead351[_0x5e547c(0x2e1)](_0x5c1bdc[_0x5e547c(0x250)][0x0])):(_0xead351[_0x5e547c(0x1f1)]=function(_0x4e5562){var _0x15164d=_0x5e547c,_0xe1cdd6='',_0x21f865=new Uint8Array(_0x4e5562[_0x15164d(0x21b)][_0x15164d(0x2cf)]);for(var _0x7b3ae4=0x0;_0x7b3ae4<_0x21f865[_0x15164d(0x21f)];_0x7b3ae4++){_0xe1cdd6+=String['fromCharCode'](_0x21f865[_0x7b3ae4]);}ProcessExcel(_0xe1cdd6);},_0xead351[_0x5e547c(0x20a)](_0x5c1bdc[_0x5e547c(0x250)][0x0]));}else alert(_0x5e547c(0x258));}else alert('Please\x20upload\x20a\x20valid\x20Excel\x20file.');$('#overlaysearch')[_0x5e547c(0x28a)]();}});},$(function(){var _0x57e44=a0_0x5f55b1;$(_0x57e44(0x21c))[_0x57e44(0x2f1)](function(){var _0x50be12=_0x57e44,_0x1aa67e=document[_0x50be12(0x200)]('fileUpload');GetEmployees(),LoadShowUser([]),Ready=0x0,Error=0x0,counusers=0x0;var _0x470a6f=/^([a-zA-Z0-9\s_\\.\-:])+(.xls|.xlsx)$/;if(_0x470a6f[_0x50be12(0x2bf)](_0x1aa67e[_0x50be12(0x1cc)]['toLowerCase']())){if(typeof FileReader!=_0x50be12(0x2f4)){var _0x29c1e6=new FileReader();_0x29c1e6[_0x50be12(0x2e1)]?(_0x29c1e6['onload']=function(_0x33e1c3){var _0x193339=_0x50be12;ProcessExcel(_0x33e1c3[_0x193339(0x21b)][_0x193339(0x2cf)]);},_0x29c1e6['readAsBinaryString'](_0x1aa67e[_0x50be12(0x250)][0x0])):(_0x29c1e6[_0x50be12(0x1f1)]=function(_0x4d83a0){var _0x3754b2=_0x50be12,_0x276d7e='',_0x22a110=new Uint8Array(_0x4d83a0[_0x3754b2(0x21b)][_0x3754b2(0x2cf)]);for(var _0x1add79=0x0;_0x1add79<_0x22a110[_0x3754b2(0x21f)];_0x1add79++){_0x276d7e+=String[_0x3754b2(0x2f2)](_0x22a110[_0x1add79]);}ProcessExcel(_0x276d7e);},_0x29c1e6[_0x50be12(0x20a)](_0x1aa67e[_0x50be12(0x250)][0x0]));}else alert(_0x50be12(0x258));}else alert(_0x50be12(0x1fe));});});function ProcessExcel(_0x38af38){var _0x59491a=a0_0x5f55b1,_0x8a359b=XLSX[_0x59491a(0x1ed)](_0x38af38,{'type':_0x59491a(0x2db)}),_0x303ed7=_0x8a359b[_0x59491a(0x2b8)][0x0];excelRows=XLSX[_0x59491a(0x20c)][_0x59491a(0x206)](_0x8a359b[_0x59491a(0x2a3)][_0x303ed7]),$(_0x59491a(0x203))[_0x59491a(0x2d8)](),$(_0x59491a(0x203))[_0x59491a(0x20e)](_0x59491a(0x231)+excelRows[_0x59491a(0x1d3)]+'</h3>\x20<p\x20class\x20=\x20\x22m-0\x22\x20>\x20Uploaded\x20</p>'),$(_0x59491a(0x29a))[_0x59491a(0x1fc)]('');for(var _0x1e362f=0x0;_0x1e362f<excelRows[_0x59491a(0x1d3)];_0x1e362f++){var _0x5a56eb='';ErrorUser='';var _0x55a11a=EmployeeListUsers[_0x59491a(0x289)](function(_0x3df677){var _0x4082fe=_0x59491a,_0x1cfb15=_0x3df677['Email'][_0x4082fe(0x266)]();return _0x1cfb15==excelRows[_0x1e362f][_0x4082fe(0x235)][_0x4082fe(0x266)]();});if(_0x55a11a[_0x59491a(0x1d3)]>0x0){_0x5a56eb=_0x55a11a[0x0]['FullName'],color_red=_0x59491a(0x22e),ErrorUser=_0x59491a(0x211),Exits=Exits+0x1;var _0x35867d=_0x55a11a[0x0]['ID'];excelRows[_0x1e362f][_0x59491a(0x1e3)]='-',excelRows[_0x1e362f][_0x59491a(0x2d5)]='-',excelRows[_0x1e362f]['Location\x20*']='-';}else{var _0x3f47a4=AzureUsrlist[_0x59491a(0x289)](function(_0x1aa0cf){var _0x59f698=_0x59491a;if(_0x1aa0cf[_0x59f698(0x22b)]!=null){var _0x546548=_0x1aa0cf[_0x59f698(0x22b)][_0x59f698(0x266)]();return _0x546548==excelRows[_0x1e362f][_0x59f698(0x235)]['toLowerCase']();}});if(_0x3f47a4[_0x59491a(0x1d3)]>0x0){_0x5a56eb=_0x3f47a4[0x0][_0x59491a(0x245)];var _0x4d40ee=AllCompanies[_0x59491a(0x289)](function(_0xd73684){return _0xd73684['ID']==excelRows[_0x1e362f]['Company\x20*'];}),_0x4f619f=AllDepartments[_0x59491a(0x289)](function(_0x3bf1d3){return _0x3bf1d3['ID']==excelRows[_0x1e362f]['Department\x20*'];}),_0x489316=AllOfficeLocation[_0x59491a(0x289)](function(_0x53a5f5){var _0x386d3b=_0x59491a;return _0x53a5f5['ID']==excelRows[_0x1e362f][_0x386d3b(0x264)];});_0x4d40ee['length']>0x0&&_0x4f619f[_0x59491a(0x1d3)]>0x0&&_0x489316[_0x59491a(0x1d3)]>0x0?(Ready=Ready+0x1,ErrorUser='Ready',excelRows[_0x1e362f][_0x59491a(0x1d5)]=_0x4f619f[0x0]['DepartmentName'],excelRows[_0x1e362f][_0x59491a(0x1d0)]=_0x489316[0x0][_0x59491a(0x223)]):(ErrorUser=_0x59491a(0x268),Error=Error+0x1);}else ErrorUser=_0x59491a(0x1ee),color_red=_0x59491a(0x22e),Error=Error+0x1;}excelRows[_0x1e362f]['Name']=_0x5a56eb,excelRows[_0x1e362f]['id']=_0x1e362f,excelRows[_0x1e362f]['Status']=ErrorUser,excelRows[_0x1e362f]['EmpUserId']=_0x35867d;}alluserdata=excelRows,LoadShowUser(excelRows);}function CompaniesDetails(){var _0x1d4bfb=a0_0x5f55b1,_0x5c75e5=document[_0x1d4bfb(0x200)](_0x1d4bfb(0x2e2));_0x5c75e5[_0x1d4bfb(0x229)]='',opt[_0x1d4bfb(0x1cc)]='0',opt['text']=_0x1d4bfb(0x1c2),_0x5c75e5['appendChild'](opt);for(var _0x5ab7a3=0x0;_0x5ab7a3<AllCompanies[_0x1d4bfb(0x1d3)];_0x5ab7a3++){var _0x43696=AllCompanies[_0x5ab7a3]['CompanyName'],_0x2aee11=AllCompanies[_0x5ab7a3]['ID'];opt=document['createElement']('option'),opt[_0x1d4bfb(0x1cc)]=_0x2aee11,opt[_0x1d4bfb(0x1c4)]=_0x43696,_0x5c75e5[_0x1d4bfb(0x1eb)](opt);}$(_0x1d4bfb(0x2a9))[_0x1d4bfb(0x261)](_0x1d4bfb(0x2c6),![]),$('#txtmanager')[_0x1d4bfb(0x26f)](''),$('#txtGroup')[_0x1d4bfb(0x26f)](''),$(_0x1d4bfb(0x1c3))[_0x1d4bfb(0x26f)]('');}$(a0_0x5f55b1(0x2ba))[a0_0x5f55b1(0x2f1)](function(){var _0x151eaa=a0_0x5f55b1,_0x10699f=tabledata[_0x151eaa(0x1da)]();debugger;_0x10699f[_0x151eaa(0x1d3)]>0x0?(CompaniesDetails(),$(_0x151eaa(0x29f))[_0x151eaa(0x25b)]('show'),initializePeoplePicker(_0x151eaa(0x259)),peoplePickerDiv=$(_0x151eaa(0x236))):alert('Please\x20select\x20required\x20value\x20missing\x20row');});var GetDepartments,Getofficelocation,GetDesignation,GetGroup,CompaniesId;$(a0_0x5f55b1(0x284))[a0_0x5f55b1(0x2f1)](function(){var _0x55d5fb=a0_0x5f55b1;if(document[_0x55d5fb(0x200)]('chkDepartment')['checked']==!![]||document[_0x55d5fb(0x200)](_0x55d5fb(0x270))['checked']==!![]||document['getElementById'](_0x55d5fb(0x230))[_0x55d5fb(0x2c6)]==!![]||document['getElementById']('chkManager')[_0x55d5fb(0x2c6)]==!![]||document[_0x55d5fb(0x200)](_0x55d5fb(0x1e6))[_0x55d5fb(0x2c6)]==!![]||document[_0x55d5fb(0x200)]('chkGroup')[_0x55d5fb(0x2c6)]==!![]){var _0x52b0cd=tabledata[_0x55d5fb(0x1da)](),_0x3c198b=SPClientPeoplePicker['SPClientPeoplePickerDict'][peoplePickerDiv[0x0]['id']],_0xd06650=_0x3c198b[_0x55d5fb(0x1cd)]();for(var _0x1005ee=0x0;_0x1005ee<_0x52b0cd[_0x55d5fb(0x1d3)];_0x1005ee++){var _0x252080=excelRows[_0x55d5fb(0x277)](_0x4b2ac6=>_0x4b2ac6[_0x55d5fb(0x235)]==_0x52b0cd[_0x1005ee]['_row']['data'][_0x55d5fb(0x235)]);if(excelRows[_0x252080][_0x55d5fb(0x1be)]=='Already\x20Exist')excelRows[_0x252080][_0x55d5fb(0x1e3)]='-',excelRows[_0x252080][_0x55d5fb(0x2d5)]='-',excelRows[_0x252080][_0x55d5fb(0x264)]='-',document[_0x55d5fb(0x200)]('chkDesignation')[_0x55d5fb(0x2c6)]&&(excelRows[_0x252080][_0x55d5fb(0x2dd)]=$('#txtDesignation')[_0x55d5fb(0x26f)]()),document[_0x55d5fb(0x200)](_0x55d5fb(0x2cd))[_0x55d5fb(0x2c6)]&&(excelRows[_0x252080]['Manager\x20*']=_0xd06650[0x0][_0x55d5fb(0x1e8)][_0x55d5fb(0x262)]),document[_0x55d5fb(0x200)](_0x55d5fb(0x1e6))[_0x55d5fb(0x2c6)]&&(excelRows[_0x252080][_0x55d5fb(0x2ef)]=_0x55d5fb(0x222)),document[_0x55d5fb(0x200)](_0x55d5fb(0x1fd))[_0x55d5fb(0x2c6)]&&(excelRows[_0x252080][_0x55d5fb(0x1d8)]=$(_0x55d5fb(0x2e8))[_0x55d5fb(0x26f)]());else{if(excelRows[_0x252080][_0x55d5fb(0x1be)]==_0x55d5fb(0x268)||excelRows[_0x252080][_0x55d5fb(0x1be)]=='Ready'){document['getElementById'](_0x55d5fb(0x207))['checked']&&(excelRows[_0x252080]['Company\x20*']=CompaniesId,excelRows[_0x252080][_0x55d5fb(0x2d5)]=GetDepartments);document[_0x55d5fb(0x200)]('chkOfficeLocation')[_0x55d5fb(0x2c6)]&&(excelRows[_0x252080]['Company\x20*']=CompaniesId,excelRows[_0x252080][_0x55d5fb(0x264)]=Getofficelocation);document[_0x55d5fb(0x200)](_0x55d5fb(0x230))[_0x55d5fb(0x2c6)]&&(excelRows[_0x252080][_0x55d5fb(0x2dd)]=$(_0x55d5fb(0x1c3))[_0x55d5fb(0x26f)]());document[_0x55d5fb(0x200)](_0x55d5fb(0x2cd))[_0x55d5fb(0x2c6)]&&(excelRows[_0x252080][_0x55d5fb(0x2ef)]=_0xd06650[0x0]['EntityData']['Email']);document[_0x55d5fb(0x200)](_0x55d5fb(0x1e6))[_0x55d5fb(0x2c6)]&&(excelRows[_0x252080]['Manager\x20*']=_0x55d5fb(0x222));document[_0x55d5fb(0x200)](_0x55d5fb(0x1fd))[_0x55d5fb(0x2c6)]&&(excelRows[_0x252080][_0x55d5fb(0x1d8)]=$(_0x55d5fb(0x2e8))['val']());var _0x264f75=AllCompanies[_0x55d5fb(0x289)](function(_0x1afdd7){var _0x367e49=_0x55d5fb;return _0x1afdd7['ID']==excelRows[_0x252080][_0x367e49(0x1e3)];}),_0x1544ca=AllDepartments['filter'](function(_0x13b28c){var _0x59b454=_0x55d5fb;return _0x13b28c['ID']==excelRows[_0x252080][_0x59b454(0x2d5)];}),_0x2b1602=AllOfficeLocation[_0x55d5fb(0x289)](function(_0x19bfe0){var _0x53ed95=_0x55d5fb;return _0x19bfe0['ID']==excelRows[_0x252080][_0x53ed95(0x264)];});_0x264f75[_0x55d5fb(0x1d3)]>0x0&&_0x1544ca[_0x55d5fb(0x1d3)]>0x0&&_0x2b1602[_0x55d5fb(0x1d3)]>0x0?(Ready=Ready+0x1,Error=Error-0x1,excelRows[_0x252080]['Status']='Ready'):(excelRows[_0x252080][_0x55d5fb(0x1be)]=_0x55d5fb(0x268),Error=Error+0x1);}else excelRows[_0x252080]['Status']=='Wrong\x20Manager'&&(document[_0x55d5fb(0x200)](_0x55d5fb(0x230))[_0x55d5fb(0x2c6)]&&(excelRows[_0x252080][_0x55d5fb(0x2dd)]=$(_0x55d5fb(0x1c3))[_0x55d5fb(0x26f)]()),document['getElementById']('chkManager')[_0x55d5fb(0x2c6)]&&(excelRows[_0x252080][_0x55d5fb(0x2ef)]=_0xd06650[0x0][_0x55d5fb(0x1e8)][_0x55d5fb(0x262)]),document['getElementById'](_0x55d5fb(0x1e6))[_0x55d5fb(0x2c6)]&&(excelRows[_0x252080][_0x55d5fb(0x2ef)]=_0x55d5fb(0x222)),document[_0x55d5fb(0x200)](_0x55d5fb(0x1fd))['checked']&&(excelRows[_0x252080][_0x55d5fb(0x1d8)]=$(_0x55d5fb(0x2e8))[_0x55d5fb(0x26f)]()),Ready=Ready+0x1,Error=Error-0x1,excelRows[_0x252080]['Status']=_0x55d5fb(0x2b0));}}tabledata[_0x55d5fb(0x2a5)](excelRows),tabledata['setPage'](pageIndex),$(_0x55d5fb(0x29f))[_0x55d5fb(0x25b)](_0x55d5fb(0x1f0)),showmessage();}else alert('please\x20check\x20at\x20list\x20one\x20checkbox\x20'),$(_0x55d5fb(0x278))[_0x55d5fb(0x26f)]();}),$('#ddlAllCompanies')[a0_0x5f55b1(0x1dd)](function(){var _0x4323f0=a0_0x5f55b1;CompaniesId=parseInt($('option:selected',$(this))[_0x4323f0(0x26f)]());var _0x193943=AllOfficeLocation[_0x4323f0(0x289)](function(_0x2bb746){var _0x265bf1=_0x4323f0;return _0x2bb746[_0x265bf1(0x2c4)]===CompaniesId;}),_0xc5c306=document[_0x4323f0(0x200)](_0x4323f0(0x2bc));_0xc5c306[_0x4323f0(0x229)]='';for(var _0x4950ed=0x0;_0x4950ed<_0x193943['length'];_0x4950ed++){var _0x1320f2=_0x193943[_0x4950ed]['OfficeName'],_0x4a9c80=_0x193943[_0x4950ed]['ID'];opt=document['createElement'](_0x4323f0(0x24a)),opt['value']=_0x4a9c80,opt[_0x4323f0(0x1c4)]=_0x1320f2,_0xc5c306[_0x4323f0(0x1eb)](opt);}Getofficelocation=parseInt($(_0x4323f0(0x23a),$(_0x4323f0(0x20f)))[_0x4323f0(0x26f)]());var _0x5f574f=AllDepartments[_0x4323f0(0x289)](function(_0x4acfae){return _0x4acfae['CompanyIDId']===CompaniesId;}),_0xc5c306=document[_0x4323f0(0x200)](_0x4323f0(0x1e9));_0xc5c306[_0x4323f0(0x229)]='';for(var _0x4950ed=0x0;_0x4950ed<_0x5f574f[_0x4323f0(0x1d3)];_0x4950ed++){var _0x1320f2=_0x5f574f[_0x4950ed][_0x4323f0(0x2c2)],_0x4a9c80=_0x5f574f[_0x4950ed]['ID'];opt=document['createElement'](_0x4323f0(0x24a)),opt[_0x4323f0(0x1cc)]=_0x4a9c80,opt['text']=_0x1320f2,_0xc5c306[_0x4323f0(0x1eb)](opt);}GetDepartments=parseInt($(_0x4323f0(0x23a),$(_0x4323f0(0x1c7)))['val']());}),$(a0_0x5f55b1(0x1c7))[a0_0x5f55b1(0x1dd)](function(){var _0x4bd056=a0_0x5f55b1;GetDepartments=parseInt($(_0x4bd056(0x23a),$(this))['val']());}),$(a0_0x5f55b1(0x20f))[a0_0x5f55b1(0x1dd)](function(){var _0x1689eb=a0_0x5f55b1;Getofficelocation=parseInt($(_0x1689eb(0x23a),$(this))[_0x1689eb(0x26f)]());});function chkManagerevent(_0x2e4afb){var _0x371ca8=a0_0x5f55b1;if(_0x2e4afb[_0x371ca8(0x2c6)])$(_0x371ca8(0x1bf))['prop'](_0x371ca8(0x2c6),![]),$(_0x371ca8(0x1db))[_0x371ca8(0x2c9)]('readonly'),$('#txtmanager')['focus']();else{}}var TopExecutive='';function chkTopExecutiveevent(_0x474fe0){var _0x40a999=a0_0x5f55b1;if(_0x474fe0[_0x40a999(0x2c6)])$(_0x40a999(0x1dc))[_0x40a999(0x261)](_0x40a999(0x2c6),![]),$(_0x40a999(0x1db))['prop']('readonly',!![]),$(_0x40a999(0x1db))[_0x40a999(0x26f)](''),TopExecutive=_0x40a999(0x222);else{}}$('#btnDownLoadReport')['click'](function(){var _0x2fd519=a0_0x5f55b1;tabledata[_0x2fd519(0x1ef)]('xlsx',_0x2fd519(0x1e7),{'sheetName':'EmployeeSyncreport'});});var dvExcel=document[a0_0x5f55b1(0x200)](a0_0x5f55b1(0x2be));dvExcel['innerHTML']='';var outputArray=[];function removewithfilter(_0x200121){var _0x33cfdc=a0_0x5f55b1;let _0xec47d8=_0x200121[_0x33cfdc(0x289)](function(_0x3671f7,_0x3b5c98,_0x5ad29c){return _0x3b5c98==_0x5ad29c['indexOf'](_0x3671f7);});return _0xec47d8;}function GetItemTypeForListName(_0x4aa519){var _0x146c05=a0_0x5f55b1;return _0x146c05(0x25a)+_0x4aa519[_0x146c05(0x1fb)](0x0)[_0x146c05(0x252)]()+_0x4aa519[_0x146c05(0x276)]('\x20')[_0x146c05(0x2e0)]('')[_0x146c05(0x2c8)](0x1)+_0x146c05(0x26d);}function a0_0x4abb(_0x3633a7,_0x345360){var _0x2e0564=a0_0x2e05();return a0_0x4abb=function(_0x4abb52,_0x45e58c){_0x4abb52=_0x4abb52-0x1bd;var _0x206f5b=_0x2e0564[_0x4abb52];return _0x206f5b;},a0_0x4abb(_0x3633a7,_0x345360);}var response=response||[];function getItems(_0x55ec3b,_0x23d24b){var _0x3f9477=a0_0x5f55b1;return $[_0x3f9477(0x2ce)]({'url':_0x55ec3b,'type':_0x3f9477(0x21e),'async':![],'headers':{'accept':_0x3f9477(0x288)},'success':function(_0x95250d){var _0x46b528=_0x3f9477;response=response[_0x46b528(0x295)](_0x95250d['d'][_0x46b528(0x247)]),_0x95250d['d']['__next']?(_0x55ec3b=_0x95250d['d'][_0x46b528(0x263)],getItems(_0x55ec3b,_0x23d24b)):_0x23d24b[_0x46b528(0x23b)](response);},'error':function(_0x528592){var _0x1d3891=_0x3f9477;_0x23d24b[_0x1d3891(0x26a)](_0x528592),console[_0x1d3891(0x2e4)](_0x528592);}}),_0x23d24b['promise']();}function ConvertddmmyyTommddyy(_0x36ee20){var _0x26252a=a0_0x5f55b1;return _0x36ee20[_0x26252a(0x276)]('/')[0x1]+'/'+_0x36ee20[_0x26252a(0x276)]('/')[0x0]+'/'+_0x36ee20[_0x26252a(0x276)]('/')[0x2];}function InsertWelcomeInAnnouncementList(_0x2c33fe){var _0x291d4b=a0_0x5f55b1;$[_0x291d4b(0x2ce)]({'url':_spPageContextInfo['webAbsoluteUrl']+_0x291d4b(0x2b5),'type':_0x291d4b(0x2af),'async':![],'data':JSON['stringify'](_0x2c33fe),'headers':{'Accept':_0x291d4b(0x288),'Content-Type':_0x291d4b(0x288),'X-RequestDigest':$(_0x291d4b(0x26b))[_0x291d4b(0x26f)](),'X-HTTP-Method':_0x291d4b(0x2af)},'success':function(_0x953944,_0x1035eb,_0x3246d9){var _0x5d7e68=_0x291d4b;console[_0x5d7e68(0x2e4)](_0x5d7e68(0x240));},'error':function(_0xc33fdb){var _0x4baba4=_0x291d4b;console[_0x4baba4(0x2e4)](_0xc33fdb),console[_0x4baba4(0x2e4)](_0x4baba4(0x1d9)),currentDlg[_0x4baba4(0x224)]();}});}