var a0_0x3c8bdd=a0_0x5162;(function(_0x490904,_0xbfd77e){var _0x5cc49f=a0_0x5162,_0x28191a=_0x490904();while(!![]){try{var _0x11f2bb=-parseInt(_0x5cc49f(0x255))/0x1+parseInt(_0x5cc49f(0x24c))/0x2+-parseInt(_0x5cc49f(0x242))/0x3+-parseInt(_0x5cc49f(0x225))/0x4*(-parseInt(_0x5cc49f(0x231))/0x5)+parseInt(_0x5cc49f(0x1db))/0x6+-parseInt(_0x5cc49f(0x2bf))/0x7+parseInt(_0x5cc49f(0x1bd))/0x8*(parseInt(_0x5cc49f(0x1bc))/0x9);if(_0x11f2bb===_0xbfd77e)break;else _0x28191a['push'](_0x28191a['shift']());}catch(_0x2a2b47){_0x28191a['push'](_0x28191a['shift']());}}}(a0_0x1676,0x611e6));var token,ClientId='',ClentSecret='',ClientUrl='',DeferredObj=$['Deferred'](),color_red='',Error=0x0,Ready=0x0,Exits=0x0,lblUpdate=0x0,ErrorUser='',alluserdata,contributersGroupId='',counusers=0x0,excelRows,AllCompanies,AllDepartments,AllOfficeLocation,tabledata,pageIndex,UserEmailId,warningmessage='',userfullname='',AvilableLicenses,ReadySelected=[],MiisingSelected=[],AddedEmployeeList=[],IsMiisingSelect,isReadeySelect,peoplePickerDiv='',IsaddedNewEmployee=![],EmployeeId='',EmployeeDepartment='',EmployeeOfficeLocation='',checkedAudience='',IsNotification=![];$(document)[a0_0x3c8bdd(0x200)](function(){var _0x38cecb=a0_0x3c8bdd;GraphAccessTokenTogetUserDetails(),GetCompanies(),GetOfficeLocation(),GetDepartments(),LoadShowUser([]),GetAllUserId(),GetEmployees(),AvilableLicenses==NaN&&GetEmployees(),$(_0x38cecb(0x1c0))[_0x38cecb(0x2c7)](AvilableLicenses);});function initializePeoplePicker(_0x230977){var _0x2ffc04=a0_0x3c8bdd,_0x1a719d={};_0x1a719d[_0x2ffc04(0x1c9)]=_0x2ffc04(0x1f7),_0x1a719d[_0x2ffc04(0x1ff)]=0xf,_0x1a719d['ResolvePrincipalSource']=0xf,_0x1a719d[_0x2ffc04(0x25a)]=![],_0x1a719d[_0x2ffc04(0x1d4)]=0x32,_0x1a719d[_0x2ffc04(0x1ee)]=_0x2ffc04(0x272),this['SPClientPeoplePicker_InitStandaloneControlWrapper'](_0x230977,null,_0x1a719d),$(_0x2ffc04(0x202))['width'](0xfa);}function GetSelectItem(){var _0x288706=a0_0x3c8bdd;IsaddedNewEmployee=![];if(contributersGroupId!==''){var _0xa86ef2=tabledata[_0x288706(0x25c)]();counusers=0x0;for(var _0x37e839=0x0;_0x37e839<_0xa86ef2[_0x288706(0x215)];_0x37e839++){var _0xae72fc=alluserdata[_0x288706(0x1fd)](function(_0x593659){var _0x544dd8=_0x288706;return _0x593659[_0x544dd8(0x284)]==_0xa86ef2[_0x37e839][_0x544dd8(0x250)][_0x544dd8(0x2b5)][_0x544dd8(0x284)];});AvilableLicenses>0x0?_0xae72fc[0x0][_0x288706(0x20a)]==_0x288706(0x217)?(AddNewEmployeeAllocated(_0xae72fc,_0x288706(0x264)),IsaddedNewEmployee=!![]):_0xae72fc[0x0][_0x288706(0x20a)]==_0x288706(0x2bb)&&UpdateExistingEmployeeAllocated(_0xae72fc,'Employees'):($(_0x288706(0x2b0))[_0x288706(0x2c7)](counusers),alert(_0x288706(0x2b9)),_0x37e839=_0xa86ef2[_0x288706(0x215)]);}warningmessage!=''&&(warningmessage+=userfullname,alert(warningmessage)),$(_0x288706(0x2b0))['text'](counusers),showmessage(),tabledata[_0x288706(0x1c1)](excelRows),tabledata['setPage'](pageIndex),IsaddedNewEmployee&&($(_0x288706(0x2c3))[_0x288706(0x1ea)]({'backdrop':_0x288706(0x234),'keyboard':![]},'show'),AddedEmployeeList['length']>0x0?$('#divAudience')[_0x288706(0x2cc)]():$('#divAudience')[_0x288706(0x27f)]());}else GetGroupIDByGroupName(),GetSelectItem();}var Temparray=[];$(a0_0x3c8bdd(0x2b3))[a0_0x3c8bdd(0x2a6)](function(){var _0x45d466=a0_0x3c8bdd;debugger;Temparray=alluserdata;let _0x4f8a75=[...new Set(Temparray[_0x45d466(0x1dc)](_0x571a0d=>_0x571a0d[_0x45d466(0x240)]))];var _0x4b89c5=document['getElementById'](_0x45d466(0x206));_0x4b89c5[_0x45d466(0x1ab)]='',opt[_0x45d466(0x2a4)]='0',opt[_0x45d466(0x2c7)]='Select\x20Company',_0x4b89c5[_0x45d466(0x1e6)](opt);for(var _0x46883a=0x0;_0x46883a<_0x4f8a75[_0x45d466(0x215)];_0x46883a++){opt=document['createElement'](_0x45d466(0x288)),opt[_0x45d466(0x2a4)]=_0x4f8a75[_0x46883a],opt['text']=_0x4f8a75[_0x46883a],_0x4b89c5[_0x45d466(0x1e6)](opt);}Temparray=alluserdata;var _0x325a18=[...new Set(Temparray[_0x45d466(0x1dc)](_0x3bb061=>_0x3bb061[_0x45d466(0x22c)]))],_0x4b89c5=document[_0x45d466(0x23e)](_0x45d466(0x26c)),_0x2fd5d8=_0x45d466(0x260);for(var _0x46883a=0x0;_0x46883a<_0x325a18[_0x45d466(0x215)];_0x46883a++){_0x2fd5d8+=_0x45d466(0x1d0)+_0x325a18[_0x46883a]+'\x22>'+_0x325a18[_0x46883a]+_0x45d466(0x263);}$(_0x45d466(0x27d))[_0x45d466(0x258)](_0x2fd5d8),Temparray=alluserdata;let _0x15f786=[...new Set(Temparray[_0x45d466(0x1dc)](_0x118ba4=>_0x118ba4[_0x45d466(0x27b)]))];var _0x4b89c5=document[_0x45d466(0x23e)](_0x45d466(0x29c));_0x4b89c5[_0x45d466(0x1ab)]='',opt['value']='0',opt[_0x45d466(0x2c7)]=_0x45d466(0x24d),_0x4b89c5[_0x45d466(0x1e6)](opt);for(var _0x46883a=0x0;_0x46883a<_0x15f786[_0x45d466(0x215)];_0x46883a++){opt=document[_0x45d466(0x237)](_0x45d466(0x288)),opt['value']=_0x15f786[_0x46883a],opt[_0x45d466(0x2c7)]=_0x15f786[_0x46883a],_0x4b89c5['appendChild'](opt);}}),$(a0_0x3c8bdd(0x233))[a0_0x3c8bdd(0x2a6)](function(){var _0x435402=a0_0x3c8bdd;let _0x453457;var _0x422895='',_0x41028d=!![];$(_0x435402(0x24a))[_0x435402(0x21f)]()!='0'&&(_0x41028d=![]);if($('#ddlfilterDepartments')['val']()!='0')_0x41028d=![];else return alert(_0x435402(0x276)),![];if($(_0x435402(0x27d))[_0x435402(0x21f)]()!='0')_0x41028d=![];else return alert(_0x435402(0x2c8)),![];_0x453457=alluserdata[_0x435402(0x1fd)](function(_0x9eab3f){var _0x5b5c98=_0x435402;return _0x9eab3f['Location\x20*']==$(_0x5b5c98(0x1f6),$(_0x5b5c98(0x27d)))[_0x5b5c98(0x21f)]()&&_0x9eab3f[_0x5b5c98(0x27b)]==$(_0x5b5c98(0x1f6),$(_0x5b5c98(0x293)))[_0x5b5c98(0x21f)]()&&_0x9eab3f[_0x5b5c98(0x240)]==$(_0x5b5c98(0x1f6),$('#ddlfilterAllCompanies'))[_0x5b5c98(0x21f)]();});var _0x30b33c=alluserdata[_0x435402(0x266)](_0x4f549e=>_0x4f549e['Location\x20*']===$(_0x435402(0x1f6),$('#ddlfilterOfficeLocation'))[_0x435402(0x21f)]()&&_0x4f549e['Department\x20*']==$('option:selected',$(_0x435402(0x293)))[_0x435402(0x21f)]()&&_0x4f549e['Company\x20*']==$(_0x435402(0x1f6),$('#ddlfilterAllCompanies'))[_0x435402(0x21f)]());_0x41028d?LoadShowUser(alluserdata):LoadShowUser(_0x453457);}),$(a0_0x3c8bdd(0x2a2))[a0_0x3c8bdd(0x1c6)](function(_0x45bdcd){var _0x578d02=a0_0x3c8bdd;LoadShowUser(search($(_0x578d02(0x2a2))[_0x578d02(0x21f)]()));});function a0_0x5162(_0x200de0,_0x38059e){var _0x1676ca=a0_0x1676();return a0_0x5162=function(_0x516239,_0x17823c){_0x516239=_0x516239-0x192;var _0x5d26f3=_0x1676ca[_0x516239];return _0x5d26f3;},a0_0x5162(_0x200de0,_0x38059e);}function search(_0x5f7851){return alluserdata['filter'](function(_0x10b5a5){var _0x4bc4ee=a0_0x5162;return _0x10b5a5[_0x4bc4ee(0x23f)]['toLowerCase']()[_0x4bc4ee(0x1b1)](_0x5f7851[_0x4bc4ee(0x1b2)]())>-0x1||_0x10b5a5[_0x4bc4ee(0x284)]['toLowerCase']()[_0x4bc4ee(0x1b1)](_0x5f7851[_0x4bc4ee(0x1b2)]())>-0x1;});}$(a0_0x3c8bdd(0x26a))[a0_0x3c8bdd(0x227)](function(){var _0x392512=a0_0x3c8bdd;checkedAudience=this[_0x392512(0x2a4)];}),$('#btnsubmitready')['on'](a0_0x3c8bdd(0x2a6),function(){$['ajax']({'cache':![],'beforeSend':function(){var _0xed29b6=a0_0x5162;$(_0xed29b6(0x1fe))['fadeIn']();},'success':function(_0x28bc66){var _0x2cc91e=a0_0x5162;AddedEmployeeList=[],SubmitReady(),$(_0x2cc91e(0x1fe))[_0x2cc91e(0x1b3)]();}});}),$('#btnAudience')['on'](a0_0x3c8bdd(0x2a6),function(){var _0x4b3ed4=a0_0x3c8bdd;$[_0x4b3ed4(0x279)]({'cache':![],'beforeSend':function(){var _0x105810=_0x4b3ed4;$(_0x105810(0x1fe))[_0x105810(0x196)]();},'success':function(_0x787935){var _0x3c56ef=_0x4b3ed4;if(AddedEmployeeList['length']>0x0&&checkedAudience!=_0x3c56ef(0x193))for(var _0x325971=0x0;_0x325971<AddedEmployeeList[_0x3c56ef(0x215)];_0x325971++){var _0x316348=new Date(AddedEmployeeList[_0x325971][_0x3c56ef(0x1a8)][_0x3c56ef(0x1ac)]),_0x330805=new Date();_0x330805[_0x3c56ef(0x1e3)](_0x316348['getMonth']()+0x3),_0x316348=$[_0x3c56ef(0x223)][_0x3c56ef(0x246)]('mm/dd/yy',_0x316348),_0x330805=$[_0x3c56ef(0x223)][_0x3c56ef(0x246)]('mm/dd/yy',_0x330805);var _0x3da858=new Date(AddedEmployeeList[_0x325971][_0x3c56ef(0x1a8)]['JoiningDate']);_0x3da858=$[_0x3c56ef(0x223)][_0x3c56ef(0x246)]('dd\x20M\x20yy',_0x3da858);var _0x5304ad=[],_0xe448e5=[],_0x198e55=[];_0x198e55[_0x3c56ef(0x1e5)](Logged_CompanyId);var _0x2461dc;_0x2461dc={'__metadata':{'type':_0x3c56ef(0x1b7)}},(_0x2461dc[_0x3c56ef(0x1da)]=_0x3c56ef(0x23b),_0x2461dc[_0x3c56ef(0x1d6)]=AddedEmployeeList[_0x325971]['EmployeeId'][_0x3c56ef(0x2cd)](),_0x2461dc['Title']=_0x3c56ef(0x1d1),_0x2461dc[_0x3c56ef(0x245)]=AddedEmployeeList[_0x325971]['Metadata']['FullName'],_0x2461dc[_0x3c56ef(0x28b)]=AddedEmployeeList[_0x325971][_0x3c56ef(0x1a8)][_0x3c56ef(0x28b)],_0x2461dc[_0x3c56ef(0x20f)]=AddedEmployeeList[_0x325971][_0x3c56ef(0x1ce)],_0x2461dc[_0x3c56ef(0x1f1)]=AddedEmployeeList[_0x325971][_0x3c56ef(0x2c1)],_0x2461dc[_0x3c56ef(0x1fa)]=_0x3c56ef(0x2b1),_0x2461dc[_0x3c56ef(0x29f)]='Welcome',_0x2461dc['Audience']=checkedAudience,_0x2461dc['ApprovalStatus']=_0x3c56ef(0x2cb),_0x2461dc[_0x3c56ef(0x1ed)]=_0x316348,_0x2461dc[_0x3c56ef(0x27e)]=_0x330805,_0x2461dc[_0x3c56ef(0x270)]='DOJ:\x20'+_0x3da858);if(checkedAudience==_0x3c56ef(0x20b))_0x198e55=[0x0],_0x5304ad=[0x0],_0xe448e5=[0x0],_0x2461dc[_0x3c56ef(0x218)]={'results':_0x198e55},_0x2461dc[_0x3c56ef(0x283)]={'results':_0xe448e5},_0x2461dc[_0x3c56ef(0x28a)]={'results':_0x5304ad};else{if(checkedAudience==_0x3c56ef(0x28d))_0x198e55[_0x3c56ef(0x1e5)](AddedEmployeeList[_0x325971][_0x3c56ef(0x1a8)]['CompanyId']),_0x5304ad=[0x0],_0xe448e5=[0x0],_0x2461dc[_0x3c56ef(0x218)]={'results':_0x198e55},_0x2461dc['DepartmentsId']={'results':_0xe448e5},_0x2461dc[_0x3c56ef(0x28a)]={'results':_0x5304ad};else{if(checkedAudience==_0x3c56ef(0x20f))_0x198e55=[0x0],_0x5304ad=[0x0],_0xe448e5[_0x3c56ef(0x1e5)](AddedEmployeeList[_0x325971]['Metadata'][_0x3c56ef(0x297)]),_0x2461dc['CompanyId']={'results':_0x198e55},_0x2461dc[_0x3c56ef(0x283)]={'results':_0xe448e5},_0x2461dc[_0x3c56ef(0x28a)]={'results':_0x5304ad};else checkedAudience==_0x3c56ef(0x298)&&(_0x198e55=[0x0],_0x5304ad['push'](AddedEmployeeList[_0x325971][_0x3c56ef(0x1a8)][_0x3c56ef(0x21c)]),_0xe448e5=[0x0],_0x2461dc[_0x3c56ef(0x218)]={'results':_0x198e55},_0x2461dc['DepartmentsId']={'results':_0xe448e5},_0x2461dc[_0x3c56ef(0x28a)]={'results':_0x5304ad});}}InsertWelcomeInAnnouncementList(_0x2461dc);}$(_0x3c56ef(0x1fe))['fadeOut']();}});});function SubmitReady(){var _0x453423=a0_0x3c8bdd;if(contributersGroupId!==''){var _0x5c1f7c=tabledata[_0x453423(0x25c)]();counusers=0x0,IsaddedNewEmployee=![];for(var _0x31096=0x0;_0x31096<_0x5c1f7c['length'];_0x31096++){var _0x3d4307=alluserdata['filter'](function(_0x499365){var _0x464d6c=_0x453423;return _0x499365[_0x464d6c(0x284)]==_0x5c1f7c[_0x31096][_0x464d6c(0x250)]['data']['Email\x20*'];});if(AvilableLicenses>0x0)_0x3d4307[0x0][_0x453423(0x20a)]==_0x453423(0x217)?(AddNewEmployeeAllocated(_0x3d4307,_0x453423(0x264)),IsaddedNewEmployee=!![]):_0x3d4307[0x0]['Status']=='Already\x20Exist'&&UpdateExistingEmployeeAllocated(_0x3d4307,'Employees');else return alert(_0x453423(0x2b9)),![];}warningmessage!=''&&(warningmessage+=userfullname,alert(warningmessage)),$(_0x453423(0x2b0))[_0x453423(0x2c7)](counusers),showmessage(),tabledata['setData'](excelRows),tabledata[_0x453423(0x2c6)](pageIndex),IsaddedNewEmployee&&($(_0x453423(0x2c3))['modal']({'backdrop':_0x453423(0x234),'keyboard':![]},_0x453423(0x2cc)),AddedEmployeeList[_0x453423(0x215)]>0x0?$(_0x453423(0x290))[_0x453423(0x2cc)]():$(_0x453423(0x290))[_0x453423(0x27f)]());}else GetGroupIDByGroupName(),GetSelectItem();}function isReadeySelecteds(){var _0x790d90=a0_0x3c8bdd;isReadeySelect=document[_0x790d90(0x23e)]('isReadeySelected');if(isReadeySelect[_0x790d90(0x1fb)]){tabledata['deselectRow'](MiisingSelected),$(_0x790d90(0x253))[_0x790d90(0x2aa)](_0x790d90(0x1fb),![]),$('#IsMiisingSelected')['prop'](_0x790d90(0x1fb),![]),ReadySelected=[];for(var _0x15eea9=0x0;_0x15eea9<excelRows[_0x790d90(0x215)];_0x15eea9++){(excelRows[_0x15eea9][_0x790d90(0x20a)]==_0x790d90(0x217)||excelRows[_0x15eea9]['Status']==_0x790d90(0x2bb))&&ReadySelected[_0x790d90(0x1e5)](_0x15eea9);}$(_0x790d90(0x213))[_0x790d90(0x2aa)](_0x790d90(0x1fb),!![]),tabledata[_0x790d90(0x2ad)](ReadySelected);}else tabledata['deselectRow'](ReadySelected),$('.select-row_isReadeySelected')['prop'](_0x790d90(0x1fb),![]);}function IsMiisingSelecteds(){var _0x24f972=a0_0x3c8bdd;IsMiisingSelect=document[_0x24f972(0x23e)](_0x24f972(0x265));if(IsMiisingSelect[_0x24f972(0x1fb)]){tabledata[_0x24f972(0x254)](ReadySelected),$('#isReadeySelected')[_0x24f972(0x2aa)](_0x24f972(0x1fb),![]),$(_0x24f972(0x213))[_0x24f972(0x2aa)](_0x24f972(0x1fb),![]),MiisingSelected=[];for(var _0x3ba8a5=0x0;_0x3ba8a5<excelRows['length'];_0x3ba8a5++){(excelRows[_0x3ba8a5][_0x24f972(0x20a)]=='Required\x20Value\x20Missing'||excelRows[_0x3ba8a5][_0x24f972(0x20a)]==_0x24f972(0x2bb)||excelRows[_0x3ba8a5][_0x24f972(0x20a)]=='Ready')&&(MiisingSelected[_0x24f972(0x1e5)](_0x3ba8a5),$(_0x24f972(0x253))[_0x24f972(0x2aa)](_0x24f972(0x1fb),!![]));}tabledata['selectRow'](MiisingSelected);}else tabledata['deselectRow'](MiisingSelected),$(_0x24f972(0x253))['prop'](_0x24f972(0x1fb),![]);}function AssignPermissiononDMSLibary(_0x238881,_0x1e5180,_0x300d22){var _0x1f7e60=a0_0x3c8bdd,_0x12f4f5={'Accept':'application/json;odata=verbose','content-Type':_0x1f7e60(0x252),'X-RequestDigest':jQuery('#__REQUESTDIGEST')[_0x1f7e60(0x21f)]()},_0x10253b=_0x300d22+_0x1f7e60(0x256)+_0x238881+_0x1f7e60(0x2c2)+_0x1e5180+')';$['ajax']({'url':_0x10253b,'type':_0x1f7e60(0x2c9),'headers':_0x12f4f5,'dataType':_0x1f7e60(0x2ae),'async':![],'success':function(_0x14f306){var _0x48098f=_0x1f7e60;console[_0x48098f(0x2c0)]('User\x20has\x20been\x20assigned\x20permission\x20.');},'error':function(_0x3b33e1){var _0x52e92f=_0x1f7e60;console[_0x52e92f(0x2c0)](JSON['stringify'](_0x3b33e1)),Permissionloder[_0x52e92f(0x1be)]();}});}function GetGroupIDByGroupName(){var _0x69dfe5=a0_0x3c8bdd,_0x4da425=_spPageContextInfo[_0x69dfe5(0x1b9)]+_0x69dfe5(0x1d8);$[_0x69dfe5(0x279)]({'url':_0x4da425,'method':_0x69dfe5(0x1e8),'async':![],'headers':{'Accept':_0x69dfe5(0x289)},'success':function(_0x179f11){contributersGroupId=_0x179f11['d']['Id'];},'error':function(_0x1cc56b){var _0x545ac8=_0x69dfe5;console[_0x545ac8(0x2c0)](_0x1cc56b);}});}function GetListItems(_0x410d73,_0xc7fa7f){var _0x209493=a0_0x3c8bdd,_0x420320,_0x190eda=_spPageContextInfo[_0x209493(0x1b9)]+_0x209493(0x2b7)+_0x410d73+_0x209493(0x2c4)+_0xc7fa7f+_0x209493(0x226);return $[_0x209493(0x279)]({'url':_0x190eda,'method':_0x209493(0x1e8),'async':![],'headers':{'Accept':_0x209493(0x289)},'success':function(_0x37be0a){_0x37be0a['d']['results']['length']>0x0?_0x420320=![]:_0x420320=!![];},'error':function(_0x2d5a26){var _0xab9a55=_0x209493;console[_0xab9a55(0x2c0)](_0x2d5a26);}}),_0x420320;}function GetCompanies(){var _0x2fd3c6=a0_0x3c8bdd,_0x439f3e=_spPageContextInfo['webAbsoluteUrl']+'/_api/web/lists/getByTitle(\x27Companies\x27)/items?$select=*&$top=4900';$[_0x2fd3c6(0x279)]({'url':_0x439f3e,'method':_0x2fd3c6(0x1e8),'async':![],'headers':{'Accept':_0x2fd3c6(0x289)},'success':function(_0xecf4b3){AllCompanies=_0xecf4b3['d']['results'];},'error':function(_0x410083){console['log'](_0x410083);}});}function GetDepartments(){var _0x13f6e9=a0_0x3c8bdd,_0x4a3813=_spPageContextInfo[_0x13f6e9(0x1b9)]+'/_api/web/lists/getByTitle(\x27Departments\x27)/items?$select=*&$top=4900';$[_0x13f6e9(0x279)]({'url':_0x4a3813,'method':'GET','async':![],'headers':{'Accept':_0x13f6e9(0x289)},'success':function(_0x57080c){var _0x14f3f7=_0x13f6e9;AllDepartments=_0x57080c['d'][_0x14f3f7(0x230)];},'error':function(_0x3c09fd){var _0x434299=_0x13f6e9;console[_0x434299(0x2c0)](_0x3c09fd);}});}function GetOfficeLocation(){var _0x2520e3=a0_0x3c8bdd,_0x42150d=_spPageContextInfo[_0x2520e3(0x1b9)]+_0x2520e3(0x1f3);$[_0x2520e3(0x279)]({'url':_0x42150d,'method':_0x2520e3(0x1e8),'async':![],'headers':{'Accept':'application/json;\x20odata=verbose'},'success':function(_0x1140e1){var _0x20b9d5=_0x2520e3;AllOfficeLocation=_0x1140e1['d'][_0x20b9d5(0x230)];},'error':function(_0x3af196){var _0x124252=_0x2520e3;console[_0x124252(0x2c0)](_0x3af196);}});}function GetSubSiteUrl(_0x2b85f5,_0x26f46b){var _0x4a9f69=a0_0x3c8bdd,_0x266e44,_0x212e0e=_spPageContextInfo[_0x4a9f69(0x1b9)]+_0x4a9f69(0x2b7)+_0x2b85f5+'\x27)/items?$select=ID,SiteURL&$filter=ID\x20eq\x20'+_0x26f46b+_0x4a9f69(0x226);return $['ajax']({'url':_0x212e0e,'method':_0x4a9f69(0x1e8),'async':![],'headers':{'Accept':_0x4a9f69(0x289)},'success':function(_0x367c81){var _0x2055a3=_0x4a9f69;_0x266e44=_0x367c81['d'][_0x2055a3(0x230)][0x0][_0x2055a3(0x291)];},'error':function(_0x1463d6){var _0x20d6ff=_0x4a9f69;console[_0x20d6ff(0x2c0)](_0x1463d6);}}),_0x266e44;}function AddUserinSharePointGroup(_0x44a147){var _0x19fa02=a0_0x3c8bdd,_0x41da6f=$[_0x19fa02(0x2bc)](),_0x2d3dc3='i:0#.f|membership|',_0x343f28=_0x2d3dc3+_0x44a147,_0x1b2bb8=_spPageContextInfo['webAbsoluteUrl']+'/_api/web/sitegroups('+contributersGroupId+_0x19fa02(0x1b8);$['ajax']({'url':_0x1b2bb8,'type':_0x19fa02(0x2c9),'async':![],'data':JSON[_0x19fa02(0x1aa)]({'__metadata':{'type':'SP.User'},'LoginName':_0x343f28}),'headers':{'accept':'application/json;odata=verbose','content-type':'application/json;odata=verbose','X-RequestDigest':$(_0x19fa02(0x1c8))[_0x19fa02(0x21f)]()},'success':_0x3eebd2,'error':_0x21118d});function _0x3eebd2(_0x5b5a52){var _0x4f8598=_0x19fa02;_0x41da6f[_0x4f8598(0x2a0)](_0x5b5a52['d']['Id']),console[_0x4f8598(0x2c0)](_0x4f8598(0x1a3));}function _0x21118d(_0x16d4cc){var _0x55b324=_0x19fa02;console[_0x55b324(0x2c0)](JSON[_0x55b324(0x1aa)](_0x16d4cc));}return _0x41da6f[_0x19fa02(0x28f)]();}function GetUserId(_0x5720f8){var _0x2b11ef=a0_0x3c8bdd,_0x1c6bc2='',_0x15ccae=_0x2b11ef(0x19c),_0x2f9d2d=_spPageContextInfo['siteAbsoluteUrl'],_0x1f060b=_0x15ccae+_0x5720f8;return $[_0x2b11ef(0x279)]({'url':_0x2f9d2d+_0x2b11ef(0x1ba)+encodeURIComponent(_0x1f060b)+'\x27','method':_0x2b11ef(0x1e8),'headers':{'Accept':_0x2b11ef(0x289)},'async':![],'success':function(_0x525009){_0x1c6bc2=_0x525009['d']['Id'];},'error':function(_0x2c498b){var _0xc82501=_0x2b11ef;console[_0xc82501(0x2c0)](JSON[_0xc82501(0x1aa)](_0x2c498b));}}),_0x1c6bc2;}var GetAllGroupsUser=[],GroupUrl=_spPageContextInfo['siteAbsoluteUrl']+a0_0x3c8bdd(0x1d2);function GetAllUserId(){var _0x1f7a1d=a0_0x3c8bdd;$[_0x1f7a1d(0x279)]({'url':GroupUrl,'method':_0x1f7a1d(0x1e8),'headers':{'Accept':_0x1f7a1d(0x289)},'async':![],'success':function(_0x4796d4){var _0x5027e2=_0x1f7a1d;GetAllGroupsUser=GetAllGroupsUser[_0x5027e2(0x1af)](_0x4796d4['d']['results']),_0x4796d4['d'][_0x5027e2(0x2be)]!=null&&(GroupUrl=_0x4796d4['d'][_0x5027e2(0x2be)],GetAllUserId());},'error':function(_0x3b1db2){var _0x198657=_0x1f7a1d;console[_0x198657(0x2c0)](JSON[_0x198657(0x1aa)](_0x3b1db2));}});}var LoginName;function UpdateExistingEmployeeAllocated(_0x2ed865,_0x43de28){var _0x342a41=a0_0x3c8bdd;try{UserEmailId=_0x2ed865[0x0][_0x342a41(0x284)],LoginName=_0x342a41(0x19c)+_0x2ed865[0x0][_0x342a41(0x284)];var _0x22d9a0,_0x38fe4e,_0x3ca252=GetAllGroupsUser[_0x342a41(0x1fd)](function(_0x36c549){var _0x4acb3d=_0x342a41;return _0x36c549['Email']['toLowerCase']()==_0x2ed865[0x0][_0x4acb3d(0x284)]['toLowerCase']();});if(_0x3ca252[_0x342a41(0x215)]>0x0)var _0x515704=_0x3ca252[0x0]['Id'];else{}if(TopExecutive==_0x342a41(0x2ab)||_0x2ed865[0x0]['Manager\x20*']==undefined)_0x2ed865[0x0][_0x342a41(0x1b0)]=_0x342a41(0x2ab),_0x22d9a0=-0x1;else{var _0x4ceb37=EmployeeListUsers['filter'](function(_0x2e93e4){var _0xc8de5e=_0x342a41,_0x4315bf;if(_0x2e93e4['Manager']!=null)return _0x4315bf=_0x2e93e4[_0xc8de5e(0x277)]['toLowerCase'](),_0x4315bf==_0x2ed865[0x0][_0xc8de5e(0x1b0)]['toLowerCase']();});if(_0x4ceb37[_0x342a41(0x215)]>0x0){_0x38fe4e=_0x4ceb37[0x0]['FullName'];var _0x3ca252=GetAllGroupsUser[_0x342a41(0x1fd)](function(_0x473c31){var _0x27df0f=_0x342a41;return _0x473c31[_0x27df0f(0x277)]['toLowerCase']()==_0x2ed865[0x0][_0x27df0f(0x1b0)][_0x27df0f(0x1b2)]();});if(_0x3ca252[_0x342a41(0x215)]>0x0)_0x22d9a0=_0x3ca252[0x0]['Id'];else{}}else{IsManager=![],_0x22d9a0='';var _0x6df92a=excelRows[_0x342a41(0x2b8)](_0x467038=>_0x467038[_0x342a41(0x284)]['toLowerCase']()==_0x2ed865[0x0]['Email\x20*']['toLowerCase']());excelRows[_0x6df92a][_0x342a41(0x20a)]=_0x342a41(0x271);}}var _0x419c6a,_0x158b9a=GetItemTypeForListName(_0x43de28);_0x419c6a={'__metadata':{'type':_0x158b9a},'Designation':_0x2ed865[0x0][_0x342a41(0x269)],'GroupName':_0x2ed865[0x0][_0x342a41(0x1e1)],'Manager':_0x38fe4e,'ManagerLoginNameId':_0x22d9a0},$[_0x342a41(0x28c)](updateItemExitUser(_0x43de28,_0x419c6a,_0x2ed865[0x0]['EmpUserId']))['done'](function(_0x5efca5){var _0x56899b=_0x342a41,_0x565417=_0x5efca5;if(_0x565417){lblUpdate=lblUpdate+0x1,Exits=Exits-0x1;var _0x27a3de=excelRows[_0x56899b(0x2b8)](_0x254825=>_0x254825[_0x56899b(0x284)]==UserEmailId);excelRows[_0x27a3de][_0x56899b(0x20a)]=_0x56899b(0x26d),showmessage();}});}catch(_0x36a95e){console['log'](_0x36a95e['message']);}}var IsManager=!![];function AddNewEmployeeAllocated(_0x50c2c8,_0x1e658f){var _0x364d91=a0_0x3c8bdd;try{if(GetListItems(_0x364d91(0x1c5),parseInt(_0x50c2c8[0x0][_0x364d91(0x27b)])))return alert('Department\x20Id\x20is\x20not\x20Correct'),![];if(GetListItems(_0x364d91(0x22e),parseInt(_0x50c2c8[0x0][_0x364d91(0x240)])))return alert(_0x364d91(0x26f)),![];else{if(GetListItems(_0x364d91(0x1f1),parseInt(_0x50c2c8[0x0]['Location\x20*'])))return alert(_0x364d91(0x22f)),![];else{LoginName=_0x50c2c8[0x0][_0x364d91(0x284)][_0x364d91(0x1b2)]();var _0x1bad64,_0x4e5310,_0xd31c41=GetAllGroupsUser[_0x364d91(0x1fd)](function(_0x4109b4){var _0xd0220e=_0x364d91;return _0x4109b4[_0xd0220e(0x277)][_0xd0220e(0x1b2)]()==_0x50c2c8[0x0][_0xd0220e(0x284)][_0xd0220e(0x1b2)]();}),_0x56f9f3;if(_0xd31c41[_0x364d91(0x215)]>0x0)var _0x56f9f3=_0xd31c41[0x0]['Id'];else $[_0x364d91(0x28c)](AddUserinSharePointGroup(LoginName))['done'](function(_0x36a6f8){_0x56f9f3=_0x36a6f8;});if(TopExecutive==_0x364d91(0x2ab)||_0x50c2c8[0x0]['Manager\x20*']==undefined)_0x50c2c8[0x0][_0x364d91(0x1b0)]=_0x364d91(0x2ab),_0x1bad64=-0x1;else{var _0x42aba4=EmployeeListUsers['filter'](function(_0x5a1dac){var _0x62937c=_0x364d91,_0x3c54af;if(_0x5a1dac[_0x62937c(0x277)]!=null)return _0x3c54af=_0x5a1dac[_0x62937c(0x277)][_0x62937c(0x1b2)](),_0x3c54af==_0x50c2c8[0x0]['Manager\x20*'][_0x62937c(0x1b2)]();});if(_0x42aba4[_0x364d91(0x215)]>0x0){_0x4e5310=_0x42aba4[0x0][_0x364d91(0x25d)];var _0xd31c41=GetAllGroupsUser['filter'](function(_0x471f7a){var _0x2c0b5c=_0x364d91;return _0x471f7a[_0x2c0b5c(0x277)][_0x2c0b5c(0x1b2)]()==_0x50c2c8[0x0][_0x2c0b5c(0x1b0)][_0x2c0b5c(0x1b2)]();});_0xd31c41[_0x364d91(0x215)]>0x0?_0x1bad64=_0xd31c41[0x0]['Id']:_0x1bad64=AddUserinSharePointGroup(_0x50c2c8[0x0][_0x364d91(0x1b0)][_0x364d91(0x1b2)]());}else{IsManager=![],_0x1bad64='';var _0x3ebcff=excelRows[_0x364d91(0x2b8)](_0x4dd395=>_0x4dd395[_0x364d91(0x284)][_0x364d91(0x1b2)]()==LoginName);excelRows[_0x3ebcff][_0x364d91(0x20a)]=_0x364d91(0x2b6);}}var _0x14e523,_0x1d9568=GetItemTypeForListName(_0x1e658f);_0x14e523={'__metadata':{'type':_0x1d9568},'CompanyId':parseInt(_0x50c2c8[0x0]['Company\x20*']),'DepartmentId':parseInt(_0x50c2c8[0x0][_0x364d91(0x27b)]),'FullName':_0x50c2c8[0x0][_0x364d91(0x23f)],'Title':_0x50c2c8[0x0]['Name'],'ParentId':'-1','Email':_0x50c2c8[0x0][_0x364d91(0x284)],'LogonNameId':_0x56f9f3,'Manager':_0x50c2c8[0x0][_0x364d91(0x1b0)],'ManagerLoginNameId':_0x1bad64,'OfficeLocationId':parseInt(_0x50c2c8[0x0]['Location\x20*']),'MobileNumber':_0x50c2c8[0x0]['Mobile'],'DateOfBirth':_0x50c2c8[0x0][_0x364d91(0x1ad)],'Gender':_0x50c2c8[0x0][_0x364d91(0x1de)],'DateOfAnniversary':_0x50c2c8[0x0][_0x364d91(0x1c3)],'JoiningDate':_0x50c2c8[0x0][_0x364d91(0x1e4)],'Designation':_0x50c2c8[0x0][_0x364d91(0x269)],'PrimaryCompany':'Primary','EmployeeID':_0x50c2c8[0x0][_0x364d91(0x21b)],'GroupName':_0x50c2c8[0x0][_0x364d91(0x1e1)],'Status':_0x364d91(0x2a8),'PostalAddresses':_0x50c2c8[0x0][_0x364d91(0x29b)],'City':_0x50c2c8[0x0]['City'],'StateProvince':_0x50c2c8[0x0]['Sate'],'ZIPPostalCode':_0x50c2c8[0x0][_0x364d91(0x2ac)],'Country':_0x50c2c8[0x0]['Country'],'HomePhone':_0x50c2c8[0x0][_0x364d91(0x222)],'OtherEMailAddress':_0x50c2c8[0x0][_0x364d91(0x241)],'HomeAddress':_0x50c2c8[0x0][_0x364d91(0x1a5)]},AddItemToList(_0x1e658f,_0x14e523);var _0x14b414=new Date(),_0x2f177b=new Date(_0x50c2c8[0x0][_0x364d91(0x1e4)]),_0x549e2b=daysDifference(_0x2f177b,_0x14b414);if(_0x549e2b<=0xf)AddedEmployeeList['push']({'Metadata':_0x14e523,'EmployeeId':EmployeeId,'EmployeeOfficeLocation':_0x50c2c8[0x0][_0x364d91(0x1cd)],'EmployeeDepartment':_0x50c2c8[0x0][_0x364d91(0x26b)]});else{}}}}catch(_0x4bf51b){console[_0x364d91(0x2c0)](_0x4bf51b[_0x364d91(0x214)]);}}function daysDifference(_0x1c088e,_0x511acb){var _0x3c8382=a0_0x3c8bdd,_0x1cbcce=new Date(+_0x511acb)[_0x3c8382(0x1e7)](0xc)-new Date(+_0x1c088e)[_0x3c8382(0x1e7)](0xc);return Math[_0x3c8382(0x2af)](_0x1cbcce/0x5265c00);}function updateItemExitUser(_0x14c6df,_0x5b9ff7,_0x3f8aba){var _0x10c6be=a0_0x3c8bdd,_0x382220=$[_0x10c6be(0x2bc)]();return $[_0x10c6be(0x279)]({'url':_spPageContextInfo[_0x10c6be(0x1b9)]+_0x10c6be(0x210)+_0x14c6df+_0x10c6be(0x20e)+_0x3f8aba+'\x27)','type':_0x10c6be(0x2c9),'headers':{'accept':_0x10c6be(0x252),'X-RequestDigest':$(_0x10c6be(0x1c8))[_0x10c6be(0x21f)](),'content-Type':_0x10c6be(0x252),'X-Http-Method':_0x10c6be(0x1f2),'If-Match':'*'},'data':JSON[_0x10c6be(0x1aa)](_0x5b9ff7),'async':![],'success':function(_0xb6ef97){var _0x1bca2e=_0x10c6be;_0x382220[_0x1bca2e(0x2a0)](!![]);},'error':function(_0x2be118){var _0x4b56f3=_0x10c6be;_0x382220[_0x4b56f3(0x1a7)](_0x2be118);}}),_0x382220[_0x10c6be(0x28f)]();}function AddItemToList(_0x261eff,_0x44a888){var _0xdd4d8=a0_0x3c8bdd;UserEmailId=_0x44a888[_0xdd4d8(0x277)];var _0x46e6fb=_0x44a888[_0xdd4d8(0x25d)];EmployeeId='';var _0x2a4648=$[_0xdd4d8(0x2bc)]();return $[_0xdd4d8(0x279)]({'url':_spPageContextInfo[_0xdd4d8(0x1b9)]+_0xdd4d8(0x210)+_0x261eff+_0xdd4d8(0x211),'type':_0xdd4d8(0x2c9),'async':![],'headers':{'accept':_0xdd4d8(0x252),'X-RequestDigest':$('#__REQUESTDIGEST')[_0xdd4d8(0x21f)](),'content-Type':_0xdd4d8(0x252)},'data':JSON['stringify'](_0x44a888),'success':function(_0x477cbf){var _0x165f2f=_0xdd4d8;EmployeeId=_0x477cbf['d']['Id'],counusers=counusers+0x1,AvilableLicenses=AvilableLicenses-0x1,Ready=Ready-0x1;var _0x5dec60=excelRows['findIndex'](_0x24974a=>_0x24974a['Email\x20*']==UserEmailId);excelRows[_0x5dec60][_0x165f2f(0x20a)]=_0x165f2f(0x238),showmessage();var _0x583ba7=GetSubSiteUrl(_0x165f2f(0x1c5),_0x477cbf['d'][_0x165f2f(0x297)]);AssignPermissiononDMSLibary(_0x477cbf['d'][_0x165f2f(0x220)],_0x165f2f(0x198),_0x583ba7),_0x2a4648['resolve'](_0x477cbf);},'error':function(_0x123d2e){var _0x4c4d53=_0xdd4d8;if(IsManager){var _0x1863e1=excelRows[_0x4c4d53(0x2b8)](_0x99990f=>_0x99990f['Email\x20*']==UserEmailId);excelRows[_0x1863e1]['Status']=_0x4c4d53(0x285);}userfullname==''?(userfullname+=_0x46e6fb,warningmessage=_0x4c4d53(0x278)):userfullname+=_0x4c4d53(0x29e)+_0x46e6fb,Ready=Ready-0x1,Error=Error+0x1,console[_0x4c4d53(0x2c0)](JSON[_0x4c4d53(0x1aa)](_0x123d2e)),_0x2a4648[_0x4c4d53(0x1a7)](JSON['stringify'](_0x123d2e));}}),_0x2a4648[_0xdd4d8(0x28f)]();}function LoadShowUser(_0x18bb08){var _0x5246d1=a0_0x3c8bdd;tabledata=new Tabulator(_0x5246d1(0x248),{'height':'','pagination':_0x5246d1(0x2a9),'paginationSize':0xa,'layout':_0x5246d1(0x23d),'paginationSizeSelector':[0xa,0x19,0x32,0x64],'placeholder':'Please\x20upload\x20xlsx\x20file','data':_0x18bb08,'pageLoaded':function(_0x3b5e2a){var _0x3bd234=_0x5246d1;_0x3b5e2a>=0x1?pageIndex=_0x3b5e2a:pageIndex=_0x3b5e2a,IsMiisingSelect=document[_0x3bd234(0x23e)](_0x3bd234(0x265)),IsMiisingSelect[_0x3bd234(0x1fb)]&&$(_0x3bd234(0x253))[_0x3bd234(0x2aa)](_0x3bd234(0x1fb),!![]),isReadeySelect=document[_0x3bd234(0x23e)](_0x3bd234(0x287)),isReadeySelect['checked']&&$(_0x3bd234(0x213))['prop'](_0x3bd234(0x1fb),!![]);},'columns':[{'formatter':function(_0x5c73ae,_0x39f5c9){var _0x1d26cc=_0x5246d1,_0x577a47=_0x5c73ae['_cell'][_0x1d26cc(0x2b2)][_0x1d26cc(0x2b5)][_0x1d26cc(0x20a)];return _0x577a47=='Invalid\x20Profile'||_0x577a47==_0x1d26cc(0x20d)||_0x577a47==_0x1d26cc(0x238)||_0x577a47==_0x1d26cc(0x26d)?_0x1d26cc(0x228):'<input\x20type=\x22checkbox\x22\x20class=\x22select-row_isReadeySelected\x22\x20aria-label=\x22select\x20this\x20row\x22\x20/>';},'title':'<input\x20type=\x22checkbox\x22\x20id=\x22isReadeySelected\x22\x20onclick=\x22isReadeySelecteds()\x22\x20/>','field':'ID','width':'1%','headerSort':![],'cellClick':function(_0x42da53,_0x4c3bf7){var _0xecc7f=_0x5246d1,_0x173926=$(_0x4c3bf7[_0xecc7f(0x2a7)]()),_0x2f1ccd=_0x173926[_0xecc7f(0x266)]('.select-row_isReadeySelected');_0x2f1ccd[0x0]['checked']==![]&&$(_0x4c3bf7[_0xecc7f(0x282)]()[_0xecc7f(0x2a7)]())[_0xecc7f(0x266)](_0xecc7f(0x253))[0x0]['checked']==![]?_0x4c3bf7[_0xecc7f(0x282)]()[_0xecc7f(0x1a2)]():_0x4c3bf7['getRow']()['select']();}},{'formatter':function(_0x1d17ae,_0x55116b){var _0x1b956a=_0x5246d1,_0x5d5f3c=_0x1d17ae['_cell'][_0x1b956a(0x2b2)][_0x1b956a(0x2b5)]['Status'];return _0x5d5f3c==_0x1b956a(0x20d)||_0x5d5f3c==_0x1b956a(0x2bb)||_0x5d5f3c=='Ready'?_0x1b956a(0x1d9):_0x1b956a(0x228);},'title':_0x5246d1(0x25f),'hozAlign':'center','field':'ID','headerSort':![],'width':'1%','cellClick':function(_0x4a9153,_0x172009){var _0x5113c1=_0x5246d1,_0x423a1b=$(_0x172009[_0x5113c1(0x2a7)]()),_0xf0368e=_0x423a1b[_0x5113c1(0x266)](_0x5113c1(0x253));_0xf0368e[0x0]['checked']==![]&&$(_0x172009[_0x5113c1(0x282)]()[_0x5113c1(0x2a7)]())['find'](_0x5113c1(0x213))[0x0][_0x5113c1(0x1fb)]==![]?_0x172009[_0x5113c1(0x282)]()[_0x5113c1(0x1a2)]():_0x172009[_0x5113c1(0x282)]()['select']();}},{'title':_0x5246d1(0x20a),'field':_0x5246d1(0x20a),'width':'8%','formatter':function(_0x4bf61f,_0xec3268){var _0x522fb9=_0x5246d1,_0x4df528=_0x4bf61f[_0x522fb9(0x1b6)]();if(_0x4df528==_0x522fb9(0x249)||_0x4df528=='Required\x20Value\x20Missing'||_0x4df528==_0x522fb9(0x285)||_0x4df528==_0x522fb9(0x271))return _0x522fb9(0x281)+_0x4df528+_0x522fb9(0x29a);else return _0x4df528==_0x522fb9(0x2bb)?_0x522fb9(0x207)+_0x4df528+'</span>':'\x20<span\x20style=\x27color:green;\x20font-weight:bold;\x27>'+_0x4df528+_0x522fb9(0x29a);}},{'title':'Type','field':_0x5246d1(0x2a5),'width':_0x5246d1(0x19d)},{'title':_0x5246d1(0x23f),'field':_0x5246d1(0x23f),'width':_0x5246d1(0x19d)},{'title':_0x5246d1(0x277),'field':'Email\x20*','align':_0x5246d1(0x259),'width':'15%'},{'title':'Company','field':_0x5246d1(0x240),'width':_0x5246d1(0x19d),'align':'center'},{'title':'Department','field':'Department\x20*','width':_0x5246d1(0x19d),'align':_0x5246d1(0x1f9)},{'title':_0x5246d1(0x298),'field':_0x5246d1(0x22c),'width':'8%','align':_0x5246d1(0x1f9)},{'title':_0x5246d1(0x28b),'field':_0x5246d1(0x269),'width':_0x5246d1(0x19d)},{'title':_0x5246d1(0x2c5),'field':_0x5246d1(0x1b0),'width':_0x5246d1(0x19d)},{'title':_0x5246d1(0x1e4),'field':_0x5246d1(0x1e4),'width':_0x5246d1(0x19d)},{'title':_0x5246d1(0x1e1),'field':'Group\x20Name','width':_0x5246d1(0x19d)}]}),showmessage(),$('#Rowcount')[_0x5246d1(0x258)]('Total\x20Row\x20Count:\x20'),$(_0x5246d1(0x1a0))[_0x5246d1(0x2bd)](),$(_0x5246d1(0x204))[_0x5246d1(0x21e)](_0x5246d1(0x1a1));}function showmessage(){var _0x1337ae=a0_0x3c8bdd;$('#Ready')[_0x1337ae(0x2c7)](Ready),$(_0x1337ae(0x205))[_0x1337ae(0x2c7)](Error),$('#Exits')[_0x1337ae(0x2c7)](Exits),$(_0x1337ae(0x203))[_0x1337ae(0x2c7)](lblUpdate),$('#AvilableLicenses')[_0x1337ae(0x2c7)](AvilableLicenses);}function requestToken(){var _0x4317fc=a0_0x3c8bdd;$[_0x4317fc(0x279)]({'async':!![],'crossDomain':!![],'url':ClientUrl,'method':'POST','headers':{'content-type':_0x4317fc(0x2a1)},'data':{'grant_type':_0x4317fc(0x1e2),'client_id\x20':ClientId,'client_secret':ClentSecret,'scope\x20':_0x4317fc(0x235)},'success':function(_0x41ebf8){var _0x33519a=_0x4317fc;console['log'](_0x41ebf8),token=_0x41ebf8[_0x33519a(0x21a)];},'error':function(_0x19aad9){var _0x175538=_0x4317fc;console['log'](JSON[_0x175538(0x1aa)](_0x19aad9));}});}function GraphAccessTokenTogetUserDetails(){var _0x57a390=a0_0x3c8bdd,_0x3f62a7=new jQuery[(_0x57a390(0x2bc))](),_0xb6b619={'X-RequestDigest':$('#__REQUESTDIGEST')[_0x57a390(0x21f)](),'accept':_0x57a390(0x1ec),'content-type':_0x57a390(0x1ec)},_0x505a06={'resource':_0x57a390(0x267)};return $[_0x57a390(0x279)]({'url':_spPageContextInfo[_0x57a390(0x1b9)]+_0x57a390(0x1e9),'headers':_0xb6b619,'type':'POST','async':![],'data':JSON[_0x57a390(0x1aa)](_0x505a06),'success':function(_0x238610){var _0xacd778=_0x57a390;token=_0x238610[_0xacd778(0x21a)],_0x3f62a7[_0xacd778(0x2a0)](token);},'error':function(_0x569159,_0x1ba61b,_0x335b5b){var _0x4173b3=_0x57a390;console[_0x4173b3(0x2c0)](_0x569159[_0x4173b3(0x212)]),_0x3f62a7[_0x4173b3(0x1a7)](_0x569159['responseText']);}}),_0x3f62a7[_0x57a390(0x28f)]();}var employeehtml='',userName='',AzureUsrlist=[],AdusersUrl=a0_0x3c8bdd(0x275);function GetAzureUsrlist(_0x6be497,_0x42c216){var _0x32a4bb=a0_0x3c8bdd;return DeferredObj=$[_0x32a4bb(0x2bc)](),$[_0x32a4bb(0x279)]({'method':_0x32a4bb(0x1e8),'url':_0x6be497,'headers':{'Authorization':_0x32a4bb(0x1ef)+_0x42c216,'Content-Type':'application/json'},'async':![],'success':function(_0x177959){var _0x5a08bc=_0x32a4bb;AzureUsrlist=AzureUsrlist[_0x5a08bc(0x1af)](_0x177959[_0x5a08bc(0x2a4)]),_0x177959[_0x5a08bc(0x197)]!=null&&(AdusersUrl=_0x177959[_0x5a08bc(0x197)],GetAzureUsrlist(AdusersUrl,_0x42c216));},'error':function(_0x522d01){var _0x11ccd3=_0x32a4bb;DeferredObj[_0x11ccd3(0x1a7)](_0x522d01),alert(_0x11ccd3(0x2b4)+JSON['stringify'](_0x522d01));}}),DeferredObj[_0x32a4bb(0x28f)]();}function getEmployee(_0x36a979){var _0x15b5af=a0_0x3c8bdd,_0x238f92='https://graph.microsoft.com/v1.0/users?$filter=mail\x20eq\x20\x27'+_0x36a979+'\x27';return DeferredObj=$[_0x15b5af(0x2bc)](),$['ajax']({'method':_0x15b5af(0x1e8),'url':_0x238f92,'headers':{'Authorization':_0x15b5af(0x1ef)+token,'Content-Type':'application/json'},'async':![],'success':function(_0x4701f6){var _0x36039a=_0x15b5af;_0x4701f6['value']['length']>0x0?DeferredObj[_0x36039a(0x2a0)](_0x4701f6[_0x36039a(0x2a4)][0x0][_0x36039a(0x1b5)]):DeferredObj['resolve']('Invalid\x20Profile');},'error':function(_0x1ea8f4){var _0x263d04=_0x15b5af;DeferredObj['reject'](_0x1ea8f4),alert(_0x263d04(0x2b4)+JSON[_0x263d04(0x1aa)](_0x1ea8f4));}}),DeferredObj[_0x15b5af(0x28f)]();}function ClientCredentials(){var _0xfbe396=a0_0x3c8bdd,_0x2e2b9b=_0xfbe396(0x23a),_0x53c73e=titanForWork[_0xfbe396(0x1d5)](_0xfbe396(0x218)),_0x354c7f=_spPageContextInfo[_0xfbe396(0x1b9)]+_0xfbe396(0x1ca)+_0x2e2b9b+'\x27)/items?$filter=Title\x20eq\x20\x27Client_Credentials\x27\x20';$[_0xfbe396(0x279)]({'url':_0x354c7f,'headers':{'Accept':_0xfbe396(0x252)},'async':![],'success':function(_0x26ebc2){var _0x167be3=_0xfbe396,_0x597f1f=_0x26ebc2['d']['results'];ClientId=_0x597f1f[0x0][_0x167be3(0x1f4)],ClentSecret=_0x597f1f[0x0][_0x167be3(0x2a3)],ClientUrl=_0x597f1f[0x0][_0x167be3(0x270)];},'error':function(_0x3a4b06){var _0x1493b3=_0xfbe396;console[_0x1493b3(0x2c0)](_0x3a4b06);}});}var EmployeeListUsers=[],GetQueryURL=_spPageContextInfo['webAbsoluteUrl']+'/_api/web/lists/GetByTitle(\x27Employees\x27)/items?$top=999&$select=ID,AttachmentFiles,FullName,Designation,Manager,MobileNumber,ExtensionName,Email,LogonName/UserName,Department/DepartmentName,Company/CompanyName,Company/ID,OfficeLocation/ID,OfficeLocation/OfficeName&$orderby=FullName&$expand=LogonName,OfficeLocation,Company,Department,AttachmentFiles\x20&$filter=\x20PrimaryCompany\x20eq\x20\x27Primary\x27\x20and\x20Status\x20eq\x20\x27Active\x27\x20';function GetEmployees(){var _0x544e07=a0_0x3c8bdd;$[_0x544e07(0x279)]({'url':GetQueryURL,'headers':{'Accept':_0x544e07(0x252)},'async':![],'beforeSend':function(){},'success':function(_0x2d7333){var _0x4d6c00=_0x544e07;EmployeeListUsers=EmployeeListUsers[_0x4d6c00(0x1af)](_0x2d7333['d']['results']);if(_0x2d7333['d'][_0x4d6c00(0x2be)]!=null)GetQueryURL=_0x2d7333['d'][_0x4d6c00(0x2be)],GetEmployees();else{GetQueryURL=_spPageContextInfo[_0x4d6c00(0x1b9)]+'/_api/web/lists/GetByTitle(\x27Employees\x27)/items?$top=999&$select=ID,AttachmentFiles,FullName,Designation,Manager,MobileNumber,ExtensionName,Email,LogonName/UserName,Department/DepartmentName,Company/CompanyName,Company/ID,OfficeLocation/ID,OfficeLocation/OfficeName&$orderby=FullName&$expand=LogonName,OfficeLocation,Company,Department,AttachmentFiles\x20&$filter=\x20PrimaryCompany\x20eq\x20\x27Primary\x27\x20and\x20Status\x20eq\x20\x27Active\x27\x20';var _0x4dca25=0x0,_0x1d30b4=_spPageContextInfo[_0x4d6c00(0x1b9)]+_0x4d6c00(0x1c7)+new Date()[_0x4d6c00(0x22d)]()+'\x27)\x20and\x20(Status\x20eq\x20\x27Active\x27)';extdfds=$[_0x4d6c00(0x2bc)](),$[_0x4d6c00(0x28c)](getItems(_0x1d30b4,extdfds))[_0x4d6c00(0x273)](function(_0x39767b){var _0x171c41=_0x4d6c00;response=[],_0x4dca25=_0x39767b[_0x171c41(0x215)];});}_0x4dca25!=undefined?AvilableLicenses=parseInt(UsersLicenceRequired)-(parseInt(EmployeeListUsers[_0x4d6c00(0x215)])+parseInt(_0x4dca25)):AvilableLicenses=parseInt(UsersLicenceRequired)-parseInt(EmployeeListUsers[_0x4d6c00(0x215)]);},'error':function(_0xb31bb0){var _0x9e438e=_0x544e07;console[_0x9e438e(0x2c0)](_0xb31bb0);}});}var fileUploadevent=document[a0_0x3c8bdd(0x23e)](a0_0x3c8bdd(0x1a9));fileUploadevent[a0_0x3c8bdd(0x1cf)]=function(){var _0xafb2a3=a0_0x3c8bdd;EmployeeListUsers=[],AvilableLicenses=0x0,this[_0xafb2a3(0x2a4)]=null;},fileUploadevent[a0_0x3c8bdd(0x244)]=function(){var _0xdcdfc7=a0_0x3c8bdd;$[_0xdcdfc7(0x279)]({'cache':![],'beforeSend':function(){var _0x466a18=_0xdcdfc7;$(_0x466a18(0x1fe))['fadeIn']();},'success':function(_0x1031ea){var _0x272d7b=_0xdcdfc7,_0x23b920=document['getElementById']('fileUpload');AzureUsrlist['length']==0x0&&GetAzureUsrlist(AdusersUrl,token);AvilableLicenses=0x0,GetEmployees(),LoadShowUser([]),Ready=0x0,Error=0x0,lblUpdate=0x0,counusers=0x0,Exits=0x0,$(_0x272d7b(0x1dd))[_0x272d7b(0x2c7)](0x0),$(_0x272d7b(0x205))[_0x272d7b(0x2c7)](0x0),$(_0x272d7b(0x2b0))[_0x272d7b(0x2c7)](0x0),$(_0x272d7b(0x203))[_0x272d7b(0x2c7)](0x0),$(_0x272d7b(0x1fc))[_0x272d7b(0x2c7)](0x0);var _0x238c22=/^([a-zA-Z0-9\s_\\.\-:])+(.xls|.xlsx)$/;if(_0x238c22[_0x272d7b(0x1d7)](_0x23b920[_0x272d7b(0x2a4)][_0x272d7b(0x1b2)]())){if(typeof FileReader!=_0x272d7b(0x1c4)){var _0x20b1ce=new FileReader();_0x20b1ce[_0x272d7b(0x19b)]?(_0x20b1ce[_0x272d7b(0x25e)]=function(_0x150b20){var _0x18fb0e=_0x272d7b;ProcessExcel(_0x150b20[_0x18fb0e(0x20c)][_0x18fb0e(0x236)]);},_0x20b1ce['readAsBinaryString'](_0x23b920[_0x272d7b(0x22b)][0x0])):(_0x20b1ce[_0x272d7b(0x25e)]=function(_0x1cb49a){var _0x2918b2=_0x272d7b,_0x537797='',_0x5e0484=new Uint8Array(_0x1cb49a[_0x2918b2(0x20c)]['result']);for(var _0x458e07=0x0;_0x458e07<_0x5e0484[_0x2918b2(0x1bb)];_0x458e07++){_0x537797+=String['fromCharCode'](_0x5e0484[_0x458e07]);}ProcessExcel(_0x537797);},_0x20b1ce[_0x272d7b(0x261)](_0x23b920[_0x272d7b(0x22b)][0x0]));}else alert(_0x272d7b(0x295));}else alert(_0x272d7b(0x1a4));$(_0x272d7b(0x1fe))[_0x272d7b(0x1b3)]();}});},$(function(){var _0x1847f0=a0_0x3c8bdd;$(_0x1847f0(0x247))[_0x1847f0(0x2a6)](function(){var _0x163655=_0x1847f0,_0x1ea3d4=document[_0x163655(0x23e)](_0x163655(0x1a9));GetEmployees(),LoadShowUser([]),Ready=0x0,Error=0x0,counusers=0x0;var _0x3bc96f=/^([a-zA-Z0-9\s_\\.\-:])+(.xls|.xlsx)$/;if(_0x3bc96f[_0x163655(0x1d7)](_0x1ea3d4[_0x163655(0x2a4)]['toLowerCase']())){if(typeof FileReader!=_0x163655(0x1c4)){var _0x2e4903=new FileReader();_0x2e4903[_0x163655(0x19b)]?(_0x2e4903[_0x163655(0x25e)]=function(_0x1d920c){var _0x2a8206=_0x163655;ProcessExcel(_0x1d920c[_0x2a8206(0x20c)]['result']);},_0x2e4903[_0x163655(0x19b)](_0x1ea3d4[_0x163655(0x22b)][0x0])):(_0x2e4903[_0x163655(0x25e)]=function(_0x2f5eb0){var _0x1fbfdf=_0x163655,_0xc1b2d7='',_0x4cecfe=new Uint8Array(_0x2f5eb0[_0x1fbfdf(0x20c)][_0x1fbfdf(0x236)]);for(var _0x274869=0x0;_0x274869<_0x4cecfe['byteLength'];_0x274869++){_0xc1b2d7+=String[_0x1fbfdf(0x19a)](_0x4cecfe[_0x274869]);}ProcessExcel(_0xc1b2d7);},_0x2e4903[_0x163655(0x261)](_0x1ea3d4['files'][0x0]));}else alert('This\x20browser\x20does\x20not\x20support\x20HTML5.');}else alert(_0x163655(0x1a4));});});function ProcessExcel(_0x2572e8){var _0x4d0bb0=a0_0x3c8bdd,_0x4dfc04=XLSX[_0x4d0bb0(0x1ae)](_0x2572e8,{'type':_0x4d0bb0(0x22a)}),_0x40d608=_0x4dfc04[_0x4d0bb0(0x209)][0x0];excelRows=XLSX[_0x4d0bb0(0x194)][_0x4d0bb0(0x27a)](_0x4dfc04[_0x4d0bb0(0x199)][_0x40d608]),$('#UploadedItems')['empty'](),$(_0x4d0bb0(0x23c))[_0x4d0bb0(0x1f0)]('<h3\x20class=\x27m-0\x27>'+excelRows[_0x4d0bb0(0x215)]+_0x4d0bb0(0x262)),$(_0x4d0bb0(0x1df))[_0x4d0bb0(0x258)]('');for(var _0x215204=0x0;_0x215204<excelRows[_0x4d0bb0(0x215)];_0x215204++){var _0x21b402='';ErrorUser='';var _0x37e81b=EmployeeListUsers['filter'](function(_0x1ba6c5){var _0x2c5749=_0x4d0bb0,_0x44cd80=_0x1ba6c5[_0x2c5749(0x277)][_0x2c5749(0x1b2)]();return _0x44cd80==excelRows[_0x215204][_0x2c5749(0x284)][_0x2c5749(0x1b2)]();});if(_0x37e81b[_0x4d0bb0(0x215)]>0x0){_0x21b402=_0x37e81b[0x0][_0x4d0bb0(0x25d)],color_red=_0x4d0bb0(0x239),ErrorUser=_0x4d0bb0(0x2bb),Exits=Exits+0x1;var _0x224e9f=_0x37e81b[0x0]['ID'];excelRows[_0x215204][_0x4d0bb0(0x240)]='-',excelRows[_0x215204][_0x4d0bb0(0x27b)]='-',excelRows[_0x215204][_0x4d0bb0(0x22c)]='-';}else{var _0x986e6b=AzureUsrlist[_0x4d0bb0(0x1fd)](function(_0x549ba7){var _0x14a87b=_0x4d0bb0;if(_0x549ba7[_0x14a87b(0x1b4)]!=null){var _0x45edea=_0x549ba7['mail'][_0x14a87b(0x1b2)]();return _0x45edea==excelRows[_0x215204][_0x14a87b(0x284)][_0x14a87b(0x1b2)]();}});if(_0x986e6b[_0x4d0bb0(0x215)]>0x0){_0x21b402=_0x986e6b[0x0][_0x4d0bb0(0x1b5)];var _0x10c9f8=AllCompanies[_0x4d0bb0(0x1fd)](function(_0x3c73fb){var _0x3f75fe=_0x4d0bb0;return _0x3c73fb['ID']==excelRows[_0x215204][_0x3f75fe(0x240)];}),_0x40ab0e=AllDepartments[_0x4d0bb0(0x1fd)](function(_0x173f12){var _0x5197f9=_0x4d0bb0;return _0x173f12['ID']==excelRows[_0x215204][_0x5197f9(0x27b)];}),_0x14d988=AllOfficeLocation[_0x4d0bb0(0x1fd)](function(_0x78a30e){var _0x21630d=_0x4d0bb0;return _0x78a30e['ID']==excelRows[_0x215204][_0x21630d(0x22c)];});_0x10c9f8['length']>0x0&&_0x40ab0e[_0x4d0bb0(0x215)]>0x0&&_0x14d988[_0x4d0bb0(0x215)]>0x0?(Ready=Ready+0x1,ErrorUser=_0x4d0bb0(0x217),excelRows[_0x215204]['DepartmentNameDetail']=_0x40ab0e[0x0]['DepartmentName'],excelRows[_0x215204]['OfficeNameDetail']=_0x14d988[0x0]['OfficeName']):(ErrorUser=_0x4d0bb0(0x20d),Error=Error+0x1);}else ErrorUser='Invalid\x20Profile',color_red=_0x4d0bb0(0x239),Error=Error+0x1;}excelRows[_0x215204][_0x4d0bb0(0x23f)]=_0x21b402,excelRows[_0x215204]['id']=_0x215204,excelRows[_0x215204][_0x4d0bb0(0x20a)]=ErrorUser,excelRows[_0x215204][_0x4d0bb0(0x1d3)]=_0x224e9f;}alluserdata=excelRows,LoadShowUser(excelRows);}function a0_0x1676(){var _0x1ab3bf=['Please\x20select\x20Location','POST','#btnmissingrequedvalue','Approved','show','toString','select#dropDownId\x20option:selected','NotSave','utils','ListItem','fadeIn','@odata.nextLink','1073741826','Sheets','fromCharCode','readAsBinaryString','i:0#.f|membership|','10%','ddlOfficeLocation','#chkTopExecutive','.breakpoint','<span\x20class=\x27breakpoint\x27></span>','deselect','User\x20Added','Please\x20upload\x20a\x20valid\x20Excel\x20file.','Home\x20Address','GetAllUserInfo','reject','Metadata','fileUpload','stringify','innerHTML','JoiningDate','Date\x20Of\x20Birth','read','concat','Manager\x20*','indexOf','toLowerCase','fadeOut','mail','displayName','getValue','SP.Data.AnnouncementsListItem',')/users','webAbsoluteUrl','/_api/web/siteusers(@v)?@v=\x27','byteLength','3999717xrcsjD','16FVAlTJ','close','EntityData','#AvilableLicenses','setData','xlsx','Date\x20Of\x20Marriage','undefined','Departments','keyup','/_api/web/lists/getbytitle(\x27ExternalUsers\x27)/items?$select=*,InternalStakeholders/Title,Supervisor_Guest/Title,Client_Name/Title,LoginName/Title\x20&$expand=\x20LoginName,Client_Name,Supervisor_Guest,InternalStakeholders\x20&$filter=(ValidUpto\x20ge\x20\x27','#__REQUESTDIGEST','PrincipalAccountType','/_api/web/lists/GetByTitle(\x27','SPClientPeoplePickerDict','EmployeeSyncReport.xlsx','OfficeNameDetail','EmployeeDepartment','onclick','<option\x20value=\x22','New\x20Joinee','/_api/web/siteusers?$top=1000&$select=*,Id','EmpUserId','MaximumEntitySuggestions','getQueryStringParameter','EmployeeID','test','/_api/web/sitegroups/getbyname(\x27Contributors\x27)?$select=id','<input\x20type=\x22checkbox\x22\x20class=\x22select-row_IsMiisingSelected\x22\x20aria-label=\x22select\x20this\x20row\x22\x20/>','Announcement_Type','1113216WwTVbw','map','#Ready','Gender','#dvExcel','Please\x20select\x20required\x20value\x20missing\x20row','Group\x20Name','client_credentials','setMonth','Date\x20Of\x20Joining','push','appendChild','setHours','GET','/_api/SP.OAuth.Token/Acquire','modal','exceltble','application/json;odata=nometadata','Publish_Date','Width','Bearer\x20','append','OfficeLocation','PATCH','/_api/web/lists/getByTitle(\x27OfficeLocation\x27)/items?$select=*&$top=4900','ClientName','chkManager','option:selected','User,DL,SecGroup,SPGroup','split','center','UserType','checked','#Exits','filter','#overlaysearch','SearchPrincipalSource','ready','chkOfficeLocation','.sp-peoplepicker-editorInput','#lblUpdate','.tabulator-page-size','#Error','ddlfilterAllCompanies','\x20<span\x20style=\x27color:blue;\x20font-weight:bold;\x27>','#ddlAllCompanies','SheetNames','Status','Corporate','target','Required\x20Value\x20Missing','\x27)/GetItemById(\x27','Department','/_api/web/lists/getbytitle(\x27','\x27)/items','responseText','.select-row_isReadeySelected','message','length','Select\x20Company','Ready','CompanyId','please\x20check\x20at\x20list\x20one\x20checkbox\x20','access_token','Employee\x20Code','OfficeLocationId','SP.Data.','after','val','LogonNameId','[id$=\x27AssaginTomanager_TopSpan\x27]','Home\x20Phone','datepicker','#btnDownLoadReport','92eGMeiz','&$top=1','change','<input\x20type=\x22checkbox\x22\x20class=\x22\x22\x20disabled\x20/>','removeProp','binary','files','Location\x20*','toISOString','Companies','Office\x20Location\x20Id\x20is\x20not\x20Correct','results','20410KfHNsl','download','#btnfiltervalue','static','https://graph.microsoft.com/.default','result','createElement','Added','color-red','EnvironmentalSettings','Welcome','#UploadedItems','fitColumns','getElementById','Name','Company\x20*','Email(Other)','294216CYUXbK','charAt','onchange','EmployeeName','formatDate','#upload','#example-table','Invalid\x20Profile','#ddlfilterAllCompanies','EmployeeSyncreport','1174102HqsMSc','All','focus','chkDesignation','_row','#ddlOfficeLocation','application/json;odata=verbose','.select-row_IsMiisingSelected','deselectRow','536279TlMFFu','/_api/web/lists/getByTitle(\x27DepartmentalDMS\x27)/roleassignments/addroleassignment(principalid=','chkDepartment','html','left','AllowMultipleValues','#UploadExcel','getSelectedRows','FullName','onload','<input\x20type=\x22checkbox\x22\x20id=\x22IsMiisingSelected\x22\x20onclick=\x22IsMiisingSelecteds()\x22\x20/>','<option\x20value=\x220\x22><strong>All</strong></option>','readAsArrayBuffer','</h3>\x20<p\x20class\x20=\x20\x22m-0\x22\x20>\x20Uploaded\x20</p>','</option>','Employees','IsMiisingSelected','find','https://graph.microsoft.com','#txtDesignation','Designation\x20*','input[type=radio][name=datasend]','DepartmentNameDetail','ddlfilterOfficeLocation','Updated','#ddlDepartment','Company\x20Id\x20is\x20not\x20Correct','Description','Worng\x20Manager','251px','done','readonly','https://graph.microsoft.com/beta/users?$top=100&$select=mail,displayName,userPrincipalName','Please\x20select\x20Department','Email','The\x20following\x20users\x20failed\x20to\x20sync\x20due\x20to\x20wrong\x20manager\x20defined!.\x0a','ajax','sheet_to_row_object_array','Department\x20*','#txtGroup','#ddlfilterOfficeLocation','Expires','hide','chkTopExecutive','\x20<span\x20style=\x27color:red;\x20font-weight:bold;\x27>','getRow','DepartmentsId','Email\x20*','Not\x20SP\x20Permission','join','isReadeySelected','option','application/json;\x20odata=verbose','OfficeLocationsId','Designation','when','Company','OfficeName','promise','#divAudience','SiteURL','#txtmanager','#ddlfilterDepartments','chkGroup','This\x20browser\x20does\x20not\x20support\x20HTML5.','toUpperCase','DepartmentId','Location','slice','</span>','Postal\x20Address','ddlfilterDepartments','ddlAllCompanies','\x20,\x20','WebPartName','resolve','application/x-www-form-urlencoded','.searching','ChangeFileName','value','Type','click','getElement','Active','local','prop','Chief\x20Executive','PIN/ZIP','selectRow','json','round','#added','Internal\x20Users','row','#btnFilter','error1','data','Wrong\x20Manager','/_api/web/lists/getByTitle(\x27','findIndex','Your\x20License\x20limit\x20has\x20been\x20ended','ddlDepartment','Already\x20Exist','Deferred','remove','__next','5062050lEwahj','log','EmployeeOfficeLocation',',roleDefId=','#successfully_notifications','\x27)/items?$select=ID&$filter=ID\x20eq\x20','Manager','setPage','text'];a0_0x1676=function(){return _0x1ab3bf;};return a0_0x1676();}function CompaniesDetails(){var _0x10e774=a0_0x3c8bdd,_0x519e45=document['getElementById'](_0x10e774(0x29d));_0x519e45[_0x10e774(0x1ab)]='',opt['value']='0',opt[_0x10e774(0x2c7)]=_0x10e774(0x216),_0x519e45[_0x10e774(0x1e6)](opt);for(var _0x65cd04=0x0;_0x65cd04<AllCompanies['length'];_0x65cd04++){var _0x9d18ed=AllCompanies[_0x65cd04]['CompanyName'],_0x670b12=AllCompanies[_0x65cd04]['ID'];opt=document[_0x10e774(0x237)]('option'),opt[_0x10e774(0x2a4)]=_0x670b12,opt[_0x10e774(0x2c7)]=_0x9d18ed,_0x519e45[_0x10e774(0x1e6)](opt);}$('.form-check-input')[_0x10e774(0x2aa)]('checked',![]),$(_0x10e774(0x292))[_0x10e774(0x21f)](''),$(_0x10e774(0x27c))[_0x10e774(0x21f)](''),$('#txtDesignation')['val']('');}$('#btnUploadExcel')['click'](function(){var _0xc50957=a0_0x3c8bdd,_0x46d8ea=tabledata[_0xc50957(0x25c)]();debugger;_0x46d8ea[_0xc50957(0x215)]>0x0?(CompaniesDetails(),$(_0xc50957(0x25b))[_0xc50957(0x1ea)]('show'),initializePeoplePicker('AssaginTomanager'),peoplePickerDiv=$(_0xc50957(0x221))):alert(_0xc50957(0x1e0));});var GetDepartments,Getofficelocation,GetDesignation,GetGroup,CompaniesId;$(a0_0x3c8bdd(0x2ca))[a0_0x3c8bdd(0x2a6)](function(){var _0x25f2db=a0_0x3c8bdd;if(document[_0x25f2db(0x23e)](_0x25f2db(0x257))[_0x25f2db(0x1fb)]==!![]||document['getElementById']('chkOfficeLocation')['checked']==!![]||document[_0x25f2db(0x23e)](_0x25f2db(0x24f))[_0x25f2db(0x1fb)]==!![]||document['getElementById'](_0x25f2db(0x1f5))[_0x25f2db(0x1fb)]==!![]||document[_0x25f2db(0x23e)](_0x25f2db(0x280))[_0x25f2db(0x1fb)]==!![]||document[_0x25f2db(0x23e)]('chkGroup')[_0x25f2db(0x1fb)]==!![]){var _0x1cf562=tabledata[_0x25f2db(0x25c)](),_0x196038=SPClientPeoplePicker[_0x25f2db(0x1cb)][peoplePickerDiv[0x0]['id']],_0x1006c5=_0x196038[_0x25f2db(0x1a6)]();for(var _0x3ed277=0x0;_0x3ed277<_0x1cf562['length'];_0x3ed277++){var _0x9a076f=excelRows[_0x25f2db(0x2b8)](_0x2300f5=>_0x2300f5['Email\x20*']==_0x1cf562[_0x3ed277][_0x25f2db(0x250)]['data'][_0x25f2db(0x284)]);if(excelRows[_0x9a076f]['Status']==_0x25f2db(0x2bb))excelRows[_0x9a076f][_0x25f2db(0x240)]='-',excelRows[_0x9a076f][_0x25f2db(0x27b)]='-',excelRows[_0x9a076f][_0x25f2db(0x22c)]='-',document[_0x25f2db(0x23e)]('chkDesignation')[_0x25f2db(0x1fb)]&&(excelRows[_0x9a076f]['Designation\x20*']=$(_0x25f2db(0x268))[_0x25f2db(0x21f)]()),document[_0x25f2db(0x23e)](_0x25f2db(0x1f5))[_0x25f2db(0x1fb)]&&(excelRows[_0x9a076f][_0x25f2db(0x1b0)]=_0x1006c5[0x0][_0x25f2db(0x1bf)][_0x25f2db(0x277)]),document['getElementById'](_0x25f2db(0x280))[_0x25f2db(0x1fb)]&&(excelRows[_0x9a076f]['Manager\x20*']='Chief\x20Executive'),document[_0x25f2db(0x23e)](_0x25f2db(0x294))[_0x25f2db(0x1fb)]&&(excelRows[_0x9a076f][_0x25f2db(0x1e1)]=$(_0x25f2db(0x27c))[_0x25f2db(0x21f)]());else{if(excelRows[_0x9a076f][_0x25f2db(0x20a)]==_0x25f2db(0x20d)||excelRows[_0x9a076f]['Status']==_0x25f2db(0x217)){document['getElementById'](_0x25f2db(0x257))[_0x25f2db(0x1fb)]&&(excelRows[_0x9a076f][_0x25f2db(0x240)]=CompaniesId,excelRows[_0x9a076f]['Department\x20*']=GetDepartments);document['getElementById'](_0x25f2db(0x201))[_0x25f2db(0x1fb)]&&(excelRows[_0x9a076f]['Company\x20*']=CompaniesId,excelRows[_0x9a076f]['Location\x20*']=Getofficelocation);document[_0x25f2db(0x23e)](_0x25f2db(0x24f))[_0x25f2db(0x1fb)]&&(excelRows[_0x9a076f]['Designation\x20*']=$(_0x25f2db(0x268))[_0x25f2db(0x21f)]());document[_0x25f2db(0x23e)](_0x25f2db(0x1f5))[_0x25f2db(0x1fb)]&&(excelRows[_0x9a076f][_0x25f2db(0x1b0)]=_0x1006c5[0x0][_0x25f2db(0x1bf)]['Email']);document[_0x25f2db(0x23e)]('chkTopExecutive')[_0x25f2db(0x1fb)]&&(excelRows[_0x9a076f][_0x25f2db(0x1b0)]=_0x25f2db(0x2ab));document[_0x25f2db(0x23e)]('chkGroup')['checked']&&(excelRows[_0x9a076f][_0x25f2db(0x1e1)]=$(_0x25f2db(0x27c))[_0x25f2db(0x21f)]());var _0x4b9785=AllCompanies[_0x25f2db(0x1fd)](function(_0x4c87de){var _0x5474f2=_0x25f2db;return _0x4c87de['ID']==excelRows[_0x9a076f][_0x5474f2(0x240)];}),_0x44ba47=AllDepartments[_0x25f2db(0x1fd)](function(_0x2c6e2d){var _0x4f83b5=_0x25f2db;return _0x2c6e2d['ID']==excelRows[_0x9a076f][_0x4f83b5(0x27b)];}),_0x535dac=AllOfficeLocation['filter'](function(_0x5a0923){var _0x305f84=_0x25f2db;return _0x5a0923['ID']==excelRows[_0x9a076f][_0x305f84(0x22c)];});_0x4b9785[_0x25f2db(0x215)]>0x0&&_0x44ba47[_0x25f2db(0x215)]>0x0&&_0x535dac[_0x25f2db(0x215)]>0x0?(Ready=Ready+0x1,Error=Error-0x1,excelRows[_0x9a076f][_0x25f2db(0x20a)]=_0x25f2db(0x217)):(excelRows[_0x9a076f][_0x25f2db(0x20a)]=_0x25f2db(0x20d),Error=Error+0x1);}else excelRows[_0x9a076f][_0x25f2db(0x20a)]==_0x25f2db(0x2b6)&&(document[_0x25f2db(0x23e)]('chkDesignation')['checked']&&(excelRows[_0x9a076f][_0x25f2db(0x269)]=$(_0x25f2db(0x268))[_0x25f2db(0x21f)]()),document[_0x25f2db(0x23e)](_0x25f2db(0x1f5))[_0x25f2db(0x1fb)]&&(excelRows[_0x9a076f][_0x25f2db(0x1b0)]=_0x1006c5[0x0][_0x25f2db(0x1bf)][_0x25f2db(0x277)]),document['getElementById'](_0x25f2db(0x280))['checked']&&(excelRows[_0x9a076f][_0x25f2db(0x1b0)]='Chief\x20Executive'),document[_0x25f2db(0x23e)]('chkGroup')[_0x25f2db(0x1fb)]&&(excelRows[_0x9a076f][_0x25f2db(0x1e1)]=$('#txtGroup')['val']()),Ready=Ready+0x1,Error=Error-0x1,excelRows[_0x9a076f][_0x25f2db(0x20a)]=_0x25f2db(0x217));}}tabledata[_0x25f2db(0x1c1)](excelRows),tabledata[_0x25f2db(0x2c6)](pageIndex),$(_0x25f2db(0x25b))[_0x25f2db(0x1ea)](_0x25f2db(0x27f)),showmessage();}else alert(_0x25f2db(0x219)),$(_0x25f2db(0x192))[_0x25f2db(0x21f)]();}),$(a0_0x3c8bdd(0x208))[a0_0x3c8bdd(0x227)](function(){var _0x5df880=a0_0x3c8bdd;CompaniesId=parseInt($('option:selected',$(this))[_0x5df880(0x21f)]());var _0x18adfa=AllOfficeLocation[_0x5df880(0x1fd)](function(_0x1e7ffa){return _0x1e7ffa['CompanyIDId']===CompaniesId;}),_0x51ba63=document[_0x5df880(0x23e)](_0x5df880(0x19e));_0x51ba63['innerHTML']='';for(var _0x5e4394=0x0;_0x5e4394<_0x18adfa['length'];_0x5e4394++){var _0x5b60f2=_0x18adfa[_0x5e4394][_0x5df880(0x28e)],_0x8d8d06=_0x18adfa[_0x5e4394]['ID'];opt=document[_0x5df880(0x237)]('option'),opt[_0x5df880(0x2a4)]=_0x8d8d06,opt[_0x5df880(0x2c7)]=_0x5b60f2,_0x51ba63[_0x5df880(0x1e6)](opt);}Getofficelocation=parseInt($(_0x5df880(0x1f6),$('#ddlOfficeLocation'))['val']());var _0x3a1286=AllDepartments[_0x5df880(0x1fd)](function(_0x2bf233){return _0x2bf233['CompanyIDId']===CompaniesId;}),_0x51ba63=document[_0x5df880(0x23e)](_0x5df880(0x2ba));_0x51ba63[_0x5df880(0x1ab)]='';for(var _0x5e4394=0x0;_0x5e4394<_0x3a1286[_0x5df880(0x215)];_0x5e4394++){var _0x5b60f2=_0x3a1286[_0x5e4394]['DepartmentName'],_0x8d8d06=_0x3a1286[_0x5e4394]['ID'];opt=document['createElement'](_0x5df880(0x288)),opt[_0x5df880(0x2a4)]=_0x8d8d06,opt['text']=_0x5b60f2,_0x51ba63[_0x5df880(0x1e6)](opt);}GetDepartments=parseInt($('option:selected',$(_0x5df880(0x26e)))[_0x5df880(0x21f)]());}),$('#ddlDepartment')[a0_0x3c8bdd(0x227)](function(){var _0x38a487=a0_0x3c8bdd;GetDepartments=parseInt($(_0x38a487(0x1f6),$(this))[_0x38a487(0x21f)]());}),$(a0_0x3c8bdd(0x251))[a0_0x3c8bdd(0x227)](function(){var _0x3286ee=a0_0x3c8bdd;Getofficelocation=parseInt($('option:selected',$(this))[_0x3286ee(0x21f)]());});function chkManagerevent(_0xc860a1){var _0x11fd78=a0_0x3c8bdd;if(_0xc860a1[_0x11fd78(0x1fb)])$(_0x11fd78(0x19f))['prop'](_0x11fd78(0x1fb),![]),$(_0x11fd78(0x292))[_0x11fd78(0x229)]('readonly'),$(_0x11fd78(0x292))[_0x11fd78(0x24e)]();else{}}var TopExecutive='';function chkTopExecutiveevent(_0xe63f2){var _0x183b1a=a0_0x3c8bdd;if(_0xe63f2[_0x183b1a(0x1fb)])$('#chkManager')[_0x183b1a(0x2aa)](_0x183b1a(0x1fb),![]),$(_0x183b1a(0x292))[_0x183b1a(0x2aa)](_0x183b1a(0x274),!![]),$(_0x183b1a(0x292))['val'](''),TopExecutive=_0x183b1a(0x2ab);else{}}$(a0_0x3c8bdd(0x224))[a0_0x3c8bdd(0x2a6)](function(){var _0x3bbcc8=a0_0x3c8bdd;tabledata[_0x3bbcc8(0x232)](_0x3bbcc8(0x1c2),_0x3bbcc8(0x1cc),{'sheetName':_0x3bbcc8(0x24b)});});var dvExcel=document[a0_0x3c8bdd(0x23e)](a0_0x3c8bdd(0x1eb));dvExcel[a0_0x3c8bdd(0x1ab)]='';var outputArray=[];function removewithfilter(_0x20c493){var _0x320d1b=a0_0x3c8bdd;let _0x36690e=_0x20c493[_0x320d1b(0x1fd)](function(_0x139b1e,_0x38d20c,_0x4eca34){var _0x352031=_0x320d1b;return _0x38d20c==_0x4eca34[_0x352031(0x1b1)](_0x139b1e);});return _0x36690e;}function GetItemTypeForListName(_0x42650d){var _0x323c8f=a0_0x3c8bdd;return _0x323c8f(0x21d)+_0x42650d[_0x323c8f(0x243)](0x0)[_0x323c8f(0x296)]()+_0x42650d[_0x323c8f(0x1f8)]('\x20')[_0x323c8f(0x286)]('')[_0x323c8f(0x299)](0x1)+_0x323c8f(0x195);}var response=response||[];function getItems(_0x21203c,_0x4792d0){var _0x3f2259=a0_0x3c8bdd;return $[_0x3f2259(0x279)]({'url':_0x21203c,'type':_0x3f2259(0x1e8),'async':![],'headers':{'accept':_0x3f2259(0x252)},'success':function(_0x3e7393){var _0x48815b=_0x3f2259;response=response['concat'](_0x3e7393['d'][_0x48815b(0x230)]),_0x3e7393['d']['__next']?(_0x21203c=_0x3e7393['d'][_0x48815b(0x2be)],getItems(_0x21203c,_0x4792d0)):_0x4792d0[_0x48815b(0x2a0)](response);},'error':function(_0x82bb3e){var _0x103521=_0x3f2259;_0x4792d0[_0x103521(0x1a7)](_0x82bb3e),console[_0x103521(0x2c0)](_0x82bb3e);}}),_0x4792d0[_0x3f2259(0x28f)]();}function ConvertddmmyyTommddyy(_0x4a29e5){var _0x623bda=a0_0x3c8bdd;return _0x4a29e5[_0x623bda(0x1f8)]('/')[0x1]+'/'+_0x4a29e5[_0x623bda(0x1f8)]('/')[0x0]+'/'+_0x4a29e5[_0x623bda(0x1f8)]('/')[0x2];}function InsertWelcomeInAnnouncementList(_0x207623){var _0x31194e=a0_0x3c8bdd;$['ajax']({'url':_spPageContextInfo[_0x31194e(0x1b9)]+'/_api/web/lists/GetByTitle(\x27Announcements\x27)/items','type':_0x31194e(0x2c9),'async':![],'data':JSON[_0x31194e(0x1aa)](_0x207623),'headers':{'Accept':_0x31194e(0x252),'Content-Type':_0x31194e(0x252),'X-RequestDigest':$(_0x31194e(0x1c8))[_0x31194e(0x21f)](),'X-HTTP-Method':_0x31194e(0x2c9)},'success':function(_0x4f06e9,_0x8d9c90,_0x1974fc){var _0x1ca1a0=_0x31194e;console[_0x1ca1a0(0x2c0)]('Data\x20Send\x20to\x20Announcements');},'error':function(_0x527706){var _0x2ff9c2=_0x31194e;console[_0x2ff9c2(0x2c0)](_0x527706),console[_0x2ff9c2(0x2c0)]('Data\x20Send\x20to\x20Announcements\x20Failed'),currentDlg[_0x2ff9c2(0x1be)]();}});}