var a0_0x3f1c76=a0_0x54b6;(function(_0x41f5f7,_0x3dc725){var _0x5a5da1=a0_0x54b6,_0x58d44f=_0x41f5f7();while(!![]){try{var _0xa9ff08=parseInt(_0x5a5da1(0x265))/0x1+-parseInt(_0x5a5da1(0x23e))/0x2+parseInt(_0x5a5da1(0x241))/0x3+-parseInt(_0x5a5da1(0x2b0))/0x4+-parseInt(_0x5a5da1(0x1b4))/0x5+-parseInt(_0x5a5da1(0x1ca))/0x6*(-parseInt(_0x5a5da1(0x286))/0x7)+-parseInt(_0x5a5da1(0x1cc))/0x8*(-parseInt(_0x5a5da1(0x200))/0x9);if(_0xa9ff08===_0x3dc725)break;else _0x58d44f['push'](_0x58d44f['shift']());}catch(_0x40dfed){_0x58d44f['push'](_0x58d44f['shift']());}}}(a0_0x1365,0x88995));var token,peoplePickerDiv='',peoplePickerDivsuper='',GroupId='',email='',IsUpdate=![],userListItemId='',GuestUserEmail='',UserListId=[],Client_Id;function initializePeoplePicker(_0x5f136c,_0x56e818){var _0x19ff2c=a0_0x54b6,_0x250281={};_0x250281[_0x19ff2c(0x1d8)]=_0x19ff2c(0x26c),_0x250281['SearchPrincipalSource']=0xf,_0x250281['ResolvePrincipalSource']=0xf,_0x250281[_0x19ff2c(0x20b)]=_0x56e818,_0x250281['MaximumEntitySuggestions']=0x32,_0x250281[_0x19ff2c(0x27a)]=_0x19ff2c(0x217),this[_0x19ff2c(0x256)](_0x5f136c,null,_0x250281),$(_0x19ff2c(0x28c))['width'](0xfa);}$(function(){var _0x5248eb=a0_0x54b6;$(_0x5248eb(0x2a0))[_0x5248eb(0x233)]({'changeMonth':!![],'changeYear':!![]});});function GetGueastEmployee(_0x421732){var _0x198356=a0_0x54b6,_0x2b558c=_0x198356(0x275)+_0x421732+'\x27';return DeferredObj=$['Deferred'](),$[_0x198356(0x262)]({'method':_0x198356(0x1c4),'url':_0x2b558c,'headers':{'Authorization':'Bearer\x20'+token,'Content-Type':_0x198356(0x295)},'async':![],'success':function(_0x5eec85){var _0x3b1d7f=_0x198356;DeferredObj[_0x3b1d7f(0x1ee)](_0x5eec85['value']);},'error':function(_0x57045a){var _0x1ad298=_0x198356;DeferredObj[_0x1ad298(0x237)](_0x57045a),alert('error1'+JSON['stringify'](_0x57045a));}}),DeferredObj['promise']();}function GetGueastUsers(_0x405a84){var _0x41d410=a0_0x54b6,_0x45d6da=_0x41d410(0x1fe)+_0x405a84+'\x27';return DeferredObj=$[_0x41d410(0x220)](),$[_0x41d410(0x262)]({'method':'GET','url':_0x45d6da,'headers':{'Authorization':_0x41d410(0x2b9)+token,'Content-Type':_0x41d410(0x295)},'async':![],'success':function(_0xe0c388){var _0x381e29=_0x41d410;DeferredObj['resolve'](_0xe0c388[_0x381e29(0x1d5)]);},'error':function(_0x43a3cc){var _0xc9e0eb=_0x41d410;DeferredObj['reject'](_0x43a3cc),alert(_0xc9e0eb(0x1ec)+JSON[_0xc9e0eb(0x282)](_0x43a3cc));}}),DeferredObj[_0x41d410(0x279)]();}function GetCategoryMaster(){var _0x385280=a0_0x54b6,_0x5a901f=_0x385280(0x1ea),_0x484208=_spPageContextInfo[_0x385280(0x1b2)]+_0x385280(0x2bb)+_0x5a901f+'\x27)/items?$filter=CategoryType\x20eq\x20\x27Guest\x20Type\x27\x20and\x20Status\x20eq\x20\x20\x27Yes\x27\x20';$[_0x385280(0x262)]({'url':_0x484208,'headers':{'Accept':_0x385280(0x29d)},'async':![],'success':function(_0x588fd4){var _0x3d68d5=_0x385280,_0x4acaf4=document['getElementById'](_0x3d68d5(0x1bd));_0x4acaf4[_0x3d68d5(0x1b5)]='';for(var _0x353e53=0x0;_0x353e53<_0x588fd4['d'][_0x3d68d5(0x1e0)][_0x3d68d5(0x258)];_0x353e53++){var _0x51390e=_0x588fd4['d'][_0x3d68d5(0x1e0)][_0x353e53][_0x3d68d5(0x257)],_0x3aee68=_0x588fd4['d'][_0x3d68d5(0x1e0)][_0x353e53]['CatogeryName'];opt=document[_0x3d68d5(0x20a)](_0x3d68d5(0x205)),opt[_0x3d68d5(0x1d5)]=_0x3aee68,opt[_0x3d68d5(0x261)]=_0x51390e,_0x4acaf4['appendChild'](opt);}},'error':function(_0x3076d2){var _0x478b62=_0x385280;console[_0x478b62(0x245)](_0x3076d2);}});}function GetUserId(_0x2795bc){var _0x125787=a0_0x54b6,_0x53cff1='',_0x4ce246=_0x125787(0x26d),_0x12d62e=_spPageContextInfo[_0x125787(0x1e9)],_0x4bcbb3=_0x4ce246+_0x2795bc;return $['ajax']({'url':_0x12d62e+_0x125787(0x234)+encodeURIComponent(_0x4bcbb3)+'\x27','method':_0x125787(0x1c4),'headers':{'Accept':_0x125787(0x230)},'async':![],'success':function(_0x250c81){_0x53cff1=_0x250c81['d']['Id'];},'error':function(_0x543360){var _0x319ad7=_0x125787;console['log'](JSON[_0x319ad7(0x282)](_0x543360));}}),_0x53cff1;}function GetUserName(_0x10f6d7){var _0x31b158=a0_0x54b6,_0x11dea1='',_0x296918='i:0#.f|membership|',_0x49fe65=_spPageContextInfo['siteAbsoluteUrl'],_0x7a9e30=_0x296918+_0x10f6d7;return $[_0x31b158(0x262)]({'url':_0x49fe65+'/_api/web/siteusers(@v)?@v=\x27'+encodeURIComponent(_0x7a9e30)+'\x27','method':_0x31b158(0x1c4),'headers':{'Accept':'application/json;\x20odata=verbose'},'async':![],'success':function(_0x4626f5){_0x11dea1=_0x4626f5['d']['Title'];},'error':function(_0x3b070f){var _0x4c5dcf=_0x31b158;console['log'](JSON[_0x4c5dcf(0x282)](_0x3b070f));}}),_0x11dea1;}function a0_0x54b6(_0x226b2a,_0x2ea05b){var _0x1365a1=a0_0x1365();return a0_0x54b6=function(_0x54b619,_0x4a1041){_0x54b619=_0x54b619-0x1ae;var _0x1cc402=_0x1365a1[_0x54b619];return _0x1cc402;},a0_0x54b6(_0x226b2a,_0x2ea05b);}function AddNewGuest(){var _0xa0ff6d=a0_0x54b6;try{var _0x574e62=_0xa0ff6d(0x28f),_0x10a693=SPClientPeoplePicker[_0xa0ff6d(0x221)][peoplePickerDiv[0x0]['id']],_0x26e1a0=_0x10a693[_0xa0ff6d(0x231)](),_0x57390b=[];for(var _0x3a7d0e=0x0;_0x3a7d0e<_0x26e1a0[_0xa0ff6d(0x258)];_0x3a7d0e++){var _0x5c50a2=GetUserId(_0x26e1a0[_0x3a7d0e]['EntityData'][_0xa0ff6d(0x269)]);_0x57390b[_0xa0ff6d(0x202)](_0x5c50a2),UserListId['push'](_0x5c50a2);}_0x10a693=SPClientPeoplePicker[_0xa0ff6d(0x221)][peoplePickerDivsuper[0x0]['id']],_0x26e1a0=_0x10a693[_0xa0ff6d(0x231)]();var _0x526072=GetUserId(_0x26e1a0[0x0]['EntityData']['Email']);UserListId['push'](_0x526072);GroupId==''&&GetGroupIDByGroupName();AddUserinSharePointGroup($(_0xa0ff6d(0x2b6))['val']());var _0x284588=GetUserId($(_0xa0ff6d(0x2b6))[_0xa0ff6d(0x212)]());UserListId['push'](_0x284588);var _0x576697=_spPageContextInfo[_0xa0ff6d(0x1b2)]+'/GuestUserDocuments/'+$('#txtAddOrganization')[_0xa0ff6d(0x212)]()[_0xa0ff6d(0x28b)]()['replace'](/ /g,'')+'/Forms/AllItems.aspx',_0x5d6769,_0x4b5e13=GetItemTypeForListName(_0x574e62);_0x5d6769={'__metadata':{'type':_0x4b5e13},'LoginNameId':_0x284588,'Title':$(_0xa0ff6d(0x2b6))[_0xa0ff6d(0x212)](),'email':$(_0xa0ff6d(0x2b6))[_0xa0ff6d(0x212)](),'Designation':$(_0xa0ff6d(0x1b0))[_0xa0ff6d(0x212)](),'Organization':$(_0xa0ff6d(0x289))[_0xa0ff6d(0x212)](),'ReferenceCode':$(_0xa0ff6d(0x27e))[_0xa0ff6d(0x212)](),'TemplateType':$(_0xa0ff6d(0x1ff),$(_0xa0ff6d(0x2bd)))[_0xa0ff6d(0x212)](),'InternalStakeholdersId':{'results':_0x57390b},'SupervisorId':_0x526072,'Client_NameId':Client_Id,'External_Supervisor':$(_0xa0ff6d(0x26f))[_0xa0ff6d(0x212)](),'ValidUpto':$('#datepickerAD5')[_0xa0ff6d(0x212)](),'CollaborationType':$(_0xa0ff6d(0x1ff),$(_0xa0ff6d(0x1c1)))[_0xa0ff6d(0x212)](),'Status':$(_0xa0ff6d(0x1ff),$('#txtExtStatus'))[_0xa0ff6d(0x212)](),'DocumentLibrary':_0x576697},AddItemToList(_0x574e62,_0x5d6769,UserListId);}catch(_0x5941b3){console['log'](_0x5941b3[_0xa0ff6d(0x226)]);}}function cleartextBox(){var _0x4ec010=a0_0x54b6;$(_0x4ec010(0x278))[_0x4ec010(0x212)](''),$(_0x4ec010(0x2b6))[_0x4ec010(0x212)](''),$(_0x4ec010(0x1b0))['val'](''),$(_0x4ec010(0x27e))[_0x4ec010(0x212)](''),$(_0x4ec010(0x296))['val'](''),$(_0x4ec010(0x29c))[_0x4ec010(0x271)](_0x4ec010(0x29a),_0x4ec010(0x208)),initializePeoplePicker(_0x4ec010(0x222),!![]),peoplePickerDiv=$(_0x4ec010(0x2a1)),initializePeoplePicker(_0x4ec010(0x1b7),![]),peoplePickerDivsuper=$(_0x4ec010(0x1de));}function AddItemToList(_0x29dd37,_0x1fc709,_0x2d7347){var _0x10b9a5=a0_0x54b6,_0x426e5c=$[_0x10b9a5(0x220)]();return $[_0x10b9a5(0x262)]({'url':_spPageContextInfo['webAbsoluteUrl']+_0x10b9a5(0x2b5)+_0x29dd37+_0x10b9a5(0x23b),'type':'POST','async':![],'headers':{'accept':'application/json;odata=verbose','X-RequestDigest':$(_0x10b9a5(0x25c))[_0x10b9a5(0x212)](),'content-Type':_0x10b9a5(0x29d)},'data':JSON[_0x10b9a5(0x282)](_0x1fc709),'success':function(_0x4e1a07){var _0x1bc440=_0x10b9a5;if(document[_0x1bc440(0x22d)](_0x1bc440(0x1d1))[_0x1bc440(0x211)][_0x1bc440(0x258)]===0x0){}else UploadAttachement(_0x4e1a07['d']['ID']);console['log'](_0x4e1a07),IsExistOrNotLibrary($('#txtAddOrganization')['val']()['trim']()[_0x1bc440(0x29e)](/ /g,''))?AssignTheEditRole($('#txtAddOrganization')[_0x1bc440(0x212)]()[_0x1bc440(0x28b)]()[_0x1bc440(0x29e)](/ /g,''),_0x2d7347):(createNewLibraryByRest($(_0x1bc440(0x289))[_0x1bc440(0x212)]()[_0x1bc440(0x28b)]()[_0x1bc440(0x29e)](/ /g,'')),AssignTheEditRole($(_0x1bc440(0x289))[_0x1bc440(0x212)]()[_0x1bc440(0x28b)]()[_0x1bc440(0x29e)](/ /g,''),_0x2d7347)),alert(_0x1bc440(0x284)),cleartextBox();},'error':function(_0x3e27e6){var _0xb3f908=_0x10b9a5;console[_0xb3f908(0x245)](JSON[_0xb3f908(0x282)](_0x3e27e6)),_0x426e5c[_0xb3f908(0x237)](_0x3e27e6);}}),_0x426e5c[_0x10b9a5(0x279)]();}function UpdateGeustuser(_0x16d5f7){var _0x4ea9e9=a0_0x54b6,_0xd73589=_0x4ea9e9(0x28f),_0x308823=SPClientPeoplePicker[_0x4ea9e9(0x221)][peoplePickerDiv[0x0]['id']],_0xf79019=_0x308823['GetAllUserInfo'](),_0x5e7306=[];for(var _0x4be02e=0x0;_0x4be02e<_0xf79019[_0x4ea9e9(0x258)];_0x4be02e++){var _0x4485e1=GetUserId(_0xf79019[_0x4be02e][_0x4ea9e9(0x218)][_0x4ea9e9(0x269)]);_0x5e7306[_0x4ea9e9(0x202)](_0x4485e1),UserListId[_0x4ea9e9(0x202)](_0x4485e1);}_0x308823=SPClientPeoplePicker[_0x4ea9e9(0x221)][peoplePickerDivsuper[0x0]['id']],_0xf79019=_0x308823[_0x4ea9e9(0x231)]();var _0x13c83f=GetUserId(_0xf79019[0x0]['EntityData'][_0x4ea9e9(0x269)]);UserListId[_0x4ea9e9(0x202)](_0x13c83f);var _0x49db1c=GetUserId($(_0x4ea9e9(0x2b6))[_0x4ea9e9(0x212)]());UserListId[_0x4ea9e9(0x202)](_0x49db1c),GuestUserEmail=$(_0x4ea9e9(0x2b6))[_0x4ea9e9(0x212)]();var _0x2d060c=_spPageContextInfo['webAbsoluteUrl']+_0x4ea9e9(0x1ce)+$(_0x4ea9e9(0x289))[_0x4ea9e9(0x212)]()[_0x4ea9e9(0x28b)]()[_0x4ea9e9(0x29e)](/ /g,'')+_0x4ea9e9(0x1c5);_0x49db1c==''&&(GetGroupIDByGroupName(),AddUserinSharePointGroup($(_0x4ea9e9(0x2b6))[_0x4ea9e9(0x212)]()));var _0x29c0cd,_0x5dfc65=GetItemTypeForListName(_0xd73589);_0x29c0cd={'__metadata':{'type':_0x5dfc65},'Designation':$(_0x4ea9e9(0x1b0))['val'](),'LoginNameId':_0x49db1c,'Organization':$(_0x4ea9e9(0x289))[_0x4ea9e9(0x212)](),'ReferenceCode':$(_0x4ea9e9(0x27e))['val'](),'TemplateType':$(_0x4ea9e9(0x1ff),$(_0x4ea9e9(0x2bd)))[_0x4ea9e9(0x212)](),'InternalStakeholdersId':{'results':_0x5e7306},'SupervisorId':_0x13c83f,'Client_NameId':Client_Id,'ValidUpto':$(_0x4ea9e9(0x2a0))[_0x4ea9e9(0x212)](),'CollaborationType':$(_0x4ea9e9(0x1ff),$(_0x4ea9e9(0x1c1)))[_0x4ea9e9(0x212)](),'Status':$(_0x4ea9e9(0x1ff),$(_0x4ea9e9(0x1ae)))[_0x4ea9e9(0x212)](),'DocumentLibrary':_0x2d060c};var _0x3c27e8=$[_0x4ea9e9(0x220)]();return $['ajax']({'url':_spPageContextInfo[_0x4ea9e9(0x1b2)]+'/_api/web/lists/GetByTitle(\x27'+_0xd73589+'\x27)/items('+_0x16d5f7+')','type':_0x4ea9e9(0x1c7),'async':![],'headers':{'accept':_0x4ea9e9(0x29d),'X-RequestDigest':$('#__REQUESTDIGEST')[_0x4ea9e9(0x212)](),'content-Type':_0x4ea9e9(0x29d),'IF-MATCH':'*','X-HTTP-Method':_0x4ea9e9(0x1fc)},'data':JSON['stringify'](_0x29c0cd),'success':function(_0x737daf){var _0x2ea0f2=_0x4ea9e9;if(document[_0x2ea0f2(0x22d)](_0x2ea0f2(0x1d1))['files'][_0x2ea0f2(0x258)]===0x0){}else UploadAttachement(_0x16d5f7);console[_0x2ea0f2(0x245)](_0x737daf),IsExistOrNotLibrary($(_0x2ea0f2(0x289))[_0x2ea0f2(0x212)]()['trim']()[_0x2ea0f2(0x29e)](/ /g,''))?AssignTheEditRole($('#txtAddOrganization')[_0x2ea0f2(0x212)]()[_0x2ea0f2(0x28b)]()[_0x2ea0f2(0x29e)](/ /g,''),UserListId):(createNewLibraryByRest($(_0x2ea0f2(0x289))[_0x2ea0f2(0x212)]()[_0x2ea0f2(0x28b)]()[_0x2ea0f2(0x29e)](/ /g,'')),AssignTheEditRole($('#txtAddOrganization')[_0x2ea0f2(0x212)]()['trim']()[_0x2ea0f2(0x29e)](/ /g,''),UserListId)),alert(_0x2ea0f2(0x1d2));},'error':function(_0x4184de){var _0x2f36b0=_0x4ea9e9;console[_0x2f36b0(0x245)](JSON[_0x2f36b0(0x282)](_0x4184de)),_0x3c27e8[_0x2f36b0(0x237)](_0x4184de);}}),_0x3c27e8['promise']();}function GetItemToList(_0x3d06b4){var _0x6f2691=a0_0x54b6,_0x284f18=_0x6f2691(0x28f),_0x28b7fc=$['Deferred']();return $['ajax']({'url':_spPageContextInfo[_0x6f2691(0x1b2)]+_0x6f2691(0x2b5)+_0x284f18+_0x6f2691(0x2be)+_0x3d06b4+'\x27','type':_0x6f2691(0x297),'async':![],'headers':{'accept':_0x6f2691(0x29d),'X-RequestDigest':$('#__REQUESTDIGEST')[_0x6f2691(0x212)](),'content-Type':'application/json;odata=verbose'},'success':function(_0x54b7ce){var _0x1ea50d=_0x6f2691;_0x28b7fc['resolve'](_0x54b7ce['d'][_0x1ea50d(0x1e0)]),console[_0x1ea50d(0x245)](_0x54b7ce);},'error':function(_0x56f036){var _0x489373=_0x6f2691;console[_0x489373(0x245)](JSON[_0x489373(0x282)](_0x56f036)),_0x28b7fc[_0x489373(0x237)](_0x56f036);}}),_0x28b7fc[_0x6f2691(0x279)]();}function a0_0x1365(){var _0x16e497=['196770UVEXcm','displayName','done','Meet\x20for\x20lun\x20Indramani\x20Indra?','Email','#btnExtSubmit','#selectByUser\x20>\x20[value=','User,DL,SecGroup,SPGroup','i:0#.f|membership|','click','#txtExternalSupervisor','ClientMaster','attr','Invitation\x20mail\x20has\x20been\x20sent\x20to\x20the\x20user.','.error','error','https://graph.microsoft.com/v1.0/users?$filter=mail\x20eq\x20\x27','application/json;odata=nometadata','#masterClientgrid','#txtExtLoginName','promise','Width','/_api/web/sitegroups/getbyname(\x27Contributors\x27)?$select=id','checked','Error\x20in\x20sending\x20Email:\x20','#txtReferenceCodeExt','formatDate','SendEmailSharedNotification\x20\x20','Invite\x20to\x20guest\x20Portal','stringify','Idea\x20has\x20been\x20submitted\x20but\x20some\x20files\x20failed\x20to\x20upload.','Guest\x20user\x20has\x20registered\x20successfully!','PendingAcceptance','9961WmHnyi','</tr>','name','#txtAddOrganization','</span>','trim','.sp-peoplepicker-editorInput','getItemsWithQueryItem','Process\x20Failed.\x20Invitation\x20mail\x20failed\x20to\x20send.\x0a\x20Enter\x20valid\x20email\x20address\x20or\x20check\x20the\x20external\x20sharing\x20features\x20is\x20enabled.','ExternalUsers','</span></h3>','contentEditable','User\x20Added','readAsDataURL','/SitePages/Thankyou.aspx','application/json','#txtExtOrganizationName','get','get_web','\x20This\x20is\x20auto\x20generated\x20e-mail,\x20please\x20do\x20not\x20respond\x20on\x20this\x20sender\x20e-mail.','src','append','#extrenalImage','application/json;odata=verbose','replace','.sp-peoplepicker-delImage','#datepickerAD5','[id$=\x27InternalStakeholders_TopSpan\x27]','TemplateType','display','byteLength','SelfCompany','ChangeFileName','Recognition\x20has\x20been\x20submitted\x20\x20!!','Designation','Active','div[id^=\x27InternalStakeholders\x27]','Title','userEmail','/_api/web/sitegroups/getbyname(\x27Contributors\x27)/users','SP.List','change','1160308AfsJAi','Choices','get_message','webServerRelativeUrl','IsActive','/_api/web/lists/getbytitle(\x27','#txtExtEmail','addClass','<p>Welcome\x20to\x20the\x20','Bearer\x20','#btnotherOrganizationSearch','/_api/web/lists/GetByTitle(\x27','Process\x20Failed.\x20Invitation\x20mail\x20failed\x20to\x20send.','#TemplateType','\x27)/items?$select=*,AttachmentFiles,Supervisor/Title,Supervisor/EMail,InternalStakeholders/Title,InternalStakeholders/EMail,LoginName/Title,Client_Name/Title,Client_Name/Id\x20&$expand=Supervisor,InternalStakeholders,AttachmentFiles,LoginName,Client_Name\x20&$filter=\x20email\x20eq\x20\x27','https://graph.microsoft.com/v1.0/me/sendMail','/_api/web/sitegroups(','#txtExtStatus','Success','#txtExtDesignation','InternalSupervisor','webAbsoluteUrl','</p>','3290790CjtxVX','innerHTML','responseText','internalsupervisor','application/x-www-form-urlencoded','<p>Click\x20on\x20<a\x20href=\x22https://adaptindia.sharepoint.com/sites/Titan_2_2_1_DEV/SitePages/GuestPortal.aspx\x22\x20target=\x22_blank\x22>\x20this-link\x20</a></p>','d-block','Already\x20send\x20invitation\x20but\x20this\x20user\x20is\x20not\x20Accepted..','access_token','selectByUser','get_siteGroups','<td\x20class=\x22text-left\x22>','externalUserState','#selectByUser','css','/_api/SP.Utilities.Utility.SendEmail','GET','/Forms/AllItems.aspx','find','POST','https://graph.microsoft.com/.default','slow','732LpsizJ','\x20\x20<tr\x20class=\x22text-center\x22>','9535216WFlOha','\x27)/items?$select=*','/GuestUserDocuments/','#txtinviteemail','[id$=\x27','GueastextinputFile','Guest\x20user\x20has\x20Update\x20successfully!','<div\x20class=\x22checkbox\x20m-0\x22>','\x27)/breakroleinheritance(false)','value','</p>\x20\x20','Please\x20enter\x20a\x20valid\x20email\x20address\x20of\x20the\x20guest\x20user,\x20who\x20is\x20outsider\x20of\x20this\x20organization.','PrincipalAccountType','empty','\x20<p>','\x22></label>','Text','#Customer-box','[id$=\x27internalsupervisor_TopSpan\x27]','input:checkbox','results','[name=UpdateEmp]','Description','SetEnabledState','Customerdd','removeClass','then','Client_Code','fail','siteAbsoluteUrl','CategoryMaster','</td>','error1','selected','resolve','send','Send\x20invitation\x20to\x20this\x20guest\x20user\x20first.','SP.User','\x20portal\x20of\x20','https://cdn.jsdelivr.net/gh/Titan4workGit/TitanRepo3.0@latest/SiteAssets/Titan-External-Employee-Portal/images/user_pic.jpg','indramani047@gmail.com','show','InternalMembers','internalsupervisor_TopSpan','/GuestUserDocuments/_api/Web/Lists/','EMail','true','focusout','MERGE','hide','https://graph.microsoft.com/v1.0/users?$select=id,displayName,userPrincipalName,otherMails,userType,identities,creationType,externalUserState\x20&$filter=mail\x20eq\x20\x27','option:selected','9DZcRQx','target','push','addUser','Email\x20Sent\x20Successfully','option','Client_Name','#txtinvitemessage','https://cdn.jsdelivr.net/gh/Titan4workGit/TitanRepo3.0@latest/SiteAssets/AdminPortal/ManageEmployee/assets/images/user_pic.jpg','Base64EncodedByteArray','createElement','AllowMultipleValues','https://graph.microsoft.com','</div>','Supervisor','Failed','.toHide','files','val','#ddlAssociation','#internalsupervisor','AttachmentFiles','onload','251px','EntityData','\x27)/items(','\x22\x20class=\x22getclientmaster\x22\x20onclick=\x22selectOnlyThis(this.id)\x22\x20\x20value=\x22','#UpdateEmp-box-','Attn_Name','.</p>','Browsers\x20supported\x20by\x20this\x20portal\x20are\x20Chrome,\x20Microsoft\x20Edge,\x20Safari…..\x20(incase\x20you\x20want\x20to\x20specify\x20their\x20versions\x20as\x20well)','readAsArrayBuffer','Deferred','SPClientPeoplePickerDict','InternalStakeholders','#btnExtUpdate','result','External_Supervisor','message','Accepted','ClientName','d-none','EnvironmentalSettings','\x09<span>','/GuestUserDocuments/_api/web/lists/?$filter=Title\x20eq\x20\x27','getElementById','disabled',')/AttachmentFiles/add(FileName=\x27','application/json;\x20odata=verbose','GetAllUserInfo','SP.Utilities.EmailProperties','datepicker','/_api/web/siteusers(@v)?@v=\x27','<option>','<p>Please\x20click\x20on\x20the\x20following\x20link\x20to\x20access\x20this\x20portal.\x20</p>','reject','ready','Message\x20has\x20been\x20sent.','#InternalStakeholders','\x27)/items','ValidUpto','invitedUserEmailAddress','1123472MVDQkN','<p>','Your\x20item\x20has\x20not\x20been\x20submitted\x20successfully!','1521606kwBwFI','InternalStakeholders_TopSpan','#TemplateType\x20>\x20[value=','statusText','log','<span>','none','.msg','get_users','input[name=UpdateEmp][value=','when','prop','getByName','\x20Your\x20e-mail\x20configured\x20for\x20this\x20portal\x20is\x20<span\x20id=\x22user_id\x22>@info.gmail.com</span>\x20and\x20you’ll\x20be\x20able\x20to\x20login\x20using\x20your\x20existing\x20passport\x20for\x20this\x20e-mail\x20service.','#Employee-box','#msgExtEmail','onerror','client_credentials','#GueastextinputFile','Association','\x27,roledefid=\x271073741830\x27)','SPClientPeoplePicker_InitStandaloneControlWrapper','CatogeryName','length','#txtinvitename','CustType','<label><input\x20type=\x22checkbox\x22\x20id=\x22Check_','#__REQUESTDIGEST','Incase\x20of\x20any\x20help\x20needed\x20or\x20if\x20you\x20are\x20facing\x20any\x20problem\x20in\x20accessing\x20this\x20portal,\x20please\x20send\x20an\x20e-mail\x20to\x20<\x20e-mail\x20ID\x20of\x20\x20admin\x20(s)\x20>','d\x20M,\x20y','Organization','#UpdateEmp-box-2','text','ajax','Guest','<img\x20src=\x22img/customer.png\x22\x20id=\x22logo\x22>'];a0_0x1365=function(){return _0x16e497;};return a0_0x1365();}function GetItemToListchoice(){var _0x787089=a0_0x54b6,_0x40077e=_0x787089(0x28f),_0x59b060=$['Deferred']();return $[_0x787089(0x262)]({'url':_spPageContextInfo[_0x787089(0x1b2)]+_0x787089(0x2b5)+_0x40077e+'\x27)/fields?&$select=*&$filter=EntityPropertyName\x20eq\x20\x27TemplateType\x27','type':_0x787089(0x297),'async':![],'headers':{'accept':_0x787089(0x29d),'X-RequestDigest':$('#__REQUESTDIGEST')[_0x787089(0x212)](),'content-Type':_0x787089(0x29d)},'success':function(_0x1b3f7d){var _0x2162e6=_0x787089;_0x59b060[_0x2162e6(0x1ee)](_0x1b3f7d['d'][_0x2162e6(0x1e0)][0x0][_0x2162e6(0x2b1)][_0x2162e6(0x1e0)]),console['log'](_0x1b3f7d);},'error':function(_0x3168e9){var _0xa49c5b=_0x787089;console['log'](JSON[_0xa49c5b(0x282)](_0x3168e9)),_0x59b060['reject'](_0x3168e9);}}),_0x59b060['promise']();}function GetItemToClientMaster(){var _0x47f604=a0_0x54b6,_0x249831=_0x47f604(0x270),_0x6d69c8=$[_0x47f604(0x220)]();return $[_0x47f604(0x262)]({'url':_spPageContextInfo[_0x47f604(0x1b2)]+_0x47f604(0x2b5)+_0x249831+_0x47f604(0x1cd),'type':'get','async':![],'headers':{'accept':_0x47f604(0x29d),'X-RequestDigest':$('#__REQUESTDIGEST')['val'](),'content-Type':'application/json;odata=verbose'},'success':function(_0x4042fc){var _0x51a1bd=_0x47f604;_0x6d69c8['resolve'](_0x4042fc['d']['results']),console[_0x51a1bd(0x245)](_0x4042fc);},'error':function(_0x2fe24e){var _0x19e969=_0x47f604;console[_0x19e969(0x245)](JSON[_0x19e969(0x282)](_0x2fe24e)),_0x6d69c8[_0x19e969(0x237)](_0x2fe24e);}}),_0x6d69c8[_0x47f604(0x279)]();}function requestToken(){var _0x53d83f=a0_0x54b6;$['ajax']({'async':!![],'crossDomain':!![],'url':ClientUrl,'method':_0x53d83f(0x1c7),'headers':{'content-type':_0x53d83f(0x1b8)},'data':{'grant_type':_0x53d83f(0x252),'client_id\x20':ClientId,'client_secret':ClentSecret,'scope\x20':_0x53d83f(0x1c8)},'success':function(_0x19f924){var _0x420934=_0x53d83f;console[_0x420934(0x245)](_0x19f924),token=_0x19f924[_0x420934(0x1bc)];},'error':function(_0x2dbd53){var _0x49d69c=_0x53d83f;console[_0x49d69c(0x245)](JSON[_0x49d69c(0x282)](_0x2dbd53));}});}function ClientCredentialss(){var _0x3b266e=a0_0x54b6,_0x417b65=_0x3b266e(0x22a),_0x5233f3=_spPageContextInfo[_0x3b266e(0x1b2)]+_0x3b266e(0x2bb)+_0x417b65+'\x27)/items?$filter=Title\x20eq\x20\x27Client_Credentials\x27\x20';$['ajax']({'url':_0x5233f3,'headers':{'Accept':_0x3b266e(0x29d)},'async':![],'success':function(_0x73976a){var _0x5bd026=_0x3b266e,_0x4b3ef5=_0x73976a['d'][_0x5bd026(0x1e0)];ClientId=_0x4b3ef5[0x0][_0x5bd026(0x228)],ClentSecret=_0x4b3ef5[0x0][_0x5bd026(0x2a6)],ClientUrl=_0x4b3ef5[0x0][_0x5bd026(0x1e2)],requestToken();},'error':function(_0x34f890){var _0xc5fb62=_0x3b266e;console[_0xc5fb62(0x245)](_0x34f890);}});}function GraphAccessTokenTogetUserDetails(){var _0x4a6470=a0_0x54b6,_0x177691=new jQuery[(_0x4a6470(0x220))](),_0x13179a={'X-RequestDigest':$(_0x4a6470(0x25c))[_0x4a6470(0x212)](),'accept':_0x4a6470(0x276),'content-type':'application/json;odata=nometadata'},_0x166c8d={'resource':_0x4a6470(0x20c)};return $['ajax']({'url':_spPageContextInfo[_0x4a6470(0x1b2)]+'/_api/SP.OAuth.Token/Acquire','headers':_0x13179a,'type':'POST','data':JSON[_0x4a6470(0x282)](_0x166c8d),'success':function(_0x386d12){var _0x5dfe6b=_0x4a6470;token=_0x386d12['access_token'],token_=token,_0x177691[_0x5dfe6b(0x1ee)](token);},'error':function(_0x265cdb,_0x2952a4,_0x5a58cf){var _0x13ec3a=_0x4a6470;console['log'](_0x265cdb[_0x13ec3a(0x1b6)]),_0x177691[_0x13ec3a(0x237)](_0x265cdb[_0x13ec3a(0x1b6)]);}}),_0x177691['promise']();}var Errorcount=0x1,Ischeckerror=![];function Inviteuser(){var _0x4e59b3=a0_0x54b6,_0xbc494a=$(_0x4e59b3(0x1cf))[_0x4e59b3(0x212)](),_0x33a874=$(_0x4e59b3(0x259))[_0x4e59b3(0x212)](),_0x3e5071=$(_0x4e59b3(0x207))[_0x4e59b3(0x212)]();Errorcount=0x1,$[_0x4e59b3(0x262)]({'url':'https://graph.microsoft.com/v1.0/invitations','type':_0x4e59b3(0x1c7),'headers':{'Authorization':_0x4e59b3(0x2b9)+token,'content-type':_0x4e59b3(0x295)},'data':JSON[_0x4e59b3(0x282)]({'invitedUserDisplayName':_0x33a874,'invitedUserEmailAddress':_0xbc494a,'inviteRedirectUrl':_spPageContextInfo[_0x4e59b3(0x1b2)]+_0x4e59b3(0x294),'sendInvitationMessage':!![],'invitedUserMessageInfo':{'customizedMessageBody':_0x3e5071}}),'async':![],'success':function(_0x499538){var _0x125ae0=_0x4e59b3;console[_0x125ae0(0x245)](_0x499538),$('#txtinviteemail')[_0x125ae0(0x212)](''),$(_0x125ae0(0x259))[_0x125ae0(0x212)](''),$(_0x125ae0(0x207))['val']('');GroupId==''&&GetGroupIDByGroupName();GuestUserEmail=_0x499538[_0x125ae0(0x23d)];try{$[_0x125ae0(0x24b)](AddUserinSharePointGroup(_0x499538[_0x125ae0(0x23d)]))[_0x125ae0(0x267)](function(_0x5b41b1){var _0x259101=_0x125ae0;Ischeckerror=![],_0x5b41b1==_0x259101(0x292)?alert(_0x259101(0x272)):alert('Process\x20Failed.\x20Invitation\x20mail\x20failed\x20to\x20send.');});}catch(_0x9d8874){alert(_0x125ae0(0x2bc));}},'error':function(_0x5f082a){var _0x59e4ba=_0x4e59b3;_0x5f082a[_0x59e4ba(0x244)]=='Unauthorized'?alert(_0x5f082a[_0x59e4ba(0x244)]+':\x20\x20Compact\x20Token\x20parsing\x20failed'):(alert(_0x59e4ba(0x1d7)),console[_0x59e4ba(0x245)](JSON[_0x59e4ba(0x282)](_0x5f082a)));}}),Ischeckerror&&alert(_0x4e59b3(0x2bc));}function setPeoplePickerUsersInfoCurrent(_0x1288ae,_0x6c3235){var _0x46850c=a0_0x54b6,_0xa531fa=$(_0x46850c(0x1d0)+_0x1288ae+'\x27]'),_0x5ac763=SPClientPeoplePicker['SPClientPeoplePickerDict'][_0xa531fa[0x0]['id']];_0x5ac763['AddUserKeys'](_0x6c3235,![]),_0x5ac763[_0x46850c(0x1e3)](![]);}function readURL(_0x1ca573){var _0x4a0961=a0_0x54b6;if(_0x1ca573[_0x4a0961(0x211)]&&_0x1ca573[_0x4a0961(0x211)][0x0]){var _0xdf26d7=new FileReader();_0xdf26d7[_0x4a0961(0x216)]=function(_0x234aeb){var _0x5e4412=_0x4a0961;$(_0x5e4412(0x29c))[_0x5e4412(0x271)](_0x5e4412(0x29a),_0x234aeb[_0x5e4412(0x201)][_0x5e4412(0x224)]);},_0xdf26d7[_0x4a0961(0x293)](_0x1ca573[_0x4a0961(0x211)][0x0]);}}function UploadAttachement(_0x49f998){var _0x5e8a3f=a0_0x54b6;try{if(document['getElementById'](_0x5e8a3f(0x1d1))[_0x5e8a3f(0x211)][_0x5e8a3f(0x258)]===0x0){}else{var _0x4c593b=_0x49f998,_0x5701c6=$(_0x5e8a3f(0x253)),_0x55b18f=_0x5701c6[0x0][_0x5e8a3f(0x211)]['length'],_0x1e97ae=[],_0x4264d0=_0x5701c6[0x0][_0x5e8a3f(0x211)][0x0][_0x5e8a3f(0x288)];_0x4264d0=_0x5701c6[0x0]['files'][0x0][_0x5e8a3f(0x288)][_0x5e8a3f(0x29e)](/[^a-zA-Z0-9-. ]/g,''),_0x4264d0=_0x4264d0[_0x5e8a3f(0x29e)](/\s/g,'');for(var _0xccdbe3=0x0;_0xccdbe3<_0x55b18f;_0xccdbe3++){_0x1e97ae[_0x5e8a3f(0x202)](_0x5701c6[0x0][_0x5e8a3f(0x211)][_0xccdbe3]);}uploadFileSP(_0x5e8a3f(0x28f),_0x4c593b,_0x1e97ae,_0x55b18f,_0x4264d0);}}catch(_0x570ef1){alert(_0x5e8a3f(0x240));}}function getFileBuffer(_0x35a902){var _0x117b33=a0_0x54b6,_0x5053d6=$['Deferred'](),_0x3870f0=new FileReader();return _0x3870f0['onload']=function(_0xb4ba24){var _0x30c7a2=a0_0x54b6;_0x5053d6[_0x30c7a2(0x1ee)](_0xb4ba24[_0x30c7a2(0x201)][_0x30c7a2(0x224)]);},_0x3870f0[_0x117b33(0x251)]=function(_0x1e775b){var _0x230f29=_0x117b33;_0x5053d6[_0x230f29(0x237)](_0x1e775b[_0x230f29(0x201)][_0x230f29(0x274)]);},_0x3870f0[_0x117b33(0x21f)](_0x35a902),_0x5053d6[_0x117b33(0x279)]();}function uploadFileSP(_0x49d595,_0x324ab2,_0x45440e,_0x27aa86,_0x3d180d){var _0x4d6c8e=a0_0x54b6,_0x4921d0=0x0,_0x2fca9e=$['Deferred'](),_0x33c685='',_0x559fcf=_0x45440e[0x0],_0x1a1d67=getFileBuffer(_0x559fcf);return _0x1a1d67['done'](function(_0x54b21b,_0x3e613c,_0x3e9511){var _0x417cb6=a0_0x54b6,_0x595b62=new Uint8Array(_0x54b21b),_0x144a05=new SP[(_0x417cb6(0x209))](),_0x12114d=_spPageContextInfo[_0x417cb6(0x1b2)]+'/_api/lists/GetByTitle(\x27'+_0x49d595+_0x417cb6(0x219)+_0x324ab2+_0x417cb6(0x22f)+_0x3d180d+'\x27)',_0x19a811=0x0;$[_0x417cb6(0x262)]({'url':_0x12114d,'type':_0x417cb6(0x1c7),'processData':![],'contentType':_0x417cb6(0x29d),'data':_0x54b21b,'headers':{'accept':_0x417cb6(0x29d),'X-RequestDigest':$(_0x417cb6(0x25c))[_0x417cb6(0x212)](),'content-length':_0x54b21b[_0x417cb6(0x2a4)]},'success':function(_0x1c96ce){var _0x3e52a7=_0x417cb6;_0x4921d0++,_0x33c685=_0x4921d0,_0x45440e['shift']();if(_0x45440e['length']>0x0)uploadFileSP(_0x3e52a7(0x28f),_0x324ab2,_0x45440e,_0x45440e['length']);else{}},'error':function(_0x20615f){var _0x13d369=_0x417cb6;alert(_0x13d369(0x283));}}),_0x2fca9e[_0x417cb6(0x1ee)](_0x33c685);}),_0x1a1d67[_0x4d6c8e(0x1e8)](function(_0x2f149a){var _0x1a6a1d=_0x4d6c8e;_0x2fca9e[_0x1a6a1d(0x237)](_0x2f149a);}),_0x2fca9e[_0x4d6c8e(0x279)]();}function GetGroupIDByGroupName(){var _0x30e292=a0_0x54b6,_0x3ac087=_spPageContextInfo['webAbsoluteUrl']+_0x30e292(0x27b);$['ajax']({'url':_0x3ac087,'method':'GET','async':![],'headers':{'Accept':_0x30e292(0x230)},'success':function(_0x58490a){GroupId=_0x58490a['d']['Id'];},'error':function(_0x23a1a2){var _0x2c64c9=_0x30e292;console[_0x2c64c9(0x245)](_0x23a1a2);}});}function AddUserToSiteGroup(_0x3beb49){var _0x512219=a0_0x54b6;clientContext=new SP['ClientContext']();var _0x491481=clientContext[_0x512219(0x298)]()[_0x512219(0x1be)]()[_0x512219(0x24d)]('Contributors'),_0x17e46e=_0x491481[_0x512219(0x249)]();_0x17e46e[_0x512219(0x203)](_0x3beb49),clientContext['executeQueryAsync'](onsuccess,onfailed);}function onsuccess(){var _0xd128c0=a0_0x54b6;console[_0xd128c0(0x245)](_0xd128c0(0x1af));}function onfailed(_0x481a77,_0x38f806){var _0x5a0a52=a0_0x54b6;console[_0x5a0a52(0x245)](_0x5a0a52(0x20f)+_0x38f806[_0x5a0a52(0x2b2)]()+'\x0a'+_0x38f806['get_stackTrace']());}function AddUserinSharePointGroup(_0x27c945){var _0x1a452d=a0_0x54b6,_0xdd1dee=$[_0x1a452d(0x220)](),_0x341ee7=_0x1a452d(0x26d),_0x2bf73e=_0x341ee7+_0x27c945,_0x266a76=_spPageContextInfo['webAbsoluteUrl']+_0x1a452d(0x2ad);$['ajax']({'url':_0x266a76,'type':_0x1a452d(0x1c7),'async':![],'data':JSON['stringify']({'__metadata':{'type':_0x1a452d(0x1f1)},'LoginName':_0x2bf73e}),'headers':{'accept':'application/json;odata=verbose','content-type':_0x1a452d(0x29d),'X-RequestDigest':$(_0x1a452d(0x25c))[_0x1a452d(0x212)]()},'success':_0x4382e4,'error':_0x2b45e8});function _0x4382e4(_0x2bd992){var _0x5e48b4=_0x1a452d;Ischeckerror=!![],_0xdd1dee[_0x5e48b4(0x1ee)](_0x5e48b4(0x292)),Errorcount=0x1,console[_0x5e48b4(0x245)](_0x5e48b4(0x292));}function _0x2b45e8(_0x65e3b6){var _0x38f899=_0x1a452d;console['log'](JSON[_0x38f899(0x282)](_0x65e3b6)),(_0x65e3b6[_0x38f899(0x244)]=='Not\x20Found'||_0x65e3b6[_0x38f899(0x244)]==_0x38f899(0x274))&&Errorcount==0xa?_0x65e3b6[_0x38f899(0x244)]==_0x38f899(0x274)?alert('Process\x20Failed.\x20Invitation\x20mail\x20failed\x20to\x20send.'):alert(_0x38f899(0x28e)):(Errorcount++,AddUserinSharePointGroup(GuestUserEmail));}return _0xdd1dee[_0x1a452d(0x279)]();}function AddUserinSharePointGroupforEdit(_0x50c165){var _0x26c9c5=a0_0x54b6,_0x1809ee='',_0x46e532=_0x26c9c5(0x26d),_0x2ed276=_0x46e532+_0x50c165,_0x47bc52=_spPageContextInfo[_0x26c9c5(0x1b2)]+_0x26c9c5(0x2c0)+GroupId+')/users';$['ajax']({'url':_0x47bc52,'type':_0x26c9c5(0x1c7),'async':![],'data':JSON[_0x26c9c5(0x282)]({'__metadata':{'type':'SP.User'},'LoginName':_0x2ed276}),'headers':{'accept':'application/json;odata=verbose','content-type':_0x26c9c5(0x29d),'X-RequestDigest':$(_0x26c9c5(0x25c))['val']()},'success':_0x5f22a9,'error':_0x452ef3});function _0x5f22a9(_0x15df72){var _0x2de424=_0x26c9c5;_0x1809ee=_0x15df72['d'],console[_0x2de424(0x245)]('User\x20Added');}function _0x452ef3(_0x391578){var _0x4454ee=_0x26c9c5;console[_0x4454ee(0x245)](JSON[_0x4454ee(0x282)](_0x391578));}return _0x1809ee;}function processSendEmails(_0x2d5177,_0x2eec64,_0xf2075a){var _0x251fe0=a0_0x54b6,_0x261197=[],_0x3b0f8=_0x251fe0(0x264)+'<h3>Dear\x20<span\x20class=\x22user_name\x22>'+_0x2d5177+_0x251fe0(0x290)+_0x251fe0(0x2b8)+_0x2eec64+_0x251fe0(0x1f2)+_0xf2075a+_0x251fe0(0x21d)+_0x251fe0(0x236)+_0x251fe0(0x1b9)+_0x251fe0(0x23f)+_0x251fe0(0x24e)+_0x251fe0(0x21e)+_0x251fe0(0x1d6)+_0x251fe0(0x1da)+_0x251fe0(0x25d)+_0x251fe0(0x299)+_0x251fe0(0x1b3),_0x245310=_0x251fe0(0x281);_0x261197['push'](email);var _0x1bcd65=_spPageContextInfo[_0x251fe0(0x2ac)],_0x149ecf;_0x149ecf={'properties':{'__metadata':{'type':_0x251fe0(0x232)},'From':_0x1bcd65,'To':{'results':_0x261197},'Body':_0x3b0f8,'Subject':_0x245310}};var _0x219cbc={'properties':{'__metadata':{'type':'SP.Utilities.EmailProperties'},'From':'From:\x20no-reply@sharepointonline.com','To':{'results':_0x261197},'Body':_0x3b0f8,'Subject':_0x245310}},_0x9fa656=_spPageContextInfo[_0x251fe0(0x2b3)]==='/'?'/':_spPageContextInfo['webServerRelativeUrl'],_0x37909e=_0x9fa656,_0x1bdde6=_0x37909e+_0x251fe0(0x1c3),_0x23f591=_spPageContextInfo[_0x251fe0(0x1b2)]+'/_api/SP.Utilities.Utility.SendEmail';$[_0x251fe0(0x262)]({'contentType':_0x251fe0(0x295),'url':_0x23f591,'type':_0x251fe0(0x1c7),'data':JSON[_0x251fe0(0x282)](_0x219cbc),'async':![],'headers':{'Accept':_0x251fe0(0x29d),'content-type':_0x251fe0(0x29d),'X-RequestDigest':$('#__REQUESTDIGEST')['val']()},'success':function(_0x9ca367){var _0x1aac21=_0x251fe0;console[_0x1aac21(0x245)](_0x1aac21(0x239));},'error':function(_0x3e18e1){var _0xb2a6e1=_0x251fe0;console[_0xb2a6e1(0x245)](_0xb2a6e1(0x280)+JSON[_0xb2a6e1(0x282)](_0x3e18e1));}});}function sendEmail(_0x2d11f2,_0x4c621f,_0x5987c9,_0xb917af){var _0x19e39b=a0_0x54b6;Email[_0x19e39b(0x1ef)]({'SecureToken':token,'To':_0x4c621f[0x0],'From':_0x2d11f2,'Subject':_0xb917af,'Body':_0x5987c9})[_0x19e39b(0x1e6)](_0x44628b=>alert('mail\x20sent\x20successfully'));var _0x1755c1=_spPageContextInfo[_0x19e39b(0x2b3)],_0x45d2cf=_0x1755c1+_0x19e39b(0x1c3);$[_0x19e39b(0x262)]({'contentType':_0x19e39b(0x295),'url':_0x45d2cf,'type':_0x19e39b(0x1c7),'data':JSON[_0x19e39b(0x282)]({'properties':{'__metadata':{'type':_0x19e39b(0x232)},'From':_0x2d11f2,'To':{'results':_0x4c621f},'Body':_0x5987c9,'Subject':_0xb917af}}),'headers':{'Accept':'application/json;odata=verbose','content-type':_0x19e39b(0x29d),'X-RequestDigest':jQuery(_0x19e39b(0x25c))[_0x19e39b(0x212)]()},'success':function(_0x14f4b7){var _0x3a6ac3=_0x19e39b;alert(_0x3a6ac3(0x204));},'error':function(_0x24ddac){var _0x435152=_0x19e39b;alert(_0x435152(0x27d)+JSON[_0x435152(0x282)](_0x24ddac));}});}$(function(){var _0x14ad7c=a0_0x54b6;$(_0x14ad7c(0x1e1))['click'](function(){var _0x5ce684=_0x14ad7c;$(_0x5ce684(0x210))['hide'](),cleartextBox(),$(_0x5ce684(0x21b)+$(this)[_0x5ce684(0x212)]())[_0x5ce684(0x1f5)](_0x5ce684(0x1c9)),$(this)[_0x5ce684(0x212)]()=='3'&&(GetCategoryMaster(),$[_0x5ce684(0x24b)](GetItemToListchoice())[_0x5ce684(0x267)](function(_0x2c4e40){var _0x5c9679=_0x5ce684;$('#TemplateType')['empty']();for(var _0x52001f=0x0;_0x52001f<_0x2c4e40['length'];_0x52001f++){var _0x22f3cc=$(_0x5c9679(0x235));_0x22f3cc['attr'](_0x5c9679(0x1d5),_0x2c4e40[_0x52001f])[_0x5c9679(0x261)](_0x2c4e40[_0x52001f]),$(_0x5c9679(0x2bd))[_0x5c9679(0x29b)](_0x22f3cc);}})),$(_0x5ce684(0x250))['hide']();});});function sendEmailg(){var _0x133b15=a0_0x54b6;$[_0x133b15(0x262)]({'async':![],'crossDomain':!![],'url':_0x133b15(0x2bf),'method':'POST','headers':{'authorization':'Bearer\x20'+token_,'content-type':_0x133b15(0x295)},'data':JSON['stringify']({'message':{'subject':_0x133b15(0x268),'body':{'contentType':_0x133b15(0x1dc),'content':'The\x20new\x20cafeteria\x20is\x20open.'},'toRecipients':[{'emailAddress':{'address':_0x133b15(0x1f4)}}]}}),'success':function(_0x23323b){var _0x4c2cd3=_0x133b15;alert(_0x4c2cd3(0x2a7));},'error':function(_0x550cbe){var _0x243d80=_0x133b15;console[_0x243d80(0x245)]('Sending\x20mail\x20with\x20attach'+JSON[_0x243d80(0x282)](_0x550cbe));}});}function createNewLibraryByRest(_0x10664a){var _0x230960=a0_0x54b6,_0x4e3517=_0x10664a,_0x5a9fdf=_spPageContextInfo[_0x230960(0x1b2)]+_0x230960(0x1f8);$[_0x230960(0x262)]({'url':_0x5a9fdf,'method':_0x230960(0x1c7),'async':![],'data':JSON[_0x230960(0x282)]({'__metadata':{'type':_0x230960(0x2ae)},'AllowContentTypes':!![],'BaseTemplate':0x65,'ContentTypesEnabled':!![],'Description':_0x230960(0x1e2),'OnQuickLaunch':!![],'Title':_0x10664a}),'headers':{'content-type':_0x230960(0x29d),'X-RequestDigest':$(_0x230960(0x25c))[_0x230960(0x212)]()},'success':function(_0x4e2571){BreakRoleInheritance(_0x4e3517);},'error':function(_0x4de45e){alert(_0x4de45e['responseText']);}});}function BreakRoleInheritance(_0x32c653){var _0x3869b4=a0_0x54b6;url=_spPageContextInfo[_0x3869b4(0x1b2)]+'/GuestUserDocuments/_api/web/lists/getbytitle(\x27'+_0x32c653+_0x3869b4(0x1d4),$[_0x3869b4(0x262)]({'url':url,'type':_0x3869b4(0x1c7),'async':![],'headers':{'accept':_0x3869b4(0x276),'X-RequestDigest':$(_0x3869b4(0x25c))[_0x3869b4(0x212)]()},'success':function(_0x45bdbe){console['log'](_0x45bdbe);},'error':function(_0x42117d){console['log'](_0x42117d);}});}function AssignTheEditRole(_0xfaa5f,_0x5a034c){var _0xc2ea24=a0_0x54b6;for(var _0x2124d5=0x0;_0x2124d5<_0x5a034c[_0xc2ea24(0x258)];_0x2124d5++){url=_spPageContextInfo[_0xc2ea24(0x1b2)]+'/GuestUserDocuments/_api/web/lists/getbytitle(\x27'+_0xfaa5f+'\x27)/roleassignments/addroleassignment(principalid=\x27'+_0x5a034c[_0x2124d5]+_0xc2ea24(0x255),$[_0xc2ea24(0x262)]({'url':url,'type':'POST','async':![],'headers':{'accept':_0xc2ea24(0x276),'X-RequestDigest':$(_0xc2ea24(0x25c))[_0xc2ea24(0x212)]()},'success':function(_0x5862fc){var _0x52fd22=_0xc2ea24;console[_0x52fd22(0x245)](_0x5862fc);},'error':function(_0x4e71b5){var _0x381c75=_0xc2ea24;console[_0x381c75(0x245)](_0x4e71b5);}});}}function IsExistOrNotLibrary(_0x2455ba){var _0x2499dd=a0_0x54b6,_0x466d60='';return url=_spPageContextInfo['webAbsoluteUrl']+_0x2499dd(0x22c)+_0x2455ba+'\x27',$['ajax']({'url':url,'type':_0x2499dd(0x297),'async':![],'headers':{'accept':'application/json;odata=nometadata','X-RequestDigest':$('#__REQUESTDIGEST')['val']()},'success':function(_0x4ed84e){var _0x3092aa=_0x2499dd;_0x4ed84e['value'][_0x3092aa(0x258)]>0x0?_0x466d60=!![]:_0x466d60=![],console['log'](_0x4ed84e);},'error':function(_0x54f31f){console['log'](_0x54f31f);}}),_0x466d60;}var SelectClientId='';function GenarateclientGrid(_0x54d1b1){var _0x4ff2c5=a0_0x54b6;$(_0x4ff2c5(0x277))[_0x4ff2c5(0x1d9)](),$(_0x4ff2c5(0x277))[_0x4ff2c5(0x29b)](_0x54d1b1);}function Selectedcclinte(){var _0x22d1ef=a0_0x54b6;$(_0x22d1ef(0x289))[_0x22d1ef(0x212)](ClientInternalMembers[SelectClientId][_0x22d1ef(0x2ab)]),Client_Id=ClientInternalMembers[SelectClientId]['ID'];ClientInternalMembers[SelectClientId]['Supervisor']!=undefined?$(_0x22d1ef(0x26f))[_0x22d1ef(0x212)](ClientInternalMembers[SelectClientId][_0x22d1ef(0x20e)]):$(_0x22d1ef(0x26f))[_0x22d1ef(0x212)]($(_0x22d1ef(0x2b6))['val']());$('#selectByUser\x20>\x20[value='+ClientInternalMembers[SelectClientId][_0x22d1ef(0x25a)]+']')[_0x22d1ef(0x271)](_0x22d1ef(0x1ed),'true'),$(_0x22d1ef(0x243)+ClientInternalMembers[SelectClientId][_0x22d1ef(0x2a2)]+']')[_0x22d1ef(0x271)]('selected',_0x22d1ef(0x1fa)),initializePeoplePicker(_0x22d1ef(0x222),!![]),peoplePickerDiv=$(_0x22d1ef(0x2a1)),initializePeoplePicker(_0x22d1ef(0x1b7),![]),peoplePickerDivsuper=$(_0x22d1ef(0x1de));for(var _0x47d67b=0x0;_0x47d67b<ClientInternalMembers[SelectClientId][_0x22d1ef(0x1f6)][_0x22d1ef(0x1e0)]['length'];_0x47d67b++){setPeoplePickerUsersInfoCurrent(_0x22d1ef(0x242),ClientInternalMembers[SelectClientId]['InternalMembers'][_0x22d1ef(0x1e0)][_0x47d67b][_0x22d1ef(0x1f9)]);}setPeoplePickerUsersInfoCurrent(_0x22d1ef(0x1f7),ClientInternalMembers[SelectClientId][_0x22d1ef(0x1b1)][_0x22d1ef(0x1f9)]),$(_0x22d1ef(0x2aa))[_0x22d1ef(0x271)](_0x22d1ef(0x291),'false'),$(_0x22d1ef(0x23a))[_0x22d1ef(0x271)]('disabled',_0x22d1ef(0x22e)),$(_0x22d1ef(0x214))[_0x22d1ef(0x271)]('disabled',_0x22d1ef(0x22e)),$(peoplePickerDiv)[_0x22d1ef(0x1c6)](_0x22d1ef(0x29f))[_0x22d1ef(0x1c2)](_0x22d1ef(0x2a3),_0x22d1ef(0x247)),$(peoplePickerDivsuper)[_0x22d1ef(0x1c6)](_0x22d1ef(0x29f))[_0x22d1ef(0x1c2)](_0x22d1ef(0x2a3),'none');}var ClientInternalMembers=[];function GetClientMasterTeamDeails(){var _0x337312=a0_0x54b6;Taskusers=[],RestQuery='?$select=*,Id,Supervisor/Title,Supervisor/EMail\x20,InternalMembers/EMail,InternalMembers/Title,InternalSupervisor/EMail,InternalSupervisor/Title\x20&$expand=Supervisor,InternalMembers,InternalSupervisor\x20',$[_0x337312(0x24b)](CommonFunction[_0x337312(0x28d)](_0x337312(0x270),RestQuery))[_0x337312(0x267)](function(_0x33a3ff){var _0x4c8e43=_0x337312,_0x393cba;IsNotTeamMember='';debugger;var _0x5b06b3='';for(var _0x468326=0x0;_0x468326<_0x33a3ff[_0x4c8e43(0x1e0)][_0x4c8e43(0x258)];_0x468326++){_0x393cba=[],_0x393cba=_0x33a3ff['results'][_0x468326];var _0x3a800a=_0x393cba[_0x4c8e43(0x2b4)]='true'?_0x393cba[_0x4c8e43(0x2b4)]:_0x4c8e43(0x2a9);_0x5b06b3+=_0x4c8e43(0x1cb)+_0x4c8e43(0x1bf)+_0x4c8e43(0x1d3)+_0x4c8e43(0x25b)+_0x468326+_0x4c8e43(0x21a)+_0x468326+_0x4c8e43(0x1db)+_0x4c8e43(0x20d)+'</td>'+_0x4c8e43(0x1bf)+'<span>'+_0x393cba[_0x4c8e43(0x1e7)]+'</span>'+_0x4c8e43(0x1eb)+'<td\x20class=\x22text-left\x22>'+_0x4c8e43(0x246)+_0x393cba['Title']+_0x4c8e43(0x28a)+_0x4c8e43(0x1eb)+'<td\x20class=\x22text-left\x22>'+_0x4c8e43(0x22b)+_0x393cba[_0x4c8e43(0x21c)]+_0x4c8e43(0x28a)+_0x4c8e43(0x1eb)+_0x4c8e43(0x1bf)+_0x4c8e43(0x246)+_0x3a800a+_0x4c8e43(0x28a)+_0x4c8e43(0x1eb)+_0x4c8e43(0x287),ClientInternalMembers['push']({'Title':_0x393cba[_0x4c8e43(0x2ab)],'Client_Code':_0x393cba[_0x4c8e43(0x1e7)],'Attn_Name':_0x393cba['Attn_Name'],'Supervisor':_0x393cba[_0x4c8e43(0x20e)]['EMail'],'SelfCompany':_0x393cba[_0x4c8e43(0x2a5)],'IsActive':_0x393cba[_0x4c8e43(0x2b4)],'CustType':_0x393cba[_0x4c8e43(0x25a)],'TemplateType':_0x393cba[_0x4c8e43(0x2a2)],'InternalMembers':_0x393cba[_0x4c8e43(0x1f6)],'InternalSupervisor':_0x393cba['InternalSupervisor'],'ID':_0x393cba['Id']});}GenarateclientGrid(_0x5b06b3);});}function selectOnlyThis(_0x253718){var _0x31f8f7=a0_0x54b6;SelectClientId='',SelectClientId=_0x253718['split']('_')[0x1],$(_0x31f8f7(0x1df))['not'](this)[_0x31f8f7(0x24c)](_0x31f8f7(0x27c),![]),document[_0x31f8f7(0x22d)](_0x253718)[_0x31f8f7(0x27c)]=!![];}$(document)[a0_0x3f1c76(0x238)](function(){var _0x2e1191=a0_0x3f1c76;$('#selectByUser')['on'](_0x2e1191(0x2af),function(){var _0x12669a=_0x2e1191,_0x53d994=$(this)[_0x12669a(0x1c6)](_0x12669a(0x1ff))[_0x12669a(0x212)]();if(_0x53d994==_0x12669a(0x1e4))$(_0x12669a(0x1dd))[_0x12669a(0x1e5)](_0x12669a(0x1ba)),$(_0x12669a(0x1dd))[_0x12669a(0x2b7)](_0x12669a(0x229)),$(_0x12669a(0x24f))[_0x12669a(0x1e5)](_0x12669a(0x229)),$(_0x12669a(0x24f))[_0x12669a(0x2b7)](_0x12669a(0x1ba));else _0x53d994==_0x12669a(0x263)&&($(_0x12669a(0x1dd))[_0x12669a(0x1e5)](_0x12669a(0x229)),$(_0x12669a(0x1dd))[_0x12669a(0x2b7)](_0x12669a(0x1ba)),$(_0x12669a(0x24f))[_0x12669a(0x1e5)]('d-block'),$(_0x12669a(0x24f))[_0x12669a(0x2b7)](_0x12669a(0x229)));}),$('#txtExtEmail')[_0x2e1191(0x1fb)](function(){var _0x440851=_0x2e1191;email=$(_0x440851(0x2b6))['val']();var _0x41aa7e=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/igm;if(_0x41aa7e['test'](email)){$(_0x440851(0x248))[_0x440851(0x1fd)](),$(_0x440851(0x250))[_0x440851(0x1fd)](),$[_0x440851(0x24b)](GetItemToListchoice(),GetItemToList(email))[_0x440851(0x267)](function(_0x2a7fff,_0x11b1e0){var _0x1a7072=_0x440851;if(_0x11b1e0[_0x1a7072(0x258)]>0x0){var _0x3b0405=GetUserName($(_0x1a7072(0x2b6))[_0x1a7072(0x212)]());_0x3b0405==''&&(GroupId==''&&GetGroupIDByGroupName(),$['when'](AddUserinSharePointGroupforEdit($('#txtExtEmail')[_0x1a7072(0x212)]()))[_0x1a7072(0x267)](function(_0x55631f){var _0x347ca7=_0x1a7072;if(_0x55631f==''){cleartextBox(),$('.toHide')[_0x347ca7(0x1fd)](),$(_0x347ca7(0x260))[_0x347ca7(0x1f5)](_0x347ca7(0x1c9));var _0x5ae5ed=0x2;return $(_0x347ca7(0x24a)+_0x5ae5ed+']')[_0x347ca7(0x24c)](_0x347ca7(0x27c),!![]),alert('This\x20user\x20is\x20not\x20invited\x20at.\x0a\x20Send\x20invitation\x20to\x20this\x20guest\x20user\x20first.'),![];}else _0x3b0405=_0x55631f[_0x347ca7(0x2ab)];}));if(_0x11b1e0[0x0][_0x1a7072(0x215)][_0x1a7072(0x1e0)][_0x1a7072(0x258)]>0x0){var _0x3e38f4=_0x11b1e0[0x0][_0x1a7072(0x215)]['results'][0x0]['ServerRelativeUrl'];$(_0x1a7072(0x29c))[_0x1a7072(0x271)](_0x1a7072(0x29a),_0x3e38f4);}else $(_0x1a7072(0x29c))[_0x1a7072(0x271)](_0x1a7072(0x29a),_0x1a7072(0x1f3));IsUpdate=!![],userListItemId=_0x11b1e0[0x0]['Id'],initializePeoplePicker(_0x1a7072(0x222),!![]),peoplePickerDiv=$(_0x1a7072(0x2a1)),initializePeoplePicker(_0x1a7072(0x1b7),![]),peoplePickerDivsuper=$(_0x1a7072(0x1de));for(var _0x49cb30=0x0;_0x49cb30<_0x11b1e0[0x0][_0x1a7072(0x222)][_0x1a7072(0x1e0)][_0x1a7072(0x258)];_0x49cb30++){setPeoplePickerUsersInfoCurrent(_0x1a7072(0x242),_0x11b1e0[0x0][_0x1a7072(0x222)]['results'][_0x49cb30]['EMail']);}setPeoplePickerUsersInfoCurrent(_0x1a7072(0x1f7),_0x11b1e0[0x0][_0x1a7072(0x20e)][_0x1a7072(0x1f9)]),$(_0x1a7072(0x23a))['attr'](_0x1a7072(0x22e),'disabled'),$(_0x1a7072(0x214))['attr'](_0x1a7072(0x22e),_0x1a7072(0x22e)),$(peoplePickerDiv)[_0x1a7072(0x1c6)](_0x1a7072(0x29f))['css'](_0x1a7072(0x2a3),_0x1a7072(0x247)),$(peoplePickerDivsuper)[_0x1a7072(0x1c6)](_0x1a7072(0x29f))[_0x1a7072(0x1c2)](_0x1a7072(0x2a3),'none'),$(_0x1a7072(0x223))[_0x1a7072(0x1f5)](),$(_0x1a7072(0x2bd))[_0x1a7072(0x1d9)]();for(var _0x49cb30=0x0;_0x49cb30<_0x2a7fff[_0x1a7072(0x258)];_0x49cb30++){var _0x45bd8a=$(_0x1a7072(0x235));_0x45bd8a[_0x1a7072(0x271)]('value',_0x2a7fff[_0x49cb30])[_0x1a7072(0x261)](_0x2a7fff[_0x49cb30]),$(_0x1a7072(0x2bd))['append'](_0x45bd8a);}$(_0x1a7072(0x278))['val'](_0x3b0405),$(_0x1a7072(0x1b0))[_0x1a7072(0x212)](_0x11b1e0[0x0][_0x1a7072(0x2a8)]),$(_0x1a7072(0x26f))[_0x1a7072(0x212)](_0x11b1e0[0x0][_0x1a7072(0x225)]),$(_0x1a7072(0x213))['val'](_0x11b1e0[0x0][_0x1a7072(0x254)]),$(_0x1a7072(0x296))['val'](_0x11b1e0[0x0][_0x1a7072(0x25f)]),$(_0x1a7072(0x289))[_0x1a7072(0x212)](_0x11b1e0[0x0][_0x1a7072(0x206)][_0x1a7072(0x2ab)]),Client_Id=_0x11b1e0[0x0]['Client_Name']['Id'],$(_0x1a7072(0x27e))[_0x1a7072(0x212)](_0x11b1e0[0x0]['ReferenceCode']),$('#TemplateType\x20>\x20[value='+_0x11b1e0[0x0]['TemplateType']+']')[_0x1a7072(0x271)](_0x1a7072(0x1ed),_0x1a7072(0x1fa)),$('#datepickerAD5')[_0x1a7072(0x212)]($['datepicker'][_0x1a7072(0x27f)](_0x1a7072(0x25e),new Date(_0x11b1e0[0x0][_0x1a7072(0x23c)]))),$(_0x1a7072(0x26b)+_0x11b1e0[0x0]['CollaborationType']+']')[_0x1a7072(0x271)](_0x1a7072(0x1ed),_0x1a7072(0x1fa)),$('#btnExtSubmit')[_0x1a7072(0x1fd)]();}else IsUpdate=![],$('#txtExtLoginName')[_0x1a7072(0x212)](''),$(_0x1a7072(0x1b0))['val'](''),$(_0x1a7072(0x296))[_0x1a7072(0x212)](''),$('#txtReferenceCodeExt')[_0x1a7072(0x212)](''),$(_0x1a7072(0x1ff),$(_0x1a7072(0x2bd)))['val'](''),$(_0x1a7072(0x2a0))['val']($['datepicker'][_0x1a7072(0x27f)](_0x1a7072(0x25e),new Date())),$('option:selected',$(_0x1a7072(0x1c1)))[_0x1a7072(0x212)](),$(_0x1a7072(0x1ff),$(_0x1a7072(0x1ae)))[_0x1a7072(0x212)](),$(_0x1a7072(0x223))['hide'](),$(_0x1a7072(0x29c))['attr'](_0x1a7072(0x29a),_0x1a7072(0x1f3)),$(_0x1a7072(0x253))[_0x1a7072(0x271)](_0x1a7072(0x29a),'https://cdn.jsdelivr.net/gh/Titan4workGit/TitanRepo3.0@latest/SiteAssets/Titan-External-Employee-Portal/images/user_pic.jpg'),initializePeoplePicker(_0x1a7072(0x222),!![]),peoplePickerDiv=$(_0x1a7072(0x2a1)),initializePeoplePicker(_0x1a7072(0x1b7),![]),peoplePickerDivsuper=$('[id$=\x27internalsupervisor_TopSpan\x27]');});if(!IsUpdate)$[_0x440851(0x24b)](GetGueastUsers(email))[_0x440851(0x267)](function(_0x10017b){var _0x3b4349=_0x440851;_0x10017b[_0x3b4349(0x258)]>0x0?(_0x10017b[0x0][_0x3b4349(0x1c0)]==_0x3b4349(0x227)&&($('#btnExtSubmit')[_0x3b4349(0x1f5)](),$(_0x3b4349(0x250))[_0x3b4349(0x1fd)](),$(_0x3b4349(0x278))[_0x3b4349(0x212)](_0x10017b[0x0][_0x3b4349(0x266)])),_0x10017b[0x0][_0x3b4349(0x1c0)]==_0x3b4349(0x285)&&($(_0x3b4349(0x250))['text'](_0x3b4349(0x1bb)),$(_0x3b4349(0x250))['show'](),$('#btnExtSubmit')[_0x3b4349(0x1fd)]())):($(_0x3b4349(0x250))[_0x3b4349(0x261)](_0x3b4349(0x1f0)),$(_0x3b4349(0x250))['show'](),$(_0x3b4349(0x26a))[_0x3b4349(0x1fd)]());});else{}}else $('.msg')[_0x440851(0x1fd)](),$(_0x440851(0x273))['show'](),$(_0x440851(0x250))['hide'](),$(_0x440851(0x26a))[_0x440851(0x1fd)]();}),$(_0x2e1191(0x26a))[_0x2e1191(0x26e)](function(){AddNewGuest();}),$(_0x2e1191(0x223))['click'](function(){UpdateGeustuser(userListItemId);}),$('#GueastextinputFile')[_0x2e1191(0x2af)](function(){readURL(this);}),$(_0x2e1191(0x2ba))[_0x2e1191(0x26e)](function(){try{}catch(_0x3acdfd){alert(_0x3acdfd);}});});