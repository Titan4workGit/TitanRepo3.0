var a0_0x5dfa68=a0_0x5110;(function(_0x39e599,_0x26e63d){var _0x60f761=a0_0x5110,_0x470426=_0x39e599();while(!![]){try{var _0x304009=parseInt(_0x60f761(0x103))/0x1+-parseInt(_0x60f761(0x186))/0x2*(parseInt(_0x60f761(0xc8))/0x3)+-parseInt(_0x60f761(0x14e))/0x4*(-parseInt(_0x60f761(0x166))/0x5)+-parseInt(_0x60f761(0x123))/0x6+parseInt(_0x60f761(0x193))/0x7+-parseInt(_0x60f761(0xaa))/0x8*(parseInt(_0x60f761(0xde))/0x9)+-parseInt(_0x60f761(0xbe))/0xa;if(_0x304009===_0x26e63d)break;else _0x470426['push'](_0x470426['shift']());}catch(_0x2227ec){_0x470426['push'](_0x470426['shift']());}}}(a0_0x26ac,0x272f4));var token,peoplePickerDiv='',peoplePickerDivsuper='',GroupId='',email='',IsUpdate=![],userListItemId='',GuestUserEmail='',UserListId=[],Client_Id;function initializePeoplePicker(_0x2b5f4e,_0x5a7289){var _0x350608=a0_0x5110,_0x263286={};_0x263286[_0x350608(0xec)]=_0x350608(0xae),_0x263286[_0x350608(0x199)]=0xf,_0x263286['ResolvePrincipalSource']=0xf,_0x263286[_0x350608(0xd7)]=_0x5a7289,_0x263286[_0x350608(0x165)]=0x32,_0x263286['Width']='251px',this['SPClientPeoplePicker_InitStandaloneControlWrapper'](_0x2b5f4e,null,_0x263286),$('.sp-peoplepicker-editorInput')[_0x350608(0xe1)](0xfa);}$(function(){$('#datepickerAD5')['datepicker']({'changeMonth':!![],'changeYear':!![]});});function GetGueastEmployee(_0x2157cc){var _0x4924a6=a0_0x5110,_0x1cb62d=_0x4924a6(0xbb)+_0x2157cc+'\x27';return DeferredObj=$[_0x4924a6(0x10f)](),$[_0x4924a6(0xf8)]({'method':_0x4924a6(0xf5),'url':_0x1cb62d,'headers':{'Authorization':_0x4924a6(0x175)+token,'Content-Type':_0x4924a6(0x19f)},'async':![],'success':function(_0x270f74){var _0x3bd167=_0x4924a6;DeferredObj[_0x3bd167(0x13e)](_0x270f74[_0x3bd167(0x170)]);},'error':function(_0x1f64fe){var _0x26395b=_0x4924a6;DeferredObj['reject'](_0x1f64fe),alert('error1'+JSON[_0x26395b(0xe0)](_0x1f64fe));}}),DeferredObj[_0x4924a6(0xed)]();}function GetGueastUsers(_0x1496fc){var _0xad12c1=a0_0x5110,_0x45132f=_0xad12c1(0x1aa)+_0x1496fc+'\x27';return DeferredObj=$['Deferred'](),$[_0xad12c1(0xf8)]({'method':_0xad12c1(0xf5),'url':_0x45132f,'headers':{'Authorization':_0xad12c1(0x175)+token,'Content-Type':_0xad12c1(0x19f)},'async':![],'success':function(_0x514843){DeferredObj['resolve'](_0x514843['value']);},'error':function(_0x53781b){var _0xbbce0e=_0xad12c1;DeferredObj[_0xbbce0e(0xa9)](_0x53781b),alert(_0xbbce0e(0xdf)+JSON['stringify'](_0x53781b));}}),DeferredObj[_0xad12c1(0xed)]();}function GetCategoryMaster(){var _0x110e90=a0_0x5110,_0x2e5dcf=_0x110e90(0xd0),_0x35b202=_spPageContextInfo[_0x110e90(0x12d)]+_0x110e90(0xeb)+_0x2e5dcf+_0x110e90(0x163);$[_0x110e90(0xf8)]({'url':_0x35b202,'headers':{'Accept':_0x110e90(0xad)},'async':![],'success':function(_0x233257){var _0x5959eb=_0x110e90,_0x5bec35=document[_0x5959eb(0x128)](_0x5959eb(0x1ad));_0x5bec35[_0x5959eb(0x149)]='';for(var _0x42d437=0x0;_0x42d437<_0x233257['d'][_0x5959eb(0xda)][_0x5959eb(0x1ab)];_0x42d437++){var _0x234737=_0x233257['d']['results'][_0x42d437][_0x5959eb(0xf7)],_0x471024=_0x233257['d'][_0x5959eb(0xda)][_0x42d437]['CatogeryName'];opt=document['createElement']('option'),opt[_0x5959eb(0x170)]=_0x471024,opt[_0x5959eb(0x102)]=_0x234737,_0x5bec35[_0x5959eb(0x159)](opt);}},'error':function(_0x400bfe){var _0x4dbd9c=_0x110e90;console[_0x4dbd9c(0xb9)](_0x400bfe);}});}function GetUserId(_0x425987){var _0x222f0b=a0_0x5110,_0x51ee95='',_0x39e8ed=_0x222f0b(0x11b),_0x29aab5=_spPageContextInfo['siteAbsoluteUrl'],_0x4285ca=_0x39e8ed+_0x425987;return $[_0x222f0b(0xf8)]({'url':_0x29aab5+_0x222f0b(0x161)+encodeURIComponent(_0x4285ca)+'\x27','method':'GET','headers':{'Accept':_0x222f0b(0xf6)},'async':![],'success':function(_0x5832c8){_0x51ee95=_0x5832c8['d']['Id'];},'error':function(_0x517033){var _0x14d1f9=_0x222f0b;console[_0x14d1f9(0xb9)](JSON[_0x14d1f9(0xe0)](_0x517033));}}),_0x51ee95;}function GetUserName(_0x188515){var _0x3594fd=a0_0x5110,_0x2817df='',_0x15c932=_0x3594fd(0x11b),_0x48f7c6=_spPageContextInfo['siteAbsoluteUrl'],_0x597055=_0x15c932+_0x188515;return $[_0x3594fd(0xf8)]({'url':_0x48f7c6+_0x3594fd(0x161)+encodeURIComponent(_0x597055)+'\x27','method':'GET','headers':{'Accept':_0x3594fd(0xf6)},'async':![],'success':function(_0x818e6){_0x2817df=_0x818e6['d']['Title'];},'error':function(_0x6e3fb8){var _0x411b6f=_0x3594fd;console[_0x411b6f(0xb9)](JSON[_0x411b6f(0xe0)](_0x6e3fb8));}}),_0x2817df;}function AddNewGuest(){var _0x29053f=a0_0x5110;try{var _0x131184='ExternalUsers',_0x2421d0=SPClientPeoplePicker[_0x29053f(0xd8)][peoplePickerDiv[0x0]['id']],_0x33d096=_0x2421d0[_0x29053f(0xfe)](),_0x5d950b=[];for(var _0x28a3f2=0x0;_0x28a3f2<_0x33d096[_0x29053f(0x1ab)];_0x28a3f2++){var _0x2bcc3b=GetUserId(_0x33d096[_0x28a3f2]['EntityData']['Email']);_0x5d950b[_0x29053f(0xf4)](_0x2bcc3b),UserListId['push'](_0x2bcc3b);}_0x2421d0=SPClientPeoplePicker[_0x29053f(0xd8)][peoplePickerDivsuper[0x0]['id']],_0x33d096=_0x2421d0['GetAllUserInfo']();var _0x3d0b8d=GetUserId(_0x33d096[0x0][_0x29053f(0xe9)][_0x29053f(0x15c)]);UserListId[_0x29053f(0xf4)](_0x3d0b8d);GroupId==''&&GetGroupIDByGroupName();AddUserinSharePointGroup($(_0x29053f(0x147))[_0x29053f(0x1a4)]());var _0x4dd07e=GetUserId($(_0x29053f(0x147))[_0x29053f(0x1a4)]());UserListId['push'](_0x4dd07e);var _0x46fea9=_spPageContextInfo['webAbsoluteUrl']+_0x29053f(0xe5)+$('#txtAddOrganization')['val']()[_0x29053f(0x17f)]()['replace'](/ /g,'')+_0x29053f(0x18e),_0x33b700,_0x34814c=GetItemTypeForListName(_0x131184);_0x33b700={'__metadata':{'type':_0x34814c},'LoginNameId':_0x4dd07e,'Title':$(_0x29053f(0x147))['val'](),'email':$(_0x29053f(0x147))['val'](),'Designation':$(_0x29053f(0xc0))[_0x29053f(0x1a4)](),'Organization':$(_0x29053f(0x10b))['val'](),'ReferenceCode':$(_0x29053f(0x181))['val'](),'TemplateType':$(_0x29053f(0x1af),$(_0x29053f(0x1ac)))['val'](),'InternalStakeholdersId':{'results':_0x5d950b},'SupervisorId':_0x3d0b8d,'Client_NameId':Client_Id,'External_Supervisor':$(_0x29053f(0x11a))[_0x29053f(0x1a4)](),'ValidUpto':$(_0x29053f(0xe3))['val'](),'CollaborationType':$(_0x29053f(0x1af),$('#selectByUser'))[_0x29053f(0x1a4)](),'Status':$(_0x29053f(0x1af),$(_0x29053f(0x155)))[_0x29053f(0x1a4)](),'DocumentLibrary':_0x46fea9},AddItemToList(_0x131184,_0x33b700,UserListId);}catch(_0x36cfe8){console[_0x29053f(0xb9)](_0x36cfe8[_0x29053f(0x172)]);}}function cleartextBox(){var _0x2f91fe=a0_0x5110;$(_0x2f91fe(0x1a6))[_0x2f91fe(0x1a4)](''),$(_0x2f91fe(0x147))[_0x2f91fe(0x1a4)](''),$(_0x2f91fe(0xc0))[_0x2f91fe(0x1a4)](''),$(_0x2f91fe(0x181))[_0x2f91fe(0x1a4)](''),$(_0x2f91fe(0x139))['val'](''),$(_0x2f91fe(0x1a7))[_0x2f91fe(0x121)](_0x2f91fe(0x191),_0x2f91fe(0xef)),initializePeoplePicker(_0x2f91fe(0x10d),!![]),peoplePickerDiv=$('[id$=\x27InternalStakeholders_TopSpan\x27]'),initializePeoplePicker(_0x2f91fe(0xf0),![]),peoplePickerDivsuper=$('[id$=\x27internalsupervisor_TopSpan\x27]');}function AddItemToList(_0x1b732d,_0x1cff53,_0x24b809){var _0x9d24a5=a0_0x5110,_0x372fd0=$[_0x9d24a5(0x10f)]();return $['ajax']({'url':_spPageContextInfo[_0x9d24a5(0x12d)]+_0x9d24a5(0x1b1)+_0x1b732d+'\x27)/items','type':_0x9d24a5(0x13a),'async':![],'headers':{'accept':_0x9d24a5(0xad),'X-RequestDigest':$(_0x9d24a5(0x169))[_0x9d24a5(0x1a4)](),'content-Type':'application/json;odata=verbose'},'data':JSON[_0x9d24a5(0xe0)](_0x1cff53),'success':function(_0x828f76){var _0x317bff=_0x9d24a5;if(document['getElementById'](_0x317bff(0x146))[_0x317bff(0x144)][_0x317bff(0x1ab)]===0x0){}else UploadAttachement(_0x828f76['d']['ID']);console[_0x317bff(0xb9)](_0x828f76),IsExistOrNotLibrary($(_0x317bff(0x10b))['val']()['trim']()['replace'](/ /g,''))?AssignTheEditRole($(_0x317bff(0x10b))[_0x317bff(0x1a4)]()[_0x317bff(0x17f)]()[_0x317bff(0x171)](/ /g,''),_0x24b809):(createNewLibraryByRest($(_0x317bff(0x10b))[_0x317bff(0x1a4)]()[_0x317bff(0x17f)]()[_0x317bff(0x171)](/ /g,'')),AssignTheEditRole($(_0x317bff(0x10b))[_0x317bff(0x1a4)]()[_0x317bff(0x17f)]()[_0x317bff(0x171)](/ /g,''),_0x24b809)),alert(_0x317bff(0x105)),cleartextBox();},'error':function(_0x583f14){var _0x1a1f61=_0x9d24a5;console[_0x1a1f61(0xb9)](JSON['stringify'](_0x583f14)),_0x372fd0['reject'](_0x583f14);}}),_0x372fd0['promise']();}function UpdateGeustuser(_0x59ea4f){var _0x35c533=a0_0x5110,_0xdb7b1a=_0x35c533(0x174),_0x345f36=SPClientPeoplePicker[_0x35c533(0xd8)][peoplePickerDiv[0x0]['id']],_0x3007ff=_0x345f36[_0x35c533(0xfe)](),_0x190db4=[];for(var _0x4d6a62=0x0;_0x4d6a62<_0x3007ff[_0x35c533(0x1ab)];_0x4d6a62++){var _0x5aab7a=GetUserId(_0x3007ff[_0x4d6a62]['EntityData'][_0x35c533(0x15c)]);_0x190db4[_0x35c533(0xf4)](_0x5aab7a),UserListId[_0x35c533(0xf4)](_0x5aab7a);}_0x345f36=SPClientPeoplePicker[_0x35c533(0xd8)][peoplePickerDivsuper[0x0]['id']],_0x3007ff=_0x345f36[_0x35c533(0xfe)]();var _0x596574=GetUserId(_0x3007ff[0x0][_0x35c533(0xe9)][_0x35c533(0x15c)]);UserListId[_0x35c533(0xf4)](_0x596574);var _0x4643e1=GetUserId($('#txtExtEmail')[_0x35c533(0x1a4)]());UserListId[_0x35c533(0xf4)](_0x4643e1),GuestUserEmail=$(_0x35c533(0x147))['val']();var _0x4fa17c=_spPageContextInfo[_0x35c533(0x12d)]+_0x35c533(0xe5)+$(_0x35c533(0x10b))[_0x35c533(0x1a4)]()[_0x35c533(0x17f)]()[_0x35c533(0x171)](/ /g,'')+_0x35c533(0x18e);_0x4643e1==''&&(GetGroupIDByGroupName(),AddUserinSharePointGroup($(_0x35c533(0x147))[_0x35c533(0x1a4)]()));var _0x59151a,_0x4551b7=GetItemTypeForListName(_0xdb7b1a);_0x59151a={'__metadata':{'type':_0x4551b7},'Designation':$('#txtExtDesignation')[_0x35c533(0x1a4)](),'LoginNameId':_0x4643e1,'Organization':$(_0x35c533(0x10b))[_0x35c533(0x1a4)](),'ReferenceCode':$(_0x35c533(0x181))['val'](),'TemplateType':$(_0x35c533(0x1af),$(_0x35c533(0x1ac)))[_0x35c533(0x1a4)](),'InternalStakeholdersId':{'results':_0x190db4},'SupervisorId':_0x596574,'Client_NameId':Client_Id,'ValidUpto':$('#datepickerAD5')['val'](),'CollaborationType':$(_0x35c533(0x1af),$(_0x35c533(0x14d)))['val'](),'Status':$('option:selected',$(_0x35c533(0x155)))[_0x35c533(0x1a4)](),'DocumentLibrary':_0x4fa17c};var _0x1f5203=$[_0x35c533(0x10f)]();return $['ajax']({'url':_spPageContextInfo['webAbsoluteUrl']+_0x35c533(0xeb)+_0xdb7b1a+_0x35c533(0x117)+_0x59ea4f+')','type':'POST','async':![],'headers':{'accept':_0x35c533(0xad),'X-RequestDigest':$(_0x35c533(0x169))['val'](),'content-Type':'application/json;odata=verbose','IF-MATCH':'*','X-HTTP-Method':_0x35c533(0xb4)},'data':JSON[_0x35c533(0xe0)](_0x59151a),'success':function(_0x4b6644){var _0x3b2e04=_0x35c533;if(document['getElementById'](_0x3b2e04(0x146))[_0x3b2e04(0x144)][_0x3b2e04(0x1ab)]===0x0){}else UploadAttachement(_0x59ea4f);console[_0x3b2e04(0xb9)](_0x4b6644),IsExistOrNotLibrary($(_0x3b2e04(0x10b))[_0x3b2e04(0x1a4)]()['trim']()[_0x3b2e04(0x171)](/ /g,''))?AssignTheEditRole($(_0x3b2e04(0x10b))[_0x3b2e04(0x1a4)]()[_0x3b2e04(0x17f)]()[_0x3b2e04(0x171)](/ /g,''),UserListId):(createNewLibraryByRest($('#txtAddOrganization')[_0x3b2e04(0x1a4)]()[_0x3b2e04(0x17f)]()[_0x3b2e04(0x171)](/ /g,'')),AssignTheEditRole($(_0x3b2e04(0x10b))[_0x3b2e04(0x1a4)]()[_0x3b2e04(0x17f)]()['replace'](/ /g,''),UserListId)),alert(_0x3b2e04(0x167));},'error':function(_0x2a1b57){var _0x1ab958=_0x35c533;console[_0x1ab958(0xb9)](JSON[_0x1ab958(0xe0)](_0x2a1b57)),_0x1f5203[_0x1ab958(0xa9)](_0x2a1b57);}}),_0x1f5203['promise']();}function GetItemToList(_0x1aa9b0){var _0x266adf=a0_0x5110,_0x1b4234=_0x266adf(0x174),_0x3854c9=$['Deferred']();return $[_0x266adf(0xf8)]({'url':_spPageContextInfo['webAbsoluteUrl']+'/_api/web/lists/getbytitle(\x27'+_0x1b4234+_0x266adf(0xaf)+_0x1aa9b0+'\x27','type':'get','async':![],'headers':{'accept':_0x266adf(0xad),'X-RequestDigest':$('#__REQUESTDIGEST')[_0x266adf(0x1a4)](),'content-Type':_0x266adf(0xad)},'success':function(_0x5087dc){var _0xa3a4f8=_0x266adf;_0x3854c9[_0xa3a4f8(0x13e)](_0x5087dc['d'][_0xa3a4f8(0xda)]),console[_0xa3a4f8(0xb9)](_0x5087dc);},'error':function(_0x5370c6){var _0x5c87fa=_0x266adf;console[_0x5c87fa(0xb9)](JSON[_0x5c87fa(0xe0)](_0x5370c6)),_0x3854c9[_0x5c87fa(0xa9)](_0x5370c6);}}),_0x3854c9[_0x266adf(0xed)]();}function GetItemToListchoice(){var _0xf972a0=a0_0x5110,_0x56293b=_0xf972a0(0x174),_0x3156dd=$[_0xf972a0(0x10f)]();return $[_0xf972a0(0xf8)]({'url':_spPageContextInfo['webAbsoluteUrl']+'/_api/web/lists/getbytitle(\x27'+_0x56293b+'\x27)/fields?&$select=*&$filter=EntityPropertyName\x20eq\x20\x27TemplateType\x27','type':_0xf972a0(0x195),'async':![],'headers':{'accept':_0xf972a0(0xad),'X-RequestDigest':$('#__REQUESTDIGEST')[_0xf972a0(0x1a4)](),'content-Type':_0xf972a0(0xad)},'success':function(_0x3c2c0a){var _0x3610f0=_0xf972a0;_0x3156dd[_0x3610f0(0x13e)](_0x3c2c0a['d'][_0x3610f0(0xda)][0x0][_0x3610f0(0x1a9)]['results']),console['log'](_0x3c2c0a);},'error':function(_0x8b09c7){var _0x574426=_0xf972a0;console[_0x574426(0xb9)](JSON[_0x574426(0xe0)](_0x8b09c7)),_0x3156dd['reject'](_0x8b09c7);}}),_0x3156dd['promise']();}function a0_0x26ac(){var _0x1dec25=['click','div[id^=\x27InternalStakeholders\x27]','get_siteGroups','getElementById','\x20Your\x20e-mail\x20configured\x20for\x20this\x20portal\x20is\x20<span\x20id=\x22user_id\x22>@info.gmail.com</span>\x20and\x20you’ll\x20be\x20able\x20to\x20login\x20using\x20your\x20existing\x20passport\x20for\x20this\x20e-mail\x20service.','Failed','result','/_api/web/sitegroups/getbyname(\x27Contributors\x27)?$select=id','webAbsoluteUrl','Description','onload','responseText','access_token','#txtinviteemail','#btnExtSubmit','Success','name','#btnExtUpdate','Contributors','<td\x20class=\x22text-left\x22>','#txtExtOrganizationName','POST','get_message','/_api/web/sitegroups/getbyname(\x27Contributors\x27)/users','target','resolve','<p>','SelfCompany','slow','InternalStakeholders_TopSpan','when','files','/_api/web/sitegroups(','GueastextinputFile','#txtExtEmail','internalsupervisor_TopSpan','innerHTML','#btnotherOrganizationSearch','Organization','ValidUpto','#selectByUser','524MqtuWR','<p>Welcome\x20to\x20the\x20','<h3>Dear\x20<span\x20class=\x22user_name\x22>','<div\x20class=\x22checkbox\x20m-0\x22>','Client_Name','d-block','onerror','#txtExtStatus','Association','addUser','show','appendChild','https://graph.microsoft.com/v1.0/invitations','getItemsWithQueryItem','Email','PendingAcceptance','display','Designation','</td>','/_api/web/siteusers(@v)?@v=\x27','fail','\x27)/items?$filter=CategoryType\x20eq\x20\x27Guest\x20Type\x27\x20and\x20Status\x20eq\x20\x20\x27Yes\x27\x20','split','MaximumEntitySuggestions','5430kFNHKq','Guest\x20user\x20has\x20Update\x20successfully!','The\x20new\x20cafeteria\x20is\x20open.','#__REQUESTDIGEST','[id$=\x27InternalStakeholders_TopSpan\x27]','#GueastextinputFile','then','Active','TemplateType','Sending\x20mail\x20with\x20attach','value','replace','message','Base64EncodedByteArray','ExternalUsers','Bearer\x20','change','hide','?$select=*,Id,Supervisor/Title,Supervisor/EMail\x20,InternalMembers/EMail,InternalMembers/Title,InternalSupervisor/EMail,InternalSupervisor/Title\x20&$expand=Supervisor,InternalMembers,InternalSupervisor\x20','datepicker','find','#msgExtEmail','</p>','none','\x27)/roleassignments/addroleassignment(principalid=\x27','trim','displayName','#txtReferenceCodeExt',')/AttachmentFiles/add(FileName=\x27','Recognition\x20has\x20been\x20submitted\x20\x20!!','#txtinvitename','\x27)/items?$filter=Title\x20eq\x20\x27Client_Credentials\x27\x20','388ZNolCk','Email\x20Sent\x20Successfully','done','<p>Click\x20on\x20<a\x20href=\x22https://adaptindia.sharepoint.com/sites/Titan_2_2_1_DEV/SitePages/GuestPortal.aspx\x22\x20target=\x22_blank\x22>\x20this-link\x20</a></p>','SP.Utilities.EmailProperties','InternalSupervisor','/_api/SP.OAuth.Token/Acquire','empty','/Forms/AllItems.aspx','Meet\x20for\x20lun\x20Indramani\x20Indra?','/_api/SP.Utilities.Utility.SendEmail','src','Guest','1458282hIJZvc','/GuestUserDocuments/_api/web/lists/getbytitle(\x27','get','/GuestUserDocuments/_api/Web/Lists/','#ddlAssociation','IsActive','SearchPrincipalSource','removeClass','</p>\x20\x20','ChangeFileName','This\x20user\x20is\x20not\x20invited\x20at.\x0a\x20Send\x20invitation\x20to\x20this\x20guest\x20user\x20first.','\x09<span>','application/json','.msg','SP.List','AttachmentFiles','https://cdn.jsdelivr.net/gh/Titan4workGit/TitanRepo3.0@latest/SiteAssets/Titan-External-Employee-Portal/images/user_pic.jpg','val','formatDate','#txtExtLoginName','#extrenalImage','ClientContext','Choices','https://graph.microsoft.com/v1.0/users?$select=id,displayName,userPrincipalName,otherMails,userType,identities,creationType,externalUserState\x20&$filter=mail\x20eq\x20\x27','length','#TemplateType','selectByUser','readAsDataURL','option:selected','selected','/_api/web/lists/getbytitle(\x27','Idea\x20has\x20been\x20submitted\x20but\x20some\x20files\x20failed\x20to\x20upload.','.sp-peoplepicker-delImage','ServerRelativeUrl','reject','8AWsVGE','append','Client_Code','application/json;odata=verbose','User,DL,SecGroup,SPGroup','\x27)/items?$select=*,AttachmentFiles,Supervisor/Title,Supervisor/EMail,InternalStakeholders/Title,InternalStakeholders/EMail,LoginName/Title,Client_Name/Title,Client_Name/Id\x20&$expand=Supervisor,InternalStakeholders,AttachmentFiles,LoginName,Client_Name\x20&$filter=\x20email\x20eq\x20\x27','test','AddUserKeys','Title','\x27,roledefid=\x271073741830\x27)','MERGE','External_Supervisor','/SitePages/Thankyou.aspx','\x27)/breakroleinheritance(false)','Unauthorized','log','d-none','https://graph.microsoft.com/v1.0/users?$filter=mail\x20eq\x20\x27',')/users','prop','432550fjKtAz','User\x20Added','#txtExtDesignation','input:checkbox','shift','focusout','Error\x20in\x20sending\x20Email:\x20','mail\x20sent\x20successfully','Send\x20invitation\x20to\x20this\x20guest\x20user\x20first.','true','4638ilDZSe','webServerRelativeUrl','statusText','Accepted','checked','Invitation\x20mail\x20has\x20been\x20sent\x20to\x20the\x20user.','#selectByUser\x20>\x20[value=','#Customer-box','CategoryMaster','Invite\x20to\x20guest\x20Portal','\x27)/items?$select=*','addClass','Process\x20Failed.\x20Invitation\x20mail\x20failed\x20to\x20send.','css','invitedUserEmailAddress','AllowMultipleValues','SPClientPeoplePickerDict','/_api/lists/GetByTitle(\x27','results','Browsers\x20supported\x20by\x20this\x20portal\x20are\x20Chrome,\x20Microsoft\x20Edge,\x20Safari…..\x20(incase\x20you\x20want\x20to\x20specify\x20their\x20versions\x20as\x20well)','getByName','https://graph.microsoft.com/v1.0/me/sendMail','253917qeBrau','error1','stringify','width','.toHide','#datepickerAD5','d\x20M,\x20y','/GuestUserDocuments/','error','</tr>','byteLength','EntityData','Not\x20Found','/_api/web/lists/GetByTitle(\x27','PrincipalAccountType','promise','\x20<p>','https://cdn.jsdelivr.net/gh/Titan4workGit/TitanRepo3.0@latest/SiteAssets/AdminPortal/ManageEmployee/assets/images/user_pic.jpg','internalsupervisor','disabled','[id$=\x27internalsupervisor_TopSpan\x27]','#masterClientgrid','push','GET','application/json;\x20odata=verbose','CatogeryName','ajax','executeQueryAsync','<label><input\x20type=\x22checkbox\x22\x20id=\x22Check_','#InternalStakeholders','SP.User','/GuestUserDocuments/_api/web/lists/?$filter=Title\x20eq\x20\x27','GetAllUserInfo','#internalsupervisor','From:\x20no-reply@sharepointonline.com','<option>','text','235415lkOxYb','SetEnabledState','Guest\x20user\x20has\x20registered\x20successfully!','https://graph.microsoft.com','InternalMembers','\x22\x20class=\x22getclientmaster\x22\x20onclick=\x22selectOnlyThis(this.id)\x22\x20\x20value=\x22','client_credentials','CustType','#txtAddOrganization','readAsArrayBuffer','InternalStakeholders','[name=UpdateEmp]','Deferred','EMail','.</p>','ready','get_stackTrace','application/json;odata=nometadata','#txtinvitemessage','Supervisor','\x27)/items(','\x20portal\x20of\x20','Already\x20send\x20invitation\x20but\x20this\x20user\x20is\x20not\x20Accepted..','#txtExternalSupervisor','i:0#.f|membership|','#Employee-box','#UpdateEmp-box-2','<span>','Attn_Name','</span>','attr','Message\x20has\x20been\x20sent.','324690uTopfv','externalUserState'];a0_0x26ac=function(){return _0x1dec25;};return a0_0x26ac();}function GetItemToClientMaster(){var _0x1741c3=a0_0x5110,_0x28f345='ClientMaster',_0x47f09f=$[_0x1741c3(0x10f)]();return $['ajax']({'url':_spPageContextInfo[_0x1741c3(0x12d)]+_0x1741c3(0x1b1)+_0x28f345+_0x1741c3(0xd2),'type':_0x1741c3(0x195),'async':![],'headers':{'accept':_0x1741c3(0xad),'X-RequestDigest':$(_0x1741c3(0x169))['val'](),'content-Type':_0x1741c3(0xad)},'success':function(_0x358ac5){var _0x50bf43=_0x1741c3;_0x47f09f['resolve'](_0x358ac5['d'][_0x50bf43(0xda)]),console[_0x50bf43(0xb9)](_0x358ac5);},'error':function(_0x5e7087){var _0x209497=_0x1741c3;console[_0x209497(0xb9)](JSON[_0x209497(0xe0)](_0x5e7087)),_0x47f09f[_0x209497(0xa9)](_0x5e7087);}}),_0x47f09f[_0x1741c3(0xed)]();}function requestToken(){var _0x3293aa=a0_0x5110;$[_0x3293aa(0xf8)]({'async':!![],'crossDomain':!![],'url':ClientUrl,'method':_0x3293aa(0x13a),'headers':{'content-type':'application/x-www-form-urlencoded'},'data':{'grant_type':_0x3293aa(0x109),'client_id\x20':ClientId,'client_secret':ClentSecret,'scope\x20':'https://graph.microsoft.com/.default'},'success':function(_0x1f9ff8){var _0x996f9d=_0x3293aa;console[_0x996f9d(0xb9)](_0x1f9ff8),token=_0x1f9ff8['access_token'];},'error':function(_0x3b1d0c){var _0x16e6d6=_0x3293aa;console[_0x16e6d6(0xb9)](JSON[_0x16e6d6(0xe0)](_0x3b1d0c));}});}function ClientCredentialss(){var _0x4eaa00=a0_0x5110,_0x5a1865='EnvironmentalSettings',_0x38f31a=_spPageContextInfo['webAbsoluteUrl']+'/_api/web/lists/GetByTitle(\x27'+_0x5a1865+_0x4eaa00(0x185);$[_0x4eaa00(0xf8)]({'url':_0x38f31a,'headers':{'Accept':_0x4eaa00(0xad)},'async':![],'success':function(_0x302d6c){var _0x51d076=_0x4eaa00,_0x448bf8=_0x302d6c['d']['results'];ClientId=_0x448bf8[0x0]['ClientName'],ClentSecret=_0x448bf8[0x0][_0x51d076(0x19c)],ClientUrl=_0x448bf8[0x0]['Description'],requestToken();},'error':function(_0x3de826){var _0x2e18d4=_0x4eaa00;console[_0x2e18d4(0xb9)](_0x3de826);}});}function GraphAccessTokenTogetUserDetails(){var _0x43aeab=a0_0x5110,_0x2cc106=new jQuery[(_0x43aeab(0x10f))](),_0x5197b0={'X-RequestDigest':$(_0x43aeab(0x169))['val'](),'accept':'application/json;odata=nometadata','content-type':'application/json;odata=nometadata'},_0x138d8f={'resource':_0x43aeab(0x106)};return $['ajax']({'url':_spPageContextInfo['webAbsoluteUrl']+_0x43aeab(0x18c),'headers':_0x5197b0,'type':_0x43aeab(0x13a),'data':JSON[_0x43aeab(0xe0)](_0x138d8f),'success':function(_0x47b57a){var _0x541fb2=_0x43aeab;token=_0x47b57a[_0x541fb2(0x131)],token_=token,_0x2cc106[_0x541fb2(0x13e)](token);},'error':function(_0x261da4,_0x12ff37,_0x2f36b0){var _0x4b55ac=_0x43aeab;console[_0x4b55ac(0xb9)](_0x261da4[_0x4b55ac(0x130)]),_0x2cc106['reject'](_0x261da4[_0x4b55ac(0x130)]);}}),_0x2cc106[_0x43aeab(0xed)]();}var Errorcount=0x1,Ischeckerror=![];function Inviteuser(){var _0x1526dd=a0_0x5110,_0x423ed3=$(_0x1526dd(0x132))[_0x1526dd(0x1a4)](),_0x597184=$(_0x1526dd(0x184))[_0x1526dd(0x1a4)](),_0x5bac82=$(_0x1526dd(0x115))[_0x1526dd(0x1a4)]();Errorcount=0x1,$[_0x1526dd(0xf8)]({'url':_0x1526dd(0x15a),'type':_0x1526dd(0x13a),'headers':{'Authorization':_0x1526dd(0x175)+token,'content-type':'application/json'},'data':JSON[_0x1526dd(0xe0)]({'invitedUserDisplayName':_0x597184,'invitedUserEmailAddress':_0x423ed3,'inviteRedirectUrl':_spPageContextInfo[_0x1526dd(0x12d)]+_0x1526dd(0xb6),'sendInvitationMessage':!![],'invitedUserMessageInfo':{'customizedMessageBody':_0x5bac82}}),'async':![],'success':function(_0x207419){var _0x4d1393=_0x1526dd;console[_0x4d1393(0xb9)](_0x207419),$('#txtinviteemail')[_0x4d1393(0x1a4)](''),$(_0x4d1393(0x184))[_0x4d1393(0x1a4)](''),$('#txtinvitemessage')[_0x4d1393(0x1a4)]('');GroupId==''&&GetGroupIDByGroupName();GuestUserEmail=_0x207419['invitedUserEmailAddress'];try{$[_0x4d1393(0x143)](AddUserinSharePointGroup(_0x207419[_0x4d1393(0xd6)]))[_0x4d1393(0x188)](function(_0x32c5d7){var _0xa75d34=_0x4d1393;Ischeckerror=![],_0x32c5d7==_0xa75d34(0xbf)?alert(_0xa75d34(0xcd)):alert(_0xa75d34(0xd4));});}catch(_0x478c60){alert(_0x4d1393(0xd4));}},'error':function(_0x1b7691){var _0x3fe859=_0x1526dd;_0x1b7691['statusText']==_0x3fe859(0xb8)?alert(_0x1b7691[_0x3fe859(0xca)]+':\x20\x20Compact\x20Token\x20parsing\x20failed'):(alert('Please\x20enter\x20a\x20valid\x20email\x20address\x20of\x20the\x20guest\x20user,\x20who\x20is\x20outsider\x20of\x20this\x20organization.'),console[_0x3fe859(0xb9)](JSON[_0x3fe859(0xe0)](_0x1b7691)));}}),Ischeckerror&&alert(_0x1526dd(0xd4));}function setPeoplePickerUsersInfoCurrent(_0x274392,_0x102c7b){var _0x1b96e5=a0_0x5110,_0x299aa3=$('[id$=\x27'+_0x274392+'\x27]'),_0x3f8adf=SPClientPeoplePicker[_0x1b96e5(0xd8)][_0x299aa3[0x0]['id']];_0x3f8adf[_0x1b96e5(0xb1)](_0x102c7b,![]),_0x3f8adf[_0x1b96e5(0x104)](![]);}function readURL(_0x1c44c6){var _0x5c0e75=a0_0x5110;if(_0x1c44c6[_0x5c0e75(0x144)]&&_0x1c44c6['files'][0x0]){var _0x3bb80c=new FileReader();_0x3bb80c[_0x5c0e75(0x12f)]=function(_0x5c66bd){var _0x574a49=_0x5c0e75;$(_0x574a49(0x1a7))[_0x574a49(0x121)](_0x574a49(0x191),_0x5c66bd[_0x574a49(0x13d)]['result']);},_0x3bb80c[_0x5c0e75(0x1ae)](_0x1c44c6['files'][0x0]);}}function UploadAttachement(_0x44781a){var _0x454cad=a0_0x5110;try{if(document[_0x454cad(0x128)](_0x454cad(0x146))[_0x454cad(0x144)]['length']===0x0){}else{var _0x549d4b=_0x44781a,_0x57ab79=$(_0x454cad(0x16b)),_0x28ac9e=_0x57ab79[0x0][_0x454cad(0x144)][_0x454cad(0x1ab)],_0xab26b3=[],_0x1c33c5=_0x57ab79[0x0][_0x454cad(0x144)][0x0][_0x454cad(0x135)];_0x1c33c5=_0x57ab79[0x0][_0x454cad(0x144)][0x0][_0x454cad(0x135)]['replace'](/[^a-zA-Z0-9-. ]/g,''),_0x1c33c5=_0x1c33c5[_0x454cad(0x171)](/\s/g,'');for(var _0x3a33e7=0x0;_0x3a33e7<_0x28ac9e;_0x3a33e7++){_0xab26b3[_0x454cad(0xf4)](_0x57ab79[0x0][_0x454cad(0x144)][_0x3a33e7]);}uploadFileSP(_0x454cad(0x174),_0x549d4b,_0xab26b3,_0x28ac9e,_0x1c33c5);}}catch(_0x2b7b91){alert('Your\x20item\x20has\x20not\x20been\x20submitted\x20successfully!');}}function getFileBuffer(_0xadb232){var _0x3a11d0=a0_0x5110,_0xe8901c=$[_0x3a11d0(0x10f)](),_0x292223=new FileReader();return _0x292223[_0x3a11d0(0x12f)]=function(_0x7a4e5b){var _0x1cc432=_0x3a11d0;_0xe8901c[_0x1cc432(0x13e)](_0x7a4e5b[_0x1cc432(0x13d)][_0x1cc432(0x12b)]);},_0x292223[_0x3a11d0(0x154)]=function(_0x275a8c){var _0x53536b=_0x3a11d0;_0xe8901c[_0x53536b(0xa9)](_0x275a8c['target'][_0x53536b(0xe6)]);},_0x292223[_0x3a11d0(0x10c)](_0xadb232),_0xe8901c['promise']();}function uploadFileSP(_0x2b5b37,_0x3058e9,_0x637391,_0x59ec70,_0x298757){var _0x1cb3fe=a0_0x5110,_0x49a280=0x0,_0x2ff2bb=$[_0x1cb3fe(0x10f)](),_0x1dbb8f='',_0xdcee92=_0x637391[0x0],_0x2ea598=getFileBuffer(_0xdcee92);return _0x2ea598[_0x1cb3fe(0x188)](function(_0x209cc3,_0x40b923,_0x521525){var _0x268beb=_0x1cb3fe,_0xd5a8ea=new Uint8Array(_0x209cc3),_0x15bf5b=new SP[(_0x268beb(0x173))](),_0x518633=_spPageContextInfo[_0x268beb(0x12d)]+_0x268beb(0xd9)+_0x2b5b37+'\x27)/items('+_0x3058e9+_0x268beb(0x182)+_0x298757+'\x27)',_0x3037c2=0x0;$[_0x268beb(0xf8)]({'url':_0x518633,'type':_0x268beb(0x13a),'processData':![],'contentType':_0x268beb(0xad),'data':_0x209cc3,'headers':{'accept':_0x268beb(0xad),'X-RequestDigest':$(_0x268beb(0x169))['val'](),'content-length':_0x209cc3[_0x268beb(0xe8)]},'success':function(_0x419e2e){var _0x369457=_0x268beb;_0x49a280++,_0x1dbb8f=_0x49a280,_0x637391[_0x369457(0xc2)]();if(_0x637391[_0x369457(0x1ab)]>0x0)uploadFileSP(_0x369457(0x174),_0x3058e9,_0x637391,_0x637391[_0x369457(0x1ab)]);else{}},'error':function(_0x294a73){var _0x10070f=_0x268beb;alert(_0x10070f(0x1b2));}}),_0x2ff2bb['resolve'](_0x1dbb8f);}),_0x2ea598[_0x1cb3fe(0x162)](function(_0x40192f){var _0x46e070=_0x1cb3fe;_0x2ff2bb[_0x46e070(0xa9)](_0x40192f);}),_0x2ff2bb['promise']();}function GetGroupIDByGroupName(){var _0x104568=a0_0x5110,_0x9c20a1=_spPageContextInfo[_0x104568(0x12d)]+_0x104568(0x12c);$[_0x104568(0xf8)]({'url':_0x9c20a1,'method':_0x104568(0xf5),'async':![],'headers':{'Accept':'application/json;\x20odata=verbose'},'success':function(_0x53d3c5){GroupId=_0x53d3c5['d']['Id'];},'error':function(_0x77781b){var _0x54b9bb=_0x104568;console[_0x54b9bb(0xb9)](_0x77781b);}});}function AddUserToSiteGroup(_0x472467){var _0x20b7c0=a0_0x5110;clientContext=new SP[(_0x20b7c0(0x1a8))]();var _0x429b42=clientContext['get_web']()[_0x20b7c0(0x127)]()[_0x20b7c0(0xdc)](_0x20b7c0(0x137)),_0x22004b=_0x429b42['get_users']();_0x22004b[_0x20b7c0(0x157)](_0x472467),clientContext[_0x20b7c0(0xf9)](onsuccess,onfailed);}function onsuccess(){var _0xc33028=a0_0x5110;console[_0xc33028(0xb9)](_0xc33028(0x134));}function onfailed(_0x197151,_0x5672b8){var _0x34ccc=a0_0x5110;console['log'](_0x34ccc(0x12a)+_0x5672b8[_0x34ccc(0x13b)]()+'\x0a'+_0x5672b8[_0x34ccc(0x113)]());}function AddUserinSharePointGroup(_0x53d104){var _0x469833=a0_0x5110,_0x2cb61c=$[_0x469833(0x10f)](),_0x52cdbe=_0x469833(0x11b),_0x4a5cd3=_0x52cdbe+_0x53d104,_0x55a2ae=_spPageContextInfo[_0x469833(0x12d)]+_0x469833(0x13c);$['ajax']({'url':_0x55a2ae,'type':_0x469833(0x13a),'async':![],'data':JSON['stringify']({'__metadata':{'type':'SP.User'},'LoginName':_0x4a5cd3}),'headers':{'accept':_0x469833(0xad),'content-type':_0x469833(0xad),'X-RequestDigest':$(_0x469833(0x169))[_0x469833(0x1a4)]()},'success':_0x9c9ca5,'error':_0x2aa2ac});function _0x9c9ca5(_0x2ebf53){var _0x534264=_0x469833;Ischeckerror=!![],_0x2cb61c[_0x534264(0x13e)](_0x534264(0xbf)),Errorcount=0x1,console[_0x534264(0xb9)](_0x534264(0xbf));}function _0x2aa2ac(_0x388185){var _0x20fa7a=_0x469833;console[_0x20fa7a(0xb9)](JSON[_0x20fa7a(0xe0)](_0x388185)),(_0x388185[_0x20fa7a(0xca)]==_0x20fa7a(0xea)||_0x388185['statusText']==_0x20fa7a(0xe6))&&Errorcount==0xa?_0x388185['statusText']==_0x20fa7a(0xe6)?alert('Process\x20Failed.\x20Invitation\x20mail\x20failed\x20to\x20send.'):alert('Process\x20Failed.\x20Invitation\x20mail\x20failed\x20to\x20send.\x0a\x20Enter\x20valid\x20email\x20address\x20or\x20check\x20the\x20external\x20sharing\x20features\x20is\x20enabled.'):(Errorcount++,AddUserinSharePointGroup(GuestUserEmail));}return _0x2cb61c[_0x469833(0xed)]();}function AddUserinSharePointGroupforEdit(_0x6dd520){var _0x1afae7=a0_0x5110,_0x1af831='',_0x43d8b2=_0x1afae7(0x11b),_0x9e29dc=_0x43d8b2+_0x6dd520,_0x161606=_spPageContextInfo[_0x1afae7(0x12d)]+_0x1afae7(0x145)+GroupId+_0x1afae7(0xbc);$['ajax']({'url':_0x161606,'type':_0x1afae7(0x13a),'async':![],'data':JSON[_0x1afae7(0xe0)]({'__metadata':{'type':_0x1afae7(0xfc)},'LoginName':_0x9e29dc}),'headers':{'accept':_0x1afae7(0xad),'content-type':_0x1afae7(0xad),'X-RequestDigest':$(_0x1afae7(0x169))[_0x1afae7(0x1a4)]()},'success':_0x59b0cf,'error':_0x1d70d0});function _0x59b0cf(_0x1ff2d7){var _0x45a6f0=_0x1afae7;_0x1af831=_0x1ff2d7['d'],console[_0x45a6f0(0xb9)](_0x45a6f0(0xbf));}function _0x1d70d0(_0x369b85){var _0x3c60c7=_0x1afae7;console['log'](JSON[_0x3c60c7(0xe0)](_0x369b85));}return _0x1af831;}function processSendEmails(_0x13774a,_0x5c0f5b,_0x345174){var _0x5d5712=a0_0x5110,_0x2012f9=[],_0x4450e4='<img\x20src=\x22img/customer.png\x22\x20id=\x22logo\x22>'+_0x5d5712(0x150)+_0x13774a+'</span></h3>'+_0x5d5712(0x14f)+_0x5c0f5b+_0x5d5712(0x118)+_0x345174+_0x5d5712(0x111)+'<p>Please\x20click\x20on\x20the\x20following\x20link\x20to\x20access\x20this\x20portal.\x20</p>'+_0x5d5712(0x189)+_0x5d5712(0x13f)+_0x5d5712(0x129)+_0x5d5712(0xdb)+_0x5d5712(0x19b)+_0x5d5712(0xee)+'Incase\x20of\x20any\x20help\x20needed\x20or\x20if\x20you\x20are\x20facing\x20any\x20problem\x20in\x20accessing\x20this\x20portal,\x20please\x20send\x20an\x20e-mail\x20to\x20<\x20e-mail\x20ID\x20of\x20\x20admin\x20(s)\x20>'+'\x20This\x20is\x20auto\x20generated\x20e-mail,\x20please\x20do\x20not\x20respond\x20on\x20this\x20sender\x20e-mail.'+_0x5d5712(0x17c),_0x3f16bd=_0x5d5712(0xd1);_0x2012f9[_0x5d5712(0xf4)](email);var _0x4db55b=_spPageContextInfo['userEmail'],_0x5a418b;_0x5a418b={'properties':{'__metadata':{'type':_0x5d5712(0x18a)},'From':_0x4db55b,'To':{'results':_0x2012f9},'Body':_0x4450e4,'Subject':_0x3f16bd}};var _0x4508c4={'properties':{'__metadata':{'type':_0x5d5712(0x18a)},'From':_0x5d5712(0x100),'To':{'results':_0x2012f9},'Body':_0x4450e4,'Subject':_0x3f16bd}},_0x267c59=_spPageContextInfo['webServerRelativeUrl']==='/'?'/':_spPageContextInfo[_0x5d5712(0xc9)],_0x33b2f6=_0x267c59,_0x56eaaf=_0x33b2f6+_0x5d5712(0x190),_0x396b0b=_spPageContextInfo[_0x5d5712(0x12d)]+_0x5d5712(0x190);$[_0x5d5712(0xf8)]({'contentType':'application/json','url':_0x396b0b,'type':_0x5d5712(0x13a),'data':JSON[_0x5d5712(0xe0)](_0x4508c4),'async':![],'headers':{'Accept':_0x5d5712(0xad),'content-type':_0x5d5712(0xad),'X-RequestDigest':$('#__REQUESTDIGEST')[_0x5d5712(0x1a4)]()},'success':function(_0x11aec7){var _0x10a7b9=_0x5d5712;console[_0x10a7b9(0xb9)](_0x10a7b9(0x122));},'error':function(_0x20a37c){var _0x1bfa12=_0x5d5712;console['log']('SendEmailSharedNotification\x20\x20'+JSON[_0x1bfa12(0xe0)](_0x20a37c));}});}function sendEmail(_0x3ae4f1,_0x14a165,_0xefc51f,_0x4ae70a){var _0x1e2a53=a0_0x5110;Email['send']({'SecureToken':token,'To':_0x14a165[0x0],'From':_0x3ae4f1,'Subject':_0x4ae70a,'Body':_0xefc51f})[_0x1e2a53(0x16c)](_0xb02165=>alert(_0x1e2a53(0xc5)));var _0x2c7c4e=_spPageContextInfo[_0x1e2a53(0xc9)],_0x2b4294=_0x2c7c4e+_0x1e2a53(0x190);$[_0x1e2a53(0xf8)]({'contentType':_0x1e2a53(0x19f),'url':_0x2b4294,'type':'POST','data':JSON[_0x1e2a53(0xe0)]({'properties':{'__metadata':{'type':_0x1e2a53(0x18a)},'From':_0x3ae4f1,'To':{'results':_0x14a165},'Body':_0xefc51f,'Subject':_0x4ae70a}}),'headers':{'Accept':_0x1e2a53(0xad),'content-type':_0x1e2a53(0xad),'X-RequestDigest':jQuery('#__REQUESTDIGEST')[_0x1e2a53(0x1a4)]()},'success':function(_0x26b69d){var _0xf42b94=_0x1e2a53;alert(_0xf42b94(0x187));},'error':function(_0x178130){var _0x13cc48=_0x1e2a53;alert(_0x13cc48(0xc4)+JSON[_0x13cc48(0xe0)](_0x178130));}});}$(function(){var _0x2bae18=a0_0x5110;$(_0x2bae18(0x10e))[_0x2bae18(0x125)](function(){var _0xc678a5=_0x2bae18;$(_0xc678a5(0xe2))[_0xc678a5(0x177)](),cleartextBox(),$('#UpdateEmp-box-'+$(this)[_0xc678a5(0x1a4)]())['show'](_0xc678a5(0x141)),$(this)[_0xc678a5(0x1a4)]()=='3'&&(GetCategoryMaster(),$[_0xc678a5(0x143)](GetItemToListchoice())[_0xc678a5(0x188)](function(_0x254e23){var _0x22e857=_0xc678a5;$(_0x22e857(0x1ac))[_0x22e857(0x18d)]();for(var _0x24e25b=0x0;_0x24e25b<_0x254e23[_0x22e857(0x1ab)];_0x24e25b++){var _0x220879=$(_0x22e857(0x101));_0x220879[_0x22e857(0x121)](_0x22e857(0x170),_0x254e23[_0x24e25b])['text'](_0x254e23[_0x24e25b]),$(_0x22e857(0x1ac))['append'](_0x220879);}})),$(_0xc678a5(0x17b))['hide']();});});function sendEmailg(){var _0xe20884=a0_0x5110;$[_0xe20884(0xf8)]({'async':![],'crossDomain':!![],'url':_0xe20884(0xdd),'method':_0xe20884(0x13a),'headers':{'authorization':'Bearer\x20'+token_,'content-type':_0xe20884(0x19f)},'data':JSON[_0xe20884(0xe0)]({'message':{'subject':_0xe20884(0x18f),'body':{'contentType':'Text','content':_0xe20884(0x168)},'toRecipients':[{'emailAddress':{'address':'indramani047@gmail.com'}}]}}),'success':function(_0x6d5942){var _0x2bd55a=_0xe20884;alert(_0x2bd55a(0x183));},'error':function(_0x377e55){var _0x5697a1=_0xe20884;console[_0x5697a1(0xb9)](_0x5697a1(0x16f)+JSON[_0x5697a1(0xe0)](_0x377e55));}});}function createNewLibraryByRest(_0x458909){var _0x26936f=a0_0x5110,_0x3e8e0d=_0x458909,_0x14df4a=_spPageContextInfo[_0x26936f(0x12d)]+_0x26936f(0x196);$['ajax']({'url':_0x14df4a,'method':_0x26936f(0x13a),'async':![],'data':JSON['stringify']({'__metadata':{'type':_0x26936f(0x1a1)},'AllowContentTypes':!![],'BaseTemplate':0x65,'ContentTypesEnabled':!![],'Description':_0x26936f(0x12e),'OnQuickLaunch':!![],'Title':_0x458909}),'headers':{'content-type':_0x26936f(0xad),'X-RequestDigest':$(_0x26936f(0x169))['val']()},'success':function(_0x2ae7ae){BreakRoleInheritance(_0x3e8e0d);},'error':function(_0x5e0972){var _0x1b9e4c=_0x26936f;alert(_0x5e0972[_0x1b9e4c(0x130)]);}});}function BreakRoleInheritance(_0x342621){var _0x439fd2=a0_0x5110;url=_spPageContextInfo[_0x439fd2(0x12d)]+_0x439fd2(0x194)+_0x342621+_0x439fd2(0xb7),$[_0x439fd2(0xf8)]({'url':url,'type':_0x439fd2(0x13a),'async':![],'headers':{'accept':_0x439fd2(0x114),'X-RequestDigest':$(_0x439fd2(0x169))[_0x439fd2(0x1a4)]()},'success':function(_0x22b10d){var _0x2be2bb=_0x439fd2;console[_0x2be2bb(0xb9)](_0x22b10d);},'error':function(_0x211f13){var _0x5bd05a=_0x439fd2;console[_0x5bd05a(0xb9)](_0x211f13);}});}function AssignTheEditRole(_0x5ce90f,_0x414c87){var _0x30ad86=a0_0x5110;for(var _0x4c9765=0x0;_0x4c9765<_0x414c87[_0x30ad86(0x1ab)];_0x4c9765++){url=_spPageContextInfo[_0x30ad86(0x12d)]+_0x30ad86(0x194)+_0x5ce90f+_0x30ad86(0x17e)+_0x414c87[_0x4c9765]+_0x30ad86(0xb3),$['ajax']({'url':url,'type':_0x30ad86(0x13a),'async':![],'headers':{'accept':_0x30ad86(0x114),'X-RequestDigest':$(_0x30ad86(0x169))[_0x30ad86(0x1a4)]()},'success':function(_0x43e0e9){var _0x598b95=_0x30ad86;console[_0x598b95(0xb9)](_0x43e0e9);},'error':function(_0x208572){var _0x2f642e=_0x30ad86;console[_0x2f642e(0xb9)](_0x208572);}});}}function IsExistOrNotLibrary(_0x1a606b){var _0x220d91=a0_0x5110,_0xcf54c1='';return url=_spPageContextInfo[_0x220d91(0x12d)]+_0x220d91(0xfd)+_0x1a606b+'\x27',$[_0x220d91(0xf8)]({'url':url,'type':_0x220d91(0x195),'async':![],'headers':{'accept':'application/json;odata=nometadata','X-RequestDigest':$('#__REQUESTDIGEST')[_0x220d91(0x1a4)]()},'success':function(_0x2ed1b4){var _0x285546=_0x220d91;_0x2ed1b4[_0x285546(0x170)][_0x285546(0x1ab)]>0x0?_0xcf54c1=!![]:_0xcf54c1=![],console[_0x285546(0xb9)](_0x2ed1b4);},'error':function(_0x3170ca){console['log'](_0x3170ca);}}),_0xcf54c1;}var SelectClientId='';function GenarateclientGrid(_0xf9fc14){var _0x1fd359=a0_0x5110;$(_0x1fd359(0xf3))[_0x1fd359(0x18d)](),$(_0x1fd359(0xf3))[_0x1fd359(0xab)](_0xf9fc14);}function Selectedcclinte(){var _0x4f8996=a0_0x5110;$(_0x4f8996(0x10b))['val'](ClientInternalMembers[SelectClientId][_0x4f8996(0xb2)]),Client_Id=ClientInternalMembers[SelectClientId]['ID'];ClientInternalMembers[SelectClientId][_0x4f8996(0x116)]!=undefined?$(_0x4f8996(0x11a))[_0x4f8996(0x1a4)](ClientInternalMembers[SelectClientId][_0x4f8996(0x116)]):$('#txtExternalSupervisor')['val']($(_0x4f8996(0x147))[_0x4f8996(0x1a4)]());$(_0x4f8996(0xce)+ClientInternalMembers[SelectClientId][_0x4f8996(0x10a)]+']')[_0x4f8996(0x121)](_0x4f8996(0x1b0),_0x4f8996(0xc7)),$('#TemplateType\x20>\x20[value='+ClientInternalMembers[SelectClientId]['TemplateType']+']')[_0x4f8996(0x121)](_0x4f8996(0x1b0),_0x4f8996(0xc7)),initializePeoplePicker('InternalStakeholders',!![]),peoplePickerDiv=$(_0x4f8996(0x16a)),initializePeoplePicker(_0x4f8996(0xf0),![]),peoplePickerDivsuper=$(_0x4f8996(0xf2));for(var _0x2cfd2f=0x0;_0x2cfd2f<ClientInternalMembers[SelectClientId][_0x4f8996(0x107)][_0x4f8996(0xda)][_0x4f8996(0x1ab)];_0x2cfd2f++){setPeoplePickerUsersInfoCurrent('InternalStakeholders_TopSpan',ClientInternalMembers[SelectClientId]['InternalMembers'][_0x4f8996(0xda)][_0x2cfd2f]['EMail']);}setPeoplePickerUsersInfoCurrent(_0x4f8996(0x148),ClientInternalMembers[SelectClientId][_0x4f8996(0x18b)][_0x4f8996(0x110)]),$(_0x4f8996(0x126))[_0x4f8996(0x121)]('contentEditable','false'),$('#InternalStakeholders')[_0x4f8996(0x121)]('disabled',_0x4f8996(0xf1)),$('#internalsupervisor')[_0x4f8996(0x121)](_0x4f8996(0xf1),'disabled'),$(peoplePickerDiv)[_0x4f8996(0x17a)](_0x4f8996(0x1b3))[_0x4f8996(0xd5)](_0x4f8996(0x15e),'none'),$(peoplePickerDivsuper)['find'](_0x4f8996(0x1b3))[_0x4f8996(0xd5)](_0x4f8996(0x15e),_0x4f8996(0x17d));}var ClientInternalMembers=[];function GetClientMasterTeamDeails(){var _0x35654f=a0_0x5110;Taskusers=[],RestQuery=_0x35654f(0x178),$['when'](CommonFunction[_0x35654f(0x15b)]('ClientMaster',RestQuery))[_0x35654f(0x188)](function(_0x4a1463){var _0x2d8c4e=_0x35654f,_0x2d78db;IsNotTeamMember='';debugger;var _0x104bda='';for(var _0x276d79=0x0;_0x276d79<_0x4a1463[_0x2d8c4e(0xda)][_0x2d8c4e(0x1ab)];_0x276d79++){_0x2d78db=[],_0x2d78db=_0x4a1463['results'][_0x276d79];var _0x2cf14e=_0x2d78db[_0x2d8c4e(0x198)]=_0x2d8c4e(0xc7)?_0x2d78db[_0x2d8c4e(0x198)]:_0x2d8c4e(0x16d);_0x104bda+='\x20\x20<tr\x20class=\x22text-center\x22>'+'<td\x20class=\x22text-left\x22>'+_0x2d8c4e(0x151)+_0x2d8c4e(0xfa)+_0x276d79+_0x2d8c4e(0x108)+_0x276d79+'\x22></label>'+'</div>'+'</td>'+_0x2d8c4e(0x138)+_0x2d8c4e(0x11e)+_0x2d78db[_0x2d8c4e(0xac)]+_0x2d8c4e(0x120)+_0x2d8c4e(0x160)+_0x2d8c4e(0x138)+_0x2d8c4e(0x11e)+_0x2d78db[_0x2d8c4e(0xb2)]+_0x2d8c4e(0x120)+_0x2d8c4e(0x160)+_0x2d8c4e(0x138)+_0x2d8c4e(0x19e)+_0x2d78db[_0x2d8c4e(0x11f)]+'</span>'+_0x2d8c4e(0x160)+_0x2d8c4e(0x138)+_0x2d8c4e(0x11e)+_0x2cf14e+_0x2d8c4e(0x120)+_0x2d8c4e(0x160)+_0x2d8c4e(0xe7),ClientInternalMembers['push']({'Title':_0x2d78db[_0x2d8c4e(0xb2)],'Client_Code':_0x2d78db[_0x2d8c4e(0xac)],'Attn_Name':_0x2d78db[_0x2d8c4e(0x11f)],'Supervisor':_0x2d78db['Supervisor'][_0x2d8c4e(0x110)],'SelfCompany':_0x2d78db[_0x2d8c4e(0x140)],'IsActive':_0x2d78db[_0x2d8c4e(0x198)],'CustType':_0x2d78db[_0x2d8c4e(0x10a)],'TemplateType':_0x2d78db['TemplateType'],'InternalMembers':_0x2d78db[_0x2d8c4e(0x107)],'InternalSupervisor':_0x2d78db[_0x2d8c4e(0x18b)],'ID':_0x2d78db['Id']});}GenarateclientGrid(_0x104bda);});}function selectOnlyThis(_0x6603a8){var _0x1e1778=a0_0x5110;SelectClientId='',SelectClientId=_0x6603a8[_0x1e1778(0x164)]('_')[0x1],$(_0x1e1778(0xc1))['not'](this)[_0x1e1778(0xbd)]('checked',![]),document[_0x1e1778(0x128)](_0x6603a8)[_0x1e1778(0xcc)]=!![];}function a0_0x5110(_0x17f99e,_0x11fa12){var _0x26ac85=a0_0x26ac();return a0_0x5110=function(_0x511047,_0x581226){_0x511047=_0x511047-0xa9;var _0x592484=_0x26ac85[_0x511047];return _0x592484;},a0_0x5110(_0x17f99e,_0x11fa12);}$(document)[a0_0x5dfa68(0x112)](function(){var _0xe6acdc=a0_0x5dfa68;$(_0xe6acdc(0x14d))['on'](_0xe6acdc(0x176),function(){var _0x169b4a=_0xe6acdc,_0x48a6fa=$(this)[_0x169b4a(0x17a)](_0x169b4a(0x1af))[_0x169b4a(0x1a4)]();if(_0x48a6fa=='Customerdd')$('#Customer-box')[_0x169b4a(0x19a)]('d-block'),$(_0x169b4a(0xcf))['addClass'](_0x169b4a(0xba)),$('#Employee-box')['removeClass'](_0x169b4a(0xba)),$('#Employee-box')[_0x169b4a(0xd3)](_0x169b4a(0x153));else _0x48a6fa==_0x169b4a(0x192)&&($(_0x169b4a(0xcf))[_0x169b4a(0x19a)](_0x169b4a(0xba)),$('#Customer-box')[_0x169b4a(0xd3)](_0x169b4a(0x153)),$(_0x169b4a(0x11c))[_0x169b4a(0x19a)](_0x169b4a(0x153)),$('#Employee-box')[_0x169b4a(0xd3)](_0x169b4a(0xba)));}),$('#txtExtEmail')[_0xe6acdc(0xc3)](function(){var _0x54f4cf=_0xe6acdc;email=$('#txtExtEmail')[_0x54f4cf(0x1a4)]();var _0x22a673=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/igm;if(_0x22a673[_0x54f4cf(0xb0)](email)){$(_0x54f4cf(0x1a0))[_0x54f4cf(0x177)](),$(_0x54f4cf(0x17b))['hide'](),$[_0x54f4cf(0x143)](GetItemToListchoice(),GetItemToList(email))[_0x54f4cf(0x188)](function(_0x417a94,_0x2bf83e){var _0xe88bb6=_0x54f4cf;if(_0x2bf83e[_0xe88bb6(0x1ab)]>0x0){var _0x4e25df=GetUserName($(_0xe88bb6(0x147))['val']());_0x4e25df==''&&(GroupId==''&&GetGroupIDByGroupName(),$['when'](AddUserinSharePointGroupforEdit($(_0xe88bb6(0x147))[_0xe88bb6(0x1a4)]()))['done'](function(_0x1c5c65){var _0x294ad9=_0xe88bb6;if(_0x1c5c65==''){cleartextBox(),$(_0x294ad9(0xe2))[_0x294ad9(0x177)](),$(_0x294ad9(0x11d))[_0x294ad9(0x158)](_0x294ad9(0x141));var _0x30d067=0x2;return $('input[name=UpdateEmp][value='+_0x30d067+']')[_0x294ad9(0xbd)](_0x294ad9(0xcc),!![]),alert(_0x294ad9(0x19d)),![];}else _0x4e25df=_0x1c5c65['Title'];}));if(_0x2bf83e[0x0][_0xe88bb6(0x1a2)][_0xe88bb6(0xda)][_0xe88bb6(0x1ab)]>0x0){var _0x217146=_0x2bf83e[0x0]['AttachmentFiles'][_0xe88bb6(0xda)][0x0][_0xe88bb6(0x1b4)];$(_0xe88bb6(0x1a7))['attr'](_0xe88bb6(0x191),_0x217146);}else $(_0xe88bb6(0x1a7))[_0xe88bb6(0x121)]('src',_0xe88bb6(0x1a3));IsUpdate=!![],userListItemId=_0x2bf83e[0x0]['Id'],initializePeoplePicker('InternalStakeholders',!![]),peoplePickerDiv=$(_0xe88bb6(0x16a)),initializePeoplePicker(_0xe88bb6(0xf0),![]),peoplePickerDivsuper=$('[id$=\x27internalsupervisor_TopSpan\x27]');for(var _0x4ea54a=0x0;_0x4ea54a<_0x2bf83e[0x0]['InternalStakeholders'][_0xe88bb6(0xda)][_0xe88bb6(0x1ab)];_0x4ea54a++){setPeoplePickerUsersInfoCurrent(_0xe88bb6(0x142),_0x2bf83e[0x0]['InternalStakeholders'][_0xe88bb6(0xda)][_0x4ea54a]['EMail']);}setPeoplePickerUsersInfoCurrent(_0xe88bb6(0x148),_0x2bf83e[0x0][_0xe88bb6(0x116)][_0xe88bb6(0x110)]),$(_0xe88bb6(0xfb))[_0xe88bb6(0x121)]('disabled',_0xe88bb6(0xf1)),$(_0xe88bb6(0xff))[_0xe88bb6(0x121)](_0xe88bb6(0xf1),_0xe88bb6(0xf1)),$(peoplePickerDiv)[_0xe88bb6(0x17a)](_0xe88bb6(0x1b3))[_0xe88bb6(0xd5)]('display',_0xe88bb6(0x17d)),$(peoplePickerDivsuper)['find'](_0xe88bb6(0x1b3))['css'](_0xe88bb6(0x15e),_0xe88bb6(0x17d)),$(_0xe88bb6(0x136))[_0xe88bb6(0x158)](),$(_0xe88bb6(0x1ac))[_0xe88bb6(0x18d)]();for(var _0x4ea54a=0x0;_0x4ea54a<_0x417a94[_0xe88bb6(0x1ab)];_0x4ea54a++){var _0x11030c=$(_0xe88bb6(0x101));_0x11030c['attr']('value',_0x417a94[_0x4ea54a])[_0xe88bb6(0x102)](_0x417a94[_0x4ea54a]),$(_0xe88bb6(0x1ac))['append'](_0x11030c);}$(_0xe88bb6(0x1a6))[_0xe88bb6(0x1a4)](_0x4e25df),$('#txtExtDesignation')[_0xe88bb6(0x1a4)](_0x2bf83e[0x0][_0xe88bb6(0x15f)]),$(_0xe88bb6(0x11a))[_0xe88bb6(0x1a4)](_0x2bf83e[0x0][_0xe88bb6(0xb5)]),$(_0xe88bb6(0x197))[_0xe88bb6(0x1a4)](_0x2bf83e[0x0][_0xe88bb6(0x156)]),$(_0xe88bb6(0x139))[_0xe88bb6(0x1a4)](_0x2bf83e[0x0][_0xe88bb6(0x14b)]),$(_0xe88bb6(0x10b))[_0xe88bb6(0x1a4)](_0x2bf83e[0x0][_0xe88bb6(0x152)][_0xe88bb6(0xb2)]),Client_Id=_0x2bf83e[0x0]['Client_Name']['Id'],$(_0xe88bb6(0x181))[_0xe88bb6(0x1a4)](_0x2bf83e[0x0]['ReferenceCode']),$('#TemplateType\x20>\x20[value='+_0x2bf83e[0x0][_0xe88bb6(0x16e)]+']')[_0xe88bb6(0x121)](_0xe88bb6(0x1b0),_0xe88bb6(0xc7)),$('#datepickerAD5')[_0xe88bb6(0x1a4)]($[_0xe88bb6(0x179)][_0xe88bb6(0x1a5)](_0xe88bb6(0xe4),new Date(_0x2bf83e[0x0][_0xe88bb6(0x14c)]))),$('#selectByUser\x20>\x20[value='+_0x2bf83e[0x0]['CollaborationType']+']')[_0xe88bb6(0x121)](_0xe88bb6(0x1b0),_0xe88bb6(0xc7)),$(_0xe88bb6(0x133))['hide']();}else IsUpdate=![],$(_0xe88bb6(0x1a6))[_0xe88bb6(0x1a4)](''),$('#txtExtDesignation')[_0xe88bb6(0x1a4)](''),$(_0xe88bb6(0x139))[_0xe88bb6(0x1a4)](''),$(_0xe88bb6(0x181))['val'](''),$(_0xe88bb6(0x1af),$(_0xe88bb6(0x1ac)))[_0xe88bb6(0x1a4)](''),$(_0xe88bb6(0xe3))[_0xe88bb6(0x1a4)]($[_0xe88bb6(0x179)][_0xe88bb6(0x1a5)](_0xe88bb6(0xe4),new Date())),$('option:selected',$('#selectByUser'))[_0xe88bb6(0x1a4)](),$(_0xe88bb6(0x1af),$(_0xe88bb6(0x155)))[_0xe88bb6(0x1a4)](),$(_0xe88bb6(0x136))[_0xe88bb6(0x177)](),$(_0xe88bb6(0x1a7))[_0xe88bb6(0x121)](_0xe88bb6(0x191),_0xe88bb6(0x1a3)),$('#GueastextinputFile')[_0xe88bb6(0x121)](_0xe88bb6(0x191),_0xe88bb6(0x1a3)),initializePeoplePicker(_0xe88bb6(0x10d),!![]),peoplePickerDiv=$(_0xe88bb6(0x16a)),initializePeoplePicker(_0xe88bb6(0xf0),![]),peoplePickerDivsuper=$(_0xe88bb6(0xf2));});if(!IsUpdate)$[_0x54f4cf(0x143)](GetGueastUsers(email))[_0x54f4cf(0x188)](function(_0x18ac40){var _0x3a34af=_0x54f4cf;_0x18ac40[_0x3a34af(0x1ab)]>0x0?(_0x18ac40[0x0][_0x3a34af(0x124)]==_0x3a34af(0xcb)&&($(_0x3a34af(0x133))[_0x3a34af(0x158)](),$('#msgExtEmail')['hide'](),$(_0x3a34af(0x1a6))[_0x3a34af(0x1a4)](_0x18ac40[0x0][_0x3a34af(0x180)])),_0x18ac40[0x0][_0x3a34af(0x124)]==_0x3a34af(0x15d)&&($(_0x3a34af(0x17b))['text'](_0x3a34af(0x119)),$(_0x3a34af(0x17b))['show'](),$('#btnExtSubmit')[_0x3a34af(0x177)]())):($('#msgExtEmail')[_0x3a34af(0x102)](_0x3a34af(0xc6)),$(_0x3a34af(0x17b))['show'](),$(_0x3a34af(0x133))['hide']());});else{}}else $('.msg')[_0x54f4cf(0x177)](),$('.error')[_0x54f4cf(0x158)](),$(_0x54f4cf(0x17b))[_0x54f4cf(0x177)](),$(_0x54f4cf(0x133))[_0x54f4cf(0x177)]();}),$(_0xe6acdc(0x133))[_0xe6acdc(0x125)](function(){AddNewGuest();}),$(_0xe6acdc(0x136))[_0xe6acdc(0x125)](function(){UpdateGeustuser(userListItemId);}),$(_0xe6acdc(0x16b))[_0xe6acdc(0x176)](function(){readURL(this);}),$(_0xe6acdc(0x14a))[_0xe6acdc(0x125)](function(){try{}catch(_0xcf08a6){alert(_0xcf08a6);}});});