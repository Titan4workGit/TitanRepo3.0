var a0_0xdee0b0=a0_0x281d;(function(_0x4eddea,_0x4edd14){var _0x45a3db=a0_0x281d,_0x2d1f4c=_0x4eddea();while(!![]){try{var _0x119378=-parseInt(_0x45a3db(0x2c7))/0x1*(parseInt(_0x45a3db(0x1e7))/0x2)+parseInt(_0x45a3db(0x242))/0x3*(-parseInt(_0x45a3db(0x2f9))/0x4)+-parseInt(_0x45a3db(0x1d7))/0x5*(parseInt(_0x45a3db(0x1ef))/0x6)+parseInt(_0x45a3db(0x22b))/0x7*(-parseInt(_0x45a3db(0x2a2))/0x8)+-parseInt(_0x45a3db(0x247))/0x9*(parseInt(_0x45a3db(0x2b9))/0xa)+-parseInt(_0x45a3db(0x2bf))/0xb+parseInt(_0x45a3db(0x282))/0xc*(parseInt(_0x45a3db(0x212))/0xd);if(_0x119378===_0x4edd14)break;else _0x2d1f4c['push'](_0x2d1f4c['shift']());}catch(_0x2587ca){_0x2d1f4c['push'](_0x2d1f4c['shift']());}}}(a0_0xd0a0,0x33956));var token,ClientId='',ClentSecret='',ClientUrl='',DeferredObj=$[a0_0xdee0b0(0x1d8)](),color_red='',Error=0x0,Ready=0x0,Exits=0x0,lblUpdate=0x0,ErrorUser='',alluserdata,contributersGroupId='',counusers=0x0,excelRows,AllCompanies,AllDepartments,AllOfficeLocation,tabledata,pageIndex,UserEmailId,warningmessage='',userfullname='',AvilableLicenses,ReadySelected=[],MiisingSelected=[],AddedEmployeeList=[],IsMiisingSelect,isReadeySelect,peoplePickerDiv='',EmployeeId='',EmployeeDepartment='',EmployeeOfficeLocation='',checkedAudience='';$(document)[a0_0xdee0b0(0x1ff)](function(){var _0x23ba4a=a0_0xdee0b0;$(_0x23ba4a(0x208))[_0x23ba4a(0x280)](function(){var _0x405ed4=_0x23ba4a;window[_0x405ed4(0x1f5)][_0x405ed4(0x203)]=_spPageContextInfo[_0x405ed4(0x279)]+_0x405ed4(0x2ad);}),GraphAccessTokenTogetUserDetails(),GetCompanies(),GetOfficeLocation(),GetDepartments(),LoadShowUser([]),GetAllUserId(),GetEmployees(),$(_0x23ba4a(0x291))[_0x23ba4a(0x2d5)](AvilableLicenses);});function initializePeoplePicker(_0x361f9f){var _0x2a4dd3=a0_0xdee0b0,_0x52ec87={};_0x52ec87[_0x2a4dd3(0x233)]='User,DL,SecGroup,SPGroup',_0x52ec87['SearchPrincipalSource']=0xf,_0x52ec87[_0x2a4dd3(0x25c)]=0xf,_0x52ec87['AllowMultipleValues']=![],_0x52ec87[_0x2a4dd3(0x269)]=0x32,_0x52ec87[_0x2a4dd3(0x2c3)]=_0x2a4dd3(0x210),this[_0x2a4dd3(0x1f4)](_0x361f9f,null,_0x52ec87),$(_0x2a4dd3(0x2f3))[_0x2a4dd3(0x2da)](0xfa);}function GetSelectItem(){var _0x36624e=a0_0xdee0b0;if(contributersGroupId!==''){var _0x453f25=tabledata[_0x36624e(0x1cd)]();counusers=0x0,IsaddedNewEmployee=![];for(var _0x447cc3=0x0;_0x447cc3<_0x453f25['length'];_0x447cc3++){var _0x1f223d=alluserdata['filter'](function(_0x2c98fe){var _0xe5ebf2=_0x36624e;return _0x2c98fe[_0xe5ebf2(0x274)]==_0x453f25[_0x447cc3]['_row'][_0xe5ebf2(0x2e3)]['Email'];});AvilableLicenses>0x0?_0x1f223d[0x0][_0x36624e(0x2c4)]=='Ready'?IsaddedNewEmployee=AddNewEmployeeAllocated(_0x1f223d,_0x36624e(0x226)):_0x1f223d[0x0][_0x36624e(0x2c4)]=='Already\x20Exist'&&UpdateExistingEmployeeAllocated(_0x1f223d,_0x36624e(0x226)):($(_0x36624e(0x284))[_0x36624e(0x2d5)](counusers),alert(_0x36624e(0x1f9)),_0x447cc3=_0x453f25['length']);}warningmessage!=''&&(warningmessage+=userfullname,alert(warningmessage)),$(_0x36624e(0x284))[_0x36624e(0x2d5)](counusers),showmessage(),tabledata[_0x36624e(0x1c7)](excelRows),tabledata[_0x36624e(0x27b)](pageIndex),IsaddedNewEmployee&&($(_0x36624e(0x1f0))['modal']({'backdrop':'static','keyboard':![]},_0x36624e(0x29c)),AddedEmployeeList[_0x36624e(0x2e8)]>0x0?$(_0x36624e(0x23f))[_0x36624e(0x29c)]():$(_0x36624e(0x23f))[_0x36624e(0x271)]());}else $(_0x36624e(0x240))[_0x36624e(0x286)]()[_0x36624e(0x27d)](0x7d0)['fadeOut'](),GetGroupIDByGroupName(),GetSelectItem();}$(a0_0xdee0b0(0x275))[a0_0xdee0b0(0x280)](function(){var _0x46617b=a0_0xdee0b0;$[_0x46617b(0x1bf)]({'cache':![],'beforeSend':function(){var _0x16a3ba=_0x46617b;$(_0x16a3ba(0x293))[_0x16a3ba(0x286)]();},'success':function(_0x49f2d4){var _0x19174c=_0x46617b;AzureUsrlist=[],GetAzureUsrlist(AdusersUrl,token),excelRows=[];for(var _0x2866f1=0x0;_0x2866f1<AzureUsrlist[_0x19174c(0x2e8)];_0x2866f1++){if(AzureUsrlist[_0x2866f1][_0x19174c(0x1e3)]!=null&&AzureUsrlist[_0x2866f1][_0x19174c(0x2ee)]==!![]){if(AzureUsrlist[_0x2866f1][_0x19174c(0x234)]!='PendingAcceptance'){var _0x5c8e4c=EmployeeListUsers['filter'](function(_0x63c9f5){var _0x4eea39=_0x19174c;return _0x63c9f5['Email']['toLowerCase']()==AzureUsrlist[_0x2866f1][_0x4eea39(0x1e3)]['toLowerCase']();}),_0x441143=AllCompanies[_0x19174c(0x235)](function(_0x2c4370){var _0x24df02=_0x19174c;if(AzureUsrlist[_0x2866f1][_0x24df02(0x296)]!=null)return _0x2c4370[_0x24df02(0x2f6)][_0x24df02(0x1f6)]()==AzureUsrlist[_0x2866f1]['companyName'][_0x24df02(0x1f6)]();}),_0x376b99=0x0;_0x441143[_0x19174c(0x2e8)]>0x0?_0x376b99=_0x441143[0x0]['Id']:_0x376b99=parseInt(Logged_CompanyId);var _0x1623d9=AllOfficeLocation[_0x19174c(0x235)](function(_0x54903e){var _0x346185=_0x19174c;if(AzureUsrlist[_0x2866f1][_0x346185(0x2af)]!=null)return _0x54903e['Title'][_0x346185(0x1f6)]()==AzureUsrlist[_0x2866f1]['officeLocation'][_0x346185(0x1f6)]();}),_0x2099d6=0x0;_0x1623d9[_0x19174c(0x2e8)]>0x0&&(_0x2099d6=_0x1623d9[0x0]['Id']);var _0x307466=AllDepartments[_0x19174c(0x235)](function(_0x3b3429){var _0x447ae7=_0x19174c;if(AzureUsrlist[_0x2866f1][_0x447ae7(0x229)]!=null)return _0x3b3429['Title'][_0x447ae7(0x1f6)]()==AzureUsrlist[_0x2866f1][_0x447ae7(0x229)]['toLowerCase']();}),_0x1c6ea8=0x0;_0x307466['length']>0x0&&(_0x1c6ea8=_0x307466[0x0]['Id']);var _0xaa0860='',_0x4fb8a2='';AzureUsrlist[_0x2866f1]['manager']!=undefined&&(_0xaa0860=AzureUsrlist[_0x2866f1][_0x19174c(0x1c4)][_0x19174c(0x1e3)]);AzureUsrlist[_0x2866f1]['employeeHireDate']!=undefined||AzureUsrlist[_0x2866f1][_0x19174c(0x285)]!=null?(_0x4fb8a2=new Date(AzureUsrlist[_0x2866f1][_0x19174c(0x285)]),_0x4fb8a2=$[_0x19174c(0x24c)][_0x19174c(0x2d3)](_0x19174c(0x297),_0x4fb8a2)):(_0x4fb8a2=new Date(),_0x4fb8a2=$[_0x19174c(0x24c)][_0x19174c(0x2d3)](_0x19174c(0x297),_0x4fb8a2));if(_0x5c8e4c[_0x19174c(0x2e8)]==0x0){var _0x3b3152=AzureUsrlist[_0x2866f1][_0x19174c(0x29e)]==_0x19174c(0x2ac)?'External':_0x19174c(0x1c5);excelRows[_0x19174c(0x2bc)]({'Id':_0x2866f1,'Name':AzureUsrlist[_0x2866f1][_0x19174c(0x2e2)],'Email':AzureUsrlist[_0x2866f1][_0x19174c(0x1e3)],'Type':_0x3b3152,'Department':_0x1c6ea8,'Company':_0x376b99,'DepartmentName':AzureUsrlist[_0x2866f1]['department'],'CompanyName':AzureUsrlist[_0x2866f1][_0x19174c(0x296)],'country':AzureUsrlist[_0x2866f1][_0x19174c(0x1c1)],'DateOfJoining':_0x4fb8a2,'employeeId':AzureUsrlist[_0x2866f1]['employeeId'],'Manager':_0xaa0860,'postalCode':AzureUsrlist[_0x2866f1][_0x19174c(0x21d)],'state':AzureUsrlist[_0x2866f1][_0x19174c(0x266)],'streetAddress':AzureUsrlist[_0x2866f1][_0x19174c(0x267)],'city':AzureUsrlist[_0x2866f1][_0x19174c(0x224)],'mobilePhone':AzureUsrlist[_0x2866f1][_0x19174c(0x2f7)],'Location':_0x2099d6,'LocationName':AzureUsrlist[_0x2866f1][_0x19174c(0x2af)],'otherMails':AzureUsrlist[_0x2866f1][_0x19174c(0x26e)][0x0],'Designation':AzureUsrlist[_0x2866f1]['jobTitle']});}}}}Ready=0x0,Error=0x0,lblUpdate=0x0,counusers=0x0,Exits=0x0,$(_0x19174c(0x2dd))[_0x19174c(0x2d5)](0x0),$(_0x19174c(0x22f))[_0x19174c(0x2d5)](0x0),$(_0x19174c(0x284))[_0x19174c(0x2d5)](0x0),$(_0x19174c(0x1bc))[_0x19174c(0x2d5)](0x0),$(_0x19174c(0x20b))[_0x19174c(0x2d5)](0x0);for(var _0x2866f1=0x0;_0x2866f1<excelRows[_0x19174c(0x2e8)];_0x2866f1++){var _0x1bb22a='',_0xa6b9dc=AzureUsrlist[_0x19174c(0x235)](function(_0x4a209f){var _0x3657be=_0x19174c;if(_0x4a209f['mail']!=null){var _0x1add56=_0x4a209f[_0x3657be(0x1e3)][_0x3657be(0x1f6)]();return _0x1add56==excelRows[_0x2866f1][_0x3657be(0x274)][_0x3657be(0x1f6)]();}});if(_0xa6b9dc[_0x19174c(0x2e8)]>0x0){_0x1bb22a=_0xa6b9dc[0x0][_0x19174c(0x2e2)];var _0x236f3a=AllCompanies[_0x19174c(0x235)](function(_0x4454fd){return _0x4454fd['ID']==excelRows[_0x2866f1]['Company'];}),_0x3fb5a0=AllDepartments[_0x19174c(0x235)](function(_0x3f7041){var _0x3ad1e0=_0x19174c;return _0x3f7041['ID']==excelRows[_0x2866f1][_0x3ad1e0(0x1da)];}),_0x31122b=AllOfficeLocation[_0x19174c(0x235)](function(_0x3d5403){var _0x2248a4=_0x19174c;return _0x3d5403['ID']==excelRows[_0x2866f1][_0x2248a4(0x2fb)];});_0x236f3a[_0x19174c(0x2e8)]>0x0&&_0x3fb5a0['length']>0x0&&_0x31122b[_0x19174c(0x2e8)]>0x0?(Ready=Ready+0x1,ErrorUser=_0x19174c(0x1fc)):(ErrorUser=_0x19174c(0x251),Error=Error+0x1);}else ErrorUser=_0x19174c(0x1fe),color_red=_0x19174c(0x1cb),Error=Error+0x1;excelRows[_0x2866f1][_0x19174c(0x2c4)]=ErrorUser;}alluserdata=excelRows,LoadShowUser(excelRows),$(_0x19174c(0x293))['fadeOut']();}});});var Temparray=[];$(a0_0xdee0b0(0x2bd))[a0_0xdee0b0(0x280)](function(){var _0x1204f2=a0_0xdee0b0;debugger;Temparray=alluserdata;let _0x43aaf3=[...new Set(Temparray[_0x1204f2(0x265)](_0x41a432=>_0x41a432[_0x1204f2(0x206)]))];var _0x46c08a=document[_0x1204f2(0x1ce)]('ddlfilterAllCompanies');_0x46c08a['innerHTML']='',opt['value']='0',opt[_0x1204f2(0x2d5)]=_0x1204f2(0x301),_0x46c08a[_0x1204f2(0x21b)](opt);for(var _0x628e24=0x0;_0x628e24<_0x43aaf3[_0x1204f2(0x2e8)];_0x628e24++){opt=document['createElement']('option'),opt['value']=_0x43aaf3[_0x628e24],opt[_0x1204f2(0x2d5)]=_0x43aaf3[_0x628e24],_0x46c08a[_0x1204f2(0x21b)](opt);}Temparray=alluserdata;var _0x35d3c2=[...new Set(Temparray[_0x1204f2(0x265)](_0x57b9d1=>_0x57b9d1[_0x1204f2(0x29a)]))],_0x46c08a=document[_0x1204f2(0x1ce)](_0x1204f2(0x218)),_0x3bfe47='<option\x20value=\x220\x22><strong>All</strong></option>';for(var _0x628e24=0x0;_0x628e24<_0x35d3c2['length'];_0x628e24++){_0x3bfe47+='<option\x20value=\x22'+_0x35d3c2[_0x628e24]+'\x22>'+_0x35d3c2[_0x628e24]+'</option>';}$(_0x1204f2(0x289))[_0x1204f2(0x222)](_0x3bfe47),Temparray=alluserdata;let _0x105a66=[...new Set(Temparray[_0x1204f2(0x265)](_0x7a38fd=>_0x7a38fd[_0x1204f2(0x1da)]))];var _0x46c08a=document[_0x1204f2(0x1ce)](_0x1204f2(0x25d));_0x46c08a[_0x1204f2(0x2dc)]='',opt['value']='0',opt['text']='All',_0x46c08a['appendChild'](opt);for(var _0x628e24=0x0;_0x628e24<_0x105a66[_0x1204f2(0x2e8)];_0x628e24++){opt=document[_0x1204f2(0x230)](_0x1204f2(0x2f5)),opt[_0x1204f2(0x2b6)]=_0x105a66[_0x628e24],opt['text']=_0x105a66[_0x628e24],_0x46c08a[_0x1204f2(0x21b)](opt);}}),$('#btnfiltervalue')[a0_0xdee0b0(0x280)](function(){var _0x2c8bc3=a0_0xdee0b0;let _0x171152;var _0x3e8b55='',_0x5e4308=!![];$(_0x2c8bc3(0x1e1))[_0x2c8bc3(0x23c)]()!='0'&&(_0x5e4308=![]);if($(_0x2c8bc3(0x2ec))['val']()!='0')_0x5e4308=![];else return alert(_0x2c8bc3(0x1be)),![];if($(_0x2c8bc3(0x289))[_0x2c8bc3(0x23c)]()!='0')_0x5e4308=![];else return alert('Please\x20select\x20Location'),![];_0x171152=alluserdata['filter'](function(_0x2ecab2){var _0x37a7f7=_0x2c8bc3;return _0x2ecab2[_0x37a7f7(0x2fb)]==$(_0x37a7f7(0x25b),$('#ddlfilterOfficeLocation'))[_0x37a7f7(0x23c)]()&&_0x2ecab2['Department']==$('option:selected',$(_0x37a7f7(0x2ec)))[_0x37a7f7(0x23c)]()&&_0x2ecab2[_0x37a7f7(0x1c3)]==$(_0x37a7f7(0x25b),$(_0x37a7f7(0x1e1)))[_0x37a7f7(0x23c)]();});var _0x3df9a2=alluserdata[_0x2c8bc3(0x26a)](_0x4415ce=>_0x4415ce[_0x2c8bc3(0x2fb)]===$('option:selected',$(_0x2c8bc3(0x289)))[_0x2c8bc3(0x23c)]()&&_0x4415ce['Department']==$(_0x2c8bc3(0x25b),$(_0x2c8bc3(0x2ec)))[_0x2c8bc3(0x23c)]()&&_0x4415ce[_0x2c8bc3(0x1c3)]==$(_0x2c8bc3(0x25b),$(_0x2c8bc3(0x1e1)))['val']());_0x5e4308?LoadShowUser(alluserdata):LoadShowUser(_0x171152);}),$(a0_0xdee0b0(0x253))[a0_0xdee0b0(0x292)](function(_0x8c3e61){var _0x5b1097=a0_0xdee0b0;LoadShowUser(search($(_0x5b1097(0x253))[_0x5b1097(0x23c)]()));});function search(_0x177b8b){var _0xf911f8=a0_0xdee0b0;return alluserdata[_0xf911f8(0x235)](({Name:_0x3740e6,Email:_0x50cf93})=>{var _0x18fea7=_0xf911f8;return _0x3740e6[_0x18fea7(0x1f6)]()[_0x18fea7(0x2fd)](_0x177b8b[_0x18fea7(0x1f6)]())>-0x1||_0x50cf93[_0x18fea7(0x1f6)]()[_0x18fea7(0x2fd)](_0x177b8b[_0x18fea7(0x1f6)]())>-0x1;});}$(a0_0xdee0b0(0x273))[a0_0xdee0b0(0x280)](function(){var _0x754c13=a0_0xdee0b0;$[_0x754c13(0x1bf)]({'cache':![],'beforeSend':function(){var _0xf2da00=_0x754c13;$(_0xf2da00(0x293))[_0xf2da00(0x286)]();},'success':function(_0x3e6cae){var _0x4ba5d3=_0x754c13;AddedEmployeeList=[],SubmitReady(),$('#overlaysearch')[_0x4ba5d3(0x1e9)]();}});});function SubmitReady(){var _0xf621a2=a0_0xdee0b0;if(contributersGroupId!==''){var _0x5a31de=tabledata['getSelectedRows']();counusers=0x0,IsaddedNewEmployee=![];for(var _0x49a29a=0x0;_0x49a29a<_0x5a31de[_0xf621a2(0x2e8)];_0x49a29a++){var _0x91eaae=alluserdata['filter'](function(_0x1d6402){var _0x43c7ad=_0xf621a2;return _0x1d6402[_0x43c7ad(0x274)]==_0x5a31de[_0x49a29a][_0x43c7ad(0x2ef)][_0x43c7ad(0x2e3)][_0x43c7ad(0x274)];});if(AvilableLicenses>0x0)_0x91eaae[0x0][_0xf621a2(0x2c4)]=='Ready'?IsaddedNewEmployee=AddNewEmployeeAllocated(_0x91eaae,_0xf621a2(0x226)):_0x91eaae[0x0][_0xf621a2(0x2c4)]=='Already\x20Exist'&&UpdateExistingEmployeeAllocated(_0x91eaae,'Employees');else return alert(_0xf621a2(0x1f9)),![];}warningmessage!=''&&(warningmessage+=userfullname,alert(warningmessage)),$(_0xf621a2(0x284))[_0xf621a2(0x2d5)](counusers),showmessage(),tabledata[_0xf621a2(0x1c7)](excelRows),tabledata[_0xf621a2(0x27b)](pageIndex),IsaddedNewEmployee&&($(_0xf621a2(0x1f0))[_0xf621a2(0x223)]({'backdrop':_0xf621a2(0x2a4),'keyboard':![]},_0xf621a2(0x29c)),AddedEmployeeList['length']>0x0?$(_0xf621a2(0x23f))[_0xf621a2(0x29c)]():$(_0xf621a2(0x23f))[_0xf621a2(0x271)]());}else GetGroupIDByGroupName(),GetSelectItem();}$(a0_0xdee0b0(0x2cf))['on']('click',function(){var _0x206f4a=a0_0xdee0b0;$[_0x206f4a(0x1bf)]({'cache':![],'beforeSend':function(){var _0x37f344=_0x206f4a;$(_0x37f344(0x293))[_0x37f344(0x286)]();},'success':function(_0xb1e17b){var _0x25c818=_0x206f4a;if(AddedEmployeeList[_0x25c818(0x2e8)]>0x0&&checkedAudience!=_0x25c818(0x2b2))for(var _0x5f246f=0x0;_0x5f246f<AddedEmployeeList[_0x25c818(0x2e8)];_0x5f246f++){var _0x486aee=new Date(AddedEmployeeList[_0x5f246f][_0x25c818(0x1d2)][_0x25c818(0x2cb)]),_0x502c66=new Date();_0x502c66[_0x25c818(0x2c0)](_0x486aee[_0x25c818(0x231)]()+0x3),_0x486aee=$[_0x25c818(0x24c)]['formatDate'](_0x25c818(0x297),_0x486aee),_0x502c66=$['datepicker'][_0x25c818(0x2d3)](_0x25c818(0x297),_0x502c66);var _0x2b4ee1=new Date(AddedEmployeeList[_0x5f246f]['Metadata']['JoiningDate']);_0x2b4ee1=$['datepicker']['formatDate'](_0x25c818(0x27a),_0x2b4ee1);var _0x46ab24=[],_0x59a89e=[],_0x359843=[];_0x359843[_0x25c818(0x2bc)](Logged_CompanyId);var _0x4eccb4;_0x4eccb4={'__metadata':{'type':'SP.Data.AnnouncementsListItem'}},(_0x4eccb4[_0x25c818(0x2d1)]=_0x25c818(0x1fb),_0x4eccb4['EmployeeID']=AddedEmployeeList[_0x5f246f][_0x25c818(0x294)][_0x25c818(0x1d5)](),_0x4eccb4[_0x25c818(0x302)]='New\x20Joinee',_0x4eccb4['EmployeeName']=AddedEmployeeList[_0x5f246f][_0x25c818(0x1d2)][_0x25c818(0x1e8)],_0x4eccb4[_0x25c818(0x1ed)]=AddedEmployeeList[_0x5f246f]['Metadata'][_0x25c818(0x1ed)],_0x4eccb4[_0x25c818(0x1da)]=AddedEmployeeList[_0x5f246f]['EmployeeDepartment'],_0x4eccb4['OfficeLocation']=AddedEmployeeList[_0x5f246f][_0x25c818(0x28e)],_0x4eccb4[_0x25c818(0x2c5)]='Internal\x20Users',_0x4eccb4[_0x25c818(0x268)]=_0x25c818(0x1fb),_0x4eccb4[_0x25c818(0x2ca)]=checkedAudience,_0x4eccb4['ApprovalStatus']='Approved',_0x4eccb4['Publish_Date']=_0x486aee,_0x4eccb4[_0x25c818(0x254)]=_0x502c66,_0x4eccb4[_0x25c818(0x20d)]='DOJ:\x20'+_0x2b4ee1);if(checkedAudience=='Corporate')_0x359843=[0x0],_0x46ab24=[0x0],_0x59a89e=[0x0],_0x4eccb4[_0x25c818(0x22c)]={'results':_0x359843},_0x4eccb4[_0x25c818(0x2c9)]={'results':_0x59a89e},_0x4eccb4[_0x25c818(0x2df)]={'results':_0x46ab24};else{if(checkedAudience==_0x25c818(0x1c3))_0x359843[_0x25c818(0x2bc)](AddedEmployeeList[_0x5f246f][_0x25c818(0x1d2)]['CompanyId']),_0x46ab24=[0x0],_0x59a89e=[0x0],_0x4eccb4[_0x25c818(0x22c)]={'results':_0x359843},_0x4eccb4[_0x25c818(0x2c9)]={'results':_0x59a89e},_0x4eccb4['OfficeLocationsId']={'results':_0x46ab24};else{if(checkedAudience==_0x25c818(0x1da))_0x359843=[0x0],_0x46ab24=[0x0],_0x59a89e['push'](AddedEmployeeList[_0x5f246f][_0x25c818(0x1d2)]['DepartmentId']),_0x4eccb4['CompanyId']={'results':_0x359843},_0x4eccb4[_0x25c818(0x2c9)]={'results':_0x59a89e},_0x4eccb4['OfficeLocationsId']={'results':_0x46ab24};else checkedAudience==_0x25c818(0x2fb)&&(_0x359843=[0x0],_0x46ab24[_0x25c818(0x2bc)](AddedEmployeeList[_0x5f246f][_0x25c818(0x1d2)][_0x25c818(0x2ab)]),_0x59a89e=[0x0],_0x4eccb4[_0x25c818(0x22c)]={'results':_0x359843},_0x4eccb4[_0x25c818(0x2c9)]={'results':_0x59a89e},_0x4eccb4[_0x25c818(0x2df)]={'results':_0x46ab24});}}InsertWelcomeInAnnouncementList(_0x4eccb4);}$(_0x25c818(0x293))[_0x25c818(0x1e9)]();}});}),$(a0_0xdee0b0(0x214))[a0_0xdee0b0(0x263)](function(){var _0x3469b2=a0_0xdee0b0;checkedAudience=this[_0x3469b2(0x2b6)];});function isReadeySelecteds(){var _0x2ab89a=a0_0xdee0b0;isReadeySelect=document[_0x2ab89a(0x1ce)](_0x2ab89a(0x27c));if(isReadeySelect[_0x2ab89a(0x28d)]){tabledata[_0x2ab89a(0x200)](MiisingSelected),$(_0x2ab89a(0x1bd))[_0x2ab89a(0x205)]('checked',![]),$('#IsMiisingSelected')['prop'](_0x2ab89a(0x28d),![]),ReadySelected=[];for(var _0x1b39ec=0x0;_0x1b39ec<excelRows[_0x2ab89a(0x2e8)];_0x1b39ec++){(excelRows[_0x1b39ec][_0x2ab89a(0x2c4)]=='Ready'||excelRows[_0x1b39ec][_0x2ab89a(0x2c4)]==_0x2ab89a(0x252))&&ReadySelected['push'](_0x1b39ec);}$(_0x2ab89a(0x23d))[_0x2ab89a(0x205)](_0x2ab89a(0x28d),!![]),tabledata['selectRow'](ReadySelected);}else tabledata[_0x2ab89a(0x200)](ReadySelected),$(_0x2ab89a(0x23d))[_0x2ab89a(0x205)](_0x2ab89a(0x28d),![]);}function IsMiisingSelecteds(){var _0x44d7e6=a0_0xdee0b0;IsMiisingSelect=document[_0x44d7e6(0x1ce)]('IsMiisingSelected');if(IsMiisingSelect[_0x44d7e6(0x28d)]){tabledata[_0x44d7e6(0x200)](ReadySelected),$('#isReadeySelected')[_0x44d7e6(0x205)](_0x44d7e6(0x28d),![]),$(_0x44d7e6(0x23d))[_0x44d7e6(0x205)](_0x44d7e6(0x28d),![]),MiisingSelected=[];for(var _0x54f96b=0x0;_0x54f96b<excelRows[_0x44d7e6(0x2e8)];_0x54f96b++){(excelRows[_0x54f96b][_0x44d7e6(0x2c4)]==_0x44d7e6(0x251)||excelRows[_0x54f96b][_0x44d7e6(0x2c4)]=='Already\x20Exist'||excelRows[_0x54f96b]['Status']==_0x44d7e6(0x1fc))&&(MiisingSelected[_0x44d7e6(0x2bc)](_0x54f96b),$(_0x44d7e6(0x1bd))[_0x44d7e6(0x205)]('checked',!![]));}tabledata['selectRow'](MiisingSelected);}else tabledata[_0x44d7e6(0x200)](MiisingSelected),$(_0x44d7e6(0x1bd))[_0x44d7e6(0x205)](_0x44d7e6(0x28d),![]);}function AssignPermissiononDMSLibary(_0x2f7c05,_0x1cc840,_0x36c197){var _0x31a017=a0_0xdee0b0,_0x4db019={'Accept':_0x31a017(0x22d),'content-Type':_0x31a017(0x22d),'X-RequestDigest':jQuery(_0x31a017(0x23e))[_0x31a017(0x23c)]()},_0x186871=_0x36c197+_0x31a017(0x1c6)+_0x2f7c05+',roleDefId='+_0x1cc840+')';$[_0x31a017(0x1bf)]({'url':_0x186871,'type':_0x31a017(0x1e2),'headers':_0x4db019,'dataType':_0x31a017(0x2ae),'async':![],'success':function(_0x19c3da){var _0x114ab7=_0x31a017;console['log'](_0x114ab7(0x1d4));},'error':function(_0x3d1451){var _0x35a7e0=_0x31a017;console[_0x35a7e0(0x28a)](JSON[_0x35a7e0(0x2a8)](_0x3d1451)),Permissionloder['close']();}});}function GetGroupIDByGroupName(){var _0x1127df=a0_0xdee0b0,_0x1a062e=_spPageContextInfo[_0x1127df(0x279)]+_0x1127df(0x1c9);$[_0x1127df(0x1bf)]({'url':_0x1a062e,'method':_0x1127df(0x298),'async':![],'headers':{'Accept':_0x1127df(0x259)},'success':function(_0x2139e8){contributersGroupId=_0x2139e8['d']['Id'];},'error':function(_0x475f57){console['log'](_0x475f57);}});}function GetListItems(_0x47eacf,_0x171cd8){var _0x33142c=a0_0xdee0b0,_0x4ce8a8,_0x8c7276=_spPageContextInfo[_0x33142c(0x279)]+_0x33142c(0x1fd)+_0x47eacf+_0x33142c(0x24b)+_0x171cd8+'&$top=1';return $[_0x33142c(0x1bf)]({'url':_0x8c7276,'method':_0x33142c(0x298),'async':![],'headers':{'Accept':_0x33142c(0x259)},'success':function(_0x2f461a){var _0xcff341=_0x33142c;_0x2f461a['d'][_0xcff341(0x202)][_0xcff341(0x2e8)]>0x0?_0x4ce8a8=![]:_0x4ce8a8=!![];},'error':function(_0x38546d){var _0x50b9ee=_0x33142c;console[_0x50b9ee(0x28a)](_0x38546d);}}),_0x4ce8a8;}function GetCompanies(){var _0x3222ab=a0_0xdee0b0,_0xa220c4=_spPageContextInfo[_0x3222ab(0x279)]+_0x3222ab(0x2b4);$[_0x3222ab(0x1bf)]({'url':_0xa220c4,'method':_0x3222ab(0x298),'async':![],'headers':{'Accept':_0x3222ab(0x259)},'success':function(_0xf542e3){var _0x24f5dc=_0x3222ab;AllCompanies=_0xf542e3['d'][_0x24f5dc(0x202)];},'error':function(_0x36ac32){var _0x54d188=_0x3222ab;console[_0x54d188(0x28a)](_0x36ac32);}});}function GetDepartments(){var _0x21020a=a0_0xdee0b0,_0x1ab403=_spPageContextInfo[_0x21020a(0x279)]+_0x21020a(0x2f8);$[_0x21020a(0x1bf)]({'url':_0x1ab403,'method':_0x21020a(0x298),'async':![],'headers':{'Accept':'application/json;\x20odata=verbose'},'success':function(_0x101ccb){AllDepartments=_0x101ccb['d']['results'];},'error':function(_0x2d13bd){var _0x338e3a=_0x21020a;console[_0x338e3a(0x28a)](_0x2d13bd);}});}function GetOfficeLocation(){var _0x292551=a0_0xdee0b0,_0x225a59=_spPageContextInfo[_0x292551(0x279)]+_0x292551(0x306);$['ajax']({'url':_0x225a59,'method':_0x292551(0x298),'async':![],'headers':{'Accept':_0x292551(0x259)},'success':function(_0x3ddc12){var _0x177420=_0x292551;AllOfficeLocation=_0x3ddc12['d'][_0x177420(0x202)];},'error':function(_0x101636){var _0x2b6353=_0x292551;console[_0x2b6353(0x28a)](_0x101636);}});}function GetSubSiteUrl(_0x1decae,_0x5c1e5a){var _0x11239d=a0_0xdee0b0,_0x534793,_0x257b5d=_spPageContextInfo[_0x11239d(0x279)]+_0x11239d(0x1fd)+_0x1decae+_0x11239d(0x25f)+_0x5c1e5a+'&$top=1';return $[_0x11239d(0x1bf)]({'url':_0x257b5d,'method':_0x11239d(0x298),'async':![],'headers':{'Accept':'application/json;\x20odata=verbose'},'success':function(_0x129099){var _0x47cee2=_0x11239d;_0x534793=_0x129099['d'][_0x47cee2(0x202)][0x0][_0x47cee2(0x220)];},'error':function(_0x2414a2){var _0x490169=_0x11239d;console[_0x490169(0x28a)](_0x2414a2);}}),_0x534793;}function AddUserinSharePointGroup(_0x4a143a){var _0x562d15=a0_0xdee0b0,_0x3834d9=$[_0x562d15(0x1d8)](),_0xce8e79=_0x562d15(0x2ce),_0x155ff9=_0xce8e79+_0x4a143a,_0x4182fe=_spPageContextInfo[_0x562d15(0x279)]+'/_api/web/sitegroups('+contributersGroupId+_0x562d15(0x1f1);$[_0x562d15(0x1bf)]({'url':_0x4182fe,'type':'POST','async':![],'data':JSON[_0x562d15(0x2a8)]({'__metadata':{'type':_0x562d15(0x2bb)},'LoginName':_0x155ff9}),'headers':{'accept':_0x562d15(0x22d),'content-type':_0x562d15(0x22d),'X-RequestDigest':$(_0x562d15(0x23e))['val']()},'success':_0x2a5909,'error':_0x17f417});function _0x2a5909(_0x3528ce){var _0x114a5b=_0x562d15;_0x3834d9[_0x114a5b(0x2db)](_0x3528ce['d']['Id']),console[_0x114a5b(0x28a)](_0x114a5b(0x262));}function _0x17f417(_0x137b93){var _0x5c82ea=_0x562d15;console['log'](JSON[_0x5c82ea(0x2a8)](_0x137b93));}return _0x3834d9[_0x562d15(0x1cf)]();}function a0_0xd0a0(){var _0x154c04=['find','chkManager','EmployeeSyncreport','left','otherMails','row','/_api/web/lists/GetByTitle(\x27Announcements\x27)/items','hide','Not\x20SP\x20Permission','#btnsubmitready','Email','#btnadsync','https://graph.microsoft.com','Wrong\x20Manager','The\x20following\x20users\x20failed\x20to\x20sync\x20due\x20to\x20wrong\x20manager\x20defined!.\x0a','webAbsoluteUrl','dd\x20M\x20yy','setPage','isReadeySelected','delay','Department\x20*','_cell','click','chkDesignation','15285876aSzQAI','/_api/web/lists/GetByTitle(\x27','#added','employeeHireDate','fadeIn','EmpUserId','Chief\x20Executive','#ddlfilterOfficeLocation','log','center','focus','checked','EmployeeOfficeLocation','done','[id$=\x27AssaginTomanager_TopSpan\x27]','#AvilableLicenses','keyup','#overlaysearch','EmployeeId','#txtGroup','companyName','mm/dd/yy','GET','getRow','Location\x20*','files','show','chkGroup','userType','Gender','reject','EmployeeSyncReport.xlsx','80tmjbvW','EnvironmentalSettings','static','deselect','@odata.nextLink','Worng\x20Manager','stringify','/_api/web/lists/GetByTitle(\x27Employees\x27)/items?$top=999&$select=ID,AttachmentFiles,FullName,Designation,Manager,MobileNumber,ExtensionName,Email,LogonName/UserName,Department/DepartmentName,Company/CompanyName,Company/ID,OfficeLocation/ID,OfficeLocation/OfficeName&$orderby=FullName&$expand=LogonName,OfficeLocation,Company,Department,AttachmentFiles\x20&$filter=\x20PrimaryCompany\x20eq\x20\x27Primary\x27\x20and\x20Status\x20eq\x20\x27Active\x27\x20','DepartmentName','OfficeLocationId','Guest','/Pages/Show_Employee.aspx?WebAppId=2','json','officeLocation','\x20<span\x20style=\x27color:red;\x20font-weight:bold;\x27>','removeProp','NotSave','Home\x20Address','/_api/web/lists/getByTitle(\x27Companies\x27)/items?$select=*','result','value','Data\x20Send\x20to\x20Announcements','#ddlOfficeLocation','3435890wYCNcE','SP.Data.','SP.User','push','#btnFilter','chkTopExecutive','559460NNIxie','setMonth','#btnUploadExcel','error1','Width','Status','UserType','undefined','1PBtKKP','employeeId','DepartmentsId','Audience','JoiningDate','Office\x20Location\x20Id\x20is\x20not\x20Correct','#ddlAllCompanies','i:0#.f|membership|','#btnAudience','local','Announcement_Type','.form-check-input','formatDate','#btnmissingrequedvalue','text','application/json;odata=nometadata','join','select','ddlDepartment','width','resolve','innerHTML','#Ready','append','OfficeLocationsId','Added','/_api/web/siteusers(@v)?@v=\x27','displayName','data','This\x20browser\x20does\x20not\x20support\x20HTML5.','#txtmanager','Type','ddlOfficeLocation','length','download','Company\x20Id\x20is\x20not\x20Correct','/_api/SP.OAuth.Token/Acquire','#ddlfilterDepartments','empty','accountEnabled','_row','DateOfJoining','#txtDesignation','Date\x20Of\x20Marriage','.sp-peoplepicker-editorInput','\x20<span\x20style=\x27color:green;\x20font-weight:bold;\x27>','option','CompanyName','mobilePhone','/_api/web/lists/getByTitle(\x27Departments\x27)/items?$select=*','12YyHzmT','readAsArrayBuffer','Location','\x27)/items?$filter=Title\x20eq\x20\x27Client_Credentials\x27\x20','indexOf','#example-table','/_api/web/lists/getbytitle(\x27','<input\x20type=\x22checkbox\x22\x20class=\x22\x22\x20disabled\x20/>','Select\x20Company','Title','#UploadExcel','Group\x20Name','byteLength','/_api/web/lists/getByTitle(\x27OfficeLocation\x27)/items?$select=*','remove','#lblUpdate','.select-row_IsMiisingSelected','Please\x20select\x20Department','ajax','#dvExcel','country','#chkTopExecutive','Company','manager','Internal\x20','/_api/web/lists/getByTitle(\x27DepartmentalDMS\x27)/roleassignments/addroleassignment(principalid=','setData','Manager','/_api/web/sitegroups/getbyname(\x27Contributors\x27)?$select=id','utils','color-red','<input\x20type=\x22checkbox\x22\x20class=\x22select-row_isReadeySelected\x22\x20aria-label=\x22select\x20this\x20row\x22\x20/>','getSelectedRows','getElementById','promise','/_api/web/siteusers?$top=1000&$select=*,Id','slice','Metadata','select#dropDownId\x20option:selected','User\x20has\x20been\x20assigned\x20permission\x20.','toString','#btnDownLoadReport','5KYcfbW','Deferred','</span>','Department','#chkManager','concat','LogonNameId','split','access_token','https://graph.microsoft.com/v1.0/users?$top=999&$select=mail,displayName,userPrincipalName,department,officeLocation,companyName,otherMails,userType,identities,creationType,externalUserState,externalUserState,country,employeeId,jobTitle,postalCode,state,streetAddress,city,mobilePhone,accountEnabled,employeeHireDate\x20&$expand=manager($levels=max;$select=id,displayName,mail)','#ddlfilterAllCompanies','POST','mail','message','<h3\x20class=\x27m-0\x27>','DepartmentId','706594ZssTnf','FullName','fadeOut','sheet_to_row_object_array','15%','GetAllUserInfo','Designation','when','1699224UgdLGb','#successfully_notifications',')/users','Department\x20Id\x20is\x20not\x20Correct','onload','SPClientPeoplePicker_InitStandaloneControlWrapper','location','toLowerCase','Active','readonly','Your\x20License\x20limit\x20has\x20been\x20ended','ClientName','Welcome','Ready','/_api/web/lists/getByTitle(\x27','Invalid\x20Profile','ready','deselectRow','fileUpload','results','href','ChangeFileName','prop','Company\x20*','chkDepartment','#btnCloseSync','Please\x20select\x20required\x20value\x20missing\x20row','https://graph.microsoft.com/v1.0/users?$filter=mail\x20eq\x20\x27','#Exits','toUpperCase','Description','Primary','EntityData','251px','application/json','13jHUhjy','Data\x20Send\x20to\x20Announcements\x20Failed','input[type=radio][name=datasend]','Bearer\x20','__next','xlsx','ddlfilterOfficeLocation','.breakpoint','<input\x20type=\x22checkbox\x22\x20id=\x22IsMiisingSelected\x22\x20onclick=\x22IsMiisingSelecteds()\x22\x20/>','appendChild','siteAbsoluteUrl','postalCode','Email\x20*','<span\x20class=\x27breakpoint\x27></span>','SiteURL','setHours','html','modal','city','exceltble','Employees','findIndex','test','department','IsMiisingSelected','336VdIDkl','CompanyId','application/json;odata=verbose','readAsBinaryString','#Error','createElement','getMonth','ddlAllCompanies','PrincipalAccountType','externalUserState','filter','Click\x20on\x20Azure\x20Sync\x20button\x20first.','OfficeNameDetail','\x20<span\x20style=\x27color:blue;\x20font-weight:bold;\x27>','Date\x20Of\x20Birth','DepartmentNameDetail','binary','val','.select-row_isReadeySelected','#__REQUESTDIGEST','#divAudience','#overlayq','#ddlDepartment','31107brWKzR','target','LocationName','.tabulator-page-size','CompanyIDId','9WfSYMw','<input\x20type=\x22checkbox\x22\x20class=\x22select-row_IsMiisingSelected\x22\x20aria-label=\x22select\x20this\x20row\x22\x20/>','SheetNames','close','\x27)/items?$select=ID&$filter=ID\x20eq\x20','datepicker','Manager\x20*','round','Updated','responseText','Required\x20Value\x20Missing','Already\x20Exist','.searching','Expires','chkOfficeLocation','fromCharCode','PATCH','ListItem','application/json;\x20odata=verbose','OfficeName','option:selected','ResolvePrincipalSource','ddlfilterDepartments','getQueryStringParameter','\x27)/items?$select=ID,SiteURL&$filter=ID\x20eq\x20','10%','Name','User\x20Added','change','getElement','map','state','streetAddress','WebPartName','MaximumEntitySuggestions'];a0_0xd0a0=function(){return _0x154c04;};return a0_0xd0a0();}function GetUserId(_0x585f49){var _0x1a1012=a0_0xdee0b0,_0x23ab5b='',_0x49b806='i:0#.f|membership|',_0x58ceff=_spPageContextInfo[_0x1a1012(0x21c)],_0x1f5c38=_0x49b806+_0x585f49;return $[_0x1a1012(0x1bf)]({'url':_0x58ceff+_0x1a1012(0x2e1)+encodeURIComponent(_0x1f5c38)+'\x27','method':'GET','headers':{'Accept':_0x1a1012(0x259)},'async':![],'success':function(_0x58b6c5){_0x23ab5b=_0x58b6c5['d']['Id'];},'error':function(_0x456fac){var _0x5eb8cb=_0x1a1012;console[_0x5eb8cb(0x28a)](JSON[_0x5eb8cb(0x2a8)](_0x456fac));}}),_0x23ab5b;}var GetAllGroupsUser=[],GroupUrl=_spPageContextInfo['siteAbsoluteUrl']+a0_0xdee0b0(0x1d0);function GetAllUserId(){var _0x4cb7a1=a0_0xdee0b0;$['ajax']({'url':GroupUrl,'method':_0x4cb7a1(0x298),'headers':{'Accept':'application/json;\x20odata=verbose'},'async':![],'success':function(_0x423d84){var _0x3f687a=_0x4cb7a1;GetAllGroupsUser=GetAllGroupsUser[_0x3f687a(0x1dc)](_0x423d84['d'][_0x3f687a(0x202)]),_0x423d84['d'][_0x3f687a(0x216)]!=null&&(GroupUrl=_0x423d84['d'][_0x3f687a(0x216)],GetAllUserId());},'error':function(_0x5a9596){var _0x3a0b58=_0x4cb7a1;console[_0x3a0b58(0x28a)](JSON[_0x3a0b58(0x2a8)](_0x5a9596));}});}var LoginName;function UpdateExistingEmployeeAllocated(_0x61f810,_0x1fc021){var _0x24fb0d=a0_0xdee0b0;try{UserEmailId=_0x61f810[0x0][_0x24fb0d(0x274)],LoginName=_0x24fb0d(0x2ce)+_0x61f810[0x0][_0x24fb0d(0x274)];var _0x24b380,_0x2381f7,_0x19f28e=GetAllGroupsUser[_0x24fb0d(0x235)](function(_0x96caf0){var _0x3462b0=_0x24fb0d;return _0x96caf0[_0x3462b0(0x274)][_0x3462b0(0x1f6)]()==_0x61f810[0x0][_0x3462b0(0x274)][_0x3462b0(0x1f6)]();});if(_0x19f28e[_0x24fb0d(0x2e8)]>0x0)var _0x28e48f=_0x19f28e[0x0]['Id'];else{}if(TopExecutive==_0x24fb0d(0x288)||_0x61f810[0x0][_0x24fb0d(0x1c8)]==undefined)_0x61f810[0x0][_0x24fb0d(0x24d)]=_0x24fb0d(0x288),_0x24b380=-0x1;else{var _0x240f50=EmployeeListUsers[_0x24fb0d(0x235)](function(_0x166dc1){var _0x1cb398=_0x24fb0d,_0x5defa9;if(_0x166dc1[_0x1cb398(0x1c8)]!=null)return _0x5defa9=_0x166dc1[_0x1cb398(0x274)][_0x1cb398(0x1f6)](),_0x5defa9==_0x61f810[0x0][_0x1cb398(0x1c8)][_0x1cb398(0x1f6)]();});if(_0x240f50[_0x24fb0d(0x2e8)]>0x0){_0x2381f7=_0x240f50[0x0][_0x24fb0d(0x1e8)];var _0x19f28e=GetAllGroupsUser[_0x24fb0d(0x235)](function(_0x598244){var _0x57f860=_0x24fb0d;return _0x598244['Email'][_0x57f860(0x1f6)]()==_0x61f810[0x0][_0x57f860(0x1c8)][_0x57f860(0x1f6)]();});if(_0x19f28e[_0x24fb0d(0x2e8)]>0x0)_0x24b380=_0x19f28e[0x0]['Id'];else{}}else{IsManager=![],_0x24b380='';var _0x4519b2=excelRows[_0x24fb0d(0x227)](_0x5a6145=>_0x5a6145[_0x24fb0d(0x274)][_0x24fb0d(0x1f6)]()==_0x61f810[0x0][_0x24fb0d(0x274)][_0x24fb0d(0x1f6)]());excelRows[_0x4519b2][_0x24fb0d(0x2c4)]=_0x24fb0d(0x2a7);}}var _0x5107ce,_0x265f74=GetItemTypeForListName(_0x1fc021);_0x5107ce={'__metadata':{'type':_0x265f74},'Designation':_0x61f810[0x0][_0x24fb0d(0x1ed)],'GroupName':_0x61f810[0x0][_0x24fb0d(0x304)],'Manager':_0x2381f7,'ManagerLoginNameId':_0x24b380},$[_0x24fb0d(0x1ee)](updateItemExitUser(_0x1fc021,_0x5107ce,_0x61f810[0x0][_0x24fb0d(0x287)]))[_0x24fb0d(0x28f)](function(_0x5b79e1){var _0x1d8f42=_0x24fb0d,_0x189837=_0x5b79e1;if(_0x189837){lblUpdate=lblUpdate+0x1,Exits=Exits-0x1;var _0x2fb3a6=excelRows['findIndex'](_0xfc942d=>_0xfc942d['Email']==UserEmailId);excelRows[_0x2fb3a6][_0x1d8f42(0x2c4)]=_0x1d8f42(0x24f),showmessage();}});}catch(_0x4ff7c8){console['log'](_0x4ff7c8[_0x24fb0d(0x1e4)]);}}var IsManager=!![];function AddNewEmployeeAllocated(_0x168a3c,_0x336eaf){var _0x4af8c3=a0_0xdee0b0,_0x219171=![];try{var _0xe67d6f=AllCompanies[_0x4af8c3(0x235)](function(_0x5d1411){var _0x33230e=_0x4af8c3;return _0x5d1411['ID']==parseInt(_0x168a3c[0x0][_0x33230e(0x1c3)]);});if(!(_0xe67d6f[_0x4af8c3(0x2e8)]>0x0))return alert(_0x4af8c3(0x2ea)),_0x219171=![],![];var _0x1b27f8=AllDepartments[_0x4af8c3(0x235)](function(_0x150128){return _0x150128['ID']==parseInt(_0x168a3c[0x0]['Department']);});if(!(_0x1b27f8[_0x4af8c3(0x2e8)]>0x0))return alert(_0x4af8c3(0x1f2)),_0x219171=![],![];var _0x5ab116=AllOfficeLocation[_0x4af8c3(0x235)](function(_0x423ae9){var _0xe90e55=_0x4af8c3;return _0x423ae9['ID']==parseInt(_0x168a3c[0x0][_0xe90e55(0x2fb)]);});if(!(_0x5ab116[_0x4af8c3(0x2e8)]>0x0))return alert(_0x4af8c3(0x2cc)),_0x219171=![],![];if(_0xe67d6f['length']>0x0&&_0x1b27f8['length']>0x0&&_0x5ab116[_0x4af8c3(0x2e8)]>0x0){EmployeeDepartment=_0x1b27f8[0x0][_0x4af8c3(0x2aa)],EmployeeOfficeLocation=_0x5ab116[0x0]['OfficeName'],LoginName=_0x168a3c[0x0][_0x4af8c3(0x274)][_0x4af8c3(0x1f6)]();var _0x3dc830,_0x88f98f,_0x4a754f=GetAllGroupsUser[_0x4af8c3(0x235)](function(_0xd3e9c){var _0x140cfa=_0x4af8c3;return _0xd3e9c[_0x140cfa(0x274)][_0x140cfa(0x1f6)]()==_0x168a3c[0x0][_0x140cfa(0x274)][_0x140cfa(0x1f6)]();}),_0x501a5a;if(_0x4a754f[_0x4af8c3(0x2e8)]>0x0)var _0x501a5a=_0x4a754f[0x0]['Id'];else $[_0x4af8c3(0x1ee)](AddUserinSharePointGroup(LoginName))['done'](function(_0x1337f7){_0x501a5a=_0x1337f7;});if(TopExecutive==_0x4af8c3(0x288)||_0x168a3c[0x0][_0x4af8c3(0x1c8)]==undefined)_0x168a3c[0x0]['Manager\x20*']=_0x4af8c3(0x288),_0x3dc830=-0x1;else{var _0x2b4ea6=EmployeeListUsers['filter'](function(_0x13f8bd){var _0x5b048c=_0x4af8c3,_0x5763ed;if(_0x13f8bd[_0x5b048c(0x274)]!=null)return _0x5763ed=_0x13f8bd['Email']['toLowerCase'](),_0x5763ed==_0x168a3c[0x0]['Manager'][_0x5b048c(0x1f6)]();});if(_0x2b4ea6[_0x4af8c3(0x2e8)]>0x0){_0x88f98f=_0x2b4ea6[0x0][_0x4af8c3(0x1e8)];var _0x4a754f=GetAllGroupsUser['filter'](function(_0x4ef876){var _0xc60e8b=_0x4af8c3;return _0x4ef876[_0xc60e8b(0x274)]['toLowerCase']()==_0x168a3c[0x0][_0xc60e8b(0x1c8)][_0xc60e8b(0x1f6)]();});_0x4a754f[_0x4af8c3(0x2e8)]>0x0?_0x3dc830=_0x4a754f[0x0]['Id']:_0x3dc830=AddUserinSharePointGroup(_0x168a3c[0x0]['Manager'][_0x4af8c3(0x1f6)]());}else{IsManager=![],_0x3dc830='';var _0x542826=excelRows[_0x4af8c3(0x227)](_0x16c2ce=>_0x16c2ce['Email']['toLowerCase']()==LoginName);excelRows[_0x542826][_0x4af8c3(0x2c4)]=_0x4af8c3(0x277);}}var _0x5cacf2,_0x4d216d=GetItemTypeForListName(_0x336eaf);_0x5cacf2={'__metadata':{'type':_0x4d216d},'CompanyId':parseInt(_0x168a3c[0x0][_0x4af8c3(0x1c3)]),'DepartmentId':parseInt(_0x168a3c[0x0]['Department']),'FullName':_0x168a3c[0x0][_0x4af8c3(0x261)],'Title':_0x168a3c[0x0][_0x4af8c3(0x261)],'ParentId':'-1','Email':_0x168a3c[0x0][_0x4af8c3(0x274)],'LogonNameId':_0x501a5a,'Manager':_0x168a3c[0x0][_0x4af8c3(0x1c8)],'ManagerLoginNameId':_0x3dc830,'OfficeLocationId':parseInt(_0x168a3c[0x0][_0x4af8c3(0x2fb)]),'MobileNumber':_0x168a3c[0x0][_0x4af8c3(0x2f7)],'DateOfBirth':_0x168a3c[0x0][_0x4af8c3(0x239)],'Gender':_0x168a3c[0x0][_0x4af8c3(0x29f)],'DateOfAnniversary':_0x168a3c[0x0][_0x4af8c3(0x2f2)],'JoiningDate':_0x168a3c[0x0][_0x4af8c3(0x2f0)],'Designation':_0x168a3c[0x0][_0x4af8c3(0x1ed)],'PrimaryCompany':_0x4af8c3(0x20e),'EmployeeID':_0x168a3c[0x0]['employeeId'],'GroupName':_0x168a3c[0x0][_0x4af8c3(0x304)],'Status':_0x4af8c3(0x1f7),'PostalAddresses':_0x168a3c[0x0][_0x4af8c3(0x21d)],'City':_0x168a3c[0x0]['city'],'StateProvince':_0x168a3c[0x0]['state'],'ZIPPostalCode':_0x168a3c[0x0][_0x4af8c3(0x21d)],'Country':_0x168a3c[0x0]['country'],'HomePhone':_0x168a3c[0x0][_0x4af8c3(0x2f7)],'OtherEMailAddress':_0x168a3c[0x0][_0x4af8c3(0x26e)],'HomeAddress':_0x168a3c[0x0][_0x4af8c3(0x2b3)]},AddItemToList(_0x336eaf,_0x5cacf2);var _0x2b148c=new Date(),_0x3ef4dd=new Date(_0x168a3c[0x0][_0x4af8c3(0x2f0)]),_0x4a3df9=daysDifference(_0x3ef4dd,_0x2b148c);_0x4a3df9<=0xf&&AddedEmployeeList['push']({'Metadata':_0x5cacf2,'EmployeeId':_0x168a3c[0x0][_0x4af8c3(0x2c8)],'EmployeeOfficeLocation':EmployeeOfficeLocation,'EmployeeDepartment':EmployeeDepartment}),_0x219171=!![];}}catch(_0x147344){console[_0x4af8c3(0x28a)](_0x147344[_0x4af8c3(0x1e4)]);}return _0x219171;}function daysDifference(_0x2b82ea,_0x4c9621){var _0x2268cd=a0_0xdee0b0,_0x1ba8a4=new Date(+_0x4c9621)[_0x2268cd(0x221)](0xc)-new Date(+_0x2b82ea)[_0x2268cd(0x221)](0xc);return Math[_0x2268cd(0x24e)](_0x1ba8a4/0x5265c00);}function updateItemExitUser(_0x53c710,_0x2bcfbe,_0x48b58b){var _0x57d04a=a0_0xdee0b0,_0x532a50=$[_0x57d04a(0x1d8)]();return $[_0x57d04a(0x1bf)]({'url':_spPageContextInfo[_0x57d04a(0x279)]+_0x57d04a(0x2ff)+_0x53c710+'\x27)/GetItemById(\x27'+_0x48b58b+'\x27)','type':_0x57d04a(0x1e2),'headers':{'accept':'application/json;odata=verbose','X-RequestDigest':$(_0x57d04a(0x23e))[_0x57d04a(0x23c)](),'content-Type':_0x57d04a(0x22d),'X-Http-Method':_0x57d04a(0x257),'If-Match':'*'},'data':JSON[_0x57d04a(0x2a8)](_0x2bcfbe),'async':![],'success':function(_0x346b68){var _0x1b9c9e=_0x57d04a;_0x532a50[_0x1b9c9e(0x2db)](!![]);},'error':function(_0x3b093a){var _0x329c67=_0x57d04a;_0x532a50[_0x329c67(0x2a0)](_0x3b093a);}}),_0x532a50[_0x57d04a(0x1cf)]();}function AddItemToList(_0x51201d,_0x3f0104){var _0x4ef892=a0_0xdee0b0;UserEmailId=_0x3f0104['Email'];var _0xabd8a9=_0x3f0104[_0x4ef892(0x1e8)],_0x5ee189=$[_0x4ef892(0x1d8)]();return $[_0x4ef892(0x1bf)]({'url':_spPageContextInfo['webAbsoluteUrl']+_0x4ef892(0x2ff)+_0x51201d+'\x27)/items','type':_0x4ef892(0x1e2),'async':![],'headers':{'accept':_0x4ef892(0x22d),'X-RequestDigest':$(_0x4ef892(0x23e))['val'](),'content-Type':_0x4ef892(0x22d)},'data':JSON[_0x4ef892(0x2a8)](_0x3f0104),'success':function(_0x6206ad){var _0x43cdd6=_0x4ef892;counusers=counusers+0x1,AvilableLicenses=AvilableLicenses-0x1,Ready=Ready-0x1;var _0x4ce461=excelRows['findIndex'](_0x2379d0=>_0x2379d0[_0x43cdd6(0x274)]==UserEmailId);excelRows[_0x4ce461]['Status']=_0x43cdd6(0x2e0),showmessage();var _0x413897=GetSubSiteUrl('Departments',_0x6206ad['d'][_0x43cdd6(0x1e6)]);AssignPermissiononDMSLibary(_0x6206ad['d'][_0x43cdd6(0x1dd)],'1073741826',_0x413897),_0x5ee189[_0x43cdd6(0x2db)](_0x6206ad);},'error':function(_0x87f23c){var _0x1e9e58=_0x4ef892;if(IsManager){var _0x5f0502=excelRows[_0x1e9e58(0x227)](_0x548eb8=>_0x548eb8['Email']==UserEmailId);excelRows[_0x5f0502][_0x1e9e58(0x2c4)]=_0x1e9e58(0x272);}userfullname==''?(userfullname+=_0xabd8a9,warningmessage=_0x1e9e58(0x278)):userfullname+='\x20,\x20'+_0xabd8a9,Ready=Ready-0x1,Error=Error+0x1,console[_0x1e9e58(0x28a)](JSON[_0x1e9e58(0x2a8)](_0x87f23c)),_0x5ee189[_0x1e9e58(0x2a0)](JSON[_0x1e9e58(0x2a8)](_0x87f23c));}}),_0x5ee189['promise']();}function LoadShowUser(_0x19f331){var _0x41785a=a0_0xdee0b0;tabledata=new Tabulator(_0x41785a(0x2fe),{'height':'','pagination':_0x41785a(0x2d0),'paginationSize':0xa,'layout':'fitColumns','paginationSizeSelector':[0xa,0x19,0x32,0x64],'placeholder':_0x41785a(0x236),'data':_0x19f331,'pageLoaded':function(_0x39ce57){var _0x85a6c3=_0x41785a;_0x39ce57>=0x1?pageIndex=_0x39ce57:pageIndex=_0x39ce57,IsMiisingSelect=document[_0x85a6c3(0x1ce)](_0x85a6c3(0x22a)),IsMiisingSelect[_0x85a6c3(0x28d)]&&$(_0x85a6c3(0x1bd))[_0x85a6c3(0x205)](_0x85a6c3(0x28d),!![]),isReadeySelect=document['getElementById']('isReadeySelected'),isReadeySelect[_0x85a6c3(0x28d)]&&$(_0x85a6c3(0x23d))[_0x85a6c3(0x205)](_0x85a6c3(0x28d),!![]);},'columns':[{'formatter':function(_0x38819c,_0x4d1570){var _0x53f840=_0x41785a,_0x487af0=_0x38819c['_cell'][_0x53f840(0x26f)][_0x53f840(0x2e3)][_0x53f840(0x2c4)];return _0x487af0==_0x53f840(0x1fe)||_0x487af0==_0x53f840(0x251)||_0x487af0==_0x53f840(0x2e0)||_0x487af0==_0x53f840(0x24f)?_0x53f840(0x300):_0x53f840(0x1cc);},'title':'<input\x20type=\x22checkbox\x22\x20id=\x22isReadeySelected\x22\x20onclick=\x22isReadeySelecteds()\x22\x20/>','field':'ID','width':'1%','headerSort':![],'cellClick':function(_0x2cbddb,_0x371fa9){var _0x417fb6=_0x41785a,_0x37e22a=$(_0x371fa9[_0x417fb6(0x264)]()),_0xc32d62=_0x37e22a[_0x417fb6(0x26a)](_0x417fb6(0x23d));_0xc32d62[0x0][_0x417fb6(0x28d)]==![]&&$(_0x371fa9['getRow']()[_0x417fb6(0x264)]())[_0x417fb6(0x26a)](_0x417fb6(0x1bd))[0x0]['checked']==![]?_0x371fa9[_0x417fb6(0x299)]()[_0x417fb6(0x2a5)]():_0x371fa9['getRow']()['select']();}},{'formatter':function(_0x2b4148,_0x4f4d82){var _0x11e673=_0x41785a,_0x4fc1a6=_0x2b4148[_0x11e673(0x27f)][_0x11e673(0x26f)][_0x11e673(0x2e3)][_0x11e673(0x2c4)];return _0x4fc1a6==_0x11e673(0x251)||_0x4fc1a6==_0x11e673(0x252)||_0x4fc1a6==_0x11e673(0x1fc)?_0x11e673(0x248):'<input\x20type=\x22checkbox\x22\x20class=\x22\x22\x20disabled\x20/>';},'title':_0x41785a(0x21a),'hozAlign':'center','field':'ID','headerSort':![],'width':'1%','cellClick':function(_0x3ece57,_0x1d983e){var _0x460f1c=_0x41785a,_0x139fb3=$(_0x1d983e[_0x460f1c(0x264)]()),_0x16d881=_0x139fb3[_0x460f1c(0x26a)](_0x460f1c(0x1bd));_0x16d881[0x0][_0x460f1c(0x28d)]==![]?_0x1d983e[_0x460f1c(0x299)]()[_0x460f1c(0x2a5)]():_0x1d983e[_0x460f1c(0x299)]()[_0x460f1c(0x2d8)]();}},{'title':_0x41785a(0x2c4),'field':'Status','width':'10%','formatter':function(_0x1233d7,_0x399c2d){var _0x3df725=_0x41785a,_0x57f80c=_0x1233d7['getValue']();if(_0x57f80c==_0x3df725(0x1fe)||_0x57f80c==_0x3df725(0x251)||_0x57f80c==_0x3df725(0x272)||_0x57f80c==_0x3df725(0x2a7))return _0x3df725(0x2b0)+_0x57f80c+_0x3df725(0x1d9);else return _0x57f80c==_0x3df725(0x252)?_0x3df725(0x238)+_0x57f80c+'</span>':_0x3df725(0x2f4)+_0x57f80c+'</span>';}},{'title':'Type','field':_0x41785a(0x2e6),'width':'10%'},{'title':_0x41785a(0x261),'field':_0x41785a(0x261),'width':_0x41785a(0x260)},{'title':_0x41785a(0x274),'field':_0x41785a(0x274),'align':_0x41785a(0x26d),'width':_0x41785a(0x1eb)},{'title':_0x41785a(0x1c3),'field':_0x41785a(0x2f6),'width':_0x41785a(0x260),'align':_0x41785a(0x28b)},{'title':_0x41785a(0x1da),'field':_0x41785a(0x2aa),'width':'10%','align':_0x41785a(0x28b)},{'title':_0x41785a(0x2fb),'field':_0x41785a(0x244),'width':'10%','align':_0x41785a(0x28b)},{'title':_0x41785a(0x1ed),'field':'Designation','width':'10%'},{'title':_0x41785a(0x1c8),'field':_0x41785a(0x1c8),'width':_0x41785a(0x260)},{'title':'Date\x20Of\x20Joining','field':'DateOfJoining','width':_0x41785a(0x260)},{'title':_0x41785a(0x304),'field':_0x41785a(0x304),'width':_0x41785a(0x260)}]}),showmessage(),$('#Rowcount')[_0x41785a(0x222)]('Total\x20Row\x20Count:\x20'),$(_0x41785a(0x219))[_0x41785a(0x1bb)](),$(_0x41785a(0x245))['after'](_0x41785a(0x21f));}function showmessage(){var _0x114c1f=a0_0xdee0b0;$(_0x114c1f(0x2dd))['text'](Ready),$(_0x114c1f(0x22f))[_0x114c1f(0x2d5)](Error),$(_0x114c1f(0x20b))[_0x114c1f(0x2d5)](Exits),$(_0x114c1f(0x1bc))[_0x114c1f(0x2d5)](lblUpdate),$(_0x114c1f(0x291))[_0x114c1f(0x2d5)](AvilableLicenses);}function a0_0x281d(_0xdfc40b,_0x59fcdb){var _0xd0a0a=a0_0xd0a0();return a0_0x281d=function(_0x281d78,_0x278c85){_0x281d78=_0x281d78-0x1bb;var _0x3ddfd8=_0xd0a0a[_0x281d78];return _0x3ddfd8;},a0_0x281d(_0xdfc40b,_0x59fcdb);}function GraphAccessTokenTogetUserDetails(){var _0x6edb84=a0_0xdee0b0,_0x28cee6=new jQuery['Deferred'](),_0x35394d={'X-RequestDigest':$(_0x6edb84(0x23e))[_0x6edb84(0x23c)](),'accept':_0x6edb84(0x2d6),'content-type':_0x6edb84(0x2d6)},_0xd6289c={'resource':_0x6edb84(0x276)};return $[_0x6edb84(0x1bf)]({'url':_spPageContextInfo['webAbsoluteUrl']+_0x6edb84(0x2eb),'headers':_0x35394d,'type':_0x6edb84(0x1e2),'async':![],'data':JSON[_0x6edb84(0x2a8)](_0xd6289c),'success':function(_0x4f3641){var _0x410ebb=_0x6edb84;token=_0x4f3641[_0x410ebb(0x1df)],_0x28cee6[_0x410ebb(0x2db)](token);},'error':function(_0x4ad3f9,_0x2691bb,_0x475380){var _0x58f056=_0x6edb84;console['log'](_0x4ad3f9[_0x58f056(0x250)]),_0x28cee6[_0x58f056(0x2a0)](_0x4ad3f9['responseText']);}}),_0x28cee6[_0x6edb84(0x1cf)]();}var employeehtml='',userName='',AzureUsrlist=[],AdusersUrl=a0_0xdee0b0(0x1e0);function GetAzureUsrlist(_0x2e4e22,_0x3dd34d){var _0x4a5c15=a0_0xdee0b0;return DeferredObj=$[_0x4a5c15(0x1d8)](),$[_0x4a5c15(0x1bf)]({'method':_0x4a5c15(0x298),'url':_0x2e4e22,'headers':{'Authorization':'Bearer\x20'+_0x3dd34d,'Content-Type':_0x4a5c15(0x211)},'async':![],'success':function(_0x219d5e){var _0x349b2f=_0x4a5c15;AzureUsrlist=AzureUsrlist[_0x349b2f(0x1dc)](_0x219d5e[_0x349b2f(0x2b6)]),_0x219d5e[_0x349b2f(0x2a6)]!=null?(AdusersUrl=_0x219d5e['@odata.nextLink'],GetAzureUsrlist(AdusersUrl,_0x3dd34d)):AdusersUrl=_0x349b2f(0x1e0);},'error':function(_0x132450){var _0x2eccd5=_0x4a5c15;DeferredObj[_0x2eccd5(0x2a0)](_0x132450),alert(_0x2eccd5(0x2c2)+JSON[_0x2eccd5(0x2a8)](_0x132450));}}),DeferredObj[_0x4a5c15(0x1cf)]();}function getEmployee(_0x41c5ca){var _0x58b6d6=a0_0xdee0b0,_0xd1dc85=_0x58b6d6(0x20a)+_0x41c5ca+'\x27';return DeferredObj=$[_0x58b6d6(0x1d8)](),$[_0x58b6d6(0x1bf)]({'method':_0x58b6d6(0x298),'url':_0xd1dc85,'headers':{'Authorization':_0x58b6d6(0x215)+token,'Content-Type':'application/json'},'async':![],'success':function(_0x12e22c){var _0x287c97=_0x58b6d6;_0x12e22c[_0x287c97(0x2b6)]['length']>0x0?DeferredObj['resolve'](_0x12e22c[_0x287c97(0x2b6)][0x0]['displayName']):DeferredObj[_0x287c97(0x2db)]('Invalid\x20Profile');},'error':function(_0x58efad){var _0x26958a=_0x58b6d6;DeferredObj[_0x26958a(0x2a0)](_0x58efad),alert(_0x26958a(0x2c2)+JSON[_0x26958a(0x2a8)](_0x58efad));}}),DeferredObj['promise']();}function ClientCredentials(){var _0x44fd5e=a0_0xdee0b0,_0x16d7e2=_0x44fd5e(0x2a3),_0x404884=titanForWork[_0x44fd5e(0x25e)]('CompanyId'),_0x2bd6fb=_spPageContextInfo[_0x44fd5e(0x279)]+_0x44fd5e(0x283)+_0x16d7e2+_0x44fd5e(0x2fc);$['ajax']({'url':_0x2bd6fb,'headers':{'Accept':'application/json;odata=verbose'},'async':![],'success':function(_0x2f5831){var _0x758f27=_0x44fd5e,_0x445632=_0x2f5831['d']['results'];ClientId=_0x445632[0x0][_0x758f27(0x1fa)],ClentSecret=_0x445632[0x0][_0x758f27(0x204)],ClientUrl=_0x445632[0x0][_0x758f27(0x20d)];},'error':function(_0x31b28f){var _0x48778c=_0x44fd5e;console[_0x48778c(0x28a)](_0x31b28f);}});}var EmployeeListUsers=[],GetQueryURL=_spPageContextInfo[a0_0xdee0b0(0x279)]+'/_api/web/lists/GetByTitle(\x27Employees\x27)/items?$top=999&$select=ID,AttachmentFiles,FullName,Designation,Manager,MobileNumber,ExtensionName,Email,LogonName/UserName,Department/DepartmentName,Company/CompanyName,Company/ID,OfficeLocation/ID,OfficeLocation/OfficeName&$orderby=FullName&$expand=LogonName,OfficeLocation,Company,Department,AttachmentFiles\x20&$filter=\x20PrimaryCompany\x20eq\x20\x27Primary\x27\x20and\x20Status\x20eq\x20\x27Active\x27\x20';function GetEmployees(){var _0x20e6b=a0_0xdee0b0;$[_0x20e6b(0x1bf)]({'url':GetQueryURL,'headers':{'Accept':'application/json;odata=verbose'},'async':![],'beforeSend':function(){},'success':function(_0x52a7a9){var _0xbbd6cd=_0x20e6b;EmployeeListUsers=EmployeeListUsers[_0xbbd6cd(0x1dc)](_0x52a7a9['d'][_0xbbd6cd(0x202)]);if(_0x52a7a9['d'][_0xbbd6cd(0x216)]!=null)GetQueryURL=_0x52a7a9['d'][_0xbbd6cd(0x216)],GetEmployees();else{GetQueryURL=_spPageContextInfo[_0xbbd6cd(0x279)]+_0xbbd6cd(0x2a9);var _0x9345b8=0x0,_0x224900=_spPageContextInfo[_0xbbd6cd(0x279)]+'/_api/web/lists/getbytitle(\x27ExternalUsers\x27)/items?$select=*,InternalStakeholders/Title,Supervisor_Guest/Title,Client_Name/Title,LoginName/Title\x20&$expand=\x20LoginName,Client_Name,Supervisor_Guest,InternalStakeholders\x20&$filter=((Status\x20eq\x20\x27Initiated\x27)\x20or\x20(Status\x20eq\x20\x27Invited\x27\x20)or\x20(Status\x20eq\x20\x27Pending\x27)or\x20(Status\x20eq\x20\x27Accepted\x27))';extdfds=$[_0xbbd6cd(0x1d8)](),$[_0xbbd6cd(0x1ee)](getItems(_0x224900,extdfds))[_0xbbd6cd(0x28f)](function(_0x2b3e4f){response=[],_0x2b3e4f['length']>0x0&&(_0x9345b8=_0x2b3e4f['length']);});}_0x9345b8!=undefined&&(AvilableLicenses=parseInt(UsersLicenceRequired)-(parseInt(EmployeeListUsers[_0xbbd6cd(0x2e8)])+parseInt(_0x9345b8)));},'error':function(_0x448890){var _0x589d26=_0x20e6b;console[_0x589d26(0x28a)](_0x448890);}});}$(function(){$('#upload')['click'](function(){var _0x243561=a0_0x281d;$('#overlayq')[_0x243561(0x286)]()[_0x243561(0x27d)](0x5dc)[_0x243561(0x1e9)]();var _0x226915=document[_0x243561(0x1ce)](_0x243561(0x201));GetEmployees(),LoadShowUser([]),Ready=0x0,Error=0x0,counusers=0x0;var _0x46227a=/^([a-zA-Z0-9\s_\\.\-:])+(.xls|.xlsx)$/;if(_0x46227a[_0x243561(0x228)](_0x226915[_0x243561(0x2b6)][_0x243561(0x1f6)]())){if(typeof FileReader!=_0x243561(0x2c6)){var _0x29aa60=new FileReader();_0x29aa60[_0x243561(0x22e)]?(_0x29aa60[_0x243561(0x1f3)]=function(_0x50f82a){var _0x4d97fc=_0x243561;ProcessExcel(_0x50f82a[_0x4d97fc(0x243)][_0x4d97fc(0x2b5)]);},_0x29aa60[_0x243561(0x22e)](_0x226915[_0x243561(0x29b)][0x0])):(_0x29aa60[_0x243561(0x1f3)]=function(_0x58ea39){var _0x3c568d=_0x243561,_0x3b0fea='',_0x3fc515=new Uint8Array(_0x58ea39[_0x3c568d(0x243)][_0x3c568d(0x2b5)]);for(var _0x4d9279=0x0;_0x4d9279<_0x3fc515[_0x3c568d(0x305)];_0x4d9279++){_0x3b0fea+=String[_0x3c568d(0x256)](_0x3fc515[_0x4d9279]);}ProcessExcel(_0x3b0fea);},_0x29aa60[_0x243561(0x2fa)](_0x226915[_0x243561(0x29b)][0x0]));}else alert(_0x243561(0x2e4));}else alert('Please\x20upload\x20a\x20valid\x20Excel\x20file.');});});function ProcessExcel(_0x485300){var _0xb6ba39=a0_0xdee0b0,_0x1a4d20=XLSX['read'](_0x485300,{'type':_0xb6ba39(0x23b)}),_0x4b9432=_0x1a4d20[_0xb6ba39(0x249)][0x0];excelRows=XLSX[_0xb6ba39(0x1ca)][_0xb6ba39(0x1ea)](_0x1a4d20['Sheets'][_0x4b9432]),$('#UploadedItems')[_0xb6ba39(0x2ed)](),$('#UploadedItems')[_0xb6ba39(0x2de)](_0xb6ba39(0x1e5)+excelRows['length']+'</h3>\x20<p\x20class\x20=\x20\x22m-0\x22\x20>\x20Uploaded\x20</p>'),$(_0xb6ba39(0x1c0))[_0xb6ba39(0x222)]('');for(var _0x166876=0x0;_0x166876<excelRows[_0xb6ba39(0x2e8)];_0x166876++){var _0x4289c8='';ErrorUser='';var _0x1095f6=EmployeeListUsers[_0xb6ba39(0x235)](function(_0x5d727a){var _0x26fb81=_0xb6ba39,_0x41d6a6=_0x5d727a[_0x26fb81(0x274)]['toLowerCase']();return _0x41d6a6==excelRows[_0x166876]['Email\x20*']['toLowerCase']();});if(_0x1095f6[_0xb6ba39(0x2e8)]>0x0){_0x4289c8=_0x1095f6[0x0][_0xb6ba39(0x1e8)],color_red='color-red',ErrorUser='Already\x20Exist',Exits=Exits+0x1;var _0x5c6f96=_0x1095f6[0x0]['ID'];excelRows[_0x166876][_0xb6ba39(0x206)]='-',excelRows[_0x166876][_0xb6ba39(0x27e)]='-',excelRows[_0x166876][_0xb6ba39(0x29a)]='-';}else{var _0x389b17=AzureUsrlist[_0xb6ba39(0x235)](function(_0x1c1f3f){var _0x559c91=_0xb6ba39;if(_0x1c1f3f[_0x559c91(0x1e3)]!=null){var _0x50d2e7=_0x1c1f3f[_0x559c91(0x1e3)][_0x559c91(0x1f6)]();return _0x50d2e7==excelRows[_0x166876][_0x559c91(0x21e)][_0x559c91(0x1f6)]();}});if(_0x389b17[_0xb6ba39(0x2e8)]>0x0){_0x4289c8=_0x389b17[0x0][_0xb6ba39(0x2e2)];var _0x4a4a3c=AllCompanies['filter'](function(_0x22476f){return _0x22476f['ID']==excelRows[_0x166876]['Company\x20*'];}),_0x4b184f=AllDepartments[_0xb6ba39(0x235)](function(_0xf8a33a){var _0x4a555b=_0xb6ba39;return _0xf8a33a['ID']==excelRows[_0x166876][_0x4a555b(0x27e)];}),_0x1c8fae=AllOfficeLocation[_0xb6ba39(0x235)](function(_0x3441f8){var _0x43dca3=_0xb6ba39;return _0x3441f8['ID']==excelRows[_0x166876][_0x43dca3(0x29a)];});_0x4a4a3c[_0xb6ba39(0x2e8)]>0x0&&_0x4b184f['length']>0x0&&_0x1c8fae['length']>0x0?(Ready=Ready+0x1,ErrorUser='Ready',excelRows[_0x166876][_0xb6ba39(0x23a)]=_0x4b184f[0x0][_0xb6ba39(0x2aa)],excelRows[_0x166876][_0xb6ba39(0x237)]=_0x1c8fae[0x0][_0xb6ba39(0x25a)]):(ErrorUser=_0xb6ba39(0x251),Error=Error+0x1);}else ErrorUser=_0xb6ba39(0x1fe),color_red=_0xb6ba39(0x1cb),Error=Error+0x1;}excelRows[_0x166876][_0xb6ba39(0x261)]=_0x4289c8,excelRows[_0x166876]['id']=_0x166876,excelRows[_0x166876][_0xb6ba39(0x2c4)]=ErrorUser,excelRows[_0x166876][_0xb6ba39(0x287)]=_0x5c6f96;}alluserdata=excelRows,LoadShowUser(excelRows);}function CompaniesDetails(){var _0xbc5990=a0_0xdee0b0,_0x398d0e=document[_0xbc5990(0x1ce)](_0xbc5990(0x232));_0x398d0e[_0xbc5990(0x2dc)]='',opt[_0xbc5990(0x2b6)]='0',opt[_0xbc5990(0x2d5)]=_0xbc5990(0x301),_0x398d0e[_0xbc5990(0x21b)](opt);for(var _0x1e8e87=0x0;_0x1e8e87<AllCompanies[_0xbc5990(0x2e8)];_0x1e8e87++){var _0x15e506=AllCompanies[_0x1e8e87][_0xbc5990(0x2f6)],_0x3d83f5=AllCompanies[_0x1e8e87]['ID'];opt=document[_0xbc5990(0x230)]('option'),opt[_0xbc5990(0x2b6)]=_0x3d83f5,opt[_0xbc5990(0x2d5)]=_0x15e506,_0x398d0e[_0xbc5990(0x21b)](opt);}$(_0xbc5990(0x2d2))[_0xbc5990(0x205)](_0xbc5990(0x28d),![]),$(_0xbc5990(0x2e5))[_0xbc5990(0x23c)](''),$('#txtGroup')[_0xbc5990(0x23c)](''),$('#txtDesignation')[_0xbc5990(0x23c)]('');}$(a0_0xdee0b0(0x2c1))[a0_0xdee0b0(0x280)](function(){var _0x23004d=a0_0xdee0b0,_0x8c3f3d=tabledata['getSelectedRows']();debugger;_0x8c3f3d[_0x23004d(0x2e8)]>0x0?(CompaniesDetails(),$(_0x23004d(0x303))[_0x23004d(0x223)](_0x23004d(0x29c)),initializePeoplePicker('AssaginTomanager'),peoplePickerDiv=$(_0x23004d(0x290))):alert(_0x23004d(0x209));});var GetDepartments,Getofficelocation,GetDesignation,GetGroup,CompaniesId,GetofficelocationName,GetDepartmentsName,CompaniesName;$(a0_0xdee0b0(0x2d4))[a0_0xdee0b0(0x280)](function(){var _0xa5b476=a0_0xdee0b0;if(document[_0xa5b476(0x1ce)](_0xa5b476(0x207))[_0xa5b476(0x28d)]==!![]||document[_0xa5b476(0x1ce)](_0xa5b476(0x255))['checked']==!![]||document[_0xa5b476(0x1ce)](_0xa5b476(0x281))[_0xa5b476(0x28d)]==!![]||document[_0xa5b476(0x1ce)]('chkManager')[_0xa5b476(0x28d)]==!![]||document[_0xa5b476(0x1ce)]('chkTopExecutive')[_0xa5b476(0x28d)]==!![]||document[_0xa5b476(0x1ce)](_0xa5b476(0x29d))[_0xa5b476(0x28d)]==!![]){var _0x476173=tabledata[_0xa5b476(0x1cd)](),_0x422704=SPClientPeoplePicker['SPClientPeoplePickerDict'][peoplePickerDiv[0x0]['id']],_0xa2c5c0=_0x422704[_0xa5b476(0x1ec)]();for(var _0x4dd602=0x0;_0x4dd602<_0x476173[_0xa5b476(0x2e8)];_0x4dd602++){var _0x5b1007=excelRows[_0xa5b476(0x227)](_0x43d425=>_0x43d425[_0xa5b476(0x274)]==_0x476173[_0x4dd602][_0xa5b476(0x2ef)][_0xa5b476(0x2e3)][_0xa5b476(0x274)]);if(excelRows[_0x5b1007]['Status']==_0xa5b476(0x252))excelRows[_0x5b1007]['Company']='-',excelRows[_0x5b1007][_0xa5b476(0x1da)]='-',excelRows[_0x5b1007][_0xa5b476(0x2fb)]='-',document[_0xa5b476(0x1ce)](_0xa5b476(0x281))[_0xa5b476(0x28d)]&&(excelRows[_0x5b1007]['Designation']=$('#txtDesignation')[_0xa5b476(0x23c)]()),document[_0xa5b476(0x1ce)](_0xa5b476(0x26b))[_0xa5b476(0x28d)]&&(excelRows[_0x5b1007]['Manager']=_0xa2c5c0[0x0][_0xa5b476(0x20f)][_0xa5b476(0x274)]),document[_0xa5b476(0x1ce)]('chkTopExecutive')['checked']&&(excelRows[_0x5b1007][_0xa5b476(0x1c8)]=_0xa5b476(0x288)),document['getElementById']('chkGroup')[_0xa5b476(0x28d)]&&(excelRows[_0x5b1007][_0xa5b476(0x304)]=$(_0xa5b476(0x295))[_0xa5b476(0x23c)]());else{if(excelRows[_0x5b1007][_0xa5b476(0x2c4)]=='Required\x20Value\x20Missing'||excelRows[_0x5b1007]['Status']==_0xa5b476(0x1fc)){document[_0xa5b476(0x1ce)](_0xa5b476(0x207))[_0xa5b476(0x28d)]&&(excelRows[_0x5b1007][_0xa5b476(0x1c3)]=CompaniesId,excelRows[_0x5b1007]['CompanyName']=CompaniesName,excelRows[_0x5b1007][_0xa5b476(0x1da)]=GetDepartments,excelRows[_0x5b1007][_0xa5b476(0x2aa)]=GetDepartmentsName);document[_0xa5b476(0x1ce)](_0xa5b476(0x255))[_0xa5b476(0x28d)]&&(excelRows[_0x5b1007][_0xa5b476(0x1c3)]=CompaniesId,excelRows[_0x5b1007][_0xa5b476(0x2f6)]=CompaniesName,excelRows[_0x5b1007][_0xa5b476(0x2fb)]=Getofficelocation,excelRows[_0x5b1007][_0xa5b476(0x244)]=GetofficelocationName);document[_0xa5b476(0x1ce)]('chkDesignation')[_0xa5b476(0x28d)]&&(excelRows[_0x5b1007][_0xa5b476(0x1ed)]=$('#txtDesignation')[_0xa5b476(0x23c)]());document[_0xa5b476(0x1ce)](_0xa5b476(0x26b))[_0xa5b476(0x28d)]&&(excelRows[_0x5b1007]['Manager']=_0xa2c5c0[0x0][_0xa5b476(0x20f)]['Email']);document[_0xa5b476(0x1ce)]('chkTopExecutive')[_0xa5b476(0x28d)]&&(excelRows[_0x5b1007][_0xa5b476(0x1c8)]=_0xa5b476(0x288));document[_0xa5b476(0x1ce)](_0xa5b476(0x29d))[_0xa5b476(0x28d)]&&(excelRows[_0x5b1007][_0xa5b476(0x304)]=$(_0xa5b476(0x295))['val']());var _0x5cbf4b=AllCompanies[_0xa5b476(0x235)](function(_0x4ed76e){var _0x5b65d6=_0xa5b476;return _0x4ed76e['ID']==excelRows[_0x5b1007][_0x5b65d6(0x1c3)];}),_0xbbfaad=AllDepartments[_0xa5b476(0x235)](function(_0x47fb58){return _0x47fb58['ID']==excelRows[_0x5b1007]['Department'];}),_0x4b3446=AllOfficeLocation[_0xa5b476(0x235)](function(_0x292bfa){var _0x42b992=_0xa5b476;return _0x292bfa['ID']==excelRows[_0x5b1007][_0x42b992(0x2fb)];});_0x5cbf4b[_0xa5b476(0x2e8)]>0x0&&_0xbbfaad[_0xa5b476(0x2e8)]>0x0&&_0x4b3446[_0xa5b476(0x2e8)]>0x0?(Ready=Ready+0x1,Error=Error-0x1,excelRows[_0x5b1007][_0xa5b476(0x2c4)]=_0xa5b476(0x1fc)):(excelRows[_0x5b1007][_0xa5b476(0x2c4)]='Required\x20Value\x20Missing',Error=Error+0x1);}else excelRows[_0x5b1007][_0xa5b476(0x2c4)]==_0xa5b476(0x277)&&(document['getElementById']('chkDesignation')[_0xa5b476(0x28d)]&&(excelRows[_0x5b1007][_0xa5b476(0x1ed)]=$(_0xa5b476(0x2f1))[_0xa5b476(0x23c)]()),document['getElementById']('chkManager')[_0xa5b476(0x28d)]&&(excelRows[_0x5b1007][_0xa5b476(0x1c8)]=_0xa2c5c0[0x0][_0xa5b476(0x20f)][_0xa5b476(0x274)]),document[_0xa5b476(0x1ce)](_0xa5b476(0x2be))[_0xa5b476(0x28d)]&&(excelRows[_0x5b1007][_0xa5b476(0x1c8)]=_0xa5b476(0x288)),document[_0xa5b476(0x1ce)]('chkGroup')[_0xa5b476(0x28d)]&&(excelRows[_0x5b1007][_0xa5b476(0x304)]=$(_0xa5b476(0x295))[_0xa5b476(0x23c)]()),Ready=Ready+0x1,Error=Error-0x1,excelRows[_0x5b1007][_0xa5b476(0x2c4)]=_0xa5b476(0x1fc));}}tabledata[_0xa5b476(0x1c7)](excelRows),tabledata[_0xa5b476(0x27b)](pageIndex),$(_0xa5b476(0x303))[_0xa5b476(0x223)](_0xa5b476(0x271)),showmessage();}else alert('please\x20check\x20at\x20list\x20one\x20checkbox\x20'),$(_0xa5b476(0x1d3))[_0xa5b476(0x23c)]();}),$(a0_0xdee0b0(0x2cd))['change'](function(){var _0x1278ec=a0_0xdee0b0;CompaniesId=parseInt($(_0x1278ec(0x25b),$(this))[_0x1278ec(0x23c)]()),CompaniesName=$(_0x1278ec(0x25b),$(this))[_0x1278ec(0x2d5)]();var _0x21d13e=AllOfficeLocation[_0x1278ec(0x235)](function(_0x2ecda2){var _0x39a9fb=_0x1278ec;return _0x2ecda2[_0x39a9fb(0x246)]===CompaniesId;}),_0x55d1e0=document[_0x1278ec(0x1ce)](_0x1278ec(0x2e7));_0x55d1e0[_0x1278ec(0x2dc)]='';for(var _0x1d55a3=0x0;_0x1d55a3<_0x21d13e[_0x1278ec(0x2e8)];_0x1d55a3++){var _0x2cf1b=_0x21d13e[_0x1d55a3][_0x1278ec(0x25a)],_0x2c3ded=_0x21d13e[_0x1d55a3]['ID'];opt=document[_0x1278ec(0x230)]('option'),opt['value']=_0x2c3ded,opt[_0x1278ec(0x2d5)]=_0x2cf1b,_0x55d1e0[_0x1278ec(0x21b)](opt);}Getofficelocation=parseInt($(_0x1278ec(0x25b),$(_0x1278ec(0x2b8)))[_0x1278ec(0x23c)]()),GetofficelocationName=$(_0x1278ec(0x25b),$(_0x1278ec(0x2b8)))[_0x1278ec(0x2d5)]();var _0x32a75a=AllDepartments['filter'](function(_0x4db524){var _0x5cc93f=_0x1278ec;return _0x4db524[_0x5cc93f(0x246)]===CompaniesId;}),_0x55d1e0=document['getElementById'](_0x1278ec(0x2d9));_0x55d1e0['innerHTML']='';for(var _0x1d55a3=0x0;_0x1d55a3<_0x32a75a[_0x1278ec(0x2e8)];_0x1d55a3++){var _0x2cf1b=_0x32a75a[_0x1d55a3][_0x1278ec(0x2aa)],_0x2c3ded=_0x32a75a[_0x1d55a3]['ID'];opt=document[_0x1278ec(0x230)](_0x1278ec(0x2f5)),opt['value']=_0x2c3ded,opt[_0x1278ec(0x2d5)]=_0x2cf1b,_0x55d1e0[_0x1278ec(0x21b)](opt);}GetDepartments=parseInt($(_0x1278ec(0x25b),$(_0x1278ec(0x241)))[_0x1278ec(0x23c)]()),GetDepartmentsName=$(_0x1278ec(0x25b),$(_0x1278ec(0x241)))[_0x1278ec(0x2d5)]();}),$(a0_0xdee0b0(0x241))[a0_0xdee0b0(0x263)](function(){var _0x4cb9a7=a0_0xdee0b0;GetDepartments=parseInt($(_0x4cb9a7(0x25b),$(this))['val']()),GetDepartmentsName=$(_0x4cb9a7(0x25b),$(_0x4cb9a7(0x241)))['text']();}),$('#ddlOfficeLocation')[a0_0xdee0b0(0x263)](function(){var _0x771c37=a0_0xdee0b0;Getofficelocation=parseInt($(_0x771c37(0x25b),$(this))[_0x771c37(0x23c)]()),GetofficelocationName=$('option:selected',$(_0x771c37(0x2b8)))['text']();});function chkManagerevent(_0x4ab30b){var _0x4a9830=a0_0xdee0b0;if(_0x4ab30b[_0x4a9830(0x28d)])$(_0x4a9830(0x1c2))[_0x4a9830(0x205)]('checked',![]),$(_0x4a9830(0x2e5))[_0x4a9830(0x2b1)]('readonly'),$('#txtmanager')[_0x4a9830(0x28c)]();else{}}var TopExecutive='';function chkTopExecutiveevent(_0x467f09){var _0x281d46=a0_0xdee0b0;if(_0x467f09[_0x281d46(0x28d)])$(_0x281d46(0x1db))['prop'](_0x281d46(0x28d),![]),$(_0x281d46(0x2e5))[_0x281d46(0x205)](_0x281d46(0x1f8),!![]),$(_0x281d46(0x2e5))[_0x281d46(0x23c)](''),TopExecutive='Chief\x20Executive';else{}}$(a0_0xdee0b0(0x1d6))['click'](function(){var _0x128263=a0_0xdee0b0;tabledata[_0x128263(0x2e9)](_0x128263(0x217),_0x128263(0x2a1),{'sheetName':_0x128263(0x26c)});});var dvExcel=document[a0_0xdee0b0(0x1ce)](a0_0xdee0b0(0x225));dvExcel[a0_0xdee0b0(0x2dc)]='';var outputArray=[];function removewithfilter(_0x29dba8){var _0x59df97=a0_0xdee0b0;let _0x45eaea=_0x29dba8[_0x59df97(0x235)](function(_0x207cd3,_0x148de5,_0x2f0f9f){var _0x1cdb3f=_0x59df97;return _0x148de5==_0x2f0f9f[_0x1cdb3f(0x2fd)](_0x207cd3);});return _0x45eaea;}function GetItemTypeForListName(_0x2e9360){var _0x440979=a0_0xdee0b0;return _0x440979(0x2ba)+_0x2e9360['charAt'](0x0)[_0x440979(0x20c)]()+_0x2e9360[_0x440979(0x1de)]('\x20')[_0x440979(0x2d7)]('')[_0x440979(0x1d1)](0x1)+_0x440979(0x258);}var response=response||[];function getItems(_0xace374,_0x34335f){var _0x57ba7c=a0_0xdee0b0;return $['ajax']({'url':_0xace374,'type':_0x57ba7c(0x298),'async':![],'headers':{'accept':_0x57ba7c(0x22d)},'success':function(_0xdeb68d){var _0x22ba7e=_0x57ba7c;response=response[_0x22ba7e(0x1dc)](_0xdeb68d['d'][_0x22ba7e(0x202)]),_0xdeb68d['d'][_0x22ba7e(0x216)]?(_0xace374=_0xdeb68d['d'][_0x22ba7e(0x216)],getItems(_0xace374,_0x34335f)):_0x34335f[_0x22ba7e(0x2db)](response);},'error':function(_0x265b2c){var _0xf60d7a=_0x57ba7c;_0x34335f[_0xf60d7a(0x2a0)](_0x265b2c),console[_0xf60d7a(0x28a)](_0x265b2c);}}),_0x34335f[_0x57ba7c(0x1cf)]();}function InsertWelcomeInAnnouncementList(_0x3f9e0e){var _0x33f366=a0_0xdee0b0;$[_0x33f366(0x1bf)]({'url':_spPageContextInfo['webAbsoluteUrl']+_0x33f366(0x270),'type':_0x33f366(0x1e2),'async':![],'data':JSON['stringify'](_0x3f9e0e),'headers':{'Accept':'application/json;odata=verbose','Content-Type':_0x33f366(0x22d),'X-RequestDigest':$('#__REQUESTDIGEST')[_0x33f366(0x23c)](),'X-HTTP-Method':_0x33f366(0x1e2)},'success':function(_0x280c46,_0x1655c9,_0x43b7ef){var _0x4a9542=_0x33f366;console[_0x4a9542(0x28a)](_0x4a9542(0x2b7));},'error':function(_0x2f1383){var _0x3748af=_0x33f366;console[_0x3748af(0x28a)](_0x2f1383),console[_0x3748af(0x28a)](_0x3748af(0x213)),currentDlg[_0x3748af(0x24a)]();}});}