(function(_0x338fac,_0x233454){var _0x407c53=a0_0x16e9,_0x4aa282=_0x338fac();while(!![]){try{var _0x16758d=parseInt(_0x407c53(0x13b))/0x1*(parseInt(_0x407c53(0x181))/0x2)+-parseInt(_0x407c53(0x153))/0x3*(-parseInt(_0x407c53(0x162))/0x4)+-parseInt(_0x407c53(0x14d))/0x5+parseInt(_0x407c53(0x139))/0x6+-parseInt(_0x407c53(0x13f))/0x7*(parseInt(_0x407c53(0x14e))/0x8)+parseInt(_0x407c53(0x137))/0x9+parseInt(_0x407c53(0x14c))/0xa*(-parseInt(_0x407c53(0x15c))/0xb);if(_0x16758d===_0x233454)break;else _0x4aa282['push'](_0x4aa282['shift']());}catch(_0x45907c){_0x4aa282['push'](_0x4aa282['shift']());}}}(a0_0x59d8,0xe46ac));const selectedFolders=[];var zip,listName='DemoLibrary';const myTimeout='';function a0_0x16e9(_0x3cfe9f,_0x36dfd2){var _0x59d8cb=a0_0x59d8();return a0_0x16e9=function(_0x16e9b6,_0x13d7d3){_0x16e9b6=_0x16e9b6-0x12b;var _0x24edbc=_0x59d8cb[_0x16e9b6];return _0x24edbc;},a0_0x16e9(_0x3cfe9f,_0x36dfd2);}var IsleftRestritcfile=![];async function downloadSelectedFilesAsZip(_0x16ee89){var _0x19f990=a0_0x16e9;$['getScript'](_0x19f990(0x12e),function(){var _0x4a1161=_0x19f990;_0x16ee89[0x0][_0x4a1161(0x17a)]==undefined?listName=_0x16ee89[0x0][_0x4a1161(0x158)]:listName=_0x16ee89[0x0][_0x4a1161(0x17a)];var _0x19de0b=[],_0x12cbdf=_0x16ee89['map'](function(_0x44c052){var _0x36ee7c=_0x4a1161;_0x44c052['IsBlock']!=_0x36ee7c(0x12f)?_0x44c052['fileserverrelativeurl']==undefined?$[_0x36ee7c(0x180)](getFolderFilesAndSubFolders(_0x44c052['ServerURL'],_0x19de0b))[_0x36ee7c(0x13a)](function(_0x2e2cdb){return _0x12cbdf=_0x2e2cdb;}):$[_0x36ee7c(0x180)](getFolderFilesAndSubFolders(_0x44c052['fileserverrelativeurl'],_0x19de0b))[_0x36ee7c(0x13a)](function(_0x2c3f98){return _0x12cbdf=_0x2c3f98;}):(Ismessage=!![],messagetext=_0x36ee7c(0x17c));}),_0xf6bf71='';_0x19de0b[_0x4a1161(0x173)]>0x0?Promise[_0x4a1161(0x12b)](_0x12cbdf)[_0x4a1161(0x14f)](function(){var _0xbf8708=_0x4a1161;zip=new JSZip();var _0x4d7aef=_0x19de0b[_0xbf8708(0x16c)](function(_0x1a88a8){var _0x21aeb4=_0xbf8708,_0x12d7f4=_spPageContextInfo[_0x21aeb4(0x16e)]+_0x1a88a8;return fetch(_0x12d7f4)[_0x21aeb4(0x14f)](function(_0x3bce25){if(!_0x3bce25['ok'])throw new Error('Network\x20response\x20was\x20not\x20ok');return _0x3bce25['blob']();})[_0x21aeb4(0x14f)](function(_0x111d8a){var _0x1f677a=_0x21aeb4,_0x167720=_0x1a88a8[_0x1f677a(0x184)](_0x1a88a8[_0x1f677a(0x16b)](listName)+listName[_0x1f677a(0x173)]+0x1);zip[_0x1f677a(0x156)](_0x167720,_0x111d8a);})[_0x21aeb4(0x17f)](_0x4870a0=>{var _0xfe868f=_0x21aeb4;console[_0xfe868f(0x177)](_0xfe868f(0x182),_0x4870a0);});});Promise['all'](_0x4d7aef)[_0xbf8708(0x14f)](function(){dowloadZip();});}):(alert(_0x4a1161(0x178)),IsleftRestritcfile=![],waitingDialog['hide']());});}function dowloadZip(){var _0x134612=a0_0x16e9;zip['generateAsync']({'type':_0x134612(0x157)})[_0x134612(0x14f)](function(_0x996e28){var _0x28b34b=_0x134612,_0x13287d=document[_0x28b34b(0x145)]('a');_0x13287d['href']=URL[_0x28b34b(0x168)](_0x996e28),_0x13287d['download']=_0x28b34b(0x133)+new Date()[_0x28b34b(0x164)]()[_0x28b34b(0x12d)](0x0,0x14)+_0x28b34b(0x134),_0x13287d[_0x28b34b(0x160)](),waitingDialog[_0x28b34b(0x183)](),IsleftRestritcfile&&(alert('Restricted\x20file(s)\x20are\x20skipped\x20to\x20download'),IsleftRestritcfile=![]),$(_0x28b34b(0x167))[_0x28b34b(0x148)](_0x28b34b(0x140),![]),$('.chkShareToMe')['prop'](_0x28b34b(0x140),![]),arrFileFolder=[];});}function getFilesFromLibrary(_0xc7913f){var _0x5a4883=a0_0x16e9,_0x1810d2=_0xc7913f+'/_api/web/lists/getByTitle(\x27DemoLibrary\x27)/items?$select=FileRef&$orderby=FileLeafRef&$filter=FSObjType\x20eq\x201';$[_0x5a4883(0x14b)]({'url':_0x1810d2,'type':_0x5a4883(0x13c),'headers':{'Accept':_0x5a4883(0x14a)},'beforeSend':function(){var _0x7b2693=_0x5a4883;$(_0x7b2693(0x165))[_0x7b2693(0x179)]();},'success':function(_0x216ddb){var _0x598cc9=_0x5a4883,_0x4a03d4=_0x216ddb['d']['results'],_0x1db428=[];_0x4a03d4['forEach'](function(_0x474967){var _0x358877=a0_0x16e9,_0x53dbfc=_0x474967[_0x358877(0x136)][_0x358877(0x184)](_0x474967[_0x358877(0x136)][_0x358877(0x138)]('/')+0x1),_0x13dac7={'name':_0x53dbfc,'url':_0x474967[_0x358877(0x136)],'checkbox':_0x358877(0x12c)+_0x474967[_0x358877(0x136)]+'\x27>'};_0x1db428[_0x358877(0x15a)](_0x13dac7);});var _0x3b76a5=_0x598cc9(0x16a);_0x3b76a5+=_0x598cc9(0x149),_0x1db428['forEach'](function(_0x4be105){var _0x129db3=_0x598cc9;_0x3b76a5+='<tr><td>'+_0x4be105[_0x129db3(0x143)]+'</td><td>'+_0x4be105[_0x129db3(0x175)]+_0x129db3(0x169);}),_0x3b76a5+=_0x598cc9(0x161),$(_0x598cc9(0x16d))['html'](_0x3b76a5);},'error':function(_0x38afbc){var _0x1717a4=_0x5a4883;console[_0x1717a4(0x16f)](_0x38afbc);}});}function getFolderFilesAndSubFolders(_0x4e0453,_0x252318){var _0x223641=a0_0x16e9,_0xba6e51=SiteUrl+'/_api/web/GetFolderByServerRelativeUrl(\x27'+_0x4e0453+_0x223641(0x130);return jQuery[_0x223641(0x14b)]({'url':_0xba6e51,'type':_0x223641(0x13c),'async':![],'headers':{'accept':_0x223641(0x14a)},'beforeSend':function(){},'success':function(_0x1b42db){var _0x14469e=_0x223641,_0x9b69b2=parseBasePermissionss(_0x1b42db['d'][_0x14469e(0x17e)][_0x14469e(0x152)]);if(_0x9b69b2!=![]){var _0x40b6bf=_0x1b42db['d'][_0x14469e(0x150)][_0x14469e(0x15d)];_0x40b6bf[_0x14469e(0x154)](function(_0x346e57){var _0x423e2f=_0x14469e;parseBasePermissionss(_0x346e57[_0x423e2f(0x17e)][_0x423e2f(0x152)])!=![]?_0x252318[_0x423e2f(0x15a)](_0x346e57[_0x423e2f(0x135)]):IsleftRestritcfile=!![];});var _0x29c3a0=_0x1b42db['d'][_0x14469e(0x176)][_0x14469e(0x15d)],_0x47090c=_0x29c3a0[_0x14469e(0x16c)](function(_0x497d79){getFolderFilesAndSubFolders(_0x497d79['ServerRelativeUrl'],_0x252318);});}else IsleftRestritcfile=!![];},'error':function(_0x2aa4d5){console['log'](_0x2aa4d5);}}),_0x252318;}function parseBasePermissionss(_0x196985){var _0x1138ad=a0_0x16e9,_0x4c91e9=new SP[(_0x1138ad(0x166))]();return _0x4c91e9[_0x1138ad(0x159)](_0x196985),_0x4c91e9[_0x1138ad(0x15f)](SP[_0x1138ad(0x142)][_0x1138ad(0x15e)]);}var Isnotpermission=![];function checkFilePermission(_0x592120){var _0x777f45=a0_0x16e9;Isnotpermission=![];var _0x16a8d0=SiteUrl+_0x777f45(0x151)+_0x592120+_0x777f45(0x131);return $[_0x777f45(0x14b)]({'url':_0x16a8d0,'type':_0x777f45(0x13c),'async':![],'headers':{'accept':_0x777f45(0x14a)},'success':function(_0x5a7055){debugger;},'error':function(_0x23155f){var _0x191aa7=_0x777f45;console[_0x191aa7(0x16f)]('Error\x20checking\x20file\x20permissions:\x20'+JSON[_0x191aa7(0x17d)](_0x23155f));}}),Isnotpermission;}function a0_0x59d8(){var _0x856a99=['<table>','indexOf','map','#fileList','portalUrl','log','reject','application/json;\x20odata=verbose','concat','length','webAbsoluteUrl','name','Folders','error','No\x20Files\x20in\x20zip\x20download','fadeIn','SelectedLibrary','resolve','\x20Files/folders\x20with\x20restricted\x20view\x20permission\x20can\x27t\x20be\x20downloaded.','stringify','ListItemAllFields','catch','when','1149782mcNBuL','There\x20was\x20a\x20problem\x20with\x20the\x20fetch\x20operation:','hide','substring','all','<input\x20type=\x27checkbox\x27\x20name=\x27files\x27\x20value=\x27','slice','https://cdnjs.cloudflare.com/ajax/libs/jszip/3.7.1/jszip.min.js','Yes','\x27)?$expand=Folders,Files,\x20ListItemAllFields/EffectiveBasePermissions,\x20Files/ListItemAllFields/EffectiveBasePermissions','\x27)?$select=ID,EncodedAbsUrl,File_x0020_Type&$expand=Folders,Folders/ListItemAllFields/HasUniqueRoleAssignments,Files/ModifiedBy/Title,Files/ListItemAllFields/HasUniqueRoleAssignments,Folders/ListItemAllFields,Files,Files/ListItemAllFields,Files/ListItemAllFields/FileSizeDisplay&$orderby=Modified\x20desc','fail','files_','.zip','ServerRelativeUrl','FileRef','1354077ucTOks','lastIndexOf','9002844HIECiS','done','1IZkeGM','GET','/_api/web/lists/getbytitle(\x27','__next','4942TDjmju','checked','\x27)/folders','PermissionKind','checkbox','\x27)/items?$top=5000','createElement','skiptoken=','\x27)/GetFolderByServerRelativeUrl(\x27','prop','<tr><th>Select</th><th>Name</th></tr>','application/json;odata=verbose','ajax','10gQtYYM','66855mdYgco','1304EtEJFh','then','Files','/_api/web/GetFolderByServerRelativePath(\x27','EffectiveBasePermissions','48aMDzlM','forEach','promise','file','blob','LibraryName','initPropertiesFromJson','push','Deferred','15324639QTJLfs','results','openItems','has','click','</table>','57844yEmQZq','&$filter=FileDirRef\x20eq\x20\x27','toJSON','#overlaysearch','BasePermissions','.chkFileFolder','createObjectURL','</td></tr>'];a0_0x59d8=function(){return _0x856a99;};return a0_0x59d8();}function retrieveAllItemsFromFolder(_0x2695f4,_0x136a7e){var _0x25e863=a0_0x16e9,_0x5bbc05=$[_0x25e863(0x15b)](),_0x4b033f=[];_0x4f4d6e(_0x2695f4,_0x136a7e,null,_0x4b033f);function _0x4f4d6e(_0x4a57f3,_0x26fdf9,_0x503862,_0x77e1da){var _0x287cb0=_0x25e863,_0xc036e7=_spPageContextInfo[_0x287cb0(0x174)]+_0x287cb0(0x13d)+_0x4a57f3+_0x287cb0(0x144);_0x26fdf9&&(_0xc036e7+=_0x287cb0(0x163)+_0x26fdf9+'\x27'),_0x503862&&(_0xc036e7+='&$skiptoken='+encodeURIComponent(_0x503862)),$[_0x287cb0(0x14b)]({'url':_0xc036e7,'method':_0x287cb0(0x13c),'headers':{'Accept':_0x287cb0(0x171)},'success':function(_0x5d31d3){var _0x25efe3=_0x287cb0;_0x77e1da=_0x77e1da['concat'](_0x5d31d3['d'][_0x25efe3(0x15d)]);if(_0x5d31d3['d'][_0x25efe3(0x13e)]){var _0x1edbfe=_0x5d31d3['d'][_0x25efe3(0x13e)],_0x1f10e5=_0x1edbfe[_0x25efe3(0x184)](_0x1edbfe[_0x25efe3(0x16b)](_0x25efe3(0x146))+0xa);_0x4f4d6e(_0x4a57f3,_0x26fdf9,_0x1f10e5,_0x77e1da);}else _0xb8687f(_0x4a57f3,_0x26fdf9,_0x77e1da)[_0x25efe3(0x14f)](function(_0x1f2560){var _0x496ebb=_0x25efe3;_0x5bbc05[_0x496ebb(0x17b)](_0x1f2560);})[_0x25efe3(0x132)](function(_0x569e59){_0x5bbc05['reject'](_0x569e59);});},'error':function(_0xfb110a){var _0x17bbdd=_0x287cb0;_0x5bbc05[_0x17bbdd(0x170)](_0xfb110a);}});}function _0xb8687f(_0x375c2f,_0x2c2f7e,_0x43a71d){var _0x386100=_0x25e863,_0x3cf722=$[_0x386100(0x15b)](),_0x49990c=_spPageContextInfo[_0x386100(0x174)]+_0x386100(0x13d)+_0x375c2f+_0x386100(0x147)+_0x2c2f7e+_0x386100(0x141);return $[_0x386100(0x14b)]({'url':_0x49990c,'method':'GET','headers':{'Accept':_0x386100(0x171)},'success':function(_0x5a2f5c){var _0x53f4b4=_0x386100,_0x3e9135=_0x5a2f5c['d']['results'],_0x1ac4f9=$[_0x53f4b4(0x16c)](_0x3e9135,function(_0x216911){var _0x45ab86=_0x216911['ServerRelativeUrl'];return _0x4f4d6e(_0x375c2f,_0x45ab86,null,_0x43a71d);});$[_0x53f4b4(0x180)]['apply']($,_0x1ac4f9)[_0x53f4b4(0x13a)](function(){var _0x4087cb=_0x53f4b4,_0x4d3de6=[];for(var _0x28184e=0x0;_0x28184e<arguments[_0x4087cb(0x173)];_0x28184e++){_0x4d3de6=_0x4d3de6[_0x4087cb(0x172)](arguments[_0x28184e]);}var _0x562b18=_0x43a71d['concat'](_0x4d3de6);_0x3cf722['resolve'](_0x562b18);})['fail'](function(_0x279177){var _0x31ac42=_0x53f4b4;_0x3cf722[_0x31ac42(0x170)](_0x279177);});},'error':function(_0x596705){var _0x375c8d=_0x386100;_0x3cf722[_0x375c8d(0x170)](_0x596705);}}),_0x3cf722[_0x386100(0x155)]();}return _0x5bbc05[_0x25e863(0x155)]();}