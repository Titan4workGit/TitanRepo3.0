var a0_0x364ba7=a0_0x5160;function a0_0x5160(_0x4726a8,_0x19a32f){var _0x1bb595=a0_0x1bb5();return a0_0x5160=function(_0x5160b2,_0x52790c){_0x5160b2=_0x5160b2-0x1a4;var _0x1aa8ad=_0x1bb595[_0x5160b2];return _0x1aa8ad;},a0_0x5160(_0x4726a8,_0x19a32f);}(function(_0x29bbeb,_0x1ea102){var _0x3458fa=a0_0x5160,_0x46b230=_0x29bbeb();while(!![]){try{var _0x383794=-parseInt(_0x3458fa(0x1e7))/0x1+parseInt(_0x3458fa(0x1cf))/0x2+parseInt(_0x3458fa(0x1fc))/0x3+parseInt(_0x3458fa(0x1b2))/0x4*(parseInt(_0x3458fa(0x1d1))/0x5)+parseInt(_0x3458fa(0x1aa))/0x6*(parseInt(_0x3458fa(0x202))/0x7)+-parseInt(_0x3458fa(0x201))/0x8+-parseInt(_0x3458fa(0x1e1))/0x9*(parseInt(_0x3458fa(0x1cd))/0xa);if(_0x383794===_0x1ea102)break;else _0x46b230['push'](_0x46b230['shift']());}catch(_0x139376){_0x46b230['push'](_0x46b230['shift']());}}}(a0_0x1bb5,0x37aca));const selectedFolders=[];var zip,listName=a0_0x364ba7(0x1de);const myTimeout='';var IsleftRestritcfile=![];async function downloadSelectedFilesAsZip(_0x140070){var _0x2f55c3=a0_0x364ba7;$[_0x2f55c3(0x1f2)](_0x2f55c3(0x1ce),function(){var _0x58c03c=_0x2f55c3;_0x140070[0x0][_0x58c03c(0x1eb)]==undefined?listName=_0x140070[0x0][_0x58c03c(0x1df)]:listName=_0x140070[0x0]['SelectedLibrary'];var _0x3172a6=[],_0x607b50=_0x140070[_0x58c03c(0x1bc)](function(_0x13abfc){var _0x3f0b6c=_0x58c03c;_0x13abfc['IsBlock']!=_0x3f0b6c(0x1a7)?_0x13abfc[_0x3f0b6c(0x1c7)]==undefined?$[_0x3f0b6c(0x1b3)](getFolderFilesAndSubFolders(_0x13abfc[_0x3f0b6c(0x1e0)],_0x3172a6))['done'](function(_0x2ef315){return _0x607b50=_0x2ef315;}):$[_0x3f0b6c(0x1b3)](getFolderFilesAndSubFolders(_0x13abfc[_0x3f0b6c(0x1c7)],_0x3172a6))['done'](function(_0x3fb8d2){return _0x607b50=_0x3fb8d2;}):(Ismessage=!![],messagetext='\x20Files/folders\x20with\x20restricted\x20view\x20permission\x20can\x27t\x20be\x20downloaded.');}),_0x162421='';_0x3172a6['length']>0x0?Promise[_0x58c03c(0x1bf)](_0x607b50)[_0x58c03c(0x1d4)](function(){var _0x54b8c5=_0x58c03c;zip=new JSZip();var _0xd2a384=_0x3172a6['map'](function(_0x5a300d){var _0x4b687f=a0_0x5160,_0x12dafc=_spPageContextInfo[_0x4b687f(0x1d8)]+_0x5a300d;return fetch(_0x12dafc)['then'](function(_0x4d50a6){var _0x3db68e=_0x4b687f;if(!_0x4d50a6['ok'])throw new Error(_0x3db68e(0x1e4));return _0x4d50a6[_0x3db68e(0x1b1)]();})[_0x4b687f(0x1d4)](function(_0x46a6fd){var _0x5d7feb=_0x4b687f,_0x10d671=_0x5a300d[_0x5d7feb(0x1d0)](_0x5a300d['indexOf'](listName)+listName[_0x5d7feb(0x1ed)]+0x1);zip['file'](_0x10d671,_0x46a6fd);})[_0x4b687f(0x1e6)](_0x3bbf16=>{var _0x104309=_0x4b687f;console[_0x104309(0x1be)](_0x104309(0x1cc),_0x3bbf16);});});Promise['all'](_0xd2a384)[_0x54b8c5(0x1d4)](function(){dowloadZip();});}):(alert(_0x58c03c(0x1fd)),IsleftRestritcfile=![],waitingDialog[_0x58c03c(0x1b8)]());});}function dowloadZip(){var _0x37b648=a0_0x364ba7;zip[_0x37b648(0x1b9)]({'type':_0x37b648(0x1b1)})[_0x37b648(0x1d4)](function(_0x5013d4){var _0x5693af=_0x37b648,_0x3d4fa9=document[_0x5693af(0x1e5)]('a');_0x3d4fa9[_0x5693af(0x1d9)]=URL[_0x5693af(0x1ef)](_0x5013d4),_0x3d4fa9['download']=_0x5693af(0x1e3)+new Date()[_0x5693af(0x1db)]()[_0x5693af(0x1ec)](0x0,0x14)+_0x5693af(0x1c6),_0x3d4fa9[_0x5693af(0x1dc)](),waitingDialog[_0x5693af(0x1b8)](),IsleftRestritcfile&&(alert(_0x5693af(0x1c8)),IsleftRestritcfile=![]),$(_0x5693af(0x1b5))[_0x5693af(0x1e2)](_0x5693af(0x1d2),![]),$(_0x5693af(0x1f8))[_0x5693af(0x1e2)]('checked',![]),arrFileFolder=[];});}function getFilesFromLibrary(_0x36ae5f){var _0xb97517=a0_0x364ba7,_0x63bb39=_0x36ae5f+_0xb97517(0x1f6);$['ajax']({'url':_0x63bb39,'type':_0xb97517(0x1c0),'headers':{'Accept':_0xb97517(0x1ea)},'beforeSend':function(){var _0x455687=_0xb97517;$(_0x455687(0x1e9))[_0x455687(0x1b7)]();},'success':function(_0x48884e){var _0x30cd16=_0xb97517,_0x5724cc=_0x48884e['d'][_0x30cd16(0x1c1)],_0x433388=[];_0x5724cc['forEach'](function(_0x4cba89){var _0xb46668=_0x30cd16,_0x1e5945=_0x4cba89[_0xb46668(0x1ca)][_0xb46668(0x1d0)](_0x4cba89[_0xb46668(0x1ca)][_0xb46668(0x1c2)]('/')+0x1),_0xb73382={'name':_0x1e5945,'url':_0x4cba89[_0xb46668(0x1ca)],'checkbox':'<input\x20type=\x27checkbox\x27\x20name=\x27files\x27\x20value=\x27'+_0x4cba89[_0xb46668(0x1ca)]+'\x27>'};_0x433388['push'](_0xb73382);});var _0x1ae23e='<table>';_0x1ae23e+=_0x30cd16(0x1da),_0x433388['forEach'](function(_0x590de4){var _0x180b6e=_0x30cd16;_0x1ae23e+=_0x180b6e(0x1af)+_0x590de4[_0x180b6e(0x1b0)]+_0x180b6e(0x1d7)+_0x590de4[_0x180b6e(0x1bb)]+'</td></tr>';}),_0x1ae23e+=_0x30cd16(0x1a5),$(_0x30cd16(0x1a9))[_0x30cd16(0x1fe)](_0x1ae23e);},'error':function(_0x19cbd7){var _0x249f67=_0xb97517;console[_0x249f67(0x1ac)](_0x19cbd7);}});}function a0_0x1bb5(){var _0x3bd9df=['application/json;odata=verbose','SelectedLibrary','slice','length','webAbsoluteUrl','createObjectURL','PermissionKind','has','getScript','Error\x20checking\x20file\x20permissions:\x20','Deferred','Files','/_api/web/lists/getByTitle(\x27DemoLibrary\x27)/items?$select=FileRef&$orderby=FileLeafRef&$filter=FSObjType\x20eq\x201','resolve','.chkShareToMe','done','Folders','ajax','14376klJgVj','No\x20Files\x20in\x20zip\x20download','html','\x27)?$expand=Folders,Files,\x20ListItemAllFields/EffectiveBasePermissions,\x20Files/ListItemAllFields/EffectiveBasePermissions','/_api/web/GetFolderByServerRelativeUrl(\x27','1628912PNPijJ','371483kWUDyD','indexOf','</table>','reject','Yes','ServerRelativeUrl','#fileList','36iBsSQE','EffectiveBasePermissions','log','\x27)/GetFolderByServerRelativeUrl(\x27','concat','<tr><td>','checkbox','blob','1646564yutsZR','when','initPropertiesFromJson','.chkFileFolder','__next','fadeIn','hide','generateAsync','openItems','name','map','/_api/web/GetFolderByServerRelativePath(\x27','error','all','GET','results','lastIndexOf','\x27)?$select=ID,EncodedAbsUrl,File_x0020_Type&$expand=Folders,Folders/ListItemAllFields/HasUniqueRoleAssignments,Files/ModifiedBy/Title,Files/ListItemAllFields/HasUniqueRoleAssignments,Folders/ListItemAllFields,Files,Files/ListItemAllFields,Files/ListItemAllFields/FileSizeDisplay&$orderby=Modified\x20desc','promise','fail','.zip','fileserverrelativeurl','Restricted\x20file(s)\x20are\x20skipped\x20to\x20download','\x27)/items?$top=5000','FileRef','application/json;\x20odata=verbose','There\x20was\x20a\x20problem\x20with\x20the\x20fetch\x20operation:','49530lfecSh','https://cdnjs.cloudflare.com/ajax/libs/jszip/3.7.1/jszip.min.js','615476aAnJQV','substring','5eHLbhe','checked','BasePermissions','then','stringify','ListItemAllFields','</td><td>','portalUrl','href','<tr><th>Select</th><th>Name</th></tr>','toJSON','click','/_api/web/lists/getbytitle(\x27','DemoLibrary','LibraryName','ServerURL','990ixnsFj','prop','files_','Network\x20response\x20was\x20not\x20ok','createElement','catch','66099GPTQCU','&$skiptoken=','#overlaysearch'];a0_0x1bb5=function(){return _0x3bd9df;};return a0_0x1bb5();}function getFolderFilesAndSubFolders(_0x4e82fd,_0x4f4eb7){var _0x302d8b=a0_0x364ba7,_0x4b1a0d=SiteUrl+_0x302d8b(0x200)+_0x4e82fd+_0x302d8b(0x1ff);return jQuery[_0x302d8b(0x1fb)]({'url':_0x4b1a0d,'type':_0x302d8b(0x1c0),'async':![],'headers':{'accept':_0x302d8b(0x1ea)},'beforeSend':function(){},'success':function(_0x3fc4ff){var _0x5b8ea2=_0x302d8b,_0x3eb669=parseBasePermissionss(_0x3fc4ff['d'][_0x5b8ea2(0x1d6)][_0x5b8ea2(0x1ab)]);if(_0x3eb669!=![]){var _0x38bbb5=_0x3fc4ff['d'][_0x5b8ea2(0x1f5)][_0x5b8ea2(0x1c1)];_0x38bbb5['forEach'](function(_0x5ae784){var _0x1422e7=_0x5b8ea2;parseBasePermissionss(_0x5ae784[_0x1422e7(0x1d6)]['EffectiveBasePermissions'])!=![]?_0x4f4eb7['push'](_0x5ae784[_0x1422e7(0x1a8)]):IsleftRestritcfile=!![];});var _0x342b7f=_0x3fc4ff['d'][_0x5b8ea2(0x1fa)][_0x5b8ea2(0x1c1)],_0x5bc008=_0x342b7f['map'](function(_0xdd4587){getFolderFilesAndSubFolders(_0xdd4587['ServerRelativeUrl'],_0x4f4eb7);});}else IsleftRestritcfile=!![];},'error':function(_0x3df4cb){var _0x47e999=_0x302d8b;console[_0x47e999(0x1ac)](_0x3df4cb);}}),_0x4f4eb7;}function parseBasePermissionss(_0x3e54fb){var _0x502d4b=a0_0x364ba7,_0x33de2d=new SP[(_0x502d4b(0x1d3))]();return _0x33de2d[_0x502d4b(0x1b4)](_0x3e54fb),_0x33de2d[_0x502d4b(0x1f1)](SP[_0x502d4b(0x1f0)][_0x502d4b(0x1ba)]);}var Isnotpermission=![];function checkFilePermission(_0x5ab028){var _0x2e418d=a0_0x364ba7;Isnotpermission=![];var _0x3c8f47=SiteUrl+_0x2e418d(0x1bd)+_0x5ab028+_0x2e418d(0x1c3);return $[_0x2e418d(0x1fb)]({'url':_0x3c8f47,'type':'GET','async':![],'headers':{'accept':_0x2e418d(0x1ea)},'success':function(_0x58e02b){debugger;},'error':function(_0xbd997f){var _0x556eae=_0x2e418d;console[_0x556eae(0x1ac)](_0x556eae(0x1f3)+JSON[_0x556eae(0x1d5)](_0xbd997f));}}),Isnotpermission;}function retrieveAllItemsFromFolder(_0x4c6b2e,_0x3e08d7){var _0x3afad6=a0_0x364ba7,_0x10de27=$[_0x3afad6(0x1f4)](),_0x2b3cd1=[];_0x309688(_0x4c6b2e,_0x3e08d7,null,_0x2b3cd1);function _0x309688(_0x1ab0b3,_0x4a330b,_0x97d4f3,_0x455b46){var _0x1b8afc=_0x3afad6,_0x4be38d=_spPageContextInfo[_0x1b8afc(0x1ee)]+_0x1b8afc(0x1dd)+_0x1ab0b3+_0x1b8afc(0x1c9);_0x4a330b&&(_0x4be38d+='&$filter=FileDirRef\x20eq\x20\x27'+_0x4a330b+'\x27'),_0x97d4f3&&(_0x4be38d+=_0x1b8afc(0x1e8)+encodeURIComponent(_0x97d4f3)),$[_0x1b8afc(0x1fb)]({'url':_0x4be38d,'method':_0x1b8afc(0x1c0),'headers':{'Accept':_0x1b8afc(0x1cb)},'success':function(_0xa8517a){var _0x2f84ce=_0x1b8afc;_0x455b46=_0x455b46[_0x2f84ce(0x1ae)](_0xa8517a['d'][_0x2f84ce(0x1c1)]);if(_0xa8517a['d'][_0x2f84ce(0x1b6)]){var _0x24caae=_0xa8517a['d'][_0x2f84ce(0x1b6)],_0x67ef35=_0x24caae[_0x2f84ce(0x1d0)](_0x24caae[_0x2f84ce(0x1a4)]('skiptoken=')+0xa);_0x309688(_0x1ab0b3,_0x4a330b,_0x67ef35,_0x455b46);}else _0x3cab16(_0x1ab0b3,_0x4a330b,_0x455b46)[_0x2f84ce(0x1d4)](function(_0x3fb415){var _0x1048ac=_0x2f84ce;_0x10de27[_0x1048ac(0x1f7)](_0x3fb415);})[_0x2f84ce(0x1c5)](function(_0x216488){var _0x3397d5=_0x2f84ce;_0x10de27[_0x3397d5(0x1a6)](_0x216488);});},'error':function(_0x487536){var _0x856628=_0x1b8afc;_0x10de27[_0x856628(0x1a6)](_0x487536);}});}function _0x3cab16(_0x3335f7,_0x483b92,_0x329dad){var _0x2cc17e=_0x3afad6,_0x37ef8b=$['Deferred'](),_0x3fe494=_spPageContextInfo[_0x2cc17e(0x1ee)]+_0x2cc17e(0x1dd)+_0x3335f7+_0x2cc17e(0x1ad)+_0x483b92+'\x27)/folders';return $[_0x2cc17e(0x1fb)]({'url':_0x3fe494,'method':'GET','headers':{'Accept':'application/json;\x20odata=verbose'},'success':function(_0x4db7fd){var _0x2b9676=_0x2cc17e,_0x3f9e60=_0x4db7fd['d'][_0x2b9676(0x1c1)],_0x3e28f2=$['map'](_0x3f9e60,function(_0x48a685){var _0x1ca877=_0x48a685['ServerRelativeUrl'];return _0x309688(_0x3335f7,_0x1ca877,null,_0x329dad);});$[_0x2b9676(0x1b3)]['apply']($,_0x3e28f2)[_0x2b9676(0x1f9)](function(){var _0x2e2401=_0x2b9676,_0x5e963f=[];for(var _0x4c5c3c=0x0;_0x4c5c3c<arguments[_0x2e2401(0x1ed)];_0x4c5c3c++){_0x5e963f=_0x5e963f['concat'](arguments[_0x4c5c3c]);}var _0x148601=_0x329dad['concat'](_0x5e963f);_0x37ef8b['resolve'](_0x148601);})[_0x2b9676(0x1c5)](function(_0x5c0418){_0x37ef8b['reject'](_0x5c0418);});},'error':function(_0x5d0254){var _0x576eaf=_0x2cc17e;_0x37ef8b[_0x576eaf(0x1a6)](_0x5d0254);}}),_0x37ef8b['promise']();}return _0x10de27[_0x3afad6(0x1c4)]();}