var a0_0x4d15ba=a0_0x55e6;(function(_0x4731b2,_0x4ecf08){var _0x139e12=a0_0x55e6,_0x460663=_0x4731b2();while(!![]){try{var _0x3ce1d8=parseInt(_0x139e12(0x1a3))/0x1*(-parseInt(_0x139e12(0x263))/0x2)+parseInt(_0x139e12(0x280))/0x3+-parseInt(_0x139e12(0x2c9))/0x4*(-parseInt(_0x139e12(0x294))/0x5)+-parseInt(_0x139e12(0x1a8))/0x6+-parseInt(_0x139e12(0x243))/0x7*(-parseInt(_0x139e12(0x264))/0x8)+-parseInt(_0x139e12(0x20a))/0x9+-parseInt(_0x139e12(0x2d5))/0xa*(parseInt(_0x139e12(0x1ce))/0xb);if(_0x3ce1d8===_0x4ecf08)break;else _0x460663['push'](_0x460663['shift']());}catch(_0x17f334){_0x460663['push'](_0x460663['shift']());}}}(a0_0x2f7b,0x89d83));var IsFirstTime=!![],token='',AvilableLicense='';$(document)[a0_0x4d15ba(0x295)](function(){var _0x5d3cb0=a0_0x4d15ba;$(_0x5d3cb0(0x250))['tooltip'](),AvilableLicense=GetAvailbleLicence(),$('#hAvilableLicenses')[_0x5d3cb0(0x23d)](AvilableLicense),IsAdmin(),LoadProject(),getTemplate();});function IsAdmin(){var _0x58dcfd=a0_0x4d15ba;$[_0x58dcfd(0x186)](CommonFunction['AdministratorUsers']())[_0x58dcfd(0x11d)](function(_0x283d4d){var _0x32179d=_0x58dcfd;if(_0x283d4d)IsTechadmin=![];else return $(_0x32179d(0x1b4))['html'](''),htmlNotAuthorized+=_0x32179d(0x266),htmlNotAuthorized+=_0x32179d(0x2bf),htmlNotAuthorized+='<span><h3\x20class=\x22red-color\x20text-center\x20mt-25\x22>Please\x20contact\x20your\x20administrator!\x20</h3></span><br>',htmlNotAuthorized+=_0x32179d(0x1fc),$(_0x32179d(0x1b4))[_0x32179d(0x287)](htmlNotAuthorized),![];});}function initializePeoplePicker(_0x2f4de6,_0x2ce785){var _0x21c2b7=a0_0x4d15ba,_0x5d4ac6={};_0x5d4ac6['PrincipalAccountType']=_0x21c2b7(0x2a3),_0x5d4ac6[_0x21c2b7(0x23b)]=0xf,_0x5d4ac6[_0x21c2b7(0x2c7)]=0xf,_0x5d4ac6[_0x21c2b7(0x220)]=_0x2ce785,_0x5d4ac6[_0x21c2b7(0x21e)]=0x32,_0x5d4ac6[_0x21c2b7(0x15a)]='358px',this[_0x21c2b7(0x284)](_0x2f4de6,null,_0x5d4ac6),$(_0x21c2b7(0x242))[_0x21c2b7(0x1c2)](0x12c);}function setPeoplePickerUsersInfoCurrent(_0x4f6e6c,_0x2c6bef){var _0xe2f329=a0_0x4d15ba,_0x21dae7=$('[id$=\x27'+_0x4f6e6c+'\x27]'),_0x4a463a=SPClientPeoplePicker['SPClientPeoplePickerDict'][_0x21dae7[0x0]['id']];_0x4a463a[_0xe2f329(0x2b9)](_0x2c6bef,![]),_0x4a463a['SetEnabledState'](![]);}var peoplePickerDiv='',peoplePickerDivsuper='',email='',htmlGridarray=[],IsSetvalue=![],GroupId='',GuestUserEmail='',ExtrnaluserId='',chkInitiated='',chkInvited='',chkActive='',chkInactive='',Isfillter=![],userListItemId='',GuestUserEmail='',UserListId=[],Client_Id;$(function(){var _0x1cfd9d=a0_0x4d15ba;$('#invitetxtValidityUpto')[_0x1cfd9d(0x191)]({'changeMonth':!![],'changeYear':!![],'minDate':0x0});}),$(function(){var _0x5329dd=a0_0x4d15ba;$(_0x5329dd(0x2a6))['datepicker']({'changeMonth':!![],'changeYear':!![],'minDate':0x0});});var Initiated='',Invited='',Active='',Inactive='',Accepted='',NotAccepted='';$(a0_0x4d15ba(0x164))['on'](a0_0x4d15ba(0x1ac),function(){var _0x5de228=a0_0x4d15ba;this[_0x5de228(0x19e)]?Initiated=_0x5de228(0x183):Initiated='';}),$(a0_0x4d15ba(0x18c))['on']('change',function(){var _0x22368b=a0_0x4d15ba;this[_0x22368b(0x19e)]?Invited=_0x22368b(0x276):Invited='';}),$(a0_0x4d15ba(0x24a))['on'](a0_0x4d15ba(0x1ac),function(){var _0x4f6d66=a0_0x4d15ba;this[_0x4f6d66(0x19e)]?Accepted=_0x4f6d66(0x1fb):Accepted='';}),$(a0_0x4d15ba(0x2b4))['on']('change',function(){var _0x230a25=a0_0x4d15ba;this[_0x230a25(0x19e)]?Active='(Status\x20eq\x20\x27Active\x27)':Active='';}),$(a0_0x4d15ba(0x12e))['on'](a0_0x4d15ba(0x1ac),function(){var _0x116d53=a0_0x4d15ba;this[_0x116d53(0x19e)]?Inactive='(Status\x20eq\x20\x27Inactive\x27)':Inactive='';}),$(a0_0x4d15ba(0x1dd))['on']('change',function(){this['checked']?NotAccepted='(Status\x20eq\x20\x27Invited\x27)':NotAccepted='';}),$(a0_0x4d15ba(0x285))[a0_0x4d15ba(0x1ac)](function(){readURL(this);}),$(a0_0x4d15ba(0x270))[a0_0x4d15ba(0x1c7)](function(){AvilableLicense>0x0?UpdateGeustuser(ExtrnaluserId):alert('Your\x20license\x20limit\x20has\x20overed.');}),$(a0_0x4d15ba(0x227))[a0_0x4d15ba(0x187)](function(){var _0x3c3eac=a0_0x4d15ba;$[_0x3c3eac(0x186)](GetGueastUsers($(_0x3c3eac(0x227))['val']()))[_0x3c3eac(0x11d)](function(_0x2148be){var _0x14fe99=_0x3c3eac;_0x2148be[_0x14fe99(0x1d2)]>0x0&&(creationType=_0x2148be[0x0][_0x14fe99(0x119)],externalUserState=_0x2148be[0x0][_0x14fe99(0x28d)]);});if(externalUserState==_0x3c3eac(0x2c6))Pertimtblock($(_0x3c3eac(0x227))[_0x3c3eac(0x1be)]());else{for(var _0x456645 in htmlGridarray){if(htmlGridarray[_0x456645]['email']==$(_0x3c3eac(0x227))[_0x3c3eac(0x1be)]()){htmlGridarray[_0x456645][_0x3c3eac(0x28d)]=_0x3c3eac(0x2ab);break;}}GenerateGridHtml(htmlGridarray),$(_0x3c3eac(0x1de))['modal'](_0x3c3eac(0x1f8)),$(_0x3c3eac(0x205))[_0x3c3eac(0x23d)]('');var _0x2cc4c4=_0x3c3eac(0x1a4);$(_0x3c3eac(0x205))['text'](_0x2cc4c4),$(_0x3c3eac(0x1f5))[_0x3c3eac(0x1d6)](),$(_0x3c3eac(0x15e))[_0x3c3eac(0x1f8)](),$(_0x3c3eac(0x262))[_0x3c3eac(0x2aa)](_0x3c3eac(0x1d6)),$(_0x3c3eac(0x215))[_0x3c3eac(0x1d6)]();}});var IscheckInvite=!![];$(a0_0x4d15ba(0x17d))[a0_0x4d15ba(0x187)](function(){var _0x4e652e=a0_0x4d15ba;$[_0x4e652e(0x186)](GetItemToList($(_0x4e652e(0x17d))['val']()))[_0x4e652e(0x11d)](function(_0x14e8a4){var _0x18b51e=_0x4e652e;_0x14e8a4['length']>0x0?(SetTextBox(_0x14e8a4[0x0]['Id'],_0x18b51e(0x172)),$(_0x18b51e(0x17d))[_0x18b51e(0x269)]('disabled')):(IscheckInvite=![],Getinvitebox(),IscheckInvite=!![]);});}),$('#btnSendReminder')['click'](function(){InviteuserSendReminder();}),$('#GetMasterclientfilter')['click'](function(){var _0x4e32f1=a0_0x4d15ba;GetClientMasterfilter();var _0x3df065=$('<option>');_0x3df065[_0x4e32f1(0x139)](_0x4e32f1(0x21a),_0x4e32f1(0x24f))['text'](_0x4e32f1(0x24f)),$(_0x4e32f1(0x2c2))[_0x4e32f1(0x287)](_0x3df065);for(var _0x105a3e=0x0;_0x105a3e<ClientInternalMembers['length'];_0x105a3e++){_0x3df065=$(_0x4e32f1(0x259)),_0x3df065['attr']('value',ClientInternalMembers[_0x105a3e][_0x4e32f1(0x233)])['text'](ClientInternalMembers[_0x105a3e][_0x4e32f1(0x233)]),$(_0x4e32f1(0x2c2))[_0x4e32f1(0x287)](_0x3df065);}create_custom_dropdowns();});function create_custom_dropdowns(){var _0x3fe92e=a0_0x4d15ba;$(_0x3fe92e(0x2c2))[_0x3fe92e(0x26c)](function(_0x4cf57b,_0x7a5b1d){var _0x3078c5=_0x3fe92e;if(!$(this)[_0x3078c5(0x2b2)]()[_0x3078c5(0x16e)](_0x3078c5(0x25d))){$(this)[_0x3078c5(0x22d)](_0x3078c5(0x14a)+($(this)[_0x3078c5(0x139)]('class')||'')+'\x22\x20tabindex=\x220\x22><span\x20class=\x22current\x22></span><div\x20class=\x22list\x22><ul></ul></div></div>');var _0x285d2=$(this)[_0x3078c5(0x2b2)](),_0xd5a992=$(_0x7a5b1d)[_0x3078c5(0x1f7)](_0x3078c5(0x1b6)),_0x438d6f=$(this)['find']('option:selected');_0x285d2[_0x3078c5(0x1f7)](_0x3078c5(0x2bb))[_0x3078c5(0x1a2)](_0x438d6f[_0x3078c5(0x254)](_0x3078c5(0x1a0))||_0x438d6f[_0x3078c5(0x23d)]()),_0xd5a992[_0x3078c5(0x26c)](function(_0x4782a6,_0x278dbf){var _0x3e2cb7=_0x3078c5,_0x464aa7=$(_0x278dbf)[_0x3e2cb7(0x254)](_0x3e2cb7(0x1a0))||'';_0x285d2['find']('ul')[_0x3e2cb7(0x287)]('<li\x20class=\x22option\x20'+($(_0x278dbf)['is'](_0x3e2cb7(0x20b))?_0x3e2cb7(0x1e8):'')+_0x3e2cb7(0x267)+$(_0x278dbf)[_0x3e2cb7(0x1be)]()+_0x3e2cb7(0x2b3)+_0x464aa7+'\x22>'+$(_0x278dbf)['text']()+'</li>');});}});var _0x5e7c87=$(_0x3fe92e(0x154))['find'](_0x3fe92e(0x22a));_0x5e7c87[_0x3fe92e(0x1d2)]==0x0&&$('.dropdown-select\x20ul')[_0x3fe92e(0x126)](_0x3fe92e(0x275));}$(document)['on'](a0_0x4d15ba(0x1c7),'.dropdown-select',function(_0x58fe07){var _0x479ec6=a0_0x4d15ba;if($(_0x58fe07[_0x479ec6(0x293)])[_0x479ec6(0x16e)](_0x479ec6(0x252)))return;$(_0x479ec6(0x163))[_0x479ec6(0x15b)]($(this))[_0x479ec6(0x2a5)](_0x479ec6(0x2a7)),$(this)[_0x479ec6(0x1c1)](_0x479ec6(0x2a7)),$(this)[_0x479ec6(0x16e)]('open')?($(this)['find']('.option')[_0x479ec6(0x139)]('tabindex',0x0),$(this)[_0x479ec6(0x1f7)](_0x479ec6(0x11c))['focus']()):($(this)[_0x479ec6(0x1f7)]('.option')[_0x479ec6(0x269)](_0x479ec6(0x1bb)),$(this)[_0x479ec6(0x24d)]());}),$(document)['on'](a0_0x4d15ba(0x1c7),function(_0x47cfbe){var _0x4e6f5a=a0_0x4d15ba;$(_0x47cfbe[_0x4e6f5a(0x293)])[_0x4e6f5a(0x2a9)](_0x4e6f5a(0x163))['length']===0x0&&($(_0x4e6f5a(0x163))[_0x4e6f5a(0x2a5)](_0x4e6f5a(0x2a7)),$(_0x4e6f5a(0x1a9))['removeAttr'](_0x4e6f5a(0x1bb))),_0x47cfbe[_0x4e6f5a(0x236)]();});function filters(){var _0x4f67e7=a0_0x4d15ba;debugger;var _0xb25831=$(_0x4f67e7(0x22a))[_0x4f67e7(0x1be)]();$(_0x4f67e7(0x26b))[_0x4f67e7(0x26c)](function(){var _0x2fcc81=_0x4f67e7,_0x314ad3=$(this)[_0x2fcc81(0x23d)]();_0x314ad3[_0x2fcc81(0x19c)]()[_0x2fcc81(0x141)](_0xb25831[_0x2fcc81(0x19c)]())>-0x1?$(this)[_0x2fcc81(0x1d6)]():$(this)[_0x2fcc81(0x1f8)]();});};$(document)['on'](a0_0x4d15ba(0x1c7),a0_0x4d15ba(0x1a9),function(_0x491f97){var _0x5429f2=a0_0x4d15ba;$(this)['closest'](_0x5429f2(0x154))[_0x5429f2(0x1f7)](_0x5429f2(0x2c2))[_0x5429f2(0x2a5)]('selected'),$(this)[_0x5429f2(0x222)]('');var _0x4125f6=$(this)[_0x5429f2(0x254)](_0x5429f2(0x1a0))||$(this)[_0x5429f2(0x23d)]();$(this)[_0x5429f2(0x2a9)](_0x5429f2(0x163))['find'](_0x5429f2(0x2bb))[_0x5429f2(0x23d)](_0x4125f6),$(this)[_0x5429f2(0x2a9)](_0x5429f2(0x163))[_0x5429f2(0x2cf)](_0x5429f2(0x2c2))[_0x5429f2(0x1be)]($(this)['data'](_0x5429f2(0x21a)))['trigger'](_0x5429f2(0x1ac)),$('#txtSearchValue')[_0x5429f2(0x1be)](''),filters();}),$(document)['on'](a0_0x4d15ba(0x1ae),a0_0x4d15ba(0x163),function(_0x394181){var _0x734f7a=a0_0x4d15ba,_0x307907=$($(this)[_0x734f7a(0x1f7)](_0x734f7a(0x1af))[0x0]||$(this)[_0x734f7a(0x1f7)]('.list\x20.option.selected')[0x0]);if(_0x394181['keyCode']==0xd)return $(this)[_0x734f7a(0x16e)](_0x734f7a(0x2a7))?_0x307907['trigger'](_0x734f7a(0x1c7)):$(this)['trigger'](_0x734f7a(0x1c7)),![];else{if(_0x394181['keyCode']==0x28)return!$(this)['hasClass'](_0x734f7a(0x2a7))?$(this)[_0x734f7a(0x144)](_0x734f7a(0x1c7)):_0x307907[_0x734f7a(0x2b2)]()[_0x734f7a(0x24d)](),![];else{if(_0x394181[_0x734f7a(0x223)]==0x26){if(!$(this)['hasClass'](_0x734f7a(0x2a7)))$(this)[_0x734f7a(0x144)]('click');else{var _0x307907=$($(this)[_0x734f7a(0x1f7)]('.list\x20.option:focus')[0x0]||$(this)[_0x734f7a(0x1f7)](_0x734f7a(0x27c))[0x0]);_0x307907['prev']()[_0x734f7a(0x24d)]();}return![];}else{if(_0x394181[_0x734f7a(0x223)]==0x1b)return $(this)[_0x734f7a(0x16e)](_0x734f7a(0x2a7))&&$(this)[_0x734f7a(0x144)](_0x734f7a(0x1c7)),![];}}}});function Getfilterdata(){Isfillter=!![],LoadProject();}function Clearfilter(){var _0x447655=a0_0x4d15ba;$(_0x447655(0x1a5))[_0x447655(0x15c)]('checked',![]),Isfillter=![],LoadProject();}var GI=0x0,GLength=0x0;function LoadProject(){var _0x2f93f5=a0_0x4d15ba;addSpinner($('body')),$[_0x2f93f5(0x186)](GetExternalUsers())[_0x2f93f5(0x11d)](function(_0x2e2ff1){var _0x1210ab=_0x2f93f5;try{token=localStorage[_0x1210ab(0x13b)](_0x1210ab(0x212));if(token==null||token=='')authContext[_0x1210ab(0x1e1)]('https://graph.microsoft.com',function(_0x5405d2,_0x31915b){var _0x104d98=_0x1210ab;console[_0x104d98(0x2d2)](_0x31915b),console['log'](_0x5405d2);if(_0x5405d2||!_0x31915b)return;localStorage[_0x104d98(0x140)](_0x104d98(0x212),_0x31915b),_0x31915b=localStorage[_0x104d98(0x13b)](_0x104d98(0x212)),token1=localStorage[_0x104d98(0x13b)]('logintoken');}),LoadProject();else{htmlGridarray=[];var _0x223256=0x0;GLength=_0x2e2ff1[_0x1210ab(0x1d2)];for(GI=0x0;GI<_0x2e2ff1['length'];GI++){_0x223256=GI;var _0x34058e=new Date(_0x2e2ff1[_0x223256][_0x1210ab(0x22c)]),_0x3db725='',_0x3d614a='';_0x2e2ff1[_0x223256][_0x1210ab(0x2b1)]==_0x1210ab(0x192)?$[_0x1210ab(0x186)](GetGueastUsers(_0x2e2ff1[_0x223256]['email']))[_0x1210ab(0x11d)](function(_0x560216){var _0x55f4a9=_0x1210ab;_0x560216[_0x55f4a9(0x1d2)]>0x0&&(_0x3db725=_0x560216[0x0]['creationType'],_0x3d614a=_0x560216[0x0][_0x55f4a9(0x28d)],htmlGridarray[_0x55f4a9(0x1ff)]({'creationType':_0x3db725,'externalUserState':_0x3d614a,'Title':_0x2e2ff1[_0x223256][_0x55f4a9(0x256)][_0x55f4a9(0x233)]?_0x2e2ff1[_0x223256]['LoginName'][_0x55f4a9(0x233)]:_0x2e2ff1[_0x223256]['Guest_name'],'email':_0x2e2ff1[_0x223256][_0x55f4a9(0x207)],'Designation':_0x2e2ff1[_0x223256]['Designation']?_0x2e2ff1[_0x223256][_0x55f4a9(0x130)]:'','CollaborationType':_0x2e2ff1[_0x223256][_0x55f4a9(0x26a)]?_0x2e2ff1[_0x223256][_0x55f4a9(0x26a)]:'','ClientName':_0x2e2ff1[_0x223256][_0x55f4a9(0x11b)][_0x55f4a9(0x233)],'Status':_0x2e2ff1[_0x223256][_0x55f4a9(0x2b1)],'ID':_0x2e2ff1[_0x223256]['Id'],'ValidUpto':_0x2e2ff1[_0x223256][_0x55f4a9(0x218)],'ReferenceCode':_0x2e2ff1[_0x223256][_0x55f4a9(0x13f)],'Modified':$[_0x55f4a9(0x191)][_0x55f4a9(0x1a6)]('d\x20M,\x20yy\x20',_0x34058e)}));}):htmlGridarray[_0x1210ab(0x1ff)]({'creationType':_0x3db725,'externalUserState':_0x3d614a,'Title':_0x2e2ff1[_0x223256][_0x1210ab(0x256)][_0x1210ab(0x233)]?_0x2e2ff1[_0x223256]['LoginName'][_0x1210ab(0x233)]:_0x2e2ff1[_0x223256][_0x1210ab(0x151)],'email':_0x2e2ff1[_0x223256][_0x1210ab(0x207)],'Designation':_0x2e2ff1[_0x223256][_0x1210ab(0x130)],'CollaborationType':_0x2e2ff1[_0x223256][_0x1210ab(0x26a)]?_0x2e2ff1[_0x223256][_0x1210ab(0x26a)]:'','ClientName':_0x2e2ff1[_0x223256][_0x1210ab(0x11b)][_0x1210ab(0x233)],'Status':_0x2e2ff1[_0x223256][_0x1210ab(0x2b1)],'ID':_0x2e2ff1[_0x223256]['Id'],'ValidUpto':_0x2e2ff1[_0x223256]['ValidUpto'],'ReferenceCode':_0x2e2ff1[_0x223256][_0x1210ab(0x13f)],'Modified':$[_0x1210ab(0x191)]['formatDate'](_0x1210ab(0x1ca),_0x34058e)});}GenerateGridHtml(htmlGridarray),removeSpinner($(_0x1210ab(0x160)));}}catch(_0x4a26e0){return alert(_0x223256+_0x1210ab(0x157)+_0x4a26e0),![];}});}function GenerateGridHtml(_0x1bd948){var _0x2d0d50=a0_0x4d15ba,_0x2eb168='';$(_0x2d0d50(0x2b7))[_0x2d0d50(0x1a2)](''),_0x2eb168+=_0x2d0d50(0x2ba)+_0x2d0d50(0x193)+_0x2d0d50(0x219)+_0x2d0d50(0x221)+'<th\x20class=\x22text-left\x20border-bottom-0\x22\x20\x20><b>Action\x20Date</b></th>'+_0x2d0d50(0x29c)+_0x2d0d50(0x1ef)+_0x2d0d50(0x209)+'\x20<th\x20class=\x22text-center\x20border-bottom-0\x22><b>Action</b></th>'+_0x2d0d50(0x1e5)+_0x2d0d50(0x131)+_0x2d0d50(0x1f2);if(htmlGridarray['length']>0x0){for(var _0x4cd881=0x0;_0x4cd881<htmlGridarray[_0x2d0d50(0x1d2)];_0x4cd881++){if(htmlGridarray[_0x4cd881][_0x2d0d50(0x28d)]==_0x2d0d50(0x2ab))_0x2eb168+='<tr\x20class=\x22text-left\x22>'+_0x2d0d50(0x1fd)+htmlGridarray[_0x4cd881][_0x2d0d50(0x233)]+_0x2d0d50(0x136)+'<td>'+htmlGridarray[_0x4cd881]['email']+'</td>'+_0x2d0d50(0x1fd)+htmlGridarray[_0x4cd881][_0x2d0d50(0x22c)]+'</td>'+_0x2d0d50(0x1fd)+htmlGridarray[_0x4cd881][_0x2d0d50(0x26a)]+_0x2d0d50(0x136)+_0x2d0d50(0x1fd)+_0x2d0d50(0x257)+htmlGridarray[_0x4cd881][_0x2d0d50(0x14b)]+_0x2d0d50(0x1d4)+_0x2d0d50(0x1d0)+_0x2d0d50(0x17b)+'<li\x20role=\x22presentation\x22\x20class=\x22pills-box-info\x20Initiated\x22><a\x20href=\x22#\x22>Initiated</a></li>'+_0x2d0d50(0x150)+_0x2d0d50(0x2b8)+_0x2d0d50(0x1d7)+_0x2d0d50(0x23f)+_0x2d0d50(0x1d4)+_0x2d0d50(0x136)+'<td>Invitation\x20Sent</td>'+_0x2d0d50(0x1fd)+_0x2d0d50(0x12f)+_0x2d0d50(0x20f)+htmlGridarray[_0x4cd881]['ID']+_0x2d0d50(0x138)+_0x2d0d50(0x2af)+_0x2d0d50(0x120)+_0x2d0d50(0x2cd)+htmlGridarray[_0x4cd881]['ID']+',\x27'+htmlGridarray[_0x4cd881]['email']+_0x2d0d50(0x216)+'<i\x20class=\x22fa\x20fa-trash-o\x22></i>'+'</a>'+_0x2d0d50(0x1d4)+_0x2d0d50(0x136)+_0x2d0d50(0x17e);else{if(htmlGridarray[_0x4cd881][_0x2d0d50(0x28d)]==_0x2d0d50(0x2c6)||htmlGridarray[_0x4cd881][_0x2d0d50(0x2b1)]==_0x2d0d50(0x2c6)){var _0x12a93c=_0x2d0d50(0x2ad);_0x2eb168+='<tr\x20class=\x22text-left\x22>'+'<td>'+htmlGridarray[_0x4cd881][_0x2d0d50(0x233)]+_0x2d0d50(0x136)+'<td>'+htmlGridarray[_0x4cd881]['email']+_0x2d0d50(0x136)+_0x2d0d50(0x1fd)+htmlGridarray[_0x4cd881][_0x2d0d50(0x22c)]+'</td>'+_0x2d0d50(0x1fd)+htmlGridarray[_0x4cd881]['CollaborationType']+_0x2d0d50(0x136)+_0x2d0d50(0x1fd)+_0x2d0d50(0x257)+htmlGridarray[_0x4cd881]['ClientName']+'</div>'+'<div\x20class=\x22form-wizard\x20centered-pills\x22\x20>'+'<ul\x20class=\x22nav\x20nav-pills\x22>'+'<li\x20role=\x22presentation\x22\x20class=\x22pills-box-info\x20Initiated\x22><a\x20href=\x22#\x22>Initiated</a></li>'+_0x2d0d50(0x150)+_0x2d0d50(0x2c3)+_0x2d0d50(0x1d7)+_0x2d0d50(0x23f)+'</div>'+_0x2d0d50(0x136)+'<td>Invitation\x20Accepted</td>'+_0x2d0d50(0x1fd)+_0x2d0d50(0x12f)+_0x2d0d50(0x2ce)+htmlGridarray[_0x4cd881]['ID']+',\x27'+_0x12a93c+'\x27)\x22\x20data-target=\x22#Permitting-into-Portal\x22\x20title=\x22Permit\x22>'+_0x2d0d50(0x13a)+_0x2d0d50(0x120)+_0x2d0d50(0x11f)+htmlGridarray[_0x4cd881]['ID']+',\x27'+htmlGridarray[_0x4cd881][_0x2d0d50(0x207)]+_0x2d0d50(0x216)+_0x2d0d50(0x177)+_0x2d0d50(0x120)+'</div>'+_0x2d0d50(0x136)+'</tr>',htmlGridarray[_0x4cd881][_0x2d0d50(0x2b1)]==_0x2d0d50(0x192)&&UpdateGeustuserInvite(htmlGridarray[_0x4cd881]['ID'],'Accepted');}else{if(htmlGridarray[_0x4cd881][_0x2d0d50(0x2b1)]==_0x2d0d50(0x192))_0x2eb168+='<tr\x20class=\x22text-left\x22>'+_0x2d0d50(0x1fd)+htmlGridarray[_0x4cd881][_0x2d0d50(0x233)]+_0x2d0d50(0x136)+_0x2d0d50(0x1fd)+htmlGridarray[_0x4cd881]['email']+'</td>'+_0x2d0d50(0x1fd)+htmlGridarray[_0x4cd881]['Modified']+_0x2d0d50(0x136)+_0x2d0d50(0x1fd)+htmlGridarray[_0x4cd881][_0x2d0d50(0x26a)]+_0x2d0d50(0x136)+'<td>'+_0x2d0d50(0x18a)+htmlGridarray[_0x4cd881][_0x2d0d50(0x14b)]+_0x2d0d50(0x1d4)+_0x2d0d50(0x1d0)+'<ul\x20class=\x22nav\x20nav-pills\x22>'+_0x2d0d50(0x15d)+_0x2d0d50(0x150)+_0x2d0d50(0x26d)+_0x2d0d50(0x1d7)+'</ul>'+_0x2d0d50(0x1d4)+'</td>'+_0x2d0d50(0x226)+_0x2d0d50(0x1fd)+_0x2d0d50(0x12f)+'<a\x20type=\x22button\x22\x20href=\x22#\x22\x20class=\x22custom-edit-btn\x22\x20data-toggle=\x22tooltip\x22\x20data-placement=\x22top\x22\x20title=\x22\x22\x20onclick=\x22CheckInvitedAction('+htmlGridarray[_0x4cd881]['ID']+_0x2d0d50(0x1e3)+_0x2d0d50(0x2af)+'</a>'+'<a\x20type=\x22button\x22\x20type=\x22button\x22\x20class=\x22custom-edit-btn\x22\x20data-toggle=\x22tooltip\x22\x20onclick=\x22DeleteHtmlRow('+htmlGridarray[_0x4cd881]['ID']+',\x27'+htmlGridarray[_0x4cd881][_0x2d0d50(0x207)]+_0x2d0d50(0x216)+_0x2d0d50(0x177)+_0x2d0d50(0x120)+_0x2d0d50(0x1d4)+_0x2d0d50(0x136)+_0x2d0d50(0x17e);else{if(htmlGridarray[_0x4cd881]['Status']==_0x2d0d50(0x24c)){var _0x12a93c=_0x2d0d50(0x2ad);_0x2eb168+=_0x2d0d50(0x20c)+'<td>'+htmlGridarray[_0x4cd881][_0x2d0d50(0x233)]+'</td>'+'<td>'+htmlGridarray[_0x4cd881][_0x2d0d50(0x207)]+'</td>'+_0x2d0d50(0x1fd)+htmlGridarray[_0x4cd881]['Modified']+_0x2d0d50(0x136)+_0x2d0d50(0x1fd)+htmlGridarray[_0x4cd881]['CollaborationType']+_0x2d0d50(0x136)+_0x2d0d50(0x1fd)+_0x2d0d50(0x257)+htmlGridarray[_0x4cd881]['ClientName']+_0x2d0d50(0x1d4)+_0x2d0d50(0x1d0)+'<ul\x20class=\x22nav\x20nav-pills\x22>'+_0x2d0d50(0x15d)+_0x2d0d50(0x150)+_0x2d0d50(0x2c3)+_0x2d0d50(0x282)+_0x2d0d50(0x23f)+_0x2d0d50(0x1d4)+'</td>'+_0x2d0d50(0x156)+'<td>'+_0x2d0d50(0x12f)+'<a\x20type=\x22button\x22\x20href=\x22#\x22\x20class=\x22custom-edit-btn\x22\x20data-toggle=\x22modal\x22\x20onclick=\x22SetTextBox('+htmlGridarray[_0x4cd881]['ID']+',\x27'+_0x12a93c+_0x2d0d50(0x283)+'<i\x20class=\x22fa\x20fa-pencil\x22></i>'+'</a>'+_0x2d0d50(0x11f)+htmlGridarray[_0x4cd881]['ID']+',\x27'+htmlGridarray[_0x4cd881][_0x2d0d50(0x207)]+_0x2d0d50(0x216)+_0x2d0d50(0x177)+'</a>'+_0x2d0d50(0x1d4)+_0x2d0d50(0x136)+_0x2d0d50(0x17e);}else{if(htmlGridarray[_0x4cd881][_0x2d0d50(0x2b1)]==_0x2d0d50(0x185)){var _0x12a93c=_0x2d0d50(0x2ad);_0x2eb168+=_0x2d0d50(0x20c)+'<td>'+htmlGridarray[_0x4cd881][_0x2d0d50(0x233)]+_0x2d0d50(0x136)+_0x2d0d50(0x1fd)+htmlGridarray[_0x4cd881][_0x2d0d50(0x207)]+_0x2d0d50(0x136)+_0x2d0d50(0x1fd)+htmlGridarray[_0x4cd881][_0x2d0d50(0x22c)]+_0x2d0d50(0x136)+_0x2d0d50(0x1fd)+htmlGridarray[_0x4cd881][_0x2d0d50(0x26a)]+'</td>'+'<td>'+_0x2d0d50(0x257)+htmlGridarray[_0x4cd881]['ClientName']+'</div>'+_0x2d0d50(0x1d0)+_0x2d0d50(0x17b)+_0x2d0d50(0x15d)+_0x2d0d50(0x150)+_0x2d0d50(0x2c3)+_0x2d0d50(0x1da)+_0x2d0d50(0x23f)+'</div>'+_0x2d0d50(0x136)+_0x2d0d50(0x1d3)+_0x2d0d50(0x1fd)+_0x2d0d50(0x12f)+_0x2d0d50(0x1ee)+htmlGridarray[_0x4cd881]['ID']+',\x27'+_0x12a93c+_0x2d0d50(0x283)+_0x2d0d50(0x1eb)+_0x2d0d50(0x120)+_0x2d0d50(0x11f)+htmlGridarray[_0x4cd881]['ID']+',\x27'+htmlGridarray[_0x4cd881][_0x2d0d50(0x207)]+_0x2d0d50(0x216)+_0x2d0d50(0x177)+_0x2d0d50(0x120)+_0x2d0d50(0x1d4)+_0x2d0d50(0x136)+'</tr>';}else _0x2eb168+=_0x2d0d50(0x20c)+_0x2d0d50(0x1fd)+htmlGridarray[_0x4cd881][_0x2d0d50(0x233)]+'</td>'+'<td>'+htmlGridarray[_0x4cd881][_0x2d0d50(0x207)]+'</td>'+_0x2d0d50(0x1fd)+htmlGridarray[_0x4cd881]['Modified']+_0x2d0d50(0x136)+_0x2d0d50(0x1fd)+htmlGridarray[_0x4cd881][_0x2d0d50(0x26a)]+_0x2d0d50(0x136)+_0x2d0d50(0x1fd)+_0x2d0d50(0x257)+htmlGridarray[_0x4cd881][_0x2d0d50(0x14b)]+'</div>'+_0x2d0d50(0x1d0)+_0x2d0d50(0x17b)+'<li\x20role=\x22presentation\x22\x20class=\x22pills-box-info\x20Initiated\x22><a\x20href=\x22#\x22>Initiated</a></li>'+'<li\x20role=\x22presentation\x22\x20class=\x22pills-box-info\x22><a\x20href=\x22#\x22>Invited</a></li>'+_0x2d0d50(0x26d)+_0x2d0d50(0x24b)+_0x2d0d50(0x24e)+_0x2d0d50(0x1d4)+'</td>'+_0x2d0d50(0x18b)+_0x2d0d50(0x1fd)+_0x2d0d50(0x12f)+'<a\x20type=\x22button\x22\x20type=\x22button\x22\x20class=\x22custom-edit-btn\x22\x20\x20data-toggle=\x22modal\x22\x20onclick=\x22SetTextBox('+htmlGridarray[_0x4cd881]['ID']+_0x2d0d50(0x28b)+_0x2d0d50(0x273)+_0x2d0d50(0x120)+_0x2d0d50(0x2cd)+htmlGridarray[_0x4cd881]['ID']+',\x27'+htmlGridarray[_0x4cd881][_0x2d0d50(0x207)]+_0x2d0d50(0x216)+_0x2d0d50(0x177)+_0x2d0d50(0x120)+_0x2d0d50(0x1d4)+'</td>'+_0x2d0d50(0x17e);}}}}}_0x2eb168+=_0x2d0d50(0x1fe);}$(_0x2d0d50(0x2b7))['html'](_0x2eb168),$['fn'][_0x2d0d50(0x2a0)][_0x2d0d50(0x240)](_0x2d0d50(0x2b7))?(table[_0x2d0d50(0x279)](),table=$('#TableGrid')[_0x2d0d50(0x18e)]({'bPaginate':!![],'bJQueryUI':!![],'bLengthChange':![],'bFilter':!![],'bSort':!![],'bInfo':!![],'bAutoWidth':!![],'bProcessing':!![],'iDisplayLength':0xa,'dom':_0x2d0d50(0x1bc),'colReorder':{'allowReorder':!![]},'language':{'searchPlaceholder':_0x2d0d50(0x1ed)},'columnDefs':[{'width':0x96,'targets':0x1}]})):table=$(_0x2d0d50(0x2b7))[_0x2d0d50(0x18e)]({'bPaginate':!![],'bJQueryUI':!![],'bLengthChange':![],'bFilter':!![],'bSort':!![],'bInfo':!![],'bAutoWidth':!![],'bProcessing':!![],'iDisplayLength':0xa,'dom':'Rlfrtip','colReorder':{'allowReorder':!![]},'language':{'searchPlaceholder':_0x2d0d50(0x1ed)},'columnDefs':[{'width':0x96,'targets':0x1}]});}function CheckInvitedAction(_0x5103c7){var _0x22759d=a0_0x4d15ba;ExtrnaluserId=_0x5103c7;var _0x4f81d2=htmlGridarray[_0x22759d(0x255)](function(_0x304c8f){return _0x304c8f['ID']==_0x5103c7;}),_0x58de5a='',_0xee3654='';$('#checkUser')['text'](''),$('#checkUser')[_0x22759d(0x23d)](_0x4f81d2[0x0]['email']),SendReminderInvitename=_0x4f81d2[0x0]['Title'],SendReminderInviteEmail=_0x4f81d2[0x0]['email'],$[_0x22759d(0x186)](GetGueastUsers(_0x4f81d2[0x0][_0x22759d(0x207)]))['done'](function(_0x193113){var _0x4ca518=_0x22759d;_0x193113[_0x4ca518(0x1d2)]>0x0&&(_0x58de5a=_0x193113[0x0][_0x4ca518(0x119)],_0xee3654=_0x193113[0x0][_0x4ca518(0x28d)]);});if(_0xee3654=='Accepted'){for(var _0x1c85bf in htmlGridarray){if(htmlGridarray[_0x1c85bf]['ID']==ExtrnaluserId){htmlGridarray[_0x1c85bf][_0x22759d(0x28d)]=_0x22759d(0x2c6);break;}}GenerateGridHtml(htmlGridarray),$(_0x22759d(0x205))[_0x22759d(0x23d)]('');var _0x4dc938=_0x22759d(0x123);$(_0x22759d(0x205))[_0x22759d(0x23d)](_0x4dc938),$(_0x22759d(0x15e))['show'](),$(_0x22759d(0x1f5))[_0x22759d(0x1f8)](),$(_0x22759d(0x215))[_0x22759d(0x1f8)](),$('#check-status')['modal'](_0x22759d(0x1d6));}else{for(var _0x1c85bf in htmlGridarray){if(htmlGridarray[_0x1c85bf]['ID']==ExtrnaluserId){htmlGridarray[_0x1c85bf][_0x22759d(0x28d)]=_0x22759d(0x2ab);break;}}GenerateGridHtml(htmlGridarray),$(_0x22759d(0x205))[_0x22759d(0x23d)]('');var _0x4dc938=_0x22759d(0x1a4);$(_0x22759d(0x205))[_0x22759d(0x23d)](_0x4dc938),$(_0x22759d(0x1f5))[_0x22759d(0x1d6)](),$(_0x22759d(0x15e))[_0x22759d(0x1f8)](),$(_0x22759d(0x262))[_0x22759d(0x2aa)](_0x22759d(0x1d6)),$('#btnSendReminder')[_0x22759d(0x1d6)]();}}function SetTextBox(_0x2ec1c1,_0x401d94){var _0x2e01bf=a0_0x4d15ba;ExtrnaluserId=_0x2ec1c1;var _0x1ac4b5=htmlGridarray['filter'](function(_0x4d8a50){return _0x4d8a50['ID']==_0x2ec1c1;});if(_0x401d94==_0x2e01bf(0x2ad))IsSetvalue=!![],Pertimtblock(_0x1ac4b5[0x0][_0x2e01bf(0x207)]);else{if(_0x401d94==_0x2e01bf(0x172)){IsSetvalue=![],$(_0x2e01bf(0x1f4))[_0x2e01bf(0x1be)](_0x1ac4b5[0x0][_0x2e01bf(0x233)]),$(_0x2e01bf(0x1f4))[_0x2e01bf(0x139)](_0x2e01bf(0x272),_0x2e01bf(0x272)),$(_0x2e01bf(0x17d))[_0x2e01bf(0x1be)](_0x1ac4b5[0x0][_0x2e01bf(0x207)]),$(_0x2e01bf(0x17d))['attr'](_0x2e01bf(0x272),_0x2e01bf(0x272)),$(_0x2e01bf(0x1d1))['val'](_0x1ac4b5[0x0][_0x2e01bf(0x130)]),$(_0x2e01bf(0x1d1))['attr'](_0x2e01bf(0x272),'disabled'),$('#invitetxtReferenceCode')['val'](_0x1ac4b5[0x0]['ReferenceCode']),$(_0x2e01bf(0x1cd))[_0x2e01bf(0x139)](_0x2e01bf(0x272),'disabled'),$(_0x2e01bf(0x26f))[_0x2e01bf(0x1be)](_0x1ac4b5[0x0]['ClientName']),$(_0x2e01bf(0x26f))[_0x2e01bf(0x139)](_0x2e01bf(0x272),_0x2e01bf(0x272));var _0x34d23=new Date(_0x1ac4b5[0x0][_0x2e01bf(0x218)]);$(_0x2e01bf(0x249))['val']($['datepicker'][_0x2e01bf(0x1a6)]('d\x20M,\x20yy\x20',_0x34d23)),$(_0x2e01bf(0x249))['attr'](_0x2e01bf(0x272),'disabled'),$(_0x2e01bf(0x2d1))[_0x2e01bf(0x1f8)]();}}}function Getinvitebox(){var _0x5d6e12=a0_0x4d15ba;$(_0x5d6e12(0x1f4))[_0x5d6e12(0x1be)](''),$(_0x5d6e12(0x217))[_0x5d6e12(0x1be)](''),$(_0x5d6e12(0x1f4))[_0x5d6e12(0x269)](_0x5d6e12(0x272)),IscheckInvite&&($(_0x5d6e12(0x17d))[_0x5d6e12(0x1be)](''),$(_0x5d6e12(0x17d))[_0x5d6e12(0x269)]('disabled')),$(_0x5d6e12(0x1d1))[_0x5d6e12(0x1be)](''),$(_0x5d6e12(0x1d1))[_0x5d6e12(0x269)](_0x5d6e12(0x272)),$(_0x5d6e12(0x1cd))[_0x5d6e12(0x1be)](''),$(_0x5d6e12(0x1cd))['removeAttr'](_0x5d6e12(0x272)),$(_0x5d6e12(0x26f))[_0x5d6e12(0x1be)](''),$(_0x5d6e12(0x26f))[_0x5d6e12(0x269)](_0x5d6e12(0x272)),$(_0x5d6e12(0x249))[_0x5d6e12(0x1be)](''),$(_0x5d6e12(0x249))[_0x5d6e12(0x269)]('disabled'),$(_0x5d6e12(0x2d1))[_0x5d6e12(0x1d6)](),IsSetvalue=!![],SetCalendar();}function UpdateGeustuserInvite(_0x4936af,_0x33c5fe){var _0x2f966e=a0_0x4d15ba,_0x1891b7=_0x2f966e(0x261),_0x10dd07,_0x3394c8=GetItemTypeForListName(_0x1891b7);_0x10dd07={'__metadata':{'type':_0x3394c8},'Status':_0x33c5fe};var _0xebc99=$['Deferred']();return $[_0x2f966e(0x299)]({'url':_spPageContextInfo[_0x2f966e(0x18d)]+_0x2f966e(0x225)+_0x1891b7+_0x2f966e(0x1b1)+_0x4936af+')','type':_0x2f966e(0x137),'async':![],'headers':{'accept':_0x2f966e(0x176),'X-RequestDigest':$(_0x2f966e(0x234))['val'](),'content-Type':_0x2f966e(0x176),'IF-MATCH':'*','X-HTTP-Method':_0x2f966e(0x129)},'data':JSON[_0x2f966e(0x202)](_0x10dd07),'success':function(_0x826ce5){},'error':function(_0x1266e8){var _0x40e955=_0x2f966e;console[_0x40e955(0x2d2)](JSON[_0x40e955(0x202)](_0x1266e8)),_0xebc99['reject'](_0x1266e8);}}),_0xebc99[_0x2f966e(0x2ac)]();}function UpdateClientMaster(_0x1aff7a,_0x3c45b5){var _0xc86ecb=a0_0x4d15ba,_0x3b8958=_0xc86ecb(0x1b2),_0x495bf2,_0x543eb8=GetItemTypeForListName(_0x3b8958);_0x495bf2={'__metadata':{'type':_0x543eb8},'SupervisorId':_0x3c45b5};var _0x30595e=$[_0xc86ecb(0x1a7)]();return $['ajax']({'url':_spPageContextInfo[_0xc86ecb(0x18d)]+_0xc86ecb(0x225)+_0x3b8958+'\x27)/items('+_0x1aff7a+')','type':_0xc86ecb(0x137),'async':![],'headers':{'accept':_0xc86ecb(0x176),'X-RequestDigest':$(_0xc86ecb(0x234))[_0xc86ecb(0x1be)](),'content-Type':_0xc86ecb(0x176),'IF-MATCH':'*','X-HTTP-Method':'MERGE'},'data':JSON[_0xc86ecb(0x202)](_0x495bf2),'success':function(_0x517774){},'error':function(_0x4a7987){var _0x41b275=_0xc86ecb;console[_0x41b275(0x2d2)](JSON[_0x41b275(0x202)](_0x4a7987)),_0x30595e[_0x41b275(0x17a)](_0x4a7987);}}),_0x30595e[_0xc86ecb(0x2ac)]();}function UpdateClientMasterDocLib(_0x558a16,_0x5039ac,_0xdb6572,_0x506974){var _0x98e2ff=a0_0x4d15ba,_0x5d9a71=_0x98e2ff(0x1b2),_0x5943c8,_0x999dbc=GetItemTypeForListName(_0x5d9a71);_0x5943c8={'__metadata':{'type':_0x999dbc},'InternalMembersId':{'results':_0x506974},'InternalSupervisorId':_0xdb6572,'DocumentLibrary':_0x5039ac};var _0xb26cf=$['Deferred']();return $[_0x98e2ff(0x299)]({'url':_spPageContextInfo[_0x98e2ff(0x18d)]+_0x98e2ff(0x225)+_0x5d9a71+_0x98e2ff(0x1b1)+_0x558a16+')','type':_0x98e2ff(0x137),'async':![],'headers':{'accept':_0x98e2ff(0x176),'X-RequestDigest':$(_0x98e2ff(0x234))[_0x98e2ff(0x1be)](),'content-Type':_0x98e2ff(0x176),'IF-MATCH':'*','X-HTTP-Method':_0x98e2ff(0x129)},'data':JSON[_0x98e2ff(0x202)](_0x5943c8),'success':function(_0x46b143){},'error':function(_0x863276){var _0x2cb936=_0x98e2ff;console[_0x2cb936(0x2d2)](JSON[_0x2cb936(0x202)](_0x863276)),_0xb26cf[_0x2cb936(0x17a)](_0x863276);}}),_0xb26cf[_0x98e2ff(0x2ac)]();}function a0_0x55e6(_0x5c0488,_0x202410){var _0x2f7b81=a0_0x2f7b();return a0_0x55e6=function(_0x55e601,_0x7fb5db){_0x55e601=_0x55e601-0x117;var _0x1cd026=_0x2f7b81[_0x55e601];return _0x1cd026;},a0_0x55e6(_0x5c0488,_0x202410);}function DeleteHtmlRow(_0x2b2f83,_0x34f424){var _0x33968a=a0_0x4d15ba,_0x3f7fa1=confirm(_0x33968a(0x28f)+_0x34f424+_0x33968a(0x2b5));_0x3f7fa1&&$['ajax']({'url':_spPageContextInfo[_0x33968a(0x18d)]+_0x33968a(0x166)+_0x2b2f83+')','type':'POST','headers':{'Accept':'application/json;odata=verbose','Content-Type':_0x33968a(0x176),'IF-MATCH':'*','X-HTTP-Method':_0x33968a(0x260),'X-RequestDigest':$(_0x33968a(0x234))['val']()},'success':function(_0x7f5ede,_0x4ebe63,_0x5252ff){var _0x34dd67=_0x33968a;console[_0x34dd67(0x2d2)]('Success\x20Delete'),LoadProject();},'error':function(_0x2ff11f,_0x5d799b,_0x232706){var _0x20c66e=_0x33968a;console['log'](_0x20c66e(0x1cc));}});}function GetGueastUsers(_0x2d3fbc){var _0x1e61fb=a0_0x4d15ba,_0x2665f3=_0x1e61fb(0x258)+_0x2d3fbc+'\x27';return DeferredObj=$[_0x1e61fb(0x1a7)](),$['ajax']({'method':_0x1e61fb(0x2c8),'url':_0x2665f3,'headers':{'Authorization':_0x1e61fb(0x1e6)+token,'Content-Type':_0x1e61fb(0x2ae)},'async':![],'success':function(_0x1428b6){var _0x498f2f=_0x1e61fb;DeferredObj[_0x498f2f(0x25c)](_0x1428b6[_0x498f2f(0x21a)]);},'error':function(_0x550cea){var _0x306e7f=_0x1e61fb;localStorage['removeItem'](_0x306e7f(0x212)),removeSpinner($(_0x306e7f(0x160))),GI=GLength,LoadProject();}}),DeferredObj[_0x1e61fb(0x2ac)]();}var filter='';function GetExternalUsers(){var _0x2c47b8=a0_0x4d15ba,_0x274077='',_0x5554d0=![];filter='';var _0x2c5e95='ExternalUsers';if(Isfillter){Initiated!=''&&(filter+=_0x2c47b8(0x232),_0x5554d0=!![]);Invited!=''&&(filter+='(Status\x20eq\x20\x27Invited\x27)\x20or\x20',_0x5554d0=!![]);NotAccepted!=''&&(filter+='(Status\x20eq\x20\x27Invited\x27)\x20or\x20',_0x5554d0=!![]);Active!=''&&(filter+=_0x2c47b8(0x25a),_0x5554d0=!![]);Inactive!=''&&(filter+='(Status\x20eq\x20\x27Inactive\x27)\x20or\x20',_0x5554d0=!![]);Accepted!=''&&(filter+='(Status\x20eq\x20\x27Accepted\x27)\x20or\x20',_0x5554d0=!![]);var _0x4a79bd=$(_0x2c47b8(0x163))['find'](_0x2c47b8(0x2bb))[_0x2c47b8(0x23d)]();_0x4a79bd==_0x2c47b8(0x24f)&&!_0x5554d0?_0x274077=_spPageContextInfo[_0x2c47b8(0x18d)]+_0x2c47b8(0x1ad)+_0x2c5e95+_0x2c47b8(0x12d):(_0x5554d0?(filter=filter[_0x2c47b8(0x28c)](0x0,filter[_0x2c47b8(0x1d2)]-0x3),_0x4a79bd!=_0x2c47b8(0x24f)&&(filter+=_0x2c47b8(0x17f)+_0x4a79bd+'\x27)')):filter+=_0x2c47b8(0x190)+_0x4a79bd+'\x27)',_0x274077=_spPageContextInfo[_0x2c47b8(0x18d)]+_0x2c47b8(0x1ad)+_0x2c5e95+_0x2c47b8(0x132)+filter+')');}else _0x274077=_spPageContextInfo['webAbsoluteUrl']+'/_api/web/lists/getbytitle(\x27'+_0x2c5e95+'\x27)/items?$select=*,InternalStakeholders/Title,Supervisor_Guest/Title,Client_Name/Title,LoginName/Title\x20&$expand=\x20LoginName,Client_Name,Supervisor_Guest,InternalStakeholders\x20&$filter=((Status\x20eq\x20\x27Initiated\x27)\x20or\x20(Status\x20eq\x20\x27Invited\x27\x20)or\x20(Status\x20eq\x20\x27Pending\x27)or\x20(Status\x20eq\x20\x27Accepted\x27)or\x20(Status\x20eq\x20\x27Inactive\x27)\x20or\x20(Status\x20eq\x20\x27Active\x27))';var _0x2e9c72=$['Deferred']();return $[_0x2c47b8(0x299)]({'url':_0x274077,'type':_0x2c47b8(0x25e),'headers':{'Accept':_0x2c47b8(0x176)},'success':function(_0x154f7a){var _0x30a8a0=_0x2c47b8,_0x4f1d78=_0x154f7a['d'][_0x30a8a0(0x1f3)][_0x30a8a0(0x255)](function(_0x4c6c2e){var _0x38d233=_0x30a8a0;return _0x4c6c2e['Status']==_0x38d233(0x192);}),_0x56540d=_0x154f7a['d']['results'][_0x30a8a0(0x255)](function(_0x5c04b0){var _0x3c0522=_0x30a8a0;return _0x5c04b0[_0x3c0522(0x2b1)]==_0x3c0522(0x169);}),_0x49aae8=_0x154f7a['d'][_0x30a8a0(0x1f3)][_0x30a8a0(0x255)](function(_0x366faf){var _0xe39978=_0x30a8a0;return _0x366faf[_0xe39978(0x2b1)]==_0xe39978(0x24c);}),_0x184426=_0x154f7a['d'][_0x30a8a0(0x1f3)][_0x30a8a0(0x255)](function(_0x48a50d){var _0x130060=_0x30a8a0;return _0x48a50d[_0x130060(0x2b1)]==_0x130060(0x185);}),_0x420a52=_0x154f7a['d'][_0x30a8a0(0x1f3)][_0x30a8a0(0x255)](function(_0x394bb1){var _0x49ca61=_0x30a8a0;return _0x394bb1[_0x49ca61(0x2b1)]==_0x49ca61(0x2c6);});_0x4f1d78['length']>0x0&&($('#hInvited')[_0x30a8a0(0x26e)](),$(_0x30a8a0(0x27a))[_0x30a8a0(0x287)](_0x30a8a0(0x203)+_0x4f1d78['length']+_0x30a8a0(0x21d))),_0x56540d['length']>0x0&&($(_0x30a8a0(0x25b))['empty'](),$(_0x30a8a0(0x25b))[_0x30a8a0(0x287)](_0x30a8a0(0x203)+_0x56540d[_0x30a8a0(0x1d2)]+_0x30a8a0(0x21d))),_0x49aae8[_0x30a8a0(0x1d2)]>0x0&&($('#hActive')[_0x30a8a0(0x26e)](),$(_0x30a8a0(0x1b5))[_0x30a8a0(0x287)]('<h3\x20class=\x27m-0\x27>'+_0x49aae8['length']+_0x30a8a0(0x21d))),_0x184426['length']>0x0&&($(_0x30a8a0(0x12a))[_0x30a8a0(0x26e)](),$(_0x30a8a0(0x12a))[_0x30a8a0(0x287)](_0x30a8a0(0x203)+_0x184426['length']+'</h3>')),_0x420a52[_0x30a8a0(0x1d2)]>0x0&&($(_0x30a8a0(0x2d9))['empty'](),$(_0x30a8a0(0x2d9))['append']('<h3\x20class=\x27m-0\x27>'+_0x420a52[_0x30a8a0(0x1d2)]+'</h3>')),Isfillter==![]&&(_0x154f7a['d'][_0x30a8a0(0x1f3)]=_0x154f7a['d'][_0x30a8a0(0x1f3)][_0x30a8a0(0x255)](function(_0xbf6b51){var _0x311634=_0x30a8a0;return _0xbf6b51[_0x311634(0x2b1)]!==_0x311634(0x24c);}),_0x154f7a['d'][_0x30a8a0(0x1f3)]=_0x154f7a['d']['results']['filter'](function(_0x571e45){var _0x4f929b=_0x30a8a0;return _0x571e45[_0x4f929b(0x2b1)]!==_0x4f929b(0x185);})),Isfillter=![],_0x2e9c72[_0x30a8a0(0x25c)](_0x154f7a['d'][_0x30a8a0(0x1f3)]);},'error':function(_0x4b18f9){var _0x1c9951=_0x2c47b8;console[_0x1c9951(0x2d2)](_0x4b18f9['responseJSON']['error']),_0x2e9c72[_0x1c9951(0x17a)](_0x4b18f9[_0x1c9951(0x281)][_0x1c9951(0x22b)]);}}),_0x2e9c72[_0x2c47b8(0x2ac)]();}var Errorcount=0x1,Ischeckerror=![];function Inviteuser(){var _0x1e48be=a0_0x4d15ba,_0x2a53fe=$(_0x1e48be(0x17d))[_0x1e48be(0x1be)](),_0x2f14fa=$(_0x1e48be(0x1f4))[_0x1e48be(0x1be)](),_0x5daf3e=$(_0x1e48be(0x217))[_0x1e48be(0x1be)](),_0x598552=$(_0x1e48be(0x26f))[_0x1e48be(0x1be)](),_0x4aeaf3=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/igm,_0xd553e=_0x4aeaf3[_0x1e48be(0x27d)](_0x2a53fe);if(_0x2a53fe=='')return alert('Please\x20enter\x20email'),![];else{if(!_0xd553e)return alert('Email\x20id\x20is\x20not\x20valid.\x20'),![];else{if(_0x2f14fa=='')return alert(_0x1e48be(0x29d)),![];else{if(_0x598552=='')return alert(_0x1e48be(0x278)),![];else{if($('#invitetxtValidityUpto')[_0x1e48be(0x1be)]()=='')return alert('Please\x20enter\x20validity\x20date.'),![];}}}}Errorcount=0x1,$(_0x1e48be(0x206))['val']('Wait\x20Plaease'),$[_0x1e48be(0x299)]({'url':'https://graph.microsoft.com/v1.0/invitations','type':_0x1e48be(0x137),'headers':{'Authorization':_0x1e48be(0x1e6)+token,'content-type':_0x1e48be(0x2ae)},'data':JSON[_0x1e48be(0x202)]({'invitedUserDisplayName':_0x2f14fa,'invitedUserEmailAddress':_0x2a53fe,'inviteRedirectUrl':_spPageContextInfo[_0x1e48be(0x18d)]+'/SitePages/Thankyou.aspx','sendInvitationMessage':!![],'invitedUserMessageInfo':{'customizedMessageBody':_0x5daf3e}}),'async':![],'success':function(_0x516492){var _0x7c3492=_0x1e48be;console[_0x7c3492(0x2d2)](_0x516492);GroupId==''&&GetGroupIDByGroupName();GuestUserEmail=_0x516492[_0x7c3492(0x145)];try{$[_0x7c3492(0x186)](AddUserinSharePointGroup(_0x516492['invitedUserEmailAddress'],GroupId))[_0x7c3492(0x11d)](function(_0x516736){var _0xaadd1a=_0x7c3492;Ischeckerror=![];if(_0x516736==_0xaadd1a(0x117)){if(!IsSetvalue){UpdateGeustuserInvite(ExtrnaluserId,_0xaadd1a(0x192));for(var _0x43f374 in htmlGridarray){if(htmlGridarray[_0x43f374]['ID']==ExtrnaluserId){htmlGridarray[_0x43f374][_0xaadd1a(0x2b1)]=_0xaadd1a(0x192);break;}}}else AddNewGuest();GenerateGridHtml(htmlGridarray),alert(_0xaadd1a(0x148)),Ischeckerror=![],$(_0xaadd1a(0x124))[_0xaadd1a(0x2aa)](_0xaadd1a(0x1f8));}else alert('Invitation\x20mail\x20sending\x20failed.\x0aPlease\x20try\x20again\x20later.\x0aAlso\x20please\x20check\x20the\x20External\x20Sharing\x20setup\x20of\x20this\x20site.');});}catch(_0x1988c1){alert('Invitation\x20mail\x20sending\x20failed.\x0aPlease\x20try\x20again\x20later.\x0aAlso\x20please\x20check\x20the\x20External\x20Sharing\x20setup\x20of\x20this\x20site.'+_0x1988c1);}},'error':function(_0x2e3919){var _0x149918=_0x1e48be;_0x2e3919[_0x149918(0x20d)]==_0x149918(0x118)?alert(_0x2e3919[_0x149918(0x20d)]+_0x149918(0x165)):(alert(_0x149918(0x12b)),console[_0x149918(0x2d2)](JSON[_0x149918(0x202)](_0x2e3919)));}}),Ischeckerror&&alert(_0x1e48be(0x198)),$('#btnInviteuser')[_0x1e48be(0x1be)](_0x1e48be(0x172));}var SendReminderInvitename='',SendReminderInviteEmail='';function InviteuserSendReminder(){var _0x34f82c=a0_0x4d15ba;$[_0x34f82c(0x299)]({'url':_0x34f82c(0x210),'type':_0x34f82c(0x137),'headers':{'Authorization':'Bearer\x20'+token,'content-type':_0x34f82c(0x2ae)},'data':JSON[_0x34f82c(0x202)]({'invitedUserDisplayName':SendReminderInvitename,'invitedUserEmailAddress':SendReminderInviteEmail,'inviteRedirectUrl':_spPageContextInfo[_0x34f82c(0x18d)]+'/SitePages/Thankyou.aspx','sendInvitationMessage':!![],'invitedUserMessageInfo':{'customizedMessageBody':_0x34f82c(0x22e)}}),'async':![],'success':function(_0x30646e){var _0x13a8b1=_0x34f82c;console[_0x13a8b1(0x2d2)](_0x30646e),alert(_0x13a8b1(0x184));},'error':function(_0x3d86de){}});}function AddUserinSharePointGroup(_0x11ac26,_0x3ad2e5){var _0x54f6b2=a0_0x4d15ba,_0x579ad5=$['Deferred'](),_0x2394d0='i:0#.f|membership|',_0xc958fb=_0x2394d0+_0x11ac26,_0x5bdfc5=_spPageContextInfo[_0x54f6b2(0x18d)]+_0x54f6b2(0x1e9)+_0x3ad2e5+_0x54f6b2(0x194);$[_0x54f6b2(0x299)]({'url':_0x5bdfc5,'type':'POST','async':![],'data':JSON[_0x54f6b2(0x202)]({'__metadata':{'type':_0x54f6b2(0x208)},'LoginName':_0xc958fb}),'headers':{'accept':_0x54f6b2(0x176),'content-type':_0x54f6b2(0x176),'X-RequestDigest':$('#__REQUESTDIGEST')[_0x54f6b2(0x1be)]()},'success':_0xc4824a,'error':_0x14f4bf});function _0xc4824a(_0x10ddef){var _0x566bfd=_0x54f6b2;Ischeckerror=!![],_0x579ad5[_0x566bfd(0x25c)](_0x566bfd(0x117)),Errorcount=0x1,console[_0x566bfd(0x2d2)]('User\x20Added');}function _0x14f4bf(_0x5a1559){var _0x4c2bce=_0x54f6b2;console[_0x4c2bce(0x2d2)](JSON[_0x4c2bce(0x202)](_0x5a1559)),console[_0x4c2bce(0x2d2)](JSON[_0x4c2bce(0x202)](_0x11ac26)),(_0x5a1559[_0x4c2bce(0x20d)]=='Not\x20Found'||_0x5a1559['statusText']=='error')&&Errorcount==0x1e?_0x5a1559[_0x4c2bce(0x20d)]==_0x4c2bce(0x22b)?(Errorcount++,AddUserinSharePointGroup(_0x11ac26,_0x3ad2e5)):alert(_0x4c2bce(0x22f)):(Errorcount++,AddUserinSharePointGroup(_0x11ac26,_0x3ad2e5));}return _0x579ad5[_0x54f6b2(0x2ac)]();}function AddNewGuest(){var _0xbf8d01=a0_0x4d15ba;try{var _0x5efcb0=_0xbf8d01(0x261);GroupId==''&&GetGroupIDByGroupName();AddUserinSharePointGroup($(_0xbf8d01(0x17d))['val'](),GroupId);var _0x44196b=GetUserEmail($('#txtinviteemail')['val']()),_0x431ea5,_0x42dc7c=GetItemTypeForListName(_0x5efcb0);_0x431ea5={'__metadata':{'type':_0x42dc7c},'LoginNameId':_0x44196b,'Title':$(_0xbf8d01(0x1f4))['val'](),'email':$('#txtinviteemail')[_0xbf8d01(0x1be)](),'Designation':$(_0xbf8d01(0x1d1))[_0xbf8d01(0x1be)](),'Organization':$(_0xbf8d01(0x26f))[_0xbf8d01(0x1be)](),'ReferenceCode':$(_0xbf8d01(0x1cd))[_0xbf8d01(0x1be)](),'InternalStakeholdersId':{'results':InternalStakeholder},'SupervisorId':Supervisormember,'Client_NameId':Client_Id,'Supervisor_GuestId':ExtnaralSupervisor,'ValidUpto':$(_0xbf8d01(0x249))['val'](),'Status':_0xbf8d01(0x192)},AddItemToList(_0x5efcb0,_0x431ea5);}catch(_0xbd9175){console[_0xbf8d01(0x2d2)](_0xbd9175[_0xbf8d01(0x277)]);}}function AddItemToList(_0xa8efde,_0x5a56a2){var _0x4d913e=a0_0x4d15ba,_0x2e16f1=$[_0x4d913e(0x1a7)]();return $[_0x4d913e(0x299)]({'url':_spPageContextInfo[_0x4d913e(0x18d)]+'/_api/web/lists/getbytitle(\x27'+_0xa8efde+'\x27)/items','type':_0x4d913e(0x137),'async':![],'headers':{'accept':_0x4d913e(0x176),'X-RequestDigest':$(_0x4d913e(0x234))[_0x4d913e(0x1be)](),'content-Type':_0x4d913e(0x176)},'data':JSON[_0x4d913e(0x202)](_0x5a56a2),'success':function(_0x4d833e){var _0x1cf319=_0x4d913e;htmlGridarray[_0x1cf319(0x1ff)]({'creationType':'','externalUserState':'','Title':$('#txtinvitename')[_0x1cf319(0x1be)](),'email':$(_0x1cf319(0x17d))['val'](),'Designation':$('#invitetxtDesignation')[_0x1cf319(0x1be)](),'CollaborationType':_0x4d833e['d'][_0x1cf319(0x26a)],'ClientName':$(_0x1cf319(0x26f))[_0x1cf319(0x1be)](),'Status':'Invited','ID':_0x4d833e['d']['ID'],'ValidUpto':$(_0x1cf319(0x249))[_0x1cf319(0x1be)](),'ReferenceCode':$('#invitetxtReferenceCode')['val']()});},'error':function(_0x410568){var _0x290b9e=_0x4d913e;console[_0x290b9e(0x2d2)](JSON[_0x290b9e(0x202)](_0x410568)),_0x2e16f1[_0x290b9e(0x17a)](_0x410568);}}),_0x2e16f1[_0x4d913e(0x2ac)]();}var InternalStakeholder=[],Supervisormember,ExtnaralSupervisor;function Selectedcclinte(){var _0x2f678=a0_0x4d15ba;if(IsSetvalue){InternalStakeholder=[],$(_0x2f678(0x26f))[_0x2f678(0x1be)](ClientInternalMembers[SelectClientId][_0x2f678(0x233)]),$(_0x2f678(0x26f))['attr'](_0x2f678(0x272),_0x2f678(0x272)),Client_Id=ClientInternalMembers[SelectClientId]['ID'];for(var _0x813a92=0x0;_0x813a92<ClientInternalMembers[SelectClientId][_0x2f678(0x2cb)][_0x2f678(0x1f3)][_0x2f678(0x1d2)];_0x813a92++){InternalStakeholder[_0x2f678(0x1ff)](ClientInternalMembers[SelectClientId]['InternalMembers'][_0x2f678(0x1f3)][_0x813a92]['Id']);}Supervisormember=ClientInternalMembers[SelectClientId][_0x2f678(0x214)]['Id'],ExtnaralSupervisor=ClientInternalMembers[SelectClientId][_0x2f678(0x2ca)];}else{$(_0x2f678(0x17c))[_0x2f678(0x1be)](ClientInternalMembers[SelectClientId][_0x2f678(0x233)]),Client_Id=ClientInternalMembers[SelectClientId]['ID'];ClientInternalMembers[SelectClientId][_0x2f678(0x2bc)]!=undefined?$(_0x2f678(0x1b0))[_0x2f678(0x1be)](ClientInternalMembers[SelectClientId][_0x2f678(0x2bc)]):$(_0x2f678(0x1b0))[_0x2f678(0x1be)]($(_0x2f678(0x227))[_0x2f678(0x1be)]());$(_0x2f678(0x231)+ClientInternalMembers[SelectClientId][_0x2f678(0x2d3)]+']')[_0x2f678(0x139)](_0x2f678(0x1e8),_0x2f678(0x142)),$(_0x2f678(0x27e)+ClientInternalMembers[SelectClientId]['TemplateType']+']')[_0x2f678(0x139)](_0x2f678(0x1e8),_0x2f678(0x142)),initializePeoplePicker(_0x2f678(0x224),!![]),peoplePickerDiv=$(_0x2f678(0x152)),initializePeoplePicker('internalsupervisor',![]),peoplePickerDivsuper=$(_0x2f678(0x179));for(var _0x813a92=0x0;_0x813a92<ClientInternalMembers[SelectClientId]['InternalMembers'][_0x2f678(0x1f3)]['length'];_0x813a92++){setPeoplePickerUsersInfoCurrent(_0x2f678(0x1ba),ClientInternalMembers[SelectClientId][_0x2f678(0x2cb)][_0x2f678(0x1f3)][_0x813a92][_0x2f678(0x292)]);}setPeoplePickerUsersInfoCurrent(_0x2f678(0x158),ClientInternalMembers[SelectClientId][_0x2f678(0x214)][_0x2f678(0x292)]),$('div[id^=\x27InternalStakeholders\x27]')[_0x2f678(0x139)](_0x2f678(0x2cc),'false'),$(_0x2f678(0x265))['attr'](_0x2f678(0x272),'disabled'),$(_0x2f678(0x29e))[_0x2f678(0x139)]('disabled','disabled'),$(peoplePickerDiv)[_0x2f678(0x1f7)](_0x2f678(0x204))[_0x2f678(0x11a)](_0x2f678(0x147),_0x2f678(0x19d)),$(peoplePickerDivsuper)['find']('.sp-peoplepicker-delImage')[_0x2f678(0x11a)](_0x2f678(0x147),_0x2f678(0x19d));}}var ClientInternalMembers=[];function GetClientMasterTeamDeails(){var _0x491784=a0_0x4d15ba;Taskusers=[],ClientInternalMembers=[],RestQuery=_0x491784(0x159),$[_0x491784(0x186)](CommonFunction[_0x491784(0x19a)]('ClientMaster',RestQuery))[_0x491784(0x11d)](function(_0x5150ed){var _0x35825a=_0x491784,_0x540c60;IsNotTeamMember='';var _0x23590e='';_0x23590e+='<thead>'+_0x35825a(0x246)+_0x35825a(0x245)+'<th\x20class=\x22text-left\x20w-20\x22><b>Client\x20Name</b></th>'+'<th\x20class=\x22text-left\x20w-10\x22><b>Attn\x20Name</b></th>'+_0x35825a(0x286)+'<th\x20class=\x22w-25\x22><b>Ref\x20Code</b></th>'+_0x35825a(0x17e)+_0x35825a(0x20e);for(var _0x2c8203=0x0;_0x2c8203<_0x5150ed[_0x35825a(0x1f3)][_0x35825a(0x1d2)];_0x2c8203++){_0x540c60=[],_0x540c60=_0x5150ed[_0x35825a(0x1f3)][_0x2c8203];var _0x15e6c5=_0x540c60[_0x35825a(0x127)]=_0x35825a(0x142)?_0x540c60[_0x35825a(0x127)]:_0x35825a(0x24c);_0x23590e+=_0x35825a(0x21b)+'<td\x20class=\x22text-left\x22>'+_0x35825a(0x16b)+_0x35825a(0x155)+_0x2c8203+_0x35825a(0x28a)+_0x2c8203+_0x35825a(0x29a)+'</div>'+'</td>'+_0x35825a(0x195)+'<span>'+_0x540c60[_0x35825a(0x233)]+_0x35825a(0x1bf)+_0x35825a(0x136)+_0x35825a(0x195)+_0x35825a(0x1a1)+_0x540c60[_0x35825a(0x1c9)]+_0x35825a(0x1bf)+_0x35825a(0x136)+'<td\x20class=\x22text-left\x22>'+_0x35825a(0x2a1)+_0x540c60[_0x35825a(0x2d3)]+'</span>'+_0x35825a(0x136)+_0x35825a(0x195)+'<span>'+_0x540c60[_0x35825a(0x29f)]+_0x35825a(0x1bf)+_0x35825a(0x136)+'</tr>',ClientInternalMembers[_0x35825a(0x1ff)]({'Title':_0x540c60[_0x35825a(0x233)],'Client_Code':_0x540c60[_0x35825a(0x29f)],'Attn_Name':_0x540c60[_0x35825a(0x1c9)],'Supervisor':_0x540c60[_0x35825a(0x2bc)][_0x35825a(0x292)],'SupervisorId':_0x540c60[_0x35825a(0x2bc)]['Id'],'SelfCompany':_0x540c60[_0x35825a(0x1e0)],'IsActive':_0x540c60['IsActive'],'CustType':_0x540c60[_0x35825a(0x2d3)],'TemplateType':_0x540c60[_0x35825a(0x133)],'InternalMembers':_0x540c60[_0x35825a(0x2cb)],'InternalSupervisor':_0x540c60[_0x35825a(0x214)],'ID':_0x540c60['Id'],'DocumentLibrary':_0x540c60[_0x35825a(0x121)]});}GenarateclientGrid(_0x23590e);});}function GetClientMasterfilter(){var _0x22fd9e=a0_0x4d15ba;Taskusers=[],ClientInternalMembers[_0x22fd9e(0x1d2)]==0x0&&(RestQuery=_0x22fd9e(0x159),$[_0x22fd9e(0x186)](CommonFunction[_0x22fd9e(0x19a)](_0x22fd9e(0x1b2),RestQuery))[_0x22fd9e(0x11d)](function(_0x491464){var _0x5b4c6f=_0x22fd9e;for(var _0xf781f9=0x0;_0xf781f9<_0x491464['results'][_0x5b4c6f(0x1d2)];_0xf781f9++){InternalMembers=[],InternalMembers=_0x491464['results'][_0xf781f9],ClientInternalMembers['push']({'Title':InternalMembers[_0x5b4c6f(0x233)],'Client_Code':InternalMembers[_0x5b4c6f(0x29f)],'Attn_Name':InternalMembers[_0x5b4c6f(0x1c9)],'Supervisor':InternalMembers['Supervisor'][_0x5b4c6f(0x292)],'SupervisorId':InternalMembers[_0x5b4c6f(0x2bc)]['Id'],'SelfCompany':InternalMembers[_0x5b4c6f(0x1e0)],'IsActive':InternalMembers[_0x5b4c6f(0x127)],'CustType':InternalMembers[_0x5b4c6f(0x2d3)],'TemplateType':InternalMembers[_0x5b4c6f(0x133)],'InternalMembers':InternalMembers[_0x5b4c6f(0x2cb)],'InternalSupervisor':InternalMembers[_0x5b4c6f(0x214)],'ID':InternalMembers['Id'],'DocumentLibrary':InternalMembers['DocumentLibrary']});}}));}function GetClientMasterTeamDeailsByTitle(_0x13d283){var _0x3b4b3b=a0_0x4d15ba;RestQuery=_0x3b4b3b(0x16a)+_0x13d283+'\x27',$['when'](CommonFunction[_0x3b4b3b(0x19a)](_0x3b4b3b(0x1b2),RestQuery))[_0x3b4b3b(0x11d)](function(_0x2fa1b4){var _0x423060=_0x3b4b3b,_0x45c35f;IsNotTeamMember='';if(_0x2fa1b4['results'][_0x423060(0x1d2)]>0x0){_0x45c35f=[],_0x45c35f=_0x2fa1b4[_0x423060(0x1f3)][0x0];var _0x40dad4=_0x45c35f[_0x423060(0x127)]=_0x423060(0x142)?_0x45c35f[_0x423060(0x127)]:'Active';ClientInternalMembers[_0x423060(0x1ff)]({'Title':_0x45c35f[_0x423060(0x233)],'Client_Code':_0x45c35f['Client_Code'],'Attn_Name':_0x45c35f[_0x423060(0x1c9)],'Supervisor':_0x45c35f[_0x423060(0x2bc)][_0x423060(0x292)],'SelfCompany':_0x45c35f[_0x423060(0x1e0)],'CustType':_0x45c35f[_0x423060(0x2d3)],'TemplateType':_0x45c35f[_0x423060(0x133)],'InternalMembers':_0x45c35f[_0x423060(0x2cb)],'InternalSupervisor':_0x45c35f[_0x423060(0x214)],'ID':_0x45c35f['Id']});}});}var SelectClientId='';function GenarateclientGrid(_0x4254d7){var _0x3ec6ac=a0_0x4d15ba;$(_0x3ec6ac(0x2c4))[_0x3ec6ac(0x26e)](),$(_0x3ec6ac(0x2c4))[_0x3ec6ac(0x287)](_0x4254d7),$['fn'][_0x3ec6ac(0x2a0)][_0x3ec6ac(0x240)](_0x3ec6ac(0x2c4))?(tableC[_0x3ec6ac(0x279)](),tableC=$(_0x3ec6ac(0x2c4))[_0x3ec6ac(0x18e)]({'bPaginate':!![],'bJQueryUI':!![],'bLengthChange':![],'bFilter':!![],'bSort':!![],'bInfo':!![],'bAutoWidth':!![],'bProcessing':!![],'iDisplayLength':0x5,'dom':_0x3ec6ac(0x1bc),'colReorder':{'allowReorder':!![]},'language':{'searchPlaceholder':_0x3ec6ac(0x1ed)},'columnDefs':[{'width':0x96,'targets':0x1}]})):tableC=$('#masterClientgrid')['DataTable']({'bPaginate':!![],'bJQueryUI':!![],'bLengthChange':![],'bFilter':!![],'bSort':!![],'bInfo':!![],'bAutoWidth':!![],'bProcessing':!![],'iDisplayLength':0x5,'dom':'Rlfrtip','colReorder':{'allowReorder':!![]},'language':{'searchPlaceholder':'Search'},'columnDefs':[{'width':0x96,'targets':0x1}]}),$(_0x3ec6ac(0x2c4))[_0x3ec6ac(0x269)](_0x3ec6ac(0x16d));}function selectOnlyThis(_0x5300bc){var _0x44bb4c=a0_0x4d15ba;SelectClientId='',SelectClientId=_0x5300bc[_0x44bb4c(0x122)]('_')[0x1],$(_0x44bb4c(0x1e4))[_0x44bb4c(0x15b)](this)['prop'](_0x44bb4c(0x19e),![]),document[_0x44bb4c(0x211)](_0x5300bc)[_0x44bb4c(0x19e)]=!![];}function cleartextBox(){var _0x12d8c5=a0_0x4d15ba;IsSetvalue=![],$(_0x12d8c5(0x153))[_0x12d8c5(0x1be)](''),$(_0x12d8c5(0x227))['val'](''),$(_0x12d8c5(0x227))[_0x12d8c5(0x269)]('disabled'),$(_0x12d8c5(0x1bd))['val'](''),$(_0x12d8c5(0x13c))[_0x12d8c5(0x1be)](''),$(_0x12d8c5(0x17c))['val'](''),$(_0x12d8c5(0x1b0))[_0x12d8c5(0x1be)](''),$(_0x12d8c5(0x28e))[_0x12d8c5(0x139)]('src',_0x12d8c5(0x1dc)),initializePeoplePicker('InternalStakeholders',!![]),peoplePickerDiv=$(_0x12d8c5(0x152)),initializePeoplePicker(_0x12d8c5(0x274),![]),peoplePickerDivsuper=$(_0x12d8c5(0x179));}function GetGroupIDByGroupName(){var _0x292f5d=a0_0x4d15ba,_0x42db0f=_spPageContextInfo[_0x292f5d(0x18d)]+_0x292f5d(0x14c);$['ajax']({'url':_0x42db0f,'method':'GET','async':![],'headers':{'Accept':_0x292f5d(0x2c5)},'success':function(_0x5ce62a){GroupId=_0x5ce62a['d']['Id'];},'error':function(_0x2192d1){console['log'](_0x2192d1);}});}function a0_0x2f7b(){var _0x22da42=['[id$=\x27internalsupervisor_TopSpan\x27]','reject','<ul\x20class=\x22nav\x20nav-pills\x22>','#txtAddOrganization','#txtinviteemail','</tr>','\x20and\x20(Client_Name/Title\x20eq\x20\x27','PermissionLevelId','Description','animationTimeout','(Status\x20eq\x20\x27Initiated\x27)','Invitation\x20mail\x20has\x20been\x20sent\x20Reminder\x20to\x20the\x20user.','Inactive','when','focusout','Required','CommentCount','<div\x20>','<td>Request\x20to\x20Invite</td>','#Invited','webAbsoluteUrl','DataTable','#btnotherOrganizationSearch','(Client_Name/Title\x20eq\x20\x27','datepicker','Invited','<tr>',')/users','<td\x20class=\x22text-left\x22>','remove','SP.List','Invitation\x20mail\x20sending\x20failed.\x0aPlease\x20try\x20again\x20later.\x0a\x20Also\x20please\x20check\x20the\x20External\x20Sharing\x20setup\x20of\x20this\x20site.','readAsDataURL','getItemsWithQueryItem','ApprovedBy','toLowerCase','none','checked','trim','display-text','\x09<span>','html','64BPDePF','The\x20user\x20does\x20not\x20accept\x20the\x20invitation\x20yet.','.checkboxss','formatDate','Deferred','2773128rQMORA','.dropdown-select\x20.option','/_api/web/Lists/getbytitle(\x27TemplateMaster\x27)/Items?$filter=Active\x20eq\x20\x271\x27','shift','change','/_api/web/lists/getbytitle(\x27','keydown','.list\x20.option:focus','#txtExternalSupervisor','\x27)/items(','ClientMaster','Pending','.row','#hActive','option','CustomName','#txtExtStatus','CatogeryName','InternalStakeholders_TopSpan','tabindex','Rlfrtip','#txtExtDesignation','val','</span>','__next','toggleClass','width','add','Approved','#TempalteName','\x22/>','click','replace','Attn_Name','d\x20M,\x20yy\x20','/GuestUserDocuments','Failed','#invitetxtReferenceCode','88NPgNPB',')/AttachmentFiles/add(FileName=\x27','<div\x20class=\x22form-wizard\x20centered-pills\x22\x20>','#invitetxtDesignation','length','<td>Inactive</td>','</div>','Shared\x20With','show','\x20<li\x20role=\x22presentation\x22\x20class=\x22pills-box-info\x20\x22><a\x20href=\x22#\x22>Active</a></li>','toUpperCase','Update\x20successfully!','\x20<li\x20role=\x22presentation\x22\x20class=\x22pills-box-info\x20Inactive\x20\x22><a\x20href=\x22#\x22>Inactive</a></li>','Rejected','https://cdn.jsdelivr.net/gh/Titan4workGit/TitanRepo3.0@latest/SiteAssets/AdminPortal/ManageEmployee/assets/images/user_pic.jpg','#NotAccepted','#Permitting-into-Portal','fail','SelfCompany','acquireToken','ListItem',')\x22\x20data-original-title=\x22Check\x22>','input:checkbox','\x20</tr>','Bearer\x20','/_api/web/lists/getByTitle(\x27','selected','/_api/web/sitegroups/GetById(','Key','<i\x20class=\x22fa\x20fa-pencil\x22></i>','\x27)/fields/getbytitle(\x27','Search','<a\x20type=\x22button\x22\x20href=\x22#\x22\x20class=\x22custom-edit-btn\x22\x20data-toggle=\x22modal\x22\x20onclick=\x22SetTextBox(','\x20<th\x20class=\x22text-left\x20border-bottom-0\x22\x20><b>Organization</b></th>','FieldTypeKind','option:selected','<tbody\x20>','results','#txtinvitename','.uncheck-icon','#TemplateType\x20option:selected','find','hide','SP.FieldChoice','\x27,roledefid=\x271073741830\x27)','(Status\x20eq\x20\x27Accepted\x27)','</div></div></div></div>','<td>','\x20</tbody>','push','#pDescription','DocumentType','stringify','<h3\x20class=\x27m-0\x27>','.sp-peoplepicker-delImage','.check-status-user-detail','#btnInviteuser','email','SP.User','\x20<th\x20class=\x22text-left\x20border-bottom-0\x22><b>Status</b></th>','2673855pTvgVK',':selected','<tr\x20class=\x22text-left\x22>','statusText','</thead>\x20','<a\x20type=\x22button\x22\x20href=\x22#\x22\x20class=\x22custom-edit-btn\x22\x20data-toggle=\x22tooltip\x22\x20data-placement=\x22top\x22\x20title=\x22\x22\x20onclick=\x22CheckInvitedAction(','https://graph.microsoft.com/v1.0/invitations','getElementById','logintoken','result','InternalSupervisor','#btnSendReminder','\x27)\x22\x20data-placement=\x22top\x22\x20title=\x22Delete\x22>','#txtinvitemessage','ValidUpto','\x20<th\x20class=\x22text-left\x20border-bottom-0\x22><b>User\x20Name</b></th>','value','\x20\x20<tr\x20class=\x22text-center\x22>','spinner-','</h3>','MaximumEntitySuggestions','\x27)/items?$select=*,AttachmentFiles,Supervisor/Title,Supervisor/EMail,InternalStakeholders/Title,InternalStakeholders/EMail,LoginName/Title,Client_Name/Title,Client_Name/Id,Supervisor_Guest/Title\x20&$expand=Supervisor,InternalStakeholders,AttachmentFiles,LoginName,Client_Name,Supervisor_Guest\x20&$filter=\x20email\x20eq\x20\x27','AllowMultipleValues','\x20<th\x20class=\x22text-left\x20border-bottom-0\x22\x20><b>Email</b></th>','addClass','keyCode','InternalStakeholders','/_api/web/lists/GetByTitle(\x27','<td>Invitation\x20Sent</td>','#txtExtEmail','getMonth','getFullYear','#txtSearchValue','error','Modified','after','Please\x20accept\x20this\x20invitations\x20mail','Process\x20Failed.\x20Invitation\x20mail\x20failed\x20to\x20send.\x0a\x20Enter\x20valid\x20email\x20address\x20or\x20check\x20the\x20external\x20sharing\x20features\x20is\x20enabled.','AccessLevel','#selectByUser\x20>\x20[value=','(Status\x20eq\x20\x27Initiated\x27)\x20or\x20','Title','#__REQUESTDIGEST','#selectByUser','stopPropagation','ServerRelativeUrl','Idea\x20has\x20been\x20submitted\x20but\x20some\x20files\x20failed\x20to\x20upload.','ApprovedVersion','application/json;odata=nometadata','SearchPrincipalSource','GueastextinputFile','text','animating','</ul>','isDataTable','SP.FieldUser','.sp-peoplepicker-editorInput','5896828nSbAVG','/_api/lists/GetByTitle(\x27','<th></th>','\x20<tr>','?$top=5000&$select=PrimaryCompany,Status&$filter=PrimaryCompany\x20eq\x20\x27Primary\x27\x20and\x20Status\x20eq\x20\x27Active\x27\x20','d\x20M,\x20yy','#invitetxtValidityUpto','#Accepted','\x20<li\x20role=\x22presentation\x22\x20class=\x22pills-box-info\x22><a\x20href=\x22#\x22>Active</a></li>','Active','focus','\x20</ul>','All','[data-toggle=\x22tooltip\x22]','\x27)/fields?&$select=*&$filter=EntityPropertyName\x20eq\x20\x27TemplateType\x27','dd-searchbox','Not\x20Required','data','filter','LoginName','<div\x20\x20>','https://graph.microsoft.com/v1.0/users?$select=id,displayName,userPrincipalName,otherMails,userType,identities,creationType,externalUserState\x20&$filter=mail\x20eq\x20\x27','<option>','(Status\x20eq\x20\x27Active\x27)\x20or\x20','#hInitiated','resolve','dropdown-select','get','EntityData','DELETE','ExternalUsers','#check-status','15596vaSaHH','8gaZcRT','#InternalStakeholders','<span><h3\x20class=\x22red-color\x20text-center\x20mt-25\x22>You\x20are\x20not\x20authorized\x20to\x20access\x20!\x20</h3></span>','\x22\x20data-value=\x22','/_api/web/Lists/getbytitle(\x27TemplateMaster\x27)/Items?$select=*,AttachmentFiles&$filter=Title\x20eq\x20\x27','removeAttr','CollaborationType','.dropdown-select\x20ul\x20>\x20li','each','<li\x20role=\x22presentation\x22\x20class=\x22pills-box-info\x20\x22><a\x20href=\x22#\x22>Accepted</a></li>','empty','#invitetxtOrganizationName','#btnPermitting','\x27)/breakroleinheritance(false)','disabled','<i\x20class=\x22fa\x20fa-envelope-o\x22></i>','internalsupervisor','<div\x20class=\x22dd-search\x22><input\x20id=\x22txtSearchValue\x22\x20autocomplete=\x22off\x22\x20\x20onkeyup=\x22filters()\x22\x20class=\x22dd-searchbox\x22\x20placeholder=\x22Search\x20client\x20name\x22\x20type=\x22text\x22></div>','(Status\x20eq\x20\x27Invited\x27)','message','Please\x20enter\x20Organization\x20Name\x20','destroy','#hInvited','createElement','.list\x20.option.selected','test','#TemplateType\x20>\x20[value=','siteAbsoluteUrl','1832898npJIYh','responseJSON','\x20<li\x20role=\x22presentation\x22\x20class=\x22pills-box-info\x20Active\x20\x22><a\x20href=\x22#\x22>Active</a></li>','\x27)\x22\x20data-target=\x22#Permitting-into-Portal\x22\x20title=\x22Edit\x22>','SPClientPeoplePicker_InitStandaloneControlWrapper','#GueastextinputFile','<th\x20class=\x22text-left\x20w-10\x22><b>Type</b></th>','append','ApprovedDate','\x27)/fields','\x22\x20class=\x22getclientmaster\x22\x20onclick=\x22selectOnlyThis(this.id)\x22\x20\x20value=\x22',',\x27Invite\x27)\x22\x20data-target=\x22#Invite-Guest-User\x22\x20title=\x22Invite\x22>','substring','externalUserState','#extrenalImage','User:\x20\x20','files','name','EMail','target','4340QYSpOP','ready','animation-duration','#CustomName','#TemplateType','ajax','\x22></label>','selectByUser','\x20<th\x20class=\x22text-left\x20border-bottom-0\x22><b>Type</b></th>','Please\x20enter\x20Invite\x20Name\x20','#internalsupervisor','Client_Code','dataTable','<span>','SP.Field','User,DL,SecGroup,SPGroup','Association','removeClass','#datepickerAD5','open','charAt','closest','modal','PendingAcceptance','promise','Permit','application/json','<i\x20class=\x22fa\x20fa-question-circle-o\x22></i>','https://cdn.jsdelivr.net/gh/Titan4workGit/TitanRepo3.0@latest/SiteAssets/Titan-External-Employee-Portal/images/user_pic.jpg','Status','next','\x22\x20data-display-text=\x22','#Active','\x0a\x20Are\x20you\x20sure\x20to\x20delete\x20this\x20user\x20?','#txtExtOrganizationName','#TableGrid','<li\x20role=\x22presentation\x22\x20class=\x22pills-box-info\x20not-Accepted\x22><a\x20href=\x22#\x22>Not\x20Accepted</a></li>','AddUserKeys','<thead>','.current','Supervisor','ApprovedByOutsider','Base64EncodedByteArray','<span><h3\x20class=\x22red-color\x20text-center\x20mt-25\x22>Only\x20Tech-Admin\x20with\x20site-collection\x20admin\x20permission\x20can\x20access\x20this\x20page.\x20</h3></span><br>','join','Delete\x20Success\x20','#orgselectpicker','<li\x20role=\x22presentation\x22\x20class=\x22pills-box-info\x20Accepted\x22><a\x20href=\x22#\x22>Accepted</a></li>','#masterClientgrid','application/json;\x20odata=verbose','Accepted','ResolvePrincipalSource','GET','2572DxtagI','SupervisorId','InternalMembers','contentEditable','<a\x20type=\x22button\x22\x20type=\x22button\x22\x20class=\x22custom-edit-btn\x22\x20data-toggle=\x22tooltip\x22\x20\x20onclick=\x22DeleteHtmlRow(','<a\x20type=\x22button\x22\x20type=\x22button\x22\x20class=\x22custom-edit-btn\x22\x20\x20\x20data-toggle=\x22modal\x22\x20onclick=\x22SetTextBox(','prev','Draft','#invitesrchbtn','log','CustType','<div\x20class=\x22spinner','235660ngIZjU','\x27)/fields?$filter=Title\x20eq\x20\x27','/Forms/AllItems.aspx','slice','#hAccepted','AttachmentFiles','User\x20Added','Unauthorized','creationType','css','Client_Name','.selected','done','SPClientPeoplePickerDict','<a\x20type=\x22button\x22\x20type=\x22button\x22\x20class=\x22custom-edit-btn\x22\x20data-toggle=\x22tooltip\x22\x20onclick=\x22DeleteHtmlRow(','</a>','DocumentLibrary','split','User\x20has\x20accept\x20the\x20invitation.\x0a\x20Please\x20proceed\x20for\x20activated\x20this\x20user.','#Invite-Guest-User','d\x20M,\x20y','before','IsActive','/_api/web/siteusers(@v)?@v=\x27','MERGE','#hInactive','Please\x20enter\x20a\x20valid\x20email\x20address\x20of\x20the\x20guest\x20user,\x20who\x20is\x20outsider\x20of\x20this\x20organization.','GetAllUserInfo','\x27)/items?$select=*,InternalStakeholders/Title,Supervisor_Guest/Title,Client_Name/Title,LoginName/Title\x20&$expand=\x20LoginName,Client_Name,Supervisor_Guest,InternalStakeholders\x20&$filter=((Status\x20eq\x20\x27Initiated\x27)\x20or\x20(Status\x20eq\x20\x27Invited\x27\x20)or\x20(Status\x20eq\x20\x27Pending\x27)or\x20(Status\x20eq\x20\x27Accepted\x27))','#Inactive','<div\x20class=\x22guesr-user-edit-lock-btn-box\x22>','Designation','</thead>','\x27)/items?$select=*,InternalStakeholders/Title,Supervisor_Guest/Title,Client_Name/Title,LoginName/Title\x20&$expand=\x20LoginName,Client_Name,Supervisor_Guest,InternalStakeholders\x20&$filter=(','TemplateType','TemplateMaster','SP.FieldDateTime','</td>','POST',')\x22\x20\x20data-original-title=\x22Check\x22>','attr','<i\x20class=\x22fa\x20fa-user-plus\x22></i>','getItem','#txtReferenceCodeExt','src','Shared','ReferenceCode','setItem','indexOf','true','PermissionLevel','trigger','invitedUserEmailAddress','\x20spinner-absolute','display','Invitation\x20mail\x20has\x20been\x20sent\x20to\x20the\x20user.','Success','<div\x20class=\x22dropdown-select\x20wide\x20','ClientName','/_api/web/sitegroups/getbyname(\x27Contributors\x27)?$select=id','children','Your\x20item\x20has\x20not\x20been\x20submitted\x20successfully!','#ddlAssociation','<li\x20role=\x22presentation\x22\x20class=\x22pills-box-info\x20Invited\x22><a\x20href=\x22#\x22>Invited</a></li>','Guest_name','[id$=\x27InternalStakeholders_TopSpan\x27]','#txtExtLoginName','.list','<label><input\x20type=\x22checkbox\x22\x20id=\x22Check_','<td>Active</td>','\x20\x20\x20\x20\x20\x20\x20\x20Token\x20','internalsupervisor_TopSpan','?$select=*,Id,Supervisor/Title,Supervisor/EMail,Supervisor/Id\x20,InternalMembers/EMail,InternalMembers/Id,InternalMembers/Title,InternalSupervisor/EMail,InternalSupervisor/Id,InternalSupervisor/Title\x20&$expand=Supervisor,InternalMembers,InternalSupervisor\x20','Width','not','prop','<li\x20role=\x22presentation\x22\x20class=\x22pills-box-info\x20Initiated\x22><a\x20href=\x22#\x22>Initiated</a></li>','.check-icon','Choices','body','#templateImg','getDate','.dropdown-select','#Initiated',':\x20\x20Compact\x20Token\x20parsing\x20failed','/_api/web/lists/getByTitle(\x27ExternalUsers\x27)/items(','Organization','This\x20user:-','Initiated','?$select=*,Id,Supervisor/Title,Supervisor/EMail,Supervisor/Id,\x20InternalMembers/EMail,InternalMembers/Title,InternalSupervisor/EMail,InternalSupervisor/Title\x20&$expand=Supervisor,InternalMembers,InternalSupervisor\x20&$filter=\x20Title\x20eq\x20\x27','<div\x20class=\x22checkbox\x20m-0\x22>','Acknowledgement','style','hasClass','/GuestUserDocuments/','email_date','.spinner','Invite','Email','Approval','SubCategory','application/json;odata=verbose','<i\x20class=\x22fa\x20fa-trash-o\x22></i>','/GuestUserDocuments/_api/web/lists/getbytitle(\x27'];a0_0x2f7b=function(){return _0x22da42;};return a0_0x2f7b();}function SetCalendar(){var _0x23d75c=a0_0x4d15ba,_0x1db1fc=new Date();today=_0x1db1fc['getMonth']()+0x1+'\x20'+_0x1db1fc[_0x23d75c(0x162)]()+'\x20'+_0x1db1fc[_0x23d75c(0x229)](),Validdate=_0x1db1fc[_0x23d75c(0x228)]()+0x1+'/'+_0x1db1fc[_0x23d75c(0x162)]()+'/'+(_0x1db1fc[_0x23d75c(0x229)]()+0x1),Dates=new Date(Validdate),$('#invitetxtValidityUpto')['val']($[_0x23d75c(0x191)][_0x23d75c(0x1a6)](_0x23d75c(0x248),Dates));}function GetItemTypeForListName(_0x2e3027){var _0x396624=a0_0x4d15ba;return'SP.Data.'+_0x2e3027[_0x396624(0x2a8)](0x0)[_0x396624(0x1d8)]()+_0x2e3027[_0x396624(0x122)]('\x20')[_0x396624(0x2c0)]('')[_0x396624(0x2d8)](0x1)+_0x396624(0x1e2);}function Pertimtblock(_0x20de16){var _0x28979c=a0_0x4d15ba;GetCategoryMaster(),$[_0x28979c(0x186)](GetItemToListchoice(),GetItemToList(_0x20de16))['done'](function(_0x527210,_0x154b90){var _0x5005f=_0x28979c;if(_0x154b90[_0x5005f(0x1d2)]>0x0){if(_0x154b90[0x0][_0x5005f(0x2da)][_0x5005f(0x1f3)]['length']>0x0){var _0x30654e=_0x154b90[0x0][_0x5005f(0x2da)]['results'][0x0]['ServerRelativeUrl'];$(_0x5005f(0x28e))['attr'](_0x5005f(0x13d),_0x30654e);}else $(_0x5005f(0x28e))[_0x5005f(0x139)](_0x5005f(0x13d),'https://cdn.jsdelivr.net/gh/Titan4workGit/TitanRepo3.0@latest/SiteAssets/AdminPortal/ManageEmployee/assets/images/user_pic.jpg');IsUpdate=!![],userListItemId=_0x154b90[0x0]['Id'],initializePeoplePicker('InternalStakeholders',!![]),peoplePickerDiv=$('[id$=\x27InternalStakeholders_TopSpan\x27]'),initializePeoplePicker('internalsupervisor',![]),peoplePickerDivsuper=$(_0x5005f(0x179));for(var _0x7a397c=0x0;_0x7a397c<_0x154b90[0x0][_0x5005f(0x224)][_0x5005f(0x1f3)][_0x5005f(0x1d2)];_0x7a397c++){setPeoplePickerUsersInfoCurrent('InternalStakeholders_TopSpan',_0x154b90[0x0][_0x5005f(0x224)][_0x5005f(0x1f3)][_0x7a397c][_0x5005f(0x292)]);}setPeoplePickerUsersInfoCurrent(_0x5005f(0x158),_0x154b90[0x0][_0x5005f(0x2bc)][_0x5005f(0x292)]);debugger;$(_0x5005f(0x265))[_0x5005f(0x139)]('disabled',_0x5005f(0x272)),$('#internalsupervisor')[_0x5005f(0x139)]('disabled',_0x5005f(0x272)),$(peoplePickerDiv)[_0x5005f(0x1f7)](_0x5005f(0x204))[_0x5005f(0x11a)](_0x5005f(0x147),_0x5005f(0x19d)),$(peoplePickerDivsuper)[_0x5005f(0x1f7)](_0x5005f(0x204))[_0x5005f(0x11a)](_0x5005f(0x147),_0x5005f(0x19d));for(var _0x7a397c=0x0;_0x7a397c<_0x527210[_0x5005f(0x1d2)];_0x7a397c++){var _0x351cd9=$(_0x5005f(0x259));_0x351cd9[_0x5005f(0x139)](_0x5005f(0x21a),_0x527210[_0x7a397c])['text'](_0x527210[_0x7a397c]);}$(_0x5005f(0x227))[_0x5005f(0x1be)](_0x154b90[0x0][_0x5005f(0x207)]);IsSetvalue&&$('#txtExtEmail')[_0x5005f(0x139)](_0x5005f(0x272),_0x5005f(0x272));$(_0x5005f(0x153))[_0x5005f(0x1be)](_0x154b90[0x0][_0x5005f(0x256)]['Title']?_0x154b90[0x0]['LoginName'][_0x5005f(0x233)]:_0x154b90[0x0][_0x5005f(0x151)]),$(_0x5005f(0x1bd))[_0x5005f(0x1be)](_0x154b90[0x0][_0x5005f(0x130)]),$(_0x5005f(0x1b0))[_0x5005f(0x1be)](_0x154b90[0x0]['Supervisor_Guest']['Title']),$(_0x5005f(0x14f))[_0x5005f(0x1be)](_0x154b90[0x0][_0x5005f(0x2a4)]),$(_0x5005f(0x2b6))[_0x5005f(0x1be)](_0x154b90[0x0][_0x5005f(0x167)]),$('#txtAddOrganization')['val'](_0x154b90[0x0][_0x5005f(0x11b)][_0x5005f(0x233)]),Client_Id=_0x154b90[0x0][_0x5005f(0x11b)]['Id'];var _0x414052=new Date(_0x154b90[0x0]['ValidUpto']);$(_0x5005f(0x2a6))[_0x5005f(0x1be)]($[_0x5005f(0x191)][_0x5005f(0x1a6)](_0x5005f(0x248),_0x414052)),$(_0x5005f(0x13c))[_0x5005f(0x1be)](_0x154b90[0x0][_0x5005f(0x13f)]),$(_0x5005f(0x27e)+_0x154b90[0x0][_0x5005f(0x133)]+']')[_0x5005f(0x139)]('selected',_0x5005f(0x142)),$('#selectByUser\x20>\x20[value='+_0x154b90[0x0][_0x5005f(0x26a)]+']')['attr']('selected',_0x5005f(0x142)),$(_0x5005f(0x18f))[_0x5005f(0x1f8)](),GetClientMasterTeamDeailsByTitle(_0x154b90[0x0][_0x5005f(0x11b)][_0x5005f(0x233)]);}else $('#txtExtLoginName')[_0x5005f(0x1be)](''),$(_0x5005f(0x1bd))[_0x5005f(0x1be)](''),$(_0x5005f(0x2b6))[_0x5005f(0x1be)](''),$(_0x5005f(0x13c))['val'](''),$('option:selected',$(_0x5005f(0x298)))[_0x5005f(0x1be)](''),$('#datepickerAD5')[_0x5005f(0x1be)]($['datepicker'][_0x5005f(0x1a6)](_0x5005f(0x125),new Date())),$(_0x5005f(0x1f1),$(_0x5005f(0x235)))[_0x5005f(0x1be)](),$(_0x5005f(0x1f1),$(_0x5005f(0x1b8)))['val'](),$(_0x5005f(0x28e))['attr'](_0x5005f(0x13d),_0x5005f(0x2b0)),$(_0x5005f(0x285))[_0x5005f(0x139)]('src',_0x5005f(0x2b0)),initializePeoplePicker('InternalStakeholders',!![]),peoplePickerDiv=$('[id$=\x27InternalStakeholders_TopSpan\x27]'),initializePeoplePicker(_0x5005f(0x274),![]),peoplePickerDivsuper=$(_0x5005f(0x179));});}function GetItemToListchoice(){var _0x59befd=a0_0x4d15ba,_0x250af3='ExternalUsers',_0x33d081=$[_0x59befd(0x1a7)]();return $[_0x59befd(0x299)]({'url':_spPageContextInfo[_0x59befd(0x18d)]+'/_api/web/lists/getbytitle(\x27'+_0x250af3+_0x59befd(0x251),'type':'get','async':![],'headers':{'accept':_0x59befd(0x176),'X-RequestDigest':$(_0x59befd(0x234))[_0x59befd(0x1be)](),'content-Type':_0x59befd(0x176)},'success':function(_0x2f2321){var _0x8283c9=_0x59befd;_0x33d081[_0x8283c9(0x25c)](_0x2f2321['d'][_0x8283c9(0x1f3)][0x0][_0x8283c9(0x15f)][_0x8283c9(0x1f3)]),console[_0x8283c9(0x2d2)](_0x2f2321);},'error':function(_0x1e44f3){var _0x2ed342=_0x59befd;console[_0x2ed342(0x2d2)](JSON[_0x2ed342(0x202)](_0x1e44f3)),_0x33d081[_0x2ed342(0x17a)](_0x1e44f3);}}),_0x33d081[_0x59befd(0x2ac)]();}function GetItemToList(_0xb68a0e){var _0x35693e=a0_0x4d15ba,_0x3194d6=_0x35693e(0x261),_0x5d9b56=$[_0x35693e(0x1a7)]();return $[_0x35693e(0x299)]({'url':_spPageContextInfo['webAbsoluteUrl']+_0x35693e(0x1ad)+_0x3194d6+_0x35693e(0x21f)+_0xb68a0e+'\x27','type':'get','async':![],'headers':{'accept':_0x35693e(0x176),'X-RequestDigest':$('#__REQUESTDIGEST')['val'](),'content-Type':_0x35693e(0x176)},'success':function(_0xaa0719){var _0x47f057=_0x35693e;_0x5d9b56[_0x47f057(0x25c)](_0xaa0719['d'][_0x47f057(0x1f3)]),console[_0x47f057(0x2d2)](_0xaa0719);},'error':function(_0x561a18){var _0xcb15bd=_0x35693e;console['log'](JSON[_0xcb15bd(0x202)](_0x561a18)),_0x5d9b56['reject'](_0x561a18);}}),_0x5d9b56[_0x35693e(0x2ac)]();}function GetCategoryMaster(){var _0x9ed243=a0_0x4d15ba,_0x471457='CategoryMaster',_0x4e8061=_spPageContextInfo[_0x9ed243(0x18d)]+_0x9ed243(0x225)+_0x471457+'\x27)/items?$filter=CategoryType\x20eq\x20\x27Guest\x20Type\x27\x20and\x20Status\x20eq\x20\x20\x27Yes\x27\x20';$['ajax']({'url':_0x4e8061,'headers':{'Accept':'application/json;odata=verbose'},'async':![],'success':function(_0x2b0fc0){var _0x354f26=_0x9ed243,_0x1273ca=document[_0x354f26(0x211)](_0x354f26(0x29b));_0x1273ca['innerHTML']='';for(var _0x4d2d3d=0x0;_0x4d2d3d<_0x2b0fc0['d']['results'][_0x354f26(0x1d2)];_0x4d2d3d++){var _0x46d1d2=_0x2b0fc0['d'][_0x354f26(0x1f3)][_0x4d2d3d]['CatogeryName'],_0x1bba3f=_0x2b0fc0['d'][_0x354f26(0x1f3)][_0x4d2d3d][_0x354f26(0x1b9)];opt=document[_0x354f26(0x27b)](_0x354f26(0x1b6)),opt[_0x354f26(0x21a)]=_0x1bba3f,opt[_0x354f26(0x23d)]=_0x46d1d2,_0x1273ca['appendChild'](opt);}},'error':function(_0x3590c8){var _0x583158=_0x9ed243;console[_0x583158(0x2d2)](_0x3590c8);}});}function readURL(_0x58d41d){var _0x55e610=a0_0x4d15ba;if(_0x58d41d[_0x55e610(0x290)]&&_0x58d41d[_0x55e610(0x290)][0x0]){var _0x22f267=new FileReader();_0x22f267['onload']=function(_0x1e2ebd){var _0x1214a5=_0x55e610;$(_0x1214a5(0x28e))[_0x1214a5(0x139)](_0x1214a5(0x13d),_0x1e2ebd['target'][_0x1214a5(0x213)]);},_0x22f267[_0x55e610(0x199)](_0x58d41d['files'][0x0]);}}var DocumentLibraryUrl='';function UpdateGeustuser(_0x412a6b){var _0x532798=a0_0x4d15ba,_0x10d437=_0x532798(0x261),_0x61045e='',_0x325349=SPClientPeoplePicker[_0x532798(0x11e)][peoplePickerDiv[0x0]['id']],_0x203a40=_0x325349[_0x532798(0x12c)](),_0x3efd7d=[];UserListId=[];for(var _0x3df294=0x0;_0x3df294<_0x203a40[_0x532798(0x1d2)];_0x3df294++){var _0x36147b=GetUserId(_0x203a40[_0x3df294]['EntityData']['Email']);_0x36147b==''&&(_0x36147b=GetUserId(_0x203a40[_0x3df294]['Key'][_0x532798(0x122)]('|')[0x2])),_0x3efd7d[_0x532798(0x1ff)](_0x36147b),UserListId['push'](_0x36147b);}var _0x128010=ClientInternalMembers['filter'](function(_0x3a0a16){var _0x5d4a77=_0x532798;return _0x3a0a16[_0x5d4a77(0x233)]==$(_0x5d4a77(0x17c))[_0x5d4a77(0x1be)]();});_0x325349=SPClientPeoplePicker[_0x532798(0x11e)][peoplePickerDivsuper[0x0]['id']],_0x203a40=_0x325349[_0x532798(0x12c)]();var _0x59f04d=GetUserId(_0x203a40[0x0][_0x532798(0x25f)][_0x532798(0x173)]);_0x59f04d==''&&(_0x59f04d=GetUserId(_0x203a40[0x0][_0x532798(0x1ea)]['split']('|')[0x2]));UserListId['push'](_0x59f04d),_0x61045e=GetUserEmail($(_0x532798(0x227))[_0x532798(0x1be)]()),UserListId[_0x532798(0x1ff)](_0x61045e),GuestUserEmail=$('#txtExtEmail')['val'](),DocumentLibraryUrl=_spPageContextInfo[_0x532798(0x18d)]+_0x532798(0x16f)+$(_0x532798(0x17c))[_0x532798(0x1be)]()['trim']()['replace'](/[^0-9A-Z]+/gi,'')+_0x532798(0x2d7);_0x61045e==''&&(GetGroupIDByGroupName(),AddUserinSharePointGroup($(_0x532798(0x227))[_0x532798(0x1be)](),GroupId));var _0x4dd8cd,_0xd6896a=GetItemTypeForListName(_0x10d437);_0x4dd8cd={'__metadata':{'type':_0xd6896a},'Designation':$(_0x532798(0x1bd))[_0x532798(0x1be)](),'LoginNameId':_0x61045e,'Supervisor_GuestId':_0x61045e,'Organization':$(_0x532798(0x17c))[_0x532798(0x1be)](),'ReferenceCode':$(_0x532798(0x13c))[_0x532798(0x1be)](),'TemplateType':$(_0x532798(0x1f1),$(_0x532798(0x298)))[_0x532798(0x1be)](),'InternalStakeholdersId':{'results':_0x3efd7d},'SupervisorId':_0x59f04d,'ValidUpto':$(_0x532798(0x2a6))[_0x532798(0x1be)](),'CollaborationType':$(_0x532798(0x1f1),$(_0x532798(0x235)))[_0x532798(0x1be)](),'Status':$('option:selected',$(_0x532798(0x1b8)))[_0x532798(0x1be)](),'DocumentLibrary':DocumentLibraryUrl};var _0x58516f=$[_0x532798(0x1a7)]();return $[_0x532798(0x299)]({'url':_spPageContextInfo[_0x532798(0x18d)]+'/_api/web/lists/GetByTitle(\x27'+_0x10d437+_0x532798(0x1b1)+_0x412a6b+')','type':_0x532798(0x137),'async':![],'headers':{'accept':'application/json;odata=verbose','X-RequestDigest':$(_0x532798(0x234))[_0x532798(0x1be)](),'content-Type':'application/json;odata=verbose','IF-MATCH':'*','X-HTTP-Method':_0x532798(0x129)},'data':JSON['stringify'](_0x4dd8cd),'success':function(_0xd96965){var _0x1f6fd7=_0x532798;if(document['getElementById'](_0x1f6fd7(0x23c))[_0x1f6fd7(0x290)][_0x1f6fd7(0x1d2)]===0x0){}else UploadAttachement(ExtrnaluserId);IsExistOrNotLibrary($(_0x1f6fd7(0x17c))['val']()['trim']()[_0x1f6fd7(0x1c8)](/[^0-9A-Z]+/gi,''))?AssignTheEditRole($(_0x1f6fd7(0x17c))[_0x1f6fd7(0x1be)]()[_0x1f6fd7(0x19f)]()[_0x1f6fd7(0x1c8)](/[^0-9A-Z]+/gi,''),UserListId):(createNewLibraryByRest($(_0x1f6fd7(0x17c))[_0x1f6fd7(0x1be)]()[_0x1f6fd7(0x19f)]()['replace'](/[^0-9A-Z]+/gi,'')),AssignTheEditRole($(_0x1f6fd7(0x17c))[_0x1f6fd7(0x1be)]()[_0x1f6fd7(0x19f)]()['replace'](/[^0-9A-Z]+/gi,''),UserListId));$(_0x1f6fd7(0x1b0))[_0x1f6fd7(0x1be)]()==''&&UpdateClientMaster(_0x128010[0x0]['ID'],_0x61045e);_0x128010[0x0][_0x1f6fd7(0x121)]==null&&UpdateClientMasterDocLib(_0x128010[0x0]['ID'],DocumentLibraryUrl,_0x59f04d,_0x3efd7d);createNewCustomColumn(),alert(_0x1f6fd7(0x1d9));for(var _0x1417bd in htmlGridarray){if(htmlGridarray[_0x1417bd]['ID']==ExtrnaluserId){htmlGridarray[_0x1417bd][_0x1f6fd7(0x2b1)]=_0x1f6fd7(0x24c),htmlGridarray[_0x1417bd][_0x1f6fd7(0x28d)]='';break;}}GenerateGridHtml(htmlGridarray);},'error':function(_0x1d5f1e){var _0x1d6bde=_0x532798;console['log'](JSON[_0x1d6bde(0x202)](_0x1d5f1e)),_0x58516f[_0x1d6bde(0x17a)](_0x1d5f1e);}}),_0x58516f['promise']();}function UploadAttachement(_0x25389c){var _0x14ad6d=a0_0x4d15ba;try{if(document[_0x14ad6d(0x211)]('GueastextinputFile')[_0x14ad6d(0x290)]['length']===0x0){}else{var _0x29d514=_0x25389c,_0x5e2590=$(_0x14ad6d(0x285)),_0x40d6fc=_0x5e2590[0x0]['files']['length'],_0x4b13ff=[],_0x92e52c=_0x5e2590[0x0][_0x14ad6d(0x290)][0x0][_0x14ad6d(0x291)];_0x92e52c=_0x5e2590[0x0][_0x14ad6d(0x290)][0x0][_0x14ad6d(0x291)][_0x14ad6d(0x1c8)](/[^a-zA-Z0-9-. ]/g,''),_0x92e52c=_0x92e52c[_0x14ad6d(0x1c8)](/\s/g,'');for(var _0x3d4040=0x0;_0x3d4040<_0x40d6fc;_0x3d4040++){_0x4b13ff[_0x14ad6d(0x1ff)](_0x5e2590[0x0][_0x14ad6d(0x290)][_0x3d4040]);}uploadFileSP('ExternalUsers',_0x29d514,_0x4b13ff,_0x40d6fc,_0x92e52c);}}catch(_0x34355a){alert(_0x14ad6d(0x14e));}}function uploadFileSP(_0x5465bf,_0x18acd3,_0x41a0cb,_0x4c9f04,_0x1a0ba0){var _0x193276=a0_0x4d15ba,_0x333733=0x0,_0x78ef14=$[_0x193276(0x1a7)](),_0x4a8a27='',_0x35e285=_0x41a0cb[0x0],_0x1be7dc=getFileBuffer(_0x35e285);return _0x1be7dc[_0x193276(0x11d)](function(_0x21646a,_0x14f75a,_0x22234f){var _0x466d2a=_0x193276,_0x2c69e6=new Uint8Array(_0x21646a),_0x142a3d=new SP[(_0x466d2a(0x2be))](),_0xe2501a=_spPageContextInfo[_0x466d2a(0x18d)]+_0x466d2a(0x244)+_0x5465bf+_0x466d2a(0x1b1)+_0x18acd3+_0x466d2a(0x1cf)+_0x1a0ba0+'\x27)',_0x26c907=0x0;$[_0x466d2a(0x299)]({'url':_0xe2501a,'type':_0x466d2a(0x137),'processData':![],'contentType':_0x466d2a(0x176),'data':_0x21646a,'headers':{'accept':'application/json;odata=verbose','X-RequestDigest':$(_0x466d2a(0x234))[_0x466d2a(0x1be)](),'content-length':_0x21646a['byteLength']},'success':function(_0x19584b){var _0x5f40b6=_0x466d2a;_0x333733++,_0x4a8a27=_0x333733,_0x41a0cb[_0x5f40b6(0x1ab)]();if(_0x41a0cb['length']>0x0)uploadFileSP('ExternalUsers',_0x18acd3,_0x41a0cb,_0x41a0cb['length']);else{}},'error':function(_0x27976b){var _0x1b0886=_0x466d2a;alert(_0x1b0886(0x238));}}),_0x78ef14[_0x466d2a(0x25c)](_0x4a8a27);}),_0x1be7dc[_0x193276(0x1df)](function(_0x46da18){var _0x41f82f=_0x193276;_0x78ef14[_0x41f82f(0x17a)](_0x46da18);}),_0x78ef14['promise']();}function GetUserId(_0x520ef0){var _0x109607=a0_0x4d15ba,_0x4cc240='',_0x134775='i:0#.f|membership|',_0x4efe03=_spPageContextInfo[_0x109607(0x27f)],_0xd127e=_0x134775+_0x520ef0;return $['ajax']({'url':_0x4efe03+_0x109607(0x128)+encodeURIComponent(_0xd127e)+'\x27','method':_0x109607(0x2c8),'headers':{'Accept':_0x109607(0x2c5)},'async':![],'success':function(_0x23ee02){_0x4cc240=_0x23ee02['d']['Id'];},'error':function(_0xb494ea){var _0x54154c=_0x109607;console[_0x54154c(0x2d2)](JSON[_0x54154c(0x202)](_0xb494ea)),console[_0x54154c(0x2d2)](JSON[_0x54154c(0x202)]('This\x20user:-'+_0x520ef0));}}),_0x4cc240;}function GetUserEmail(_0xb71f88){var _0x460b2e=a0_0x4d15ba,_0x3f6628='',_0x3f6045=_spPageContextInfo[_0x460b2e(0x27f)];return $[_0x460b2e(0x299)]({'url':_0x3f6045+'/_api/web/siteusers/getbyemail(\x27'+_0xb71f88+'\x27)','method':_0x460b2e(0x2c8),'headers':{'Accept':_0x460b2e(0x2c5)},'async':![],'success':function(_0x31906d){_0x3f6628=_0x31906d['d']['Id'];},'error':function(_0x1c67bd){var _0x944b8c=_0x460b2e;console[_0x944b8c(0x2d2)](JSON['stringify'](_0x1c67bd)),console[_0x944b8c(0x2d2)](JSON[_0x944b8c(0x202)](_0x944b8c(0x168)+_0xb71f88));}}),_0x3f6628;}function createNewLibraryByRest(_0x5e9d4b){var _0xa56e1c=a0_0x4d15ba,_0x356197=_0x5e9d4b,_0xf4641c=_spPageContextInfo[_0xa56e1c(0x18d)]+'/GuestUserDocuments/_api/Web/Lists/';$[_0xa56e1c(0x299)]({'url':_0xf4641c,'method':_0xa56e1c(0x137),'async':![],'data':JSON['stringify']({'__metadata':{'type':_0xa56e1c(0x197)},'AllowContentTypes':!![],'BaseTemplate':0x65,'ContentTypesEnabled':!![],'Description':_0xa56e1c(0x181),'OnQuickLaunch':!![],'Title':_0x5e9d4b}),'headers':{'content-type':_0xa56e1c(0x176),'X-RequestDigest':$(_0xa56e1c(0x234))[_0xa56e1c(0x1be)]()},'success':function(_0x434707){BreakRoleInheritance(_0x356197);},'error':function(_0x197eb1){alert(_0x197eb1['responseText']);}});}function BreakRoleInheritance(_0x2988cd){var _0x55ade4=a0_0x4d15ba;url=_spPageContextInfo[_0x55ade4(0x18d)]+'/GuestUserDocuments/_api/web/lists/getbytitle(\x27'+_0x2988cd+_0x55ade4(0x271),$[_0x55ade4(0x299)]({'url':url,'type':'POST','async':![],'headers':{'accept':_0x55ade4(0x23a),'X-RequestDigest':$(_0x55ade4(0x234))[_0x55ade4(0x1be)]()},'success':function(_0x4f52f6){var _0x5a3ad7=_0x55ade4;console[_0x5a3ad7(0x2d2)](_0x4f52f6);},'error':function(_0x21b5cd){console['log'](_0x21b5cd);}});}function AssignTheEditRole(_0x3ad109,_0x368bef){var _0x522e2c=a0_0x4d15ba;for(var _0x52d989=0x0;_0x52d989<_0x368bef['length'];_0x52d989++){url=_spPageContextInfo[_0x522e2c(0x18d)]+_0x522e2c(0x178)+_0x3ad109+'\x27)/roleassignments/addroleassignment(principalid=\x27'+_0x368bef[_0x52d989]+_0x522e2c(0x1fa),$[_0x522e2c(0x299)]({'url':url,'type':_0x522e2c(0x137),'async':![],'headers':{'accept':_0x522e2c(0x23a),'X-RequestDigest':$(_0x522e2c(0x234))[_0x522e2c(0x1be)]()},'success':function(_0x1718bd){var _0x104b60=_0x522e2c;console[_0x104b60(0x2d2)](_0x1718bd);},'error':function(_0x54cacb){var _0x5a4a32=_0x522e2c;console[_0x5a4a32(0x2d2)](_0x54cacb);}});}}function IsExistOrNotLibrary(_0x54908a){var _0x19e749=a0_0x4d15ba,_0x4074b4='';return url=_spPageContextInfo[_0x19e749(0x18d)]+'/GuestUserDocuments/_api/web/lists/?$filter=Title\x20eq\x20\x27'+_0x54908a+'\x27',$[_0x19e749(0x299)]({'url':url,'type':'get','async':![],'headers':{'accept':_0x19e749(0x23a),'X-RequestDigest':$(_0x19e749(0x234))['val']()},'success':function(_0x5a6a96){var _0x4ec261=_0x19e749;_0x5a6a96[_0x4ec261(0x21a)]['length']>0x0?_0x4074b4=!![]:_0x4074b4=![],console[_0x4ec261(0x2d2)](_0x5a6a96);},'error':function(_0x2ff1ab){var _0x24ec86=_0x19e749;console[_0x24ec86(0x2d2)](_0x2ff1ab);}}),_0x4074b4;}function addSpinner(_0x256629,_0x3cae07){var _0x4d13ea=a0_0x4d15ba,_0x433f49=_0x256629[_0x4d13ea(0x14d)](_0x4d13ea(0x171));if(_0x433f49['length']&&!_0x433f49[_0x4d13ea(0x16e)]('spinner-remove'))return null;!_0x433f49[_0x4d13ea(0x1d2)]&&(_0x433f49=$(_0x4d13ea(0x2d4)+(_0x3cae07?'':_0x4d13ea(0x146))+_0x4d13ea(0x1c6))['appendTo'](_0x256629)),animateSpinner(_0x433f49,_0x4d13ea(0x1c3));}function removeSpinner(_0x5a4168,_0x35c9b0){var _0x4263ce=a0_0x4d15ba,_0x3cd046=_0x5a4168[_0x4263ce(0x14d)]('.spinner');_0x3cd046['length']&&animateSpinner(_0x3cd046,_0x4263ce(0x196),_0x35c9b0);}function animateSpinner(_0x350485,_0x2de1b4,_0x9ad897){var _0x42732e=a0_0x4d15ba;_0x350485['data'](_0x42732e(0x23e))&&(_0x350485[_0x42732e(0x2a5)](_0x350485[_0x42732e(0x254)](_0x42732e(0x23e)))[_0x42732e(0x254)](_0x42732e(0x23e),null),_0x350485[_0x42732e(0x254)](_0x42732e(0x182))&&clearTimeout(_0x350485[_0x42732e(0x254)](_0x42732e(0x182)))),_0x350485[_0x42732e(0x222)](_0x42732e(0x21c)+_0x2de1b4)['data'](_0x42732e(0x23e),_0x42732e(0x21c)+_0x2de1b4),_0x350485[_0x42732e(0x254)](_0x42732e(0x182),setTimeout(function(){var _0x239db2=_0x42732e;_0x2de1b4==_0x239db2(0x196)&&_0x350485[_0x239db2(0x196)](),_0x9ad897&&_0x9ad897();},parseFloat(_0x350485[_0x42732e(0x11a)](_0x42732e(0x296)))*0x3e8));}function getTemplate(){var _0x22d866=a0_0x4d15ba,_0x7006b3,_0x2ae25d=_0x22d866(0x134),_0x2f8cc2,_0x1c0abb=$(_0x22d866(0x1f6))[_0x22d866(0x23d)]();_0x2f8cc2=$(_0x22d866(0x1f6))['val'](),$(_0x22d866(0x1c5))[_0x22d866(0x26e)](),$(_0x22d866(0x297))[_0x22d866(0x26e)](),$(_0x22d866(0x200))[_0x22d866(0x26e)](),_0x1c0abb!=''?_0x7006b3=_spPageContextInfo[_0x22d866(0x18d)]+_0x22d866(0x268)+_0x2f8cc2+'\x27&$expand=AttachmentFiles':_0x7006b3=_spPageContextInfo['webAbsoluteUrl']+_0x22d866(0x1aa),$[_0x22d866(0x299)]({'url':_0x7006b3,'headers':{'Accept':'application/json;odata=verbose'},'async':![],'success':function(_0x11ee13){var _0x3acf25=_0x22d866,_0x4f8289=_0x11ee13['d']['results'];for(var _0x536c68=0x0;_0x536c68<_0x4f8289[_0x3acf25(0x1d2)];_0x536c68++){$(_0x3acf25(0x1c5))['append'](_0x4f8289[_0x536c68]['Title']),$(_0x3acf25(0x297))[_0x3acf25(0x287)](_0x4f8289[_0x536c68][_0x3acf25(0x1b7)]),$('#pDescription')[_0x3acf25(0x287)](_0x4f8289[_0x536c68][_0x3acf25(0x181)]);var _0x1bf93d=$(_0x3acf25(0x161));_0x1c0abb!=''&&_0x1bf93d[_0x3acf25(0x139)](_0x3acf25(0x13d),_0x4f8289[0x0][_0x3acf25(0x2da)]['results'][0x0][_0x3acf25(0x237)]),_0x1c0abb==''&&$(_0x3acf25(0x298))[_0x3acf25(0x287)]($('<option/>')['val'](_0x4f8289[_0x536c68][_0x3acf25(0x233)])[_0x3acf25(0x23d)](_0x4f8289[_0x536c68]['CustomName']));}},'error':function(_0x2f1b4b){console['log'](_0x2f1b4b);}});}function createNewCustomColumn(){var _0x46b83c=a0_0x4d15ba,_0x5a6419=$(_0x46b83c(0x17c))[_0x46b83c(0x1be)]()['trim']()[_0x46b83c(0x1c8)](/[^0-9A-Z]+/gi,''),_0x52bd9f=_spPageContextInfo[_0x46b83c(0x18d)]+_0x46b83c(0x1cb);for(var _0x23040d=0x0;_0x23040d<arrMeta[_0x46b83c(0x1d2)];_0x23040d++){var _0x1b6966,_0x268fb0='';GetAllFieldsFromList(_0x52bd9f,_0x5a6419,arrMeta[_0x23040d][_0x46b83c(0x233)]),_0x268fb0=_0x52bd9f+_0x46b83c(0x1e7)+_0x5a6419+_0x46b83c(0x289),arrMeta[_0x23040d][_0x46b83c(0x1f0)]==0x6?arrMeta[_0x23040d][_0x46b83c(0x233)]==_0x46b83c(0x16c)?_0x1b6966={'__metadata':{'type':_0x46b83c(0x1f9),'addToDefaultView':'true'},'FieldTypeKind':arrMeta[_0x23040d][_0x46b83c(0x1f0)],'Title':arrMeta[_0x23040d]['Title'],'Choices':{'results':[_0x46b83c(0x188),_0x46b83c(0x253),'N/A']}}:_0x1b6966={'__metadata':{'type':_0x46b83c(0x1f9),'addToDefaultView':_0x46b83c(0x142)},'FieldTypeKind':arrMeta[_0x23040d][_0x46b83c(0x1f0)],'Title':arrMeta[_0x23040d][_0x46b83c(0x233)],'Choices':{'results':[_0x46b83c(0x2d0),_0x46b83c(0x1c4),_0x46b83c(0x1b3),_0x46b83c(0x1db)]}}:arrMeta[_0x23040d][_0x46b83c(0x1f0)]!=0x7&&(_0x1b6966={'__metadata':{'type':_0x46b83c(0x2a2),'addToDefaultView':_0x46b83c(0x142)},'FieldTypeKind':arrMeta[_0x23040d]['FieldTypeKind'],'Title':arrMeta[_0x23040d]['Title']}),arrMeta[_0x23040d][_0x46b83c(0x233)]==_0x46b83c(0x13e)&&(_0x268fb0=_0x52bd9f+'/_api/web/lists/getByTitle(\x27'+_0x5a6419+_0x46b83c(0x289),_0x1b6966={'__metadata':{'type':_0x46b83c(0x241),'addToDefaultView':_0x46b83c(0x142)},'FieldTypeKind':arrMeta[_0x23040d][_0x46b83c(0x1f0)],'Title':arrMeta[_0x23040d][_0x46b83c(0x233)],'AllowMultipleValues':!![]}),arrMeta[_0x23040d][_0x46b83c(0x233)]==_0x46b83c(0x1d5)&&(_0x268fb0=_0x52bd9f+_0x46b83c(0x1e7)+_0x5a6419+_0x46b83c(0x289),_0x1b6966={'__metadata':{'type':_0x46b83c(0x241),'addToDefaultView':_0x46b83c(0x142)},'FieldTypeKind':arrMeta[_0x23040d][_0x46b83c(0x1f0)],'Title':arrMeta[_0x23040d]['Title']}),arrMeta[_0x23040d][_0x46b83c(0x233)]==_0x46b83c(0x288)&&(_0x268fb0=_0x52bd9f+_0x46b83c(0x1e7)+_0x5a6419+_0x46b83c(0x289),_0x1b6966={'__metadata':{'type':_0x46b83c(0x135)},'FieldTypeKind':arrMeta[_0x23040d][_0x46b83c(0x1f0)],'Title':arrMeta[_0x23040d][_0x46b83c(0x233)],'DisplayFormat':0x0}),arrMeta[_0x23040d][_0x46b83c(0x233)]==_0x46b83c(0x170)&&(_0x268fb0=_0x52bd9f+_0x46b83c(0x1e7)+_0x5a6419+_0x46b83c(0x289),_0x1b6966={'__metadata':{'type':'SP.FieldDateTime'},'FieldTypeKind':arrMeta[_0x23040d][_0x46b83c(0x1f0)],'Title':arrMeta[_0x23040d][_0x46b83c(0x233)],'DisplayFormat':0x0}),arrMeta[_0x23040d][_0x46b83c(0x233)]=='FileValidity'&&(_0x268fb0=_0x52bd9f+'/_api/web/lists/getByTitle(\x27'+_0x5a6419+_0x46b83c(0x289),_0x1b6966={'__metadata':{'type':_0x46b83c(0x135)},'FieldTypeKind':arrMeta[_0x23040d][_0x46b83c(0x1f0)],'Title':arrMeta[_0x23040d][_0x46b83c(0x233)],'DisplayFormat':0x0}),arrMeta[_0x23040d]['Title']=='ApprovedBy'&&(_0x268fb0=_0x52bd9f+_0x46b83c(0x1e7)+_0x5a6419+_0x46b83c(0x289),_0x1b6966={'__metadata':{'type':_0x46b83c(0x241),'addToDefaultView':_0x46b83c(0x142)},'FieldTypeKind':arrMeta[_0x23040d][_0x46b83c(0x1f0)],'Title':arrMeta[_0x23040d]['Title'],'SelectionMode':0x0}),$[_0x46b83c(0x299)]({'url':_0x268fb0,'type':_0x46b83c(0x137),'async':![],'data':JSON[_0x46b83c(0x202)](_0x1b6966),'headers':{'Accept':_0x46b83c(0x176),'Content-Type':_0x46b83c(0x176),'X-RequestDigest':$(_0x46b83c(0x234))['val']()},'success':function(_0xe05877,_0x44d0d2,_0x290a7e){var _0xc4cef3=_0x46b83c;console[_0xc4cef3(0x2d2)](_0xc4cef3(0x149));},'error':function(_0x333747,_0x5817d0,_0x5662ba){var _0xd1e20=_0x46b83c;console[_0xd1e20(0x2d2)](_0xd1e20(0x1cc));}});}}function GetAllFieldsFromList(_0xeef1ea,_0x2bc4c6,_0x737b38){var _0x152c3f=a0_0x4d15ba;arrColumn='',$['ajax']({'url':_0xeef1ea+_0x152c3f(0x1e7)+_0x2bc4c6+_0x152c3f(0x2d6)+_0x737b38+'\x27','method':_0x152c3f(0x2c8),'async':![],'headers':{'Accept':'application/json;odata=verbose'},'success':function(_0x13b165,_0x113746,_0x2f7dfd){var _0x1ce866=_0x152c3f,_0x37a134=_0x13b165['d'][_0x1ce866(0x1f3)];if(_0x37a134[_0x1ce866(0x1d2)]>0x0)for(var _0x3fb757=0x0;_0x3fb757<_0x37a134[_0x1ce866(0x1d2)];_0x3fb757++){ColumnTitle=_0x37a134[_0x3fb757][_0x1ce866(0x233)],DeleteListColumn(_0xeef1ea,ColumnTitle,_0x2bc4c6);}},'error':function(_0x2e7b96,_0x320815,_0x29a6bd){alert(_0x2e7b96);}});}function DeleteListColumn(_0x46a5b0,_0x5e763b,_0x11828d){var _0x329cc2=a0_0x4d15ba;$[_0x329cc2(0x299)]({'url':_0x46a5b0+_0x329cc2(0x1e7)+_0x11828d+_0x329cc2(0x1ec)+_0x5e763b+'\x27)','type':'POST','async':![],'headers':{'Accept':_0x329cc2(0x176),'Content-Type':_0x329cc2(0x176),'IF-MATCH':'*','X-HTTP-Method':_0x329cc2(0x260),'X-RequestDigest':$('#__REQUESTDIGEST')['val']()},'success':function(_0x1876f2,_0x31a646,_0x16057e){var _0xd1309f=_0x329cc2;console[_0xd1309f(0x2d2)](_0xd1309f(0x2c1)+_0x5e763b);},'error':function(_0x3df980,_0xbad5f6,_0x117881){console['log']('Failed');}});}var arrMeta=[{'FieldTypeKind':0x2,'Title':'DocumentNo'},{'FieldTypeKind':0x2,'Title':a0_0x4d15ba(0x201)},{'FieldTypeKind':0x2,'Title':'DocumentWrittenBy'},{'FieldTypeKind':0x3,'Title':'Details'},{'FieldTypeKind':0x3,'Title':'Titan_Permission'},{'FieldTypeKind':0x14,'Title':a0_0x4d15ba(0x13e)},{'FieldTypeKind':0x2,'Title':a0_0x4d15ba(0x175)},{'FieldTypeKind':0x9,'Title':a0_0x4d15ba(0x189)},{'FieldTypeKind':0x14,'Title':'Shared\x20With'},{'FieldTypeKind':0x2,'Title':a0_0x4d15ba(0x230)},{'FieldTypeKind':0x2,'Title':'SecurityLevel'},{'FieldTypeKind':0x2,'Title':a0_0x4d15ba(0x143)},{'FieldTypeKind':0x2,'Title':a0_0x4d15ba(0x180)},{'FieldTypeKind':0x6,'Title':a0_0x4d15ba(0x16c)},{'FieldTypeKind':0x2,'Title':a0_0x4d15ba(0x174)},{'FieldTypeKind':0x14,'Title':a0_0x4d15ba(0x19b)},{'FieldTypeKind':0x4,'Title':a0_0x4d15ba(0x288)},{'FieldTypeKind':0x4,'Title':'FileValidity'},{'FieldTypeKind':0x4,'Title':a0_0x4d15ba(0x170)},{'FieldTypeKind':0x2,'Title':a0_0x4d15ba(0x239)},{'FieldTypeKind':0x2,'Title':a0_0x4d15ba(0x2bd)}];function GetAvailbleLicence(){var _0x1ce220=a0_0x4d15ba,_0x2a39c1='',_0x53c407=_0x1ce220(0x247);dfds=$['Deferred'](),extdfds=$[_0x1ce220(0x1a7)]();var _0x19abf1='',_0x1ec1ef,_0x204225;return url=_spPageContextInfo[_0x1ce220(0x18d)]+'/_api/web/lists/getbytitle(\x27Employees\x27)/items/'+_0x53c407,$[_0x1ce220(0x186)](getItems(url,dfds))['done'](function(_0x184ac4){var _0x3ec7f9=_0x1ce220;response=[],_0x1ec1ef=_0x184ac4[_0x3ec7f9(0x1d2)];var _0x356ce8=_spPageContextInfo[_0x3ec7f9(0x18d)]+'/_api/web/lists/getbytitle(\x27ExternalUsers\x27)/items?$select=*,InternalStakeholders/Title,Supervisor_Guest/Title,Client_Name/Title,LoginName/Title\x20&$expand=\x20LoginName,Client_Name,Supervisor_Guest,InternalStakeholders\x20&$filter=(ValidUpto\x20ge\x20\x27'+new Date()['toISOString']()+'\x27)\x20and\x20(Status\x20eq\x20\x27Active\x27)';$[_0x3ec7f9(0x186)](getItems(_0x356ce8,extdfds))[_0x3ec7f9(0x11d)](function(_0x133708){var _0x2e3c25=_0x3ec7f9;response=[],_0x204225=_0x133708[_0x2e3c25(0x1d2)];}),_0x19abf1=parseInt(_0x1ec1ef)+parseInt(_0x204225),_0x2a39c1=parseInt(UsersLicenceRequired)-parseInt(_0x19abf1);}),_0x2a39c1;}var response=response||[];function getItems(_0x415c41,_0x2f1a14){var _0x3ccd4a=a0_0x4d15ba;return $[_0x3ccd4a(0x299)]({'url':_0x415c41,'type':_0x3ccd4a(0x2c8),'async':![],'headers':{'accept':_0x3ccd4a(0x176)},'success':function(_0x45a5f9){var _0x555aa0=_0x3ccd4a;response=response['concat'](_0x45a5f9['d'][_0x555aa0(0x1f3)]),_0x45a5f9['d'][_0x555aa0(0x1c0)]?(_0x415c41=_0x45a5f9['d'][_0x555aa0(0x1c0)],getItems(_0x415c41,_0x2f1a14)):_0x2f1a14[_0x555aa0(0x25c)](response);},'error':function(_0x41e2eb){var _0x566975=_0x3ccd4a;_0x2f1a14['reject'](_0x41e2eb),console[_0x566975(0x2d2)](_0x41e2eb);}}),_0x2f1a14[_0x3ccd4a(0x2ac)]();}