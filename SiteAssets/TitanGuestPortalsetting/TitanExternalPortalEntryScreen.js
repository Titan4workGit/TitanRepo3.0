var a0_0x5ba68b=a0_0x3204;(function(_0x561290,_0x679bf0){var _0x433b51=a0_0x3204,_0x184a87=_0x561290();while(!![]){try{var _0x164d03=-parseInt(_0x433b51(0x22b))/0x1+-parseInt(_0x433b51(0x287))/0x2+-parseInt(_0x433b51(0x210))/0x3*(-parseInt(_0x433b51(0x19b))/0x4)+-parseInt(_0x433b51(0x175))/0x5*(-parseInt(_0x433b51(0x1b1))/0x6)+parseInt(_0x433b51(0x2ae))/0x7+-parseInt(_0x433b51(0x181))/0x8+parseInt(_0x433b51(0x146))/0x9;if(_0x164d03===_0x679bf0)break;else _0x184a87['push'](_0x184a87['shift']());}catch(_0x23c8d2){_0x184a87['push'](_0x184a87['shift']());}}}(a0_0x3164,0x7295e));var IsFirstTime=!![],token='',AvilableLicense='';$(document)[a0_0x5ba68b(0x11d)](function(){var _0x557648=a0_0x5ba68b;$(_0x557648(0x21b))['tooltip'](),AvilableLicense=GetAvailbleLicence(),$(_0x557648(0x21d))[_0x557648(0x162)](AvilableLicense),IsAdmin(),LoadProject(),getTemplate();});function IsAdmin(){var _0x254b1b=a0_0x5ba68b;$[_0x254b1b(0x240)](CommonFunction[_0x254b1b(0x11c)]())[_0x254b1b(0x20e)](function(_0x35579a){var _0xdff1f4=_0x254b1b;if(_0x35579a)IsTechadmin=![];else return $('.row')['html'](''),htmlNotAuthorized+=_0xdff1f4(0x19f),htmlNotAuthorized+=_0xdff1f4(0x1ac),htmlNotAuthorized+='<span><h3\x20class=\x22red-color\x20text-center\x20mt-25\x22>Please\x20contact\x20your\x20administrator!\x20</h3></span><br>',htmlNotAuthorized+=_0xdff1f4(0x29f),$(_0xdff1f4(0x132))['append'](htmlNotAuthorized),![];});}function initializePeoplePicker(_0x5753fb,_0x4ebfff){var _0x4dea2d=a0_0x5ba68b,_0xe4becb={};_0xe4becb[_0x4dea2d(0x1e1)]=_0x4dea2d(0x1ab),_0xe4becb[_0x4dea2d(0x1d5)]=0xf,_0xe4becb['ResolvePrincipalSource']=0xf,_0xe4becb[_0x4dea2d(0x238)]=_0x4ebfff,_0xe4becb[_0x4dea2d(0x1bc)]=0x32,_0xe4becb['Width']=_0x4dea2d(0x1cf),this['SPClientPeoplePicker_InitStandaloneControlWrapper'](_0x5753fb,null,_0xe4becb),$('.sp-peoplepicker-editorInput')[_0x4dea2d(0x1c6)](0x12c);}function a0_0x3204(_0x3a2a0a,_0x3ea7c7){var _0x3164ad=a0_0x3164();return a0_0x3204=function(_0x320489,_0x5d618e){_0x320489=_0x320489-0xf6;var _0x2ab302=_0x3164ad[_0x320489];return _0x2ab302;},a0_0x3204(_0x3a2a0a,_0x3ea7c7);}function setPeoplePickerUsersInfoCurrent(_0x147154,_0x3e802c){var _0x5cae34=a0_0x5ba68b,_0x3bea22=$('[id$=\x27'+_0x147154+'\x27]'),_0x30a48d=SPClientPeoplePicker[_0x5cae34(0x126)][_0x3bea22[0x0]['id']];_0x30a48d[_0x5cae34(0x152)](_0x3e802c,![]),_0x30a48d[_0x5cae34(0x29b)](![]);}var peoplePickerDiv='',peoplePickerDivsuper='',email='',htmlGridarray=[],IsSetvalue=![],GroupId='',GuestUserEmail='',ExtrnaluserId='',chkInitiated='',chkInvited='',chkActive='',chkInactive='',Isfillter=![],userListItemId='',GuestUserEmail='',UserListId=[],Client_Id;$(function(){var _0x357928=a0_0x5ba68b;$(_0x357928(0x296))[_0x357928(0x107)]({'changeMonth':!![],'changeYear':!![],'minDate':0x0});}),$(function(){var _0x2972b0=a0_0x5ba68b;$(_0x2972b0(0x19d))['datepicker']({'changeMonth':!![],'changeYear':!![],'minDate':0x0});});var Initiated='',Invited='',Active='',Inactive='',Accepted='',NotAccepted='';$('#Initiated')['on'](a0_0x5ba68b(0x113),function(){var _0x5a268c=a0_0x5ba68b;this[_0x5a268c(0x163)]?Initiated=_0x5a268c(0x1c0):Initiated='';}),$(a0_0x5ba68b(0x144))['on'](a0_0x5ba68b(0x113),function(){var _0x4fa6ee=a0_0x5ba68b;this[_0x4fa6ee(0x163)]?Invited=_0x4fa6ee(0x1f9):Invited='';}),$('#Accepted')['on'](a0_0x5ba68b(0x113),function(){var _0x49a16a=a0_0x5ba68b;this[_0x49a16a(0x163)]?Accepted=_0x49a16a(0x117):Accepted='';}),$(a0_0x5ba68b(0x246))['on'](a0_0x5ba68b(0x113),function(){this['checked']?Active='(Status\x20eq\x20\x27Active\x27)':Active='';}),$(a0_0x5ba68b(0x1a1))['on'](a0_0x5ba68b(0x113),function(){var _0xa7e046=a0_0x5ba68b;this['checked']?Inactive=_0xa7e046(0x161):Inactive='';}),$('#NotAccepted')['on'](a0_0x5ba68b(0x113),function(){var _0x1682ce=a0_0x5ba68b;this['checked']?NotAccepted=_0x1682ce(0x1f9):NotAccepted='';}),$(a0_0x5ba68b(0x18b))[a0_0x5ba68b(0x113)](function(){readURL(this);}),$(a0_0x5ba68b(0x17e))[a0_0x5ba68b(0x1e2)](function(){AvilableLicense>0x0?UpdateGeustuser(ExtrnaluserId):alert('Your\x20license\x20limit\x20has\x20overed.');}),$(a0_0x5ba68b(0xf6))[a0_0x5ba68b(0x1ec)](function(){var _0x456005=a0_0x5ba68b;$[_0x456005(0x240)](GetGueastUsers($('#txtExtEmail')[_0x456005(0x1e3)]()))['done'](function(_0x1f77b1){var _0x4b99d1=_0x456005;_0x1f77b1['length']>0x0&&(creationType=_0x1f77b1[0x0][_0x4b99d1(0x2aa)],externalUserState=_0x1f77b1[0x0][_0x4b99d1(0x13e)]);});if(externalUserState==_0x456005(0x1fd))Pertimtblock($(_0x456005(0xf6))[_0x456005(0x1e3)]());else{for(var _0x5cbc54 in htmlGridarray){if(htmlGridarray[_0x5cbc54][_0x456005(0x1a6)]==$('#txtExtEmail')[_0x456005(0x1e3)]()){htmlGridarray[_0x5cbc54][_0x456005(0x13e)]=_0x456005(0x25f);break;}}GenerateGridHtml(htmlGridarray),$(_0x456005(0x1c1))['modal'](_0x456005(0x292)),$(_0x456005(0x195))['text']('');var _0x354897='The\x20user\x20does\x20not\x20accept\x20the\x20invitation\x20yet.';$(_0x456005(0x195))[_0x456005(0x162)](_0x354897),$(_0x456005(0x249))['show'](),$(_0x456005(0x1aa))['hide'](),$(_0x456005(0x159))[_0x456005(0x1b9)]('show'),$(_0x456005(0x191))['show']();}});var IscheckInvite=!![];$(a0_0x5ba68b(0x17f))[a0_0x5ba68b(0x1ec)](function(){var _0x337a36=a0_0x5ba68b;$[_0x337a36(0x240)](GetItemToList($(_0x337a36(0x17f))[_0x337a36(0x1e3)]()))[_0x337a36(0x20e)](function(_0x1bb35a){var _0x113af8=_0x337a36;_0x1bb35a[_0x113af8(0x1df)]>0x0?(SetTextBox(_0x1bb35a[0x0]['Id'],'Invite'),$('#txtinviteemail')[_0x113af8(0x11e)](_0x113af8(0x22e))):(IscheckInvite=![],Getinvitebox(),IscheckInvite=!![]);});}),$('#btnSendReminder')[a0_0x5ba68b(0x1e2)](function(){InviteuserSendReminder();}),$(a0_0x5ba68b(0x2a3))[a0_0x5ba68b(0x1e2)](function(){var _0x3bea26=a0_0x5ba68b;GetClientMasterfilter();var _0x59f34c=$('<option>');_0x59f34c['attr'](_0x3bea26(0x122),'All')[_0x3bea26(0x162)]('All'),$('#orgselectpicker')['append'](_0x59f34c);for(var _0x27546d=0x0;_0x27546d<ClientInternalMembers['length'];_0x27546d++){_0x59f34c=$(_0x3bea26(0x267)),_0x59f34c[_0x3bea26(0x127)](_0x3bea26(0x122),ClientInternalMembers[_0x27546d][_0x3bea26(0x21c)])[_0x3bea26(0x162)](ClientInternalMembers[_0x27546d][_0x3bea26(0x21c)]),$(_0x3bea26(0x130))['append'](_0x59f34c);}create_custom_dropdowns();});function create_custom_dropdowns(){var _0x105812=a0_0x5ba68b;$(_0x105812(0x130))[_0x105812(0x1e5)](function(_0x1ab10c,_0x319f86){var _0x42704a=_0x105812;if(!$(this)['next']()['hasClass'](_0x42704a(0x21f))){$(this)['after'](_0x42704a(0x258)+($(this)['attr'](_0x42704a(0x2a5))||'')+_0x42704a(0x184));var _0x17b972=$(this)[_0x42704a(0x297)](),_0x57eb41=$(_0x319f86)[_0x42704a(0x111)]('option'),_0x41a8d4=$(this)[_0x42704a(0x111)]('option:selected');_0x17b972['find']('.current')[_0x42704a(0x251)](_0x41a8d4[_0x42704a(0x27b)](_0x42704a(0x26d))||_0x41a8d4['text']()),_0x57eb41[_0x42704a(0x1e5)](function(_0x3672d7,_0x183582){var _0x2943bb=_0x42704a,_0x42b77c=$(_0x183582)[_0x2943bb(0x27b)]('display-text')||'';_0x17b972[_0x2943bb(0x111)]('ul')[_0x2943bb(0x26b)](_0x2943bb(0x186)+($(_0x183582)['is'](_0x2943bb(0x221))?'selected':'')+_0x2943bb(0x1f8)+$(_0x183582)['val']()+'\x22\x20data-display-text=\x22'+_0x42b77c+'\x22>'+$(_0x183582)[_0x2943bb(0x162)]()+'</li>');});}});var _0x4dcba6=$('.list')[_0x105812(0x111)](_0x105812(0x101));_0x4dcba6['length']==0x0&&$('.dropdown-select\x20ul')[_0x105812(0xf8)]('<div\x20class=\x22dd-search\x22><input\x20id=\x22txtSearchValue\x22\x20autocomplete=\x22off\x22\x20\x20onkeyup=\x22filters()\x22\x20class=\x22dd-searchbox\x22\x20placeholder=\x22Search\x20client\x20name\x22\x20type=\x22text\x22></div>');}function a0_0x3164(){var _0x26d8d8=['[data-toggle=\x22tooltip\x22]','Title','#hAvilableLicenses','trigger','dropdown-select','FileValidity',':selected','(Status\x20eq\x20\x27Active\x27)\x20or\x20','Permit','/_api/web/lists/getbytitle(\x27','<th></th>','#extrenalImage','\x27)/items(','#selectByUser','display','InternalStakeholders','808592wOnJvL','Shared\x20With','InternalMembers','disabled','</h3>','<th\x20class=\x22text-left\x20w-10\x22><b>Type</b></th>','getElementById','option:selected','#btnInviteuser','InternalStakeholders_TopSpan',',\x27Invite\x27)\x22\x20data-target=\x22#Invite-Guest-User\x22\x20title=\x22Invite\x22>','true','#invitesrchbtn','AllowMultipleValues','Choices','__next','promise','Rlfrtip','Please\x20enter\x20Invite\x20Name\x20','option','#hActive','when','application/json;\x20odata=verbose','\x20<th\x20class=\x22text-left\x20border-bottom-0\x22><b>Status</b></th>','not','#TableGrid','FieldTypeKind','#Active','DocumentType','replace','.uncheck-icon',')\x22\x20data-original-title=\x22Check\x22>','appendTo','DataTable','.dropdown-select','tabindex','\x27)/fields?&$select=*&$filter=EntityPropertyName\x20eq\x20\x27TemplateType\x27','Required','html','Pending','https://graph.microsoft.com/v1.0/invitations','\x20</ul>','\x27)\x22\x20data-placement=\x22top\x22\x20title=\x22Delete\x22>','addClass','</tr>','<div\x20class=\x22dropdown-select\x20wide\x20','[id$=\x27InternalStakeholders_TopSpan\x27]','\x27)/items?$select=*,AttachmentFiles,Supervisor/Title,Supervisor/EMail,InternalStakeholders/Title,InternalStakeholders/EMail,LoginName/Title,Client_Name/Title,Client_Name/Id,Supervisor_Guest/Title\x20&$expand=Supervisor,InternalStakeholders,AttachmentFiles,LoginName,Client_Name,Supervisor_Guest\x20&$filter=\x20email\x20eq\x20\x27','#pDescription','/GuestUserDocuments/_api/web/lists/?$filter=Title\x20eq\x20\x27','EntityData','Description','PendingAcceptance','<th\x20class=\x22text-left\x20border-bottom-0\x22\x20\x20><b>Action\x20Date</b></th>','<td>Invitation\x20Accepted</td>','isDataTable','d\x20M,\x20yy','ValidUpto','<li\x20role=\x22presentation\x22\x20class=\x22pills-box-info\x20\x22><a\x20href=\x22#\x22>Accepted</a></li>','#txtExtDesignation','<option>','<td>Request\x20to\x20Invite</td>','AttachmentFiles','css','append','false','display-text','#TemplateType\x20option:selected','contentEditable','#TemplateType\x20>\x20[value=','getMonth','selectByUser','\x20<th\x20class=\x22text-left\x20border-bottom-0\x22\x20><b>Email</b></th>','Active','internalsupervisor_TopSpan','message','hasClass','getFullYear','destroy','log','data','stringify','</span>','reject','<div\x20class=\x22guesr-user-edit-lock-btn-box\x22>','<th\x20class=\x22text-left\x20w-10\x22><b>Attn\x20Name</b></th>','TemplateMaster','\x27)/roleassignments/addroleassignment(principalid=\x27','open','Designation','Email\x20id\x20is\x20not\x20valid.\x20','application/json;odata=verbose','393396YrbAdl','siteAbsoluteUrl','getItem','<li\x20role=\x22presentation\x22\x20class=\x22pills-box-info\x20Invited\x22><a\x20href=\x22#\x22>Invited</a></li>','d\x20M,\x20yy\x20','#CustomName','Unauthorized',')/AttachmentFiles/add(FileName=\x27','.list','CategoryMaster','[id$=\x27internalsupervisor_TopSpan\x27]','hide','name','https://cdn.jsdelivr.net/gh/Titan4workGit/TitanRepo3.0@latest/SiteAssets/AdminPortal/ManageEmployee/assets/images/user_pic.jpg','appendChild','#invitetxtValidityUpto','next','AccessLevel','Invitation\x20mail\x20sending\x20failed.\x0aPlease\x20try\x20again\x20later.\x0aAlso\x20please\x20check\x20the\x20External\x20Sharing\x20setup\x20of\x20this\x20site.','error','SetEnabledState','Success\x20Delete','<label><input\x20type=\x22checkbox\x22\x20id=\x22Check_','formatDate','</div></div></div></div>','\x20<li\x20role=\x22presentation\x22\x20class=\x22pills-box-info\x20Active\x20\x22><a\x20href=\x22#\x22>Active</a></li>','InternalSupervisor','Failed','#GetMasterclientfilter','/_api/web/lists/getByTitle(\x27','class','focus','<li\x20role=\x22presentation\x22\x20class=\x22pills-box-info\x20Accepted\x22><a\x20href=\x22#\x22>Accepted</a></li>','.list\x20.option.selected','CustomName','creationType','Wait\x20Plaease','#txtExtOrganizationName','Client_Name','1708749xSsIvz','</td>','#txtExtEmail','SP.User','before','Titan_Permission','email_date','#txtExtStatus','#invitetxtReferenceCode','Email','#invitetxtOrganizationName','DocumentLibrary','Client_Code','#txtSearchValue','Association','<tr\x20class=\x22text-left\x22>','/_api/lists/GetByTitle(\x27','#txtinvitename','Status','datepicker','.list\x20.option:focus','/GuestUserDocuments/','<a\x20type=\x22button\x22\x20href=\x22#\x22\x20class=\x22custom-edit-btn\x22\x20data-toggle=\x22modal\x22\x20onclick=\x22SetTextBox(','innerHTML','<a\x20type=\x22button\x22\x20type=\x22button\x22\x20class=\x22custom-edit-btn\x22\x20data-toggle=\x22tooltip\x22\x20onclick=\x22DeleteHtmlRow(','Base64EncodedByteArray','\x27)/items?$select=*,InternalStakeholders/Title,Supervisor_Guest/Title,Client_Name/Title,LoginName/Title\x20&$expand=\x20LoginName,Client_Name,Supervisor_Guest,InternalStakeholders\x20&$filter=((Status\x20eq\x20\x27Initiated\x27)\x20or\x20(Status\x20eq\x20\x27Invited\x27\x20)or\x20(Status\x20eq\x20\x27Pending\x27)or\x20(Status\x20eq\x20\x27Accepted\x27))','SP.Data.','.dropdown-select\x20ul\x20>\x20li','find','EMail','change','?$select=*,Id,Supervisor/Title,Supervisor/EMail,Supervisor/Id,\x20InternalMembers/EMail,InternalMembers/Title,InternalSupervisor/EMail,InternalSupervisor/Title\x20&$expand=Supervisor,InternalMembers,InternalSupervisor\x20&$filter=\x20Title\x20eq\x20\x27','<span>','logintoken','(Status\x20eq\x20\x27Accepted\x27)','ajax','#selectByUser\x20>\x20[value=','<td>Inactive</td>','#templateImg','AdministratorUsers','ready','removeAttr','Invitation\x20mail\x20has\x20been\x20sent\x20Reminder\x20to\x20the\x20user.','<li\x20role=\x22presentation\x22\x20class=\x22pills-box-info\x20Initiated\x22><a\x20href=\x22#\x22>Initiated</a></li>','#masterClientgrid','value','Search','</ul>','/GuestUserDocuments/_api/Web/Lists/','SPClientPeoplePickerDict','attr','<td\x20class=\x22text-left\x22>','application/json','POST','/SitePages/Thankyou.aspx','</div>','SP.FieldChoice','dataTable','Acknowledgement','#orgselectpicker','ExternalUsers','.row','Bearer\x20','getItemsWithQueryItem','responseText','<div\x20class=\x22form-wizard\x20centered-pills\x22\x20>','PermissionLevel','<thead>','Please\x20enter\x20validity\x20date.','<a\x20type=\x22button\x22\x20type=\x22button\x22\x20class=\x22custom-edit-btn\x22\x20\x20\x20data-toggle=\x22modal\x22\x20onclick=\x22SetTextBox(','Idea\x20has\x20been\x20submitted\x20but\x20some\x20files\x20failed\x20to\x20upload.','/_api/web/lists/getbytitle(\x27Employees\x27)/items/','<h3\x20class=\x27m-0\x27>','externalUserState','getDate','ClientName','animating','<li\x20role=\x22presentation\x22\x20class=\x22pills-box-info\x20not-Accepted\x22><a\x20href=\x22#\x22>Not\x20Accepted</a></li>','User\x20Added','#Invited','removeItem','2282328wFwhZZ','<td>','webAbsoluteUrl','join','charAt','Supervisor','acquireToken','(Client_Name/Title\x20eq\x20\x27','/GuestUserDocuments','https://graph.microsoft.com','none','<a\x20type=\x22button\x22\x20type=\x22button\x22\x20class=\x22custom-edit-btn\x22\x20\x20data-toggle=\x22modal\x22\x20onclick=\x22SetTextBox(','AddUserKeys','?$select=*,Id,Supervisor/Title,Supervisor/EMail,Supervisor/Id\x20,InternalMembers/EMail,InternalMembers/Id,InternalMembers/Title,InternalSupervisor/EMail,InternalSupervisor/Id,InternalSupervisor/Title\x20&$expand=Supervisor,InternalMembers,InternalSupervisor\x20','\x20<th\x20class=\x22text-left\x20border-bottom-0\x22><b>User\x20Name</b></th>','#invitetxtDesignation','/Forms/AllItems.aspx','statusText','application/json;odata=nometadata','#check-status','CommentCount','\x22\x20class=\x22getclientmaster\x22\x20onclick=\x22selectOnlyThis(this.id)\x22\x20\x20value=\x22','/_api/web/lists/getByTitle(\x27ExternalUsers\x27)/items(','responseJSON','User\x20has\x20accept\x20the\x20invitation.\x0a\x20Please\x20proceed\x20for\x20activated\x20this\x20user.','<div\x20\x20>','CollaborationType','(Status\x20eq\x20\x27Inactive\x27)','text','checked','<a\x20type=\x22button\x22\x20href=\x22#\x22\x20class=\x22custom-edit-btn\x22\x20data-toggle=\x22tooltip\x22\x20data-placement=\x22top\x22\x20title=\x22\x22\x20onclick=\x22CheckInvitedAction(','This\x20user:-','\x27)\x22\x20data-target=\x22#Permitting-into-Portal\x22\x20title=\x22Edit\x22>','.sp-peoplepicker-delImage','#ddlAssociation','<div\x20class=\x22spinner','Invitation\x20mail\x20has\x20been\x20sent\x20to\x20the\x20user.','#hInvited','i:0#.f|membership|','https://cdn.jsdelivr.net/gh/Titan4workGit/TitanRepo3.0@latest/SiteAssets/Titan-External-Employee-Portal/images/user_pic.jpg','\x27)/items?$select=*,InternalStakeholders/Title,Supervisor_Guest/Title,Client_Name/Title,LoginName/Title\x20&$expand=\x20LoginName,Client_Name,Supervisor_Guest,InternalStakeholders\x20&$filter=(','show','\x27)/fields/getbytitle(\x27','/_api/web/Lists/getbytitle(\x27TemplateMaster\x27)/Items?$filter=Active\x20eq\x20\x271\x27','dd-searchbox','Process\x20Failed.\x20Invitation\x20mail\x20failed\x20to\x20send.\x0a\x20Enter\x20valid\x20email\x20address\x20or\x20check\x20the\x20external\x20sharing\x20features\x20is\x20enabled.','/_api/web/sitegroups/GetById(','45bvWtql','filter','Modified','#InternalStakeholders','setItem','prop','User:\x20\x20',':\x20\x20Compact\x20Token\x20parsing\x20failed','\x27)/breakroleinheritance(false)','#btnPermitting','#txtinviteemail','#txtinvitemessage','332752aIXgRz','target','internalsupervisor','\x22\x20tabindex=\x220\x22><span\x20class=\x22current\x22></span><div\x20class=\x22list\x22><ul></ul></div></div>','(Status\x20eq\x20\x27Inactive\x27)\x20or\x20','<li\x20class=\x22option\x20','GetAllUserInfo','empty','invitedUserEmailAddress','PermissionLevelId','#GueastextinputFile','concat','indexOf','GET','\x27)\x20and\x20(Status\x20eq\x20\x27Active\x27)','get','#btnSendReminder','<div\x20>','remove','toISOString','.check-status-user-detail','\x20<tr>','SecurityLevel','</a>','DELETE','ApprovedBy','44052SXmpMB','(Status\x20eq\x20\x27Invited\x27)\x20or\x20','#datepickerAD5','<th\x20class=\x22w-25\x22><b>Ref\x20Code</b></th>','<span><h3\x20class=\x22red-color\x20text-center\x20mt-25\x22>You\x20are\x20not\x20authorized\x20to\x20access\x20!\x20</h3></span>','Shared','#Inactive','IsActive','#txtExtLoginName','\x20</tbody>','<td>Active</td>','email','\x20and\x20(Client_Name/Title\x20eq\x20\x27','Invite','toggleClass','.check-icon','User,DL,SecGroup,SPGroup','<span><h3\x20class=\x22red-color\x20text-center\x20mt-25\x22>Only\x20Tech-Admin\x20with\x20site-collection\x20admin\x20permission\x20can\x20access\x20this\x20page.\x20</h3></span><br>','#hInactive','DocumentWrittenBy','Deferred','<ul\x20class=\x22nav\x20nav-pills\x22>','341286vgIUYL','\x27)/fields?$filter=Title\x20eq\x20\x27','.spinner','\x20<li\x20role=\x22presentation\x22\x20class=\x22pills-box-info\x20\x22><a\x20href=\x22#\x22>Active</a></li>','onload','\x20spinner-absolute','SP.List','/_api/web/siteusers(@v)?@v=\x27','modal','#TempalteName','Update\x20successfully!','MaximumEntitySuggestions','\x27)/items?$select=*,InternalStakeholders/Title,Supervisor_Guest/Title,Client_Name/Title,LoginName/Title\x20&$expand=\x20LoginName,Client_Name,Supervisor_Guest,InternalStakeholders\x20&$filter=((Status\x20eq\x20\x27Initiated\x27)\x20or\x20(Status\x20eq\x20\x27Invited\x27\x20)or\x20(Status\x20eq\x20\x27Pending\x27)or\x20(Status\x20eq\x20\x27Accepted\x27)or\x20(Status\x20eq\x20\x27Inactive\x27)\x20or\x20(Status\x20eq\x20\x27Active\x27))','Approval','\x27&$expand=AttachmentFiles','(Status\x20eq\x20\x27Initiated\x27)','#Permitting-into-Portal','#hInitiated','SP.FieldDateTime','#hAccepted','\x20\x20\x20\x20\x20\x20\x20\x20Token\x20','width','closest','\x20\x20<tr\x20class=\x22text-center\x22>','selected','Organization','<td>Invitation\x20Sent</td>','div[id^=\x27InternalStakeholders\x27]','ApprovedDate','Guest_name','358px','N/A','/_api/web/lists/GetByTitle(\x27','#txtExternalSupervisor','</thead>\x20','resolve','SearchPrincipalSource','/GuestUserDocuments/_api/web/lists/getbytitle(\x27','Invited','prev','children','?$top=5000&$select=PrimaryCompany,Status&$filter=PrimaryCompany\x20eq\x20\x27Primary\x27\x20and\x20Status\x20eq\x20\x27Active\x27\x20','d\x20M,\x20y','results','Inactive','LoginName','length','Your\x20item\x20has\x20not\x20been\x20submitted\x20successfully!','PrincipalAccountType','click','val','Invitation\x20mail\x20sending\x20failed.\x0aPlease\x20try\x20again\x20later.\x0a\x20Also\x20please\x20check\x20the\x20External\x20Sharing\x20setup\x20of\x20this\x20site.','each','src','push','/_api/web/Lists/getbytitle(\x27TemplateMaster\x27)/Items?$select=*,AttachmentFiles&$filter=Title\x20eq\x20\x27','\x27)/items?$filter=CategoryType\x20eq\x20\x27Guest\x20Type\x27\x20and\x20Status\x20eq\x20\x20\x27Yes\x27\x20','.dropdown-select\x20.option','toUpperCase','focusout','<i\x20class=\x22fa\x20fa-question-circle-o\x22></i>','GueastextinputFile','<i\x20class=\x22fa\x20fa-trash-o\x22></i>','CustType','shift','.current','trim','result','files','Key','ApprovedVersion','\x22\x20data-value=\x22','(Status\x20eq\x20\x27Invited\x27)','test','spinner-','#checkUser','Accepted','ReferenceCode','MERGE','SP.FieldUser','ClientMaster','byteLength','Success','#__REQUESTDIGEST','#txtReferenceCodeExt','body','keyCode','TemplateType','split','removeClass','.option','\x27)/fields','#TemplateType','done','#txtAddOrganization','138amPVkA','SupervisorId','Attn_Name','\x20<li\x20role=\x22presentation\x22\x20class=\x22pills-box-info\x20Inactive\x20\x22><a\x20href=\x22#\x22>Inactive</a></li>','CatogeryName','Delete\x20Success\x20','Rejected','\x27)\x22\x20data-target=\x22#Permitting-into-Portal\x22\x20title=\x22Permit\x22>','animationTimeout','Initiated','#Invite-Guest-User'];a0_0x3164=function(){return _0x26d8d8;};return a0_0x3164();}$(document)['on'](a0_0x5ba68b(0x1e2),'.dropdown-select',function(_0x10b7a5){var _0x5bb48f=a0_0x5ba68b;if($(_0x10b7a5['target'])[_0x5bb48f(0x277)](_0x5bb48f(0x172)))return;$(_0x5bb48f(0x24d))[_0x5bb48f(0x243)]($(this))['removeClass'](_0x5bb48f(0x283)),$(this)[_0x5bb48f(0x1a9)]('open'),$(this)[_0x5bb48f(0x277)](_0x5bb48f(0x283))?($(this)[_0x5bb48f(0x111)](_0x5bb48f(0x20b))[_0x5bb48f(0x127)](_0x5bb48f(0x24e),0x0),$(this)['find']('.selected')[_0x5bb48f(0x2a6)]()):($(this)[_0x5bb48f(0x111)](_0x5bb48f(0x20b))[_0x5bb48f(0x11e)](_0x5bb48f(0x24e)),$(this)['focus']());}),$(document)['on'](a0_0x5ba68b(0x1e2),function(_0x51e6db){var _0x1d65c9=a0_0x5ba68b;$(_0x51e6db[_0x1d65c9(0x182)])[_0x1d65c9(0x1c7)](_0x1d65c9(0x24d))['length']===0x0&&($(_0x1d65c9(0x24d))['removeClass']('open'),$('.dropdown-select\x20.option')[_0x1d65c9(0x11e)]('tabindex')),_0x51e6db['stopPropagation']();});function filters(){var _0x559a0e=a0_0x5ba68b;debugger;var _0x1fab71=$('#txtSearchValue')[_0x559a0e(0x1e3)]();$(_0x559a0e(0x110))[_0x559a0e(0x1e5)](function(){var _0x256e2e=_0x559a0e,_0x5f33b1=$(this)[_0x256e2e(0x162)]();_0x5f33b1['toLowerCase']()[_0x256e2e(0x18d)](_0x1fab71['toLowerCase']())>-0x1?$(this)[_0x256e2e(0x16f)]():$(this)['hide']();});};$(document)['on'](a0_0x5ba68b(0x1e2),a0_0x5ba68b(0x1ea),function(_0x1dc045){var _0x1a3aaa=a0_0x5ba68b;$(this)[_0x1a3aaa(0x1c7)](_0x1a3aaa(0x28f))[_0x1a3aaa(0x111)]('#orgselectpicker')[_0x1a3aaa(0x20a)](_0x1a3aaa(0x1c9)),$(this)['addClass']('');var _0x2f7497=$(this)[_0x1a3aaa(0x27b)](_0x1a3aaa(0x26d))||$(this)[_0x1a3aaa(0x162)]();$(this)[_0x1a3aaa(0x1c7)](_0x1a3aaa(0x24d))[_0x1a3aaa(0x111)]('.current')[_0x1a3aaa(0x162)](_0x2f7497),$(this)[_0x1a3aaa(0x1c7)](_0x1a3aaa(0x24d))[_0x1a3aaa(0x1d8)](_0x1a3aaa(0x130))['val']($(this)['data']('value'))[_0x1a3aaa(0x21e)]('change'),$(_0x1a3aaa(0x101))[_0x1a3aaa(0x1e3)](''),filters();}),$(document)['on']('keydown',a0_0x5ba68b(0x24d),function(_0x1aba90){var _0x13635b=a0_0x5ba68b,_0x7399e5=$($(this)[_0x13635b(0x111)](_0x13635b(0x108))[0x0]||$(this)[_0x13635b(0x111)](_0x13635b(0x2a8))[0x0]);if(_0x1aba90[_0x13635b(0x207)]==0xd)return $(this)[_0x13635b(0x277)]('open')?_0x7399e5['trigger'](_0x13635b(0x1e2)):$(this)['trigger'](_0x13635b(0x1e2)),![];else{if(_0x1aba90[_0x13635b(0x207)]==0x28)return!$(this)['hasClass'](_0x13635b(0x283))?$(this)[_0x13635b(0x21e)]('click'):_0x7399e5[_0x13635b(0x297)]()[_0x13635b(0x2a6)](),![];else{if(_0x1aba90[_0x13635b(0x207)]==0x26){if(!$(this)['hasClass'](_0x13635b(0x283)))$(this)[_0x13635b(0x21e)]('click');else{var _0x7399e5=$($(this)['find'](_0x13635b(0x108))[0x0]||$(this)[_0x13635b(0x111)](_0x13635b(0x2a8))[0x0]);_0x7399e5['prev']()[_0x13635b(0x2a6)]();}return![];}else{if(_0x1aba90[_0x13635b(0x207)]==0x1b)return $(this)['hasClass'](_0x13635b(0x283))&&$(this)[_0x13635b(0x21e)](_0x13635b(0x1e2)),![];}}}});function Getfilterdata(){Isfillter=!![],LoadProject();}function Clearfilter(){var _0x418733=a0_0x5ba68b;$('.checkboxss')['prop'](_0x418733(0x163),![]),Isfillter=![],LoadProject();}var GI=0x0,GLength=0x0;function LoadProject(){var _0x27f68b=a0_0x5ba68b;addSpinner($('body')),$[_0x27f68b(0x240)](GetExternalUsers())[_0x27f68b(0x20e)](function(_0x39d0f9){var _0x10b356=_0x27f68b;try{token=localStorage['getItem'](_0x10b356(0x116));if(token==null||token=='')authContext[_0x10b356(0x14c)](_0x10b356(0x14f),function(_0x4a4bb7,_0x1e3bb1){var _0x599ef8=_0x10b356;console[_0x599ef8(0x27a)](_0x1e3bb1),console[_0x599ef8(0x27a)](_0x4a4bb7);if(_0x4a4bb7||!_0x1e3bb1)return;localStorage[_0x599ef8(0x179)](_0x599ef8(0x116),_0x1e3bb1),_0x1e3bb1=localStorage[_0x599ef8(0x289)](_0x599ef8(0x116)),token1=localStorage[_0x599ef8(0x289)](_0x599ef8(0x116));}),LoadProject();else{htmlGridarray=[];var _0xac8b0f=0x0;GLength=_0x39d0f9[_0x10b356(0x1df)];for(GI=0x0;GI<_0x39d0f9[_0x10b356(0x1df)];GI++){_0xac8b0f=GI;var _0xd78724=new Date(_0x39d0f9[_0xac8b0f][_0x10b356(0x177)]),_0x5b5c24='',_0x319ed9='';_0x39d0f9[_0xac8b0f][_0x10b356(0x106)]==_0x10b356(0x1d7)?$[_0x10b356(0x240)](GetGueastUsers(_0x39d0f9[_0xac8b0f][_0x10b356(0x1a6)]))['done'](function(_0xf9808d){var _0x45a5cb=_0x10b356;_0xf9808d['length']>0x0&&(_0x5b5c24=_0xf9808d[0x0][_0x45a5cb(0x2aa)],_0x319ed9=_0xf9808d[0x0][_0x45a5cb(0x13e)],htmlGridarray[_0x45a5cb(0x1e7)]({'creationType':_0x5b5c24,'externalUserState':_0x319ed9,'Title':_0x39d0f9[_0xac8b0f][_0x45a5cb(0x1de)][_0x45a5cb(0x21c)]?_0x39d0f9[_0xac8b0f][_0x45a5cb(0x1de)][_0x45a5cb(0x21c)]:_0x39d0f9[_0xac8b0f][_0x45a5cb(0x1ce)],'email':_0x39d0f9[_0xac8b0f][_0x45a5cb(0x1a6)],'Designation':_0x39d0f9[_0xac8b0f][_0x45a5cb(0x284)]?_0x39d0f9[_0xac8b0f][_0x45a5cb(0x284)]:'','CollaborationType':_0x39d0f9[_0xac8b0f]['CollaborationType']?_0x39d0f9[_0xac8b0f][_0x45a5cb(0x160)]:'','ClientName':_0x39d0f9[_0xac8b0f][_0x45a5cb(0x2ad)][_0x45a5cb(0x21c)],'Status':_0x39d0f9[_0xac8b0f][_0x45a5cb(0x106)],'ID':_0x39d0f9[_0xac8b0f]['Id'],'ValidUpto':_0x39d0f9[_0xac8b0f][_0x45a5cb(0x264)],'ReferenceCode':_0x39d0f9[_0xac8b0f][_0x45a5cb(0x1fe)],'Modified':$[_0x45a5cb(0x107)][_0x45a5cb(0x29e)](_0x45a5cb(0x28b),_0xd78724)}));}):htmlGridarray['push']({'creationType':_0x5b5c24,'externalUserState':_0x319ed9,'Title':_0x39d0f9[_0xac8b0f][_0x10b356(0x1de)][_0x10b356(0x21c)]?_0x39d0f9[_0xac8b0f][_0x10b356(0x1de)]['Title']:_0x39d0f9[_0xac8b0f][_0x10b356(0x1ce)],'email':_0x39d0f9[_0xac8b0f][_0x10b356(0x1a6)],'Designation':_0x39d0f9[_0xac8b0f][_0x10b356(0x284)],'CollaborationType':_0x39d0f9[_0xac8b0f]['CollaborationType']?_0x39d0f9[_0xac8b0f][_0x10b356(0x160)]:'','ClientName':_0x39d0f9[_0xac8b0f]['Client_Name'][_0x10b356(0x21c)],'Status':_0x39d0f9[_0xac8b0f][_0x10b356(0x106)],'ID':_0x39d0f9[_0xac8b0f]['Id'],'ValidUpto':_0x39d0f9[_0xac8b0f][_0x10b356(0x264)],'ReferenceCode':_0x39d0f9[_0xac8b0f][_0x10b356(0x1fe)],'Modified':$['datepicker'][_0x10b356(0x29e)](_0x10b356(0x28b),_0xd78724)});}GenerateGridHtml(htmlGridarray),removeSpinner($(_0x10b356(0x206)));}}catch(_0x17b157){return alert(_0xac8b0f+_0x10b356(0x1c5)+_0x17b157),![];}});}function GenerateGridHtml(_0x4057f0){var _0x471bc6=a0_0x5ba68b,_0x52dd0c='';$(_0x471bc6(0x244))['html'](''),_0x52dd0c+=_0x471bc6(0x138)+'<tr>'+_0x471bc6(0x154)+_0x471bc6(0x273)+_0x471bc6(0x260)+'\x20<th\x20class=\x22text-left\x20border-bottom-0\x22><b>Type</b></th>'+'\x20<th\x20class=\x22text-left\x20border-bottom-0\x22\x20><b>Organization</b></th>'+_0x471bc6(0x242)+'\x20<th\x20class=\x22text-center\x20border-bottom-0\x22><b>Action</b></th>'+'\x20</tr>'+'</thead>'+'<tbody\x20>';if(htmlGridarray['length']>0x0){for(var _0x13cfed=0x0;_0x13cfed<htmlGridarray[_0x471bc6(0x1df)];_0x13cfed++){if(htmlGridarray[_0x13cfed][_0x471bc6(0x13e)]==_0x471bc6(0x25f))_0x52dd0c+=_0x471bc6(0x103)+_0x471bc6(0x147)+htmlGridarray[_0x13cfed]['Title']+_0x471bc6(0x2af)+'<td>'+htmlGridarray[_0x13cfed][_0x471bc6(0x1a6)]+_0x471bc6(0x2af)+_0x471bc6(0x147)+htmlGridarray[_0x13cfed][_0x471bc6(0x177)]+_0x471bc6(0x2af)+'<td>'+htmlGridarray[_0x13cfed]['CollaborationType']+_0x471bc6(0x2af)+_0x471bc6(0x147)+_0x471bc6(0x15f)+htmlGridarray[_0x13cfed][_0x471bc6(0x140)]+_0x471bc6(0x12c)+'<div\x20class=\x22form-wizard\x20centered-pills\x22\x20>'+_0x471bc6(0x1b0)+'<li\x20role=\x22presentation\x22\x20class=\x22pills-box-info\x20Initiated\x22><a\x20href=\x22#\x22>Initiated</a></li>'+_0x471bc6(0x28a)+_0x471bc6(0x142)+'\x20<li\x20role=\x22presentation\x22\x20class=\x22pills-box-info\x20\x22><a\x20href=\x22#\x22>Active</a></li>'+_0x471bc6(0x124)+_0x471bc6(0x12c)+_0x471bc6(0x2af)+_0x471bc6(0x1cb)+_0x471bc6(0x147)+'<div\x20class=\x22guesr-user-edit-lock-btn-box\x22>'+'<a\x20type=\x22button\x22\x20href=\x22#\x22\x20class=\x22custom-edit-btn\x22\x20data-toggle=\x22tooltip\x22\x20data-placement=\x22top\x22\x20title=\x22\x22\x20onclick=\x22CheckInvitedAction('+htmlGridarray[_0x13cfed]['ID']+')\x22\x20\x20data-original-title=\x22Check\x22>'+'<i\x20class=\x22fa\x20fa-question-circle-o\x22></i>'+_0x471bc6(0x198)+'<a\x20type=\x22button\x22\x20type=\x22button\x22\x20class=\x22custom-edit-btn\x22\x20data-toggle=\x22tooltip\x22\x20\x20onclick=\x22DeleteHtmlRow('+htmlGridarray[_0x13cfed]['ID']+',\x27'+htmlGridarray[_0x13cfed][_0x471bc6(0x1a6)]+_0x471bc6(0x255)+_0x471bc6(0x1ef)+_0x471bc6(0x198)+_0x471bc6(0x12c)+_0x471bc6(0x2af)+_0x471bc6(0x257);else{if(htmlGridarray[_0x13cfed][_0x471bc6(0x13e)]==_0x471bc6(0x1fd)||htmlGridarray[_0x13cfed][_0x471bc6(0x106)]==_0x471bc6(0x1fd)){var _0x206286=_0x471bc6(0x223);_0x52dd0c+=_0x471bc6(0x103)+_0x471bc6(0x147)+htmlGridarray[_0x13cfed]['Title']+'</td>'+_0x471bc6(0x147)+htmlGridarray[_0x13cfed][_0x471bc6(0x1a6)]+'</td>'+_0x471bc6(0x147)+htmlGridarray[_0x13cfed][_0x471bc6(0x177)]+_0x471bc6(0x2af)+_0x471bc6(0x147)+htmlGridarray[_0x13cfed][_0x471bc6(0x160)]+_0x471bc6(0x2af)+_0x471bc6(0x147)+'<div\x20\x20>'+htmlGridarray[_0x13cfed][_0x471bc6(0x140)]+_0x471bc6(0x12c)+_0x471bc6(0x136)+_0x471bc6(0x1b0)+'<li\x20role=\x22presentation\x22\x20class=\x22pills-box-info\x20Initiated\x22><a\x20href=\x22#\x22>Initiated</a></li>'+_0x471bc6(0x28a)+'<li\x20role=\x22presentation\x22\x20class=\x22pills-box-info\x20Accepted\x22><a\x20href=\x22#\x22>Accepted</a></li>'+_0x471bc6(0x1b4)+_0x471bc6(0x124)+_0x471bc6(0x12c)+'</td>'+_0x471bc6(0x261)+_0x471bc6(0x147)+_0x471bc6(0x27f)+_0x471bc6(0x13a)+htmlGridarray[_0x13cfed]['ID']+',\x27'+_0x206286+_0x471bc6(0x217)+'<i\x20class=\x22fa\x20fa-user-plus\x22></i>'+_0x471bc6(0x198)+_0x471bc6(0x10c)+htmlGridarray[_0x13cfed]['ID']+',\x27'+htmlGridarray[_0x13cfed][_0x471bc6(0x1a6)]+_0x471bc6(0x255)+_0x471bc6(0x1ef)+'</a>'+_0x471bc6(0x12c)+'</td>'+_0x471bc6(0x257),htmlGridarray[_0x13cfed]['Status']=='Invited'&&UpdateGeustuserInvite(htmlGridarray[_0x13cfed]['ID'],_0x471bc6(0x1fd));}else{if(htmlGridarray[_0x13cfed][_0x471bc6(0x106)]==_0x471bc6(0x1d7))_0x52dd0c+=_0x471bc6(0x103)+_0x471bc6(0x147)+htmlGridarray[_0x13cfed]['Title']+_0x471bc6(0x2af)+_0x471bc6(0x147)+htmlGridarray[_0x13cfed][_0x471bc6(0x1a6)]+_0x471bc6(0x2af)+_0x471bc6(0x147)+htmlGridarray[_0x13cfed][_0x471bc6(0x177)]+_0x471bc6(0x2af)+_0x471bc6(0x147)+htmlGridarray[_0x13cfed][_0x471bc6(0x160)]+'</td>'+'<td>'+_0x471bc6(0x192)+htmlGridarray[_0x13cfed][_0x471bc6(0x140)]+'</div>'+_0x471bc6(0x136)+'<ul\x20class=\x22nav\x20nav-pills\x22>'+'<li\x20role=\x22presentation\x22\x20class=\x22pills-box-info\x20Initiated\x22><a\x20href=\x22#\x22>Initiated</a></li>'+_0x471bc6(0x28a)+_0x471bc6(0x265)+_0x471bc6(0x1b4)+_0x471bc6(0x124)+_0x471bc6(0x12c)+_0x471bc6(0x2af)+_0x471bc6(0x1cb)+_0x471bc6(0x147)+'<div\x20class=\x22guesr-user-edit-lock-btn-box\x22>'+_0x471bc6(0x164)+htmlGridarray[_0x13cfed]['ID']+_0x471bc6(0x24a)+_0x471bc6(0x1ed)+_0x471bc6(0x198)+_0x471bc6(0x10c)+htmlGridarray[_0x13cfed]['ID']+',\x27'+htmlGridarray[_0x13cfed]['email']+_0x471bc6(0x255)+_0x471bc6(0x1ef)+_0x471bc6(0x198)+_0x471bc6(0x12c)+_0x471bc6(0x2af)+_0x471bc6(0x257);else{if(htmlGridarray[_0x13cfed][_0x471bc6(0x106)]==_0x471bc6(0x274)){var _0x206286=_0x471bc6(0x223);_0x52dd0c+=_0x471bc6(0x103)+_0x471bc6(0x147)+htmlGridarray[_0x13cfed][_0x471bc6(0x21c)]+'</td>'+_0x471bc6(0x147)+htmlGridarray[_0x13cfed][_0x471bc6(0x1a6)]+_0x471bc6(0x2af)+'<td>'+htmlGridarray[_0x13cfed]['Modified']+_0x471bc6(0x2af)+_0x471bc6(0x147)+htmlGridarray[_0x13cfed][_0x471bc6(0x160)]+_0x471bc6(0x2af)+_0x471bc6(0x147)+_0x471bc6(0x15f)+htmlGridarray[_0x13cfed][_0x471bc6(0x140)]+_0x471bc6(0x12c)+_0x471bc6(0x136)+_0x471bc6(0x1b0)+_0x471bc6(0x120)+_0x471bc6(0x28a)+_0x471bc6(0x2a7)+_0x471bc6(0x2a0)+_0x471bc6(0x124)+_0x471bc6(0x12c)+_0x471bc6(0x2af)+_0x471bc6(0x1a5)+_0x471bc6(0x147)+'<div\x20class=\x22guesr-user-edit-lock-btn-box\x22>'+_0x471bc6(0x10a)+htmlGridarray[_0x13cfed]['ID']+',\x27'+_0x206286+_0x471bc6(0x166)+'<i\x20class=\x22fa\x20fa-pencil\x22></i>'+_0x471bc6(0x198)+_0x471bc6(0x10c)+htmlGridarray[_0x13cfed]['ID']+',\x27'+htmlGridarray[_0x13cfed]['email']+_0x471bc6(0x255)+_0x471bc6(0x1ef)+_0x471bc6(0x198)+_0x471bc6(0x12c)+_0x471bc6(0x2af)+_0x471bc6(0x257);}else{if(htmlGridarray[_0x13cfed][_0x471bc6(0x106)]==_0x471bc6(0x1dd)){var _0x206286=_0x471bc6(0x223);_0x52dd0c+='<tr\x20class=\x22text-left\x22>'+_0x471bc6(0x147)+htmlGridarray[_0x13cfed][_0x471bc6(0x21c)]+'</td>'+_0x471bc6(0x147)+htmlGridarray[_0x13cfed][_0x471bc6(0x1a6)]+'</td>'+_0x471bc6(0x147)+htmlGridarray[_0x13cfed][_0x471bc6(0x177)]+_0x471bc6(0x2af)+_0x471bc6(0x147)+htmlGridarray[_0x13cfed]['CollaborationType']+'</td>'+'<td>'+_0x471bc6(0x15f)+htmlGridarray[_0x13cfed][_0x471bc6(0x140)]+_0x471bc6(0x12c)+_0x471bc6(0x136)+'<ul\x20class=\x22nav\x20nav-pills\x22>'+_0x471bc6(0x120)+_0x471bc6(0x28a)+'<li\x20role=\x22presentation\x22\x20class=\x22pills-box-info\x20Accepted\x22><a\x20href=\x22#\x22>Accepted</a></li>'+_0x471bc6(0x213)+'</ul>'+_0x471bc6(0x12c)+_0x471bc6(0x2af)+_0x471bc6(0x11a)+'<td>'+_0x471bc6(0x27f)+_0x471bc6(0x10a)+htmlGridarray[_0x13cfed]['ID']+',\x27'+_0x206286+_0x471bc6(0x166)+'<i\x20class=\x22fa\x20fa-pencil\x22></i>'+_0x471bc6(0x198)+'<a\x20type=\x22button\x22\x20type=\x22button\x22\x20class=\x22custom-edit-btn\x22\x20data-toggle=\x22tooltip\x22\x20onclick=\x22DeleteHtmlRow('+htmlGridarray[_0x13cfed]['ID']+',\x27'+htmlGridarray[_0x13cfed][_0x471bc6(0x1a6)]+_0x471bc6(0x255)+_0x471bc6(0x1ef)+_0x471bc6(0x198)+_0x471bc6(0x12c)+_0x471bc6(0x2af)+_0x471bc6(0x257);}else _0x52dd0c+=_0x471bc6(0x103)+_0x471bc6(0x147)+htmlGridarray[_0x13cfed][_0x471bc6(0x21c)]+_0x471bc6(0x2af)+_0x471bc6(0x147)+htmlGridarray[_0x13cfed]['email']+_0x471bc6(0x2af)+_0x471bc6(0x147)+htmlGridarray[_0x13cfed][_0x471bc6(0x177)]+_0x471bc6(0x2af)+'<td>'+htmlGridarray[_0x13cfed][_0x471bc6(0x160)]+'</td>'+_0x471bc6(0x147)+_0x471bc6(0x15f)+htmlGridarray[_0x13cfed]['ClientName']+_0x471bc6(0x12c)+_0x471bc6(0x136)+_0x471bc6(0x1b0)+_0x471bc6(0x120)+'<li\x20role=\x22presentation\x22\x20class=\x22pills-box-info\x22><a\x20href=\x22#\x22>Invited</a></li>'+'<li\x20role=\x22presentation\x22\x20class=\x22pills-box-info\x20\x22><a\x20href=\x22#\x22>Accepted</a></li>'+'\x20<li\x20role=\x22presentation\x22\x20class=\x22pills-box-info\x22><a\x20href=\x22#\x22>Active</a></li>'+_0x471bc6(0x254)+_0x471bc6(0x12c)+'</td>'+_0x471bc6(0x268)+_0x471bc6(0x147)+_0x471bc6(0x27f)+_0x471bc6(0x151)+htmlGridarray[_0x13cfed]['ID']+_0x471bc6(0x235)+'<i\x20class=\x22fa\x20fa-envelope-o\x22></i>'+_0x471bc6(0x198)+'<a\x20type=\x22button\x22\x20type=\x22button\x22\x20class=\x22custom-edit-btn\x22\x20data-toggle=\x22tooltip\x22\x20\x20onclick=\x22DeleteHtmlRow('+htmlGridarray[_0x13cfed]['ID']+',\x27'+htmlGridarray[_0x13cfed][_0x471bc6(0x1a6)]+_0x471bc6(0x255)+_0x471bc6(0x1ef)+_0x471bc6(0x198)+_0x471bc6(0x12c)+'</td>'+_0x471bc6(0x257);}}}}}_0x52dd0c+=_0x471bc6(0x1a4);}$(_0x471bc6(0x244))[_0x471bc6(0x251)](_0x52dd0c),$['fn'][_0x471bc6(0x12e)][_0x471bc6(0x262)](_0x471bc6(0x244))?(table[_0x471bc6(0x279)](),table=$(_0x471bc6(0x244))[_0x471bc6(0x24c)]({'bPaginate':!![],'bJQueryUI':!![],'bLengthChange':![],'bFilter':!![],'bSort':!![],'bInfo':!![],'bAutoWidth':!![],'bProcessing':!![],'iDisplayLength':0xa,'dom':_0x471bc6(0x23c),'colReorder':{'allowReorder':!![]},'language':{'searchPlaceholder':'Search'},'columnDefs':[{'width':0x96,'targets':0x1}]})):table=$(_0x471bc6(0x244))[_0x471bc6(0x24c)]({'bPaginate':!![],'bJQueryUI':!![],'bLengthChange':![],'bFilter':!![],'bSort':!![],'bInfo':!![],'bAutoWidth':!![],'bProcessing':!![],'iDisplayLength':0xa,'dom':_0x471bc6(0x23c),'colReorder':{'allowReorder':!![]},'language':{'searchPlaceholder':_0x471bc6(0x123)},'columnDefs':[{'width':0x96,'targets':0x1}]});}function CheckInvitedAction(_0x445454){var _0x345aee=a0_0x5ba68b;ExtrnaluserId=_0x445454;var _0x579d2a=htmlGridarray['filter'](function(_0x178f04){return _0x178f04['ID']==_0x445454;}),_0x58d75a='',_0x198ac6='';$(_0x345aee(0x1fc))[_0x345aee(0x162)](''),$('#checkUser')[_0x345aee(0x162)](_0x579d2a[0x0][_0x345aee(0x1a6)]),SendReminderInvitename=_0x579d2a[0x0][_0x345aee(0x21c)],SendReminderInviteEmail=_0x579d2a[0x0][_0x345aee(0x1a6)],$[_0x345aee(0x240)](GetGueastUsers(_0x579d2a[0x0][_0x345aee(0x1a6)]))[_0x345aee(0x20e)](function(_0x2c4c7b){var _0x5757dc=_0x345aee;_0x2c4c7b[_0x5757dc(0x1df)]>0x0&&(_0x58d75a=_0x2c4c7b[0x0][_0x5757dc(0x2aa)],_0x198ac6=_0x2c4c7b[0x0]['externalUserState']);});if(_0x198ac6==_0x345aee(0x1fd)){for(var _0x57811a in htmlGridarray){if(htmlGridarray[_0x57811a]['ID']==ExtrnaluserId){htmlGridarray[_0x57811a]['externalUserState']=_0x345aee(0x1fd);break;}}GenerateGridHtml(htmlGridarray),$(_0x345aee(0x195))[_0x345aee(0x162)]('');var _0x8f371f=_0x345aee(0x15e);$(_0x345aee(0x195))[_0x345aee(0x162)](_0x8f371f),$(_0x345aee(0x1aa))[_0x345aee(0x16f)](),$(_0x345aee(0x249))[_0x345aee(0x292)](),$('#btnSendReminder')[_0x345aee(0x292)](),$('#check-status')[_0x345aee(0x1b9)](_0x345aee(0x16f));}else{for(var _0x57811a in htmlGridarray){if(htmlGridarray[_0x57811a]['ID']==ExtrnaluserId){htmlGridarray[_0x57811a]['externalUserState']=_0x345aee(0x25f);break;}}GenerateGridHtml(htmlGridarray),$(_0x345aee(0x195))[_0x345aee(0x162)]('');var _0x8f371f='The\x20user\x20does\x20not\x20accept\x20the\x20invitation\x20yet.';$(_0x345aee(0x195))[_0x345aee(0x162)](_0x8f371f),$(_0x345aee(0x249))['show'](),$('.check-icon')[_0x345aee(0x292)](),$('#check-status')[_0x345aee(0x1b9)]('show'),$(_0x345aee(0x191))['show']();}}function SetTextBox(_0x2d496f,_0x222ba3){var _0x2ab229=a0_0x5ba68b;ExtrnaluserId=_0x2d496f;var _0x43bb1a=htmlGridarray[_0x2ab229(0x176)](function(_0x4b3c72){return _0x4b3c72['ID']==_0x2d496f;});if(_0x222ba3=='Permit')IsSetvalue=!![],Pertimtblock(_0x43bb1a[0x0][_0x2ab229(0x1a6)]);else{if(_0x222ba3=='Invite'){IsSetvalue=![],$(_0x2ab229(0x105))[_0x2ab229(0x1e3)](_0x43bb1a[0x0][_0x2ab229(0x21c)]),$('#txtinvitename')[_0x2ab229(0x127)](_0x2ab229(0x22e),_0x2ab229(0x22e)),$('#txtinviteemail')[_0x2ab229(0x1e3)](_0x43bb1a[0x0]['email']),$(_0x2ab229(0x17f))[_0x2ab229(0x127)](_0x2ab229(0x22e),_0x2ab229(0x22e)),$(_0x2ab229(0x155))['val'](_0x43bb1a[0x0]['Designation']),$(_0x2ab229(0x155))[_0x2ab229(0x127)](_0x2ab229(0x22e),_0x2ab229(0x22e)),$(_0x2ab229(0xfc))['val'](_0x43bb1a[0x0][_0x2ab229(0x1fe)]),$(_0x2ab229(0xfc))[_0x2ab229(0x127)](_0x2ab229(0x22e),_0x2ab229(0x22e)),$(_0x2ab229(0xfe))[_0x2ab229(0x1e3)](_0x43bb1a[0x0][_0x2ab229(0x140)]),$('#invitetxtOrganizationName')[_0x2ab229(0x127)](_0x2ab229(0x22e),_0x2ab229(0x22e));var _0x4023c1=new Date(_0x43bb1a[0x0][_0x2ab229(0x264)]);$(_0x2ab229(0x296))[_0x2ab229(0x1e3)]($['datepicker'][_0x2ab229(0x29e)](_0x2ab229(0x28b),_0x4023c1)),$(_0x2ab229(0x296))[_0x2ab229(0x127)]('disabled',_0x2ab229(0x22e)),$(_0x2ab229(0x237))['hide']();}}}function Getinvitebox(){var _0x597f9f=a0_0x5ba68b;$(_0x597f9f(0x105))[_0x597f9f(0x1e3)](''),$(_0x597f9f(0x180))[_0x597f9f(0x1e3)](''),$('#txtinvitename')[_0x597f9f(0x11e)](_0x597f9f(0x22e)),IscheckInvite&&($('#txtinviteemail')[_0x597f9f(0x1e3)](''),$('#txtinviteemail')['removeAttr'](_0x597f9f(0x22e))),$(_0x597f9f(0x155))['val'](''),$(_0x597f9f(0x155))['removeAttr'](_0x597f9f(0x22e)),$(_0x597f9f(0xfc))[_0x597f9f(0x1e3)](''),$(_0x597f9f(0xfc))['removeAttr']('disabled'),$(_0x597f9f(0xfe))[_0x597f9f(0x1e3)](''),$(_0x597f9f(0xfe))[_0x597f9f(0x11e)](_0x597f9f(0x22e)),$(_0x597f9f(0x296))[_0x597f9f(0x1e3)](''),$(_0x597f9f(0x296))[_0x597f9f(0x11e)](_0x597f9f(0x22e)),$(_0x597f9f(0x237))[_0x597f9f(0x16f)](),IsSetvalue=!![],SetCalendar();}function UpdateGeustuserInvite(_0x1c8a12,_0x5ce53f){var _0x4ba61a=a0_0x5ba68b,_0xf47f41='ExternalUsers',_0x1aa44c,_0x332b83=GetItemTypeForListName(_0xf47f41);_0x1aa44c={'__metadata':{'type':_0x332b83},'Status':_0x5ce53f};var _0x503723=$[_0x4ba61a(0x1af)]();return $[_0x4ba61a(0x118)]({'url':_spPageContextInfo[_0x4ba61a(0x148)]+_0x4ba61a(0x1d1)+_0xf47f41+_0x4ba61a(0x227)+_0x1c8a12+')','type':_0x4ba61a(0x12a),'async':![],'headers':{'accept':_0x4ba61a(0x286),'X-RequestDigest':$(_0x4ba61a(0x204))['val'](),'content-Type':_0x4ba61a(0x286),'IF-MATCH':'*','X-HTTP-Method':_0x4ba61a(0x1ff)},'data':JSON['stringify'](_0x1aa44c),'success':function(_0xd229a7){},'error':function(_0x8e5495){var _0xc1154e=_0x4ba61a;console[_0xc1154e(0x27a)](JSON[_0xc1154e(0x27c)](_0x8e5495)),_0x503723[_0xc1154e(0x27e)](_0x8e5495);}}),_0x503723[_0x4ba61a(0x23b)]();}function UpdateClientMaster(_0x836f1,_0x10eff4){var _0xdb6cc4=a0_0x5ba68b,_0x32c3e7=_0xdb6cc4(0x201),_0x5cfc8d,_0x50d641=GetItemTypeForListName(_0x32c3e7);_0x5cfc8d={'__metadata':{'type':_0x50d641},'SupervisorId':_0x10eff4};var _0x49e6a0=$['Deferred']();return $['ajax']({'url':_spPageContextInfo[_0xdb6cc4(0x148)]+_0xdb6cc4(0x1d1)+_0x32c3e7+'\x27)/items('+_0x836f1+')','type':_0xdb6cc4(0x12a),'async':![],'headers':{'accept':_0xdb6cc4(0x286),'X-RequestDigest':$(_0xdb6cc4(0x204))[_0xdb6cc4(0x1e3)](),'content-Type':_0xdb6cc4(0x286),'IF-MATCH':'*','X-HTTP-Method':'MERGE'},'data':JSON[_0xdb6cc4(0x27c)](_0x5cfc8d),'success':function(_0x388bd6){},'error':function(_0x1101df){var _0x149fa8=_0xdb6cc4;console[_0x149fa8(0x27a)](JSON['stringify'](_0x1101df)),_0x49e6a0[_0x149fa8(0x27e)](_0x1101df);}}),_0x49e6a0['promise']();}function UpdateClientMasterDocLib(_0x17d72c,_0x5a4cc3,_0x3a15bd,_0x3b66b6){var _0x5bb569=a0_0x5ba68b,_0x1ab168=_0x5bb569(0x201),_0x310b2f,_0x22aff8=GetItemTypeForListName(_0x1ab168);_0x310b2f={'__metadata':{'type':_0x22aff8},'InternalMembersId':{'results':_0x3b66b6},'InternalSupervisorId':_0x3a15bd,'DocumentLibrary':_0x5a4cc3};var _0x3ecef5=$['Deferred']();return $[_0x5bb569(0x118)]({'url':_spPageContextInfo['webAbsoluteUrl']+_0x5bb569(0x1d1)+_0x1ab168+'\x27)/items('+_0x17d72c+')','type':_0x5bb569(0x12a),'async':![],'headers':{'accept':_0x5bb569(0x286),'X-RequestDigest':$('#__REQUESTDIGEST')[_0x5bb569(0x1e3)](),'content-Type':'application/json;odata=verbose','IF-MATCH':'*','X-HTTP-Method':'MERGE'},'data':JSON['stringify'](_0x310b2f),'success':function(_0x1991ee){},'error':function(_0x55e55c){var _0x51c656=_0x5bb569;console[_0x51c656(0x27a)](JSON[_0x51c656(0x27c)](_0x55e55c)),_0x3ecef5['reject'](_0x55e55c);}}),_0x3ecef5['promise']();}function DeleteHtmlRow(_0x381b97,_0x47604a){var _0x59a694=a0_0x5ba68b,_0x463103=confirm(_0x59a694(0x17b)+_0x47604a+'\x0a\x20Are\x20you\x20sure\x20to\x20delete\x20this\x20user\x20?');_0x463103&&$[_0x59a694(0x118)]({'url':_spPageContextInfo[_0x59a694(0x148)]+_0x59a694(0x15c)+_0x381b97+')','type':_0x59a694(0x12a),'headers':{'Accept':_0x59a694(0x286),'Content-Type':_0x59a694(0x286),'IF-MATCH':'*','X-HTTP-Method':'DELETE','X-RequestDigest':$(_0x59a694(0x204))[_0x59a694(0x1e3)]()},'success':function(_0x2ad278,_0x5b1344,_0x3e9eab){var _0x7a84ee=_0x59a694;console[_0x7a84ee(0x27a)](_0x7a84ee(0x29c)),LoadProject();},'error':function(_0x507e8a,_0x3f9eb0,_0xc5ad1c){var _0xb4424c=_0x59a694;console[_0xb4424c(0x27a)]('Failed');}});}function GetGueastUsers(_0x480901){var _0x2b4c2a=a0_0x5ba68b,_0x5ded61='https://graph.microsoft.com/v1.0/users?$select=id,displayName,userPrincipalName,otherMails,userType,identities,creationType,externalUserState\x20&$filter=mail\x20eq\x20\x27'+_0x480901+'\x27';return DeferredObj=$[_0x2b4c2a(0x1af)](),$[_0x2b4c2a(0x118)]({'method':_0x2b4c2a(0x18e),'url':_0x5ded61,'headers':{'Authorization':_0x2b4c2a(0x133)+token,'Content-Type':'application/json'},'async':![],'success':function(_0x54bdeb){var _0x528c2e=_0x2b4c2a;DeferredObj[_0x528c2e(0x1d4)](_0x54bdeb[_0x528c2e(0x122)]);},'error':function(_0x499be4){var _0x48d5ed=_0x2b4c2a;localStorage[_0x48d5ed(0x145)](_0x48d5ed(0x116)),removeSpinner($(_0x48d5ed(0x206))),GI=GLength,LoadProject();}}),DeferredObj['promise']();}var filter='';function GetExternalUsers(){var _0x25afd7=a0_0x5ba68b,_0x2505d4='',_0x17c070=![];filter='';var _0x249815=_0x25afd7(0x131);if(Isfillter){Initiated!=''&&(filter+='(Status\x20eq\x20\x27Initiated\x27)\x20or\x20',_0x17c070=!![]);Invited!=''&&(filter+=_0x25afd7(0x19c),_0x17c070=!![]);NotAccepted!=''&&(filter+=_0x25afd7(0x19c),_0x17c070=!![]);Active!=''&&(filter+=_0x25afd7(0x222),_0x17c070=!![]);Inactive!=''&&(filter+=_0x25afd7(0x185),_0x17c070=!![]);Accepted!=''&&(filter+='(Status\x20eq\x20\x27Accepted\x27)\x20or\x20',_0x17c070=!![]);var _0x368a64=$(_0x25afd7(0x24d))[_0x25afd7(0x111)](_0x25afd7(0x1f2))[_0x25afd7(0x162)]();_0x368a64=='All'&&!_0x17c070?_0x2505d4=_spPageContextInfo[_0x25afd7(0x148)]+_0x25afd7(0x224)+_0x249815+_0x25afd7(0x10e):(_0x17c070?(filter=filter['substring'](0x0,filter['length']-0x3),_0x368a64!='All'&&(filter+=_0x25afd7(0x1a7)+_0x368a64+'\x27)')):filter+=_0x25afd7(0x14d)+_0x368a64+'\x27)',_0x2505d4=_spPageContextInfo[_0x25afd7(0x148)]+_0x25afd7(0x224)+_0x249815+_0x25afd7(0x16e)+filter+')');}else _0x2505d4=_spPageContextInfo[_0x25afd7(0x148)]+_0x25afd7(0x224)+_0x249815+_0x25afd7(0x1bd);var _0x25f715=$['Deferred']();return $[_0x25afd7(0x118)]({'url':_0x2505d4,'type':_0x25afd7(0x190),'headers':{'Accept':_0x25afd7(0x286)},'success':function(_0x16d9d2){var _0x541a1e=_0x25afd7,_0xf9e518=_0x16d9d2['d'][_0x541a1e(0x1dc)]['filter'](function(_0x32e7b0){var _0x21806e=_0x541a1e;return _0x32e7b0[_0x21806e(0x106)]==_0x21806e(0x1d7);}),_0x4a41fd=_0x16d9d2['d'][_0x541a1e(0x1dc)]['filter'](function(_0x5773ae){var _0x5c7da2=_0x541a1e;return _0x5773ae['Status']==_0x5c7da2(0x219);}),_0x256f14=_0x16d9d2['d'][_0x541a1e(0x1dc)]['filter'](function(_0x2385b5){var _0xc75814=_0x541a1e;return _0x2385b5[_0xc75814(0x106)]==_0xc75814(0x274);}),_0x4fc7b6=_0x16d9d2['d'][_0x541a1e(0x1dc)][_0x541a1e(0x176)](function(_0xee1444){var _0x1c3f0b=_0x541a1e;return _0xee1444[_0x1c3f0b(0x106)]==_0x1c3f0b(0x1dd);}),_0x331fc3=_0x16d9d2['d'][_0x541a1e(0x1dc)][_0x541a1e(0x176)](function(_0x3cd1a7){var _0x2d9c12=_0x541a1e;return _0x3cd1a7[_0x2d9c12(0x106)]==_0x2d9c12(0x1fd);});_0xf9e518[_0x541a1e(0x1df)]>0x0&&($(_0x541a1e(0x16b))['empty'](),$('#hInvited')[_0x541a1e(0x26b)](_0x541a1e(0x13d)+_0xf9e518['length']+_0x541a1e(0x22f))),_0x4a41fd[_0x541a1e(0x1df)]>0x0&&($(_0x541a1e(0x1c2))['empty'](),$(_0x541a1e(0x1c2))[_0x541a1e(0x26b)](_0x541a1e(0x13d)+_0x4a41fd[_0x541a1e(0x1df)]+'</h3>')),_0x256f14['length']>0x0&&($('#hActive')['empty'](),$(_0x541a1e(0x23f))[_0x541a1e(0x26b)](_0x541a1e(0x13d)+_0x256f14['length']+_0x541a1e(0x22f))),_0x4fc7b6[_0x541a1e(0x1df)]>0x0&&($(_0x541a1e(0x1ad))['empty'](),$(_0x541a1e(0x1ad))[_0x541a1e(0x26b)](_0x541a1e(0x13d)+_0x4fc7b6[_0x541a1e(0x1df)]+_0x541a1e(0x22f))),_0x331fc3['length']>0x0&&($(_0x541a1e(0x1c4))['empty'](),$(_0x541a1e(0x1c4))[_0x541a1e(0x26b)](_0x541a1e(0x13d)+_0x331fc3[_0x541a1e(0x1df)]+_0x541a1e(0x22f))),Isfillter==![]&&(_0x16d9d2['d'][_0x541a1e(0x1dc)]=_0x16d9d2['d'][_0x541a1e(0x1dc)]['filter'](function(_0xc3f40a){var _0x536dbe=_0x541a1e;return _0xc3f40a[_0x536dbe(0x106)]!==_0x536dbe(0x274);}),_0x16d9d2['d'][_0x541a1e(0x1dc)]=_0x16d9d2['d'][_0x541a1e(0x1dc)][_0x541a1e(0x176)](function(_0x3818c3){var _0x57ea33=_0x541a1e;return _0x3818c3[_0x57ea33(0x106)]!==_0x57ea33(0x1dd);})),Isfillter=![],_0x25f715[_0x541a1e(0x1d4)](_0x16d9d2['d'][_0x541a1e(0x1dc)]);},'error':function(_0x464a63){var _0x4aa9ff=_0x25afd7;console[_0x4aa9ff(0x27a)](_0x464a63[_0x4aa9ff(0x15d)][_0x4aa9ff(0x29a)]),_0x25f715[_0x4aa9ff(0x27e)](_0x464a63['responseJSON'][_0x4aa9ff(0x29a)]);}}),_0x25f715['promise']();}var Errorcount=0x1,Ischeckerror=![];function Inviteuser(){var _0x2f8971=a0_0x5ba68b,_0xcf941c=$('#txtinviteemail')[_0x2f8971(0x1e3)](),_0x5411b5=$(_0x2f8971(0x105))[_0x2f8971(0x1e3)](),_0x2a7c51=$(_0x2f8971(0x180))[_0x2f8971(0x1e3)](),_0x4a58dd=$(_0x2f8971(0xfe))['val'](),_0x1a8d52=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/igm,_0x4573e1=_0x1a8d52[_0x2f8971(0x1fa)](_0xcf941c);if(_0xcf941c=='')return alert('Please\x20enter\x20email'),![];else{if(!_0x4573e1)return alert(_0x2f8971(0x285)),![];else{if(_0x5411b5=='')return alert(_0x2f8971(0x23d)),![];else{if(_0x4a58dd=='')return alert('Please\x20enter\x20Organization\x20Name\x20'),![];else{if($(_0x2f8971(0x296))[_0x2f8971(0x1e3)]()=='')return alert(_0x2f8971(0x139)),![];}}}}Errorcount=0x1,$(_0x2f8971(0x233))[_0x2f8971(0x1e3)](_0x2f8971(0x2ab)),$['ajax']({'url':'https://graph.microsoft.com/v1.0/invitations','type':'POST','headers':{'Authorization':_0x2f8971(0x133)+token,'content-type':'application/json'},'data':JSON[_0x2f8971(0x27c)]({'invitedUserDisplayName':_0x5411b5,'invitedUserEmailAddress':_0xcf941c,'inviteRedirectUrl':_spPageContextInfo[_0x2f8971(0x148)]+_0x2f8971(0x12b),'sendInvitationMessage':!![],'invitedUserMessageInfo':{'customizedMessageBody':_0x2a7c51}}),'async':![],'success':function(_0x2fbbfc){var _0x46df27=_0x2f8971;console[_0x46df27(0x27a)](_0x2fbbfc);GroupId==''&&GetGroupIDByGroupName();GuestUserEmail=_0x2fbbfc[_0x46df27(0x189)];try{$['when'](AddUserinSharePointGroup(_0x2fbbfc[_0x46df27(0x189)],GroupId))[_0x46df27(0x20e)](function(_0x329aaa){var _0xccc84d=_0x46df27;Ischeckerror=![];if(_0x329aaa==_0xccc84d(0x143)){if(!IsSetvalue){UpdateGeustuserInvite(ExtrnaluserId,_0xccc84d(0x1d7));for(var _0x2877f3 in htmlGridarray){if(htmlGridarray[_0x2877f3]['ID']==ExtrnaluserId){htmlGridarray[_0x2877f3]['Status']=_0xccc84d(0x1d7);break;}}}else AddNewGuest();GenerateGridHtml(htmlGridarray),alert(_0xccc84d(0x16a)),Ischeckerror=![],$(_0xccc84d(0x21a))['modal']('hide');}else alert(_0xccc84d(0x299));});}catch(_0x1412e4){alert(_0x46df27(0x299)+_0x1412e4);}},'error':function(_0x5badfe){var _0x140bb3=_0x2f8971;_0x5badfe['statusText']==_0x140bb3(0x28d)?alert(_0x5badfe[_0x140bb3(0x157)]+_0x140bb3(0x17c)):(alert('Please\x20enter\x20a\x20valid\x20email\x20address\x20of\x20the\x20guest\x20user,\x20who\x20is\x20outsider\x20of\x20this\x20organization.'),console['log'](JSON[_0x140bb3(0x27c)](_0x5badfe)));}}),Ischeckerror&&alert(_0x2f8971(0x1e4)),$(_0x2f8971(0x233))[_0x2f8971(0x1e3)](_0x2f8971(0x1a8));}var SendReminderInvitename='',SendReminderInviteEmail='';function InviteuserSendReminder(){var _0x87180=a0_0x5ba68b;$[_0x87180(0x118)]({'url':_0x87180(0x253),'type':_0x87180(0x12a),'headers':{'Authorization':_0x87180(0x133)+token,'content-type':_0x87180(0x129)},'data':JSON[_0x87180(0x27c)]({'invitedUserDisplayName':SendReminderInvitename,'invitedUserEmailAddress':SendReminderInviteEmail,'inviteRedirectUrl':_spPageContextInfo[_0x87180(0x148)]+_0x87180(0x12b),'sendInvitationMessage':!![],'invitedUserMessageInfo':{'customizedMessageBody':'Please\x20accept\x20this\x20invitations\x20mail'}}),'async':![],'success':function(_0x3a8524){var _0xe6267a=_0x87180;console[_0xe6267a(0x27a)](_0x3a8524),alert(_0xe6267a(0x11f));},'error':function(_0x11e4d6){}});}function AddUserinSharePointGroup(_0x117651,_0x21b3da){var _0x478a9f=a0_0x5ba68b,_0x4d9870=$[_0x478a9f(0x1af)](),_0x5a5bae='i:0#.f|membership|',_0x35bc5a=_0x5a5bae+_0x117651,_0x20f17f=_spPageContextInfo[_0x478a9f(0x148)]+_0x478a9f(0x174)+_0x21b3da+')/users';$[_0x478a9f(0x118)]({'url':_0x20f17f,'type':_0x478a9f(0x12a),'async':![],'data':JSON[_0x478a9f(0x27c)]({'__metadata':{'type':_0x478a9f(0xf7)},'LoginName':_0x35bc5a}),'headers':{'accept':_0x478a9f(0x286),'content-type':'application/json;odata=verbose','X-RequestDigest':$(_0x478a9f(0x204))[_0x478a9f(0x1e3)]()},'success':_0x5c6060,'error':_0x28a267});function _0x5c6060(_0xb48013){var _0x299b0d=_0x478a9f;Ischeckerror=!![],_0x4d9870[_0x299b0d(0x1d4)](_0x299b0d(0x143)),Errorcount=0x1,console['log'](_0x299b0d(0x143));}function _0x28a267(_0x3b4e0d){var _0x4015df=_0x478a9f;console['log'](JSON[_0x4015df(0x27c)](_0x3b4e0d)),console[_0x4015df(0x27a)](JSON[_0x4015df(0x27c)](_0x117651)),(_0x3b4e0d[_0x4015df(0x157)]=='Not\x20Found'||_0x3b4e0d[_0x4015df(0x157)]==_0x4015df(0x29a))&&Errorcount==0x1e?_0x3b4e0d[_0x4015df(0x157)]==_0x4015df(0x29a)?(Errorcount++,AddUserinSharePointGroup(_0x117651,_0x21b3da)):alert(_0x4015df(0x173)):(Errorcount++,AddUserinSharePointGroup(_0x117651,_0x21b3da));}return _0x4d9870[_0x478a9f(0x23b)]();}function AddNewGuest(){var _0x2faef6=a0_0x5ba68b;try{var _0x53c4b6='ExternalUsers';GroupId==''&&GetGroupIDByGroupName();AddUserinSharePointGroup($('#txtinviteemail')[_0x2faef6(0x1e3)](),GroupId);var _0x602f65=GetUserEmail($('#txtinviteemail')[_0x2faef6(0x1e3)]()),_0x5a26fa,_0x52cdd2=GetItemTypeForListName(_0x53c4b6);_0x5a26fa={'__metadata':{'type':_0x52cdd2},'LoginNameId':_0x602f65,'Title':$(_0x2faef6(0x105))[_0x2faef6(0x1e3)](),'email':$(_0x2faef6(0x17f))['val'](),'Designation':$(_0x2faef6(0x155))['val'](),'Organization':$(_0x2faef6(0xfe))[_0x2faef6(0x1e3)](),'ReferenceCode':$(_0x2faef6(0xfc))['val'](),'InternalStakeholdersId':{'results':InternalStakeholder},'SupervisorId':Supervisormember,'Client_NameId':Client_Id,'Supervisor_GuestId':ExtnaralSupervisor,'ValidUpto':$(_0x2faef6(0x296))[_0x2faef6(0x1e3)](),'Status':_0x2faef6(0x1d7)},AddItemToList(_0x53c4b6,_0x5a26fa);}catch(_0x39acad){console['log'](_0x39acad[_0x2faef6(0x276)]);}}function AddItemToList(_0x5cc574,_0x216edf){var _0x4b2b84=a0_0x5ba68b,_0x1a3f68=$[_0x4b2b84(0x1af)]();return $[_0x4b2b84(0x118)]({'url':_spPageContextInfo['webAbsoluteUrl']+_0x4b2b84(0x224)+_0x5cc574+'\x27)/items','type':_0x4b2b84(0x12a),'async':![],'headers':{'accept':_0x4b2b84(0x286),'X-RequestDigest':$(_0x4b2b84(0x204))[_0x4b2b84(0x1e3)](),'content-Type':_0x4b2b84(0x286)},'data':JSON[_0x4b2b84(0x27c)](_0x216edf),'success':function(_0x448fcb){var _0x4f3db6=_0x4b2b84;htmlGridarray[_0x4f3db6(0x1e7)]({'creationType':'','externalUserState':'','Title':$(_0x4f3db6(0x105))[_0x4f3db6(0x1e3)](),'email':$(_0x4f3db6(0x17f))[_0x4f3db6(0x1e3)](),'Designation':$('#invitetxtDesignation')[_0x4f3db6(0x1e3)](),'CollaborationType':_0x448fcb['d'][_0x4f3db6(0x160)],'ClientName':$('#invitetxtOrganizationName')[_0x4f3db6(0x1e3)](),'Status':_0x4f3db6(0x1d7),'ID':_0x448fcb['d']['ID'],'ValidUpto':$(_0x4f3db6(0x296))[_0x4f3db6(0x1e3)](),'ReferenceCode':$(_0x4f3db6(0xfc))[_0x4f3db6(0x1e3)]()});},'error':function(_0x562211){var _0x422d60=_0x4b2b84;console[_0x422d60(0x27a)](JSON['stringify'](_0x562211)),_0x1a3f68[_0x422d60(0x27e)](_0x562211);}}),_0x1a3f68[_0x4b2b84(0x23b)]();}var InternalStakeholder=[],Supervisormember,ExtnaralSupervisor;function Selectedcclinte(){var _0x3cb7c8=a0_0x5ba68b;if(IsSetvalue){InternalStakeholder=[],$(_0x3cb7c8(0xfe))[_0x3cb7c8(0x1e3)](ClientInternalMembers[SelectClientId]['Title']),$(_0x3cb7c8(0xfe))['attr'](_0x3cb7c8(0x22e),_0x3cb7c8(0x22e)),Client_Id=ClientInternalMembers[SelectClientId]['ID'];for(var _0x2a2ed7=0x0;_0x2a2ed7<ClientInternalMembers[SelectClientId][_0x3cb7c8(0x22d)]['results'][_0x3cb7c8(0x1df)];_0x2a2ed7++){InternalStakeholder[_0x3cb7c8(0x1e7)](ClientInternalMembers[SelectClientId][_0x3cb7c8(0x22d)][_0x3cb7c8(0x1dc)][_0x2a2ed7]['Id']);}Supervisormember=ClientInternalMembers[SelectClientId][_0x3cb7c8(0x2a1)]['Id'],ExtnaralSupervisor=ClientInternalMembers[SelectClientId][_0x3cb7c8(0x211)];}else{$(_0x3cb7c8(0x20f))['val'](ClientInternalMembers[SelectClientId][_0x3cb7c8(0x21c)]),Client_Id=ClientInternalMembers[SelectClientId]['ID'];ClientInternalMembers[SelectClientId][_0x3cb7c8(0x14b)]!=undefined?$(_0x3cb7c8(0x1d2))['val'](ClientInternalMembers[SelectClientId]['Supervisor']):$(_0x3cb7c8(0x1d2))[_0x3cb7c8(0x1e3)]($(_0x3cb7c8(0xf6))[_0x3cb7c8(0x1e3)]());$(_0x3cb7c8(0x119)+ClientInternalMembers[SelectClientId][_0x3cb7c8(0x1f0)]+']')[_0x3cb7c8(0x127)](_0x3cb7c8(0x1c9),'true'),$(_0x3cb7c8(0x270)+ClientInternalMembers[SelectClientId][_0x3cb7c8(0x208)]+']')[_0x3cb7c8(0x127)](_0x3cb7c8(0x1c9),_0x3cb7c8(0x236)),initializePeoplePicker(_0x3cb7c8(0x22a),!![]),peoplePickerDiv=$(_0x3cb7c8(0x259)),initializePeoplePicker(_0x3cb7c8(0x183),![]),peoplePickerDivsuper=$(_0x3cb7c8(0x291));for(var _0x2a2ed7=0x0;_0x2a2ed7<ClientInternalMembers[SelectClientId][_0x3cb7c8(0x22d)][_0x3cb7c8(0x1dc)][_0x3cb7c8(0x1df)];_0x2a2ed7++){setPeoplePickerUsersInfoCurrent(_0x3cb7c8(0x234),ClientInternalMembers[SelectClientId][_0x3cb7c8(0x22d)][_0x3cb7c8(0x1dc)][_0x2a2ed7][_0x3cb7c8(0x112)]);}setPeoplePickerUsersInfoCurrent('internalsupervisor_TopSpan',ClientInternalMembers[SelectClientId][_0x3cb7c8(0x2a1)][_0x3cb7c8(0x112)]),$(_0x3cb7c8(0x1cc))[_0x3cb7c8(0x127)](_0x3cb7c8(0x26f),_0x3cb7c8(0x26c)),$('#InternalStakeholders')[_0x3cb7c8(0x127)]('disabled','disabled'),$('#internalsupervisor')[_0x3cb7c8(0x127)](_0x3cb7c8(0x22e),_0x3cb7c8(0x22e)),$(peoplePickerDiv)[_0x3cb7c8(0x111)](_0x3cb7c8(0x167))[_0x3cb7c8(0x26a)]('display','none'),$(peoplePickerDivsuper)[_0x3cb7c8(0x111)]('.sp-peoplepicker-delImage')[_0x3cb7c8(0x26a)](_0x3cb7c8(0x229),_0x3cb7c8(0x150));}}var ClientInternalMembers=[];function GetClientMasterTeamDeails(){var _0x9c1e9a=a0_0x5ba68b;Taskusers=[],ClientInternalMembers=[],RestQuery=_0x9c1e9a(0x153),$['when'](CommonFunction[_0x9c1e9a(0x134)](_0x9c1e9a(0x201),RestQuery))[_0x9c1e9a(0x20e)](function(_0x4a0572){var _0x32b8f9=_0x9c1e9a,_0x409c0f;IsNotTeamMember='';var _0x546dd2='';_0x546dd2+=_0x32b8f9(0x138)+_0x32b8f9(0x196)+_0x32b8f9(0x225)+'<th\x20class=\x22text-left\x20w-20\x22><b>Client\x20Name</b></th>'+_0x32b8f9(0x280)+_0x32b8f9(0x230)+_0x32b8f9(0x19e)+'</tr>'+_0x32b8f9(0x1d3);for(var _0x1ae4dd=0x0;_0x1ae4dd<_0x4a0572[_0x32b8f9(0x1dc)]['length'];_0x1ae4dd++){_0x409c0f=[],_0x409c0f=_0x4a0572[_0x32b8f9(0x1dc)][_0x1ae4dd];var _0xd7e617=_0x409c0f[_0x32b8f9(0x1a2)]=_0x32b8f9(0x236)?_0x409c0f['IsActive']:_0x32b8f9(0x274);_0x546dd2+=_0x32b8f9(0x1c8)+'<td\x20class=\x22text-left\x22>'+'<div\x20class=\x22checkbox\x20m-0\x22>'+_0x32b8f9(0x29d)+_0x1ae4dd+_0x32b8f9(0x15b)+_0x1ae4dd+'\x22></label>'+_0x32b8f9(0x12c)+_0x32b8f9(0x2af)+_0x32b8f9(0x128)+_0x32b8f9(0x115)+_0x409c0f['Title']+'</span>'+_0x32b8f9(0x2af)+_0x32b8f9(0x128)+'\x09<span>'+_0x409c0f[_0x32b8f9(0x212)]+_0x32b8f9(0x27d)+'</td>'+'<td\x20class=\x22text-left\x22>'+_0x32b8f9(0x115)+_0x409c0f['CustType']+_0x32b8f9(0x27d)+'</td>'+_0x32b8f9(0x128)+_0x32b8f9(0x115)+_0x409c0f[_0x32b8f9(0x100)]+_0x32b8f9(0x27d)+_0x32b8f9(0x2af)+'</tr>',ClientInternalMembers['push']({'Title':_0x409c0f[_0x32b8f9(0x21c)],'Client_Code':_0x409c0f[_0x32b8f9(0x100)],'Attn_Name':_0x409c0f[_0x32b8f9(0x212)],'Supervisor':_0x409c0f[_0x32b8f9(0x14b)][_0x32b8f9(0x112)],'SupervisorId':_0x409c0f[_0x32b8f9(0x14b)]['Id'],'SelfCompany':_0x409c0f['SelfCompany'],'IsActive':_0x409c0f[_0x32b8f9(0x1a2)],'CustType':_0x409c0f[_0x32b8f9(0x1f0)],'TemplateType':_0x409c0f[_0x32b8f9(0x208)],'InternalMembers':_0x409c0f['InternalMembers'],'InternalSupervisor':_0x409c0f[_0x32b8f9(0x2a1)],'ID':_0x409c0f['Id'],'DocumentLibrary':_0x409c0f['DocumentLibrary']});}GenarateclientGrid(_0x546dd2);});}function GetClientMasterfilter(){var _0x4408fd=a0_0x5ba68b;Taskusers=[],ClientInternalMembers[_0x4408fd(0x1df)]==0x0&&(RestQuery=_0x4408fd(0x153),$[_0x4408fd(0x240)](CommonFunction[_0x4408fd(0x134)](_0x4408fd(0x201),RestQuery))[_0x4408fd(0x20e)](function(_0x1338b1){var _0x32afdd=_0x4408fd;for(var _0x472ff1=0x0;_0x472ff1<_0x1338b1[_0x32afdd(0x1dc)][_0x32afdd(0x1df)];_0x472ff1++){InternalMembers=[],InternalMembers=_0x1338b1['results'][_0x472ff1],ClientInternalMembers[_0x32afdd(0x1e7)]({'Title':InternalMembers[_0x32afdd(0x21c)],'Client_Code':InternalMembers['Client_Code'],'Attn_Name':InternalMembers[_0x32afdd(0x212)],'Supervisor':InternalMembers['Supervisor'][_0x32afdd(0x112)],'SupervisorId':InternalMembers['Supervisor']['Id'],'SelfCompany':InternalMembers['SelfCompany'],'IsActive':InternalMembers[_0x32afdd(0x1a2)],'CustType':InternalMembers['CustType'],'TemplateType':InternalMembers[_0x32afdd(0x208)],'InternalMembers':InternalMembers[_0x32afdd(0x22d)],'InternalSupervisor':InternalMembers[_0x32afdd(0x2a1)],'ID':InternalMembers['Id'],'DocumentLibrary':InternalMembers[_0x32afdd(0xff)]});}}));}function GetClientMasterTeamDeailsByTitle(_0x4bf064){var _0x522f9d=a0_0x5ba68b;RestQuery=_0x522f9d(0x114)+_0x4bf064+'\x27',$[_0x522f9d(0x240)](CommonFunction[_0x522f9d(0x134)]('ClientMaster',RestQuery))[_0x522f9d(0x20e)](function(_0x1dc9fc){var _0x1a7236=_0x522f9d,_0x1a1b57;IsNotTeamMember='';if(_0x1dc9fc[_0x1a7236(0x1dc)][_0x1a7236(0x1df)]>0x0){_0x1a1b57=[],_0x1a1b57=_0x1dc9fc['results'][0x0];var _0x32cdf7=_0x1a1b57[_0x1a7236(0x1a2)]=_0x1a7236(0x236)?_0x1a1b57[_0x1a7236(0x1a2)]:'Active';ClientInternalMembers[_0x1a7236(0x1e7)]({'Title':_0x1a1b57[_0x1a7236(0x21c)],'Client_Code':_0x1a1b57[_0x1a7236(0x100)],'Attn_Name':_0x1a1b57[_0x1a7236(0x212)],'Supervisor':_0x1a1b57[_0x1a7236(0x14b)][_0x1a7236(0x112)],'SelfCompany':_0x1a1b57['SelfCompany'],'CustType':_0x1a1b57['CustType'],'TemplateType':_0x1a1b57[_0x1a7236(0x208)],'InternalMembers':_0x1a1b57['InternalMembers'],'InternalSupervisor':_0x1a1b57[_0x1a7236(0x2a1)],'ID':_0x1a1b57['Id']});}});}var SelectClientId='';function GenarateclientGrid(_0x30b608){var _0x1b8623=a0_0x5ba68b;$('#masterClientgrid')[_0x1b8623(0x188)](),$(_0x1b8623(0x121))[_0x1b8623(0x26b)](_0x30b608),$['fn']['dataTable'][_0x1b8623(0x262)]('#masterClientgrid')?(tableC[_0x1b8623(0x279)](),tableC=$(_0x1b8623(0x121))[_0x1b8623(0x24c)]({'bPaginate':!![],'bJQueryUI':!![],'bLengthChange':![],'bFilter':!![],'bSort':!![],'bInfo':!![],'bAutoWidth':!![],'bProcessing':!![],'iDisplayLength':0x5,'dom':_0x1b8623(0x23c),'colReorder':{'allowReorder':!![]},'language':{'searchPlaceholder':_0x1b8623(0x123)},'columnDefs':[{'width':0x96,'targets':0x1}]})):tableC=$(_0x1b8623(0x121))['DataTable']({'bPaginate':!![],'bJQueryUI':!![],'bLengthChange':![],'bFilter':!![],'bSort':!![],'bInfo':!![],'bAutoWidth':!![],'bProcessing':!![],'iDisplayLength':0x5,'dom':_0x1b8623(0x23c),'colReorder':{'allowReorder':!![]},'language':{'searchPlaceholder':_0x1b8623(0x123)},'columnDefs':[{'width':0x96,'targets':0x1}]}),$(_0x1b8623(0x121))[_0x1b8623(0x11e)]('style');}function selectOnlyThis(_0x6b4b2a){var _0x57d84f=a0_0x5ba68b;SelectClientId='',SelectClientId=_0x6b4b2a[_0x57d84f(0x209)]('_')[0x1],$('input:checkbox')[_0x57d84f(0x243)](this)[_0x57d84f(0x17a)](_0x57d84f(0x163),![]),document[_0x57d84f(0x231)](_0x6b4b2a)[_0x57d84f(0x163)]=!![];}function cleartextBox(){var _0x29ba5d=a0_0x5ba68b;IsSetvalue=![],$(_0x29ba5d(0x1a3))[_0x29ba5d(0x1e3)](''),$('#txtExtEmail')[_0x29ba5d(0x1e3)](''),$(_0x29ba5d(0xf6))[_0x29ba5d(0x11e)]('disabled'),$(_0x29ba5d(0x266))[_0x29ba5d(0x1e3)](''),$('#txtReferenceCodeExt')[_0x29ba5d(0x1e3)](''),$(_0x29ba5d(0x20f))[_0x29ba5d(0x1e3)](''),$(_0x29ba5d(0x1d2))[_0x29ba5d(0x1e3)](''),$('#extrenalImage')[_0x29ba5d(0x127)](_0x29ba5d(0x1e6),_0x29ba5d(0x294)),initializePeoplePicker('InternalStakeholders',!![]),peoplePickerDiv=$(_0x29ba5d(0x259)),initializePeoplePicker(_0x29ba5d(0x183),![]),peoplePickerDivsuper=$(_0x29ba5d(0x291));}function GetGroupIDByGroupName(){var _0x34bc85=a0_0x5ba68b,_0x486521=_spPageContextInfo['webAbsoluteUrl']+'/_api/web/sitegroups/getbyname(\x27Contributors\x27)?$select=id';$[_0x34bc85(0x118)]({'url':_0x486521,'method':'GET','async':![],'headers':{'Accept':_0x34bc85(0x241)},'success':function(_0xc0a7b4){GroupId=_0xc0a7b4['d']['Id'];},'error':function(_0xd72802){console['log'](_0xd72802);}});}function SetCalendar(){var _0x28a859=a0_0x5ba68b,_0x24ee40=new Date();today=_0x24ee40[_0x28a859(0x271)]()+0x1+'\x20'+_0x24ee40[_0x28a859(0x13f)]()+'\x20'+_0x24ee40[_0x28a859(0x278)](),Validdate=_0x24ee40[_0x28a859(0x271)]()+0x1+'/'+_0x24ee40[_0x28a859(0x13f)]()+'/'+(_0x24ee40[_0x28a859(0x278)]()+0x1),Dates=new Date(Validdate),$('#invitetxtValidityUpto')[_0x28a859(0x1e3)]($[_0x28a859(0x107)][_0x28a859(0x29e)](_0x28a859(0x263),Dates));}function GetItemTypeForListName(_0x85a112){var _0x723525=a0_0x5ba68b;return _0x723525(0x10f)+_0x85a112[_0x723525(0x14a)](0x0)[_0x723525(0x1eb)]()+_0x85a112[_0x723525(0x209)]('\x20')[_0x723525(0x149)]('')['slice'](0x1)+'ListItem';}function Pertimtblock(_0x39e227){var _0x271b46=a0_0x5ba68b;GetCategoryMaster(),$[_0x271b46(0x240)](GetItemToListchoice(),GetItemToList(_0x39e227))[_0x271b46(0x20e)](function(_0x25df24,_0x13d29a){var _0x4b46d3=_0x271b46;if(_0x13d29a['length']>0x0){if(_0x13d29a[0x0][_0x4b46d3(0x269)][_0x4b46d3(0x1dc)][_0x4b46d3(0x1df)]>0x0){var _0x974b69=_0x13d29a[0x0][_0x4b46d3(0x269)][_0x4b46d3(0x1dc)][0x0]['ServerRelativeUrl'];$(_0x4b46d3(0x226))['attr'](_0x4b46d3(0x1e6),_0x974b69);}else $(_0x4b46d3(0x226))[_0x4b46d3(0x127)](_0x4b46d3(0x1e6),_0x4b46d3(0x294));IsUpdate=!![],userListItemId=_0x13d29a[0x0]['Id'],initializePeoplePicker(_0x4b46d3(0x22a),!![]),peoplePickerDiv=$(_0x4b46d3(0x259)),initializePeoplePicker(_0x4b46d3(0x183),![]),peoplePickerDivsuper=$(_0x4b46d3(0x291));for(var _0x27c3ed=0x0;_0x27c3ed<_0x13d29a[0x0][_0x4b46d3(0x22a)][_0x4b46d3(0x1dc)][_0x4b46d3(0x1df)];_0x27c3ed++){setPeoplePickerUsersInfoCurrent(_0x4b46d3(0x234),_0x13d29a[0x0]['InternalStakeholders'][_0x4b46d3(0x1dc)][_0x27c3ed][_0x4b46d3(0x112)]);}setPeoplePickerUsersInfoCurrent(_0x4b46d3(0x275),_0x13d29a[0x0][_0x4b46d3(0x14b)][_0x4b46d3(0x112)]);debugger;$(_0x4b46d3(0x178))[_0x4b46d3(0x127)]('disabled',_0x4b46d3(0x22e)),$('#internalsupervisor')['attr'](_0x4b46d3(0x22e),_0x4b46d3(0x22e)),$(peoplePickerDiv)['find'](_0x4b46d3(0x167))[_0x4b46d3(0x26a)]('display',_0x4b46d3(0x150)),$(peoplePickerDivsuper)['find'](_0x4b46d3(0x167))['css'](_0x4b46d3(0x229),'none');for(var _0x27c3ed=0x0;_0x27c3ed<_0x25df24[_0x4b46d3(0x1df)];_0x27c3ed++){var _0x26eb23=$('<option>');_0x26eb23[_0x4b46d3(0x127)]('value',_0x25df24[_0x27c3ed])[_0x4b46d3(0x162)](_0x25df24[_0x27c3ed]);}$(_0x4b46d3(0xf6))[_0x4b46d3(0x1e3)](_0x13d29a[0x0][_0x4b46d3(0x1a6)]);IsSetvalue&&$(_0x4b46d3(0xf6))[_0x4b46d3(0x127)](_0x4b46d3(0x22e),_0x4b46d3(0x22e));$(_0x4b46d3(0x1a3))['val'](_0x13d29a[0x0][_0x4b46d3(0x1de)][_0x4b46d3(0x21c)]?_0x13d29a[0x0][_0x4b46d3(0x1de)][_0x4b46d3(0x21c)]:_0x13d29a[0x0][_0x4b46d3(0x1ce)]),$('#txtExtDesignation')[_0x4b46d3(0x1e3)](_0x13d29a[0x0]['Designation']),$('#txtExternalSupervisor')['val'](_0x13d29a[0x0]['Supervisor_Guest'][_0x4b46d3(0x21c)]),$(_0x4b46d3(0x168))[_0x4b46d3(0x1e3)](_0x13d29a[0x0][_0x4b46d3(0x102)]),$(_0x4b46d3(0x2ac))[_0x4b46d3(0x1e3)](_0x13d29a[0x0][_0x4b46d3(0x1ca)]),$(_0x4b46d3(0x20f))[_0x4b46d3(0x1e3)](_0x13d29a[0x0]['Client_Name'][_0x4b46d3(0x21c)]),Client_Id=_0x13d29a[0x0]['Client_Name']['Id'];var _0x57492f=new Date(_0x13d29a[0x0]['ValidUpto']);$(_0x4b46d3(0x19d))['val']($[_0x4b46d3(0x107)][_0x4b46d3(0x29e)](_0x4b46d3(0x263),_0x57492f)),$('#txtReferenceCodeExt')['val'](_0x13d29a[0x0]['ReferenceCode']),$(_0x4b46d3(0x270)+_0x13d29a[0x0][_0x4b46d3(0x208)]+']')[_0x4b46d3(0x127)](_0x4b46d3(0x1c9),'true'),$(_0x4b46d3(0x119)+_0x13d29a[0x0][_0x4b46d3(0x160)]+']')['attr'](_0x4b46d3(0x1c9),'true'),$('#btnotherOrganizationSearch')[_0x4b46d3(0x292)](),GetClientMasterTeamDeailsByTitle(_0x13d29a[0x0][_0x4b46d3(0x2ad)][_0x4b46d3(0x21c)]);}else $(_0x4b46d3(0x1a3))[_0x4b46d3(0x1e3)](''),$('#txtExtDesignation')[_0x4b46d3(0x1e3)](''),$('#txtExtOrganizationName')[_0x4b46d3(0x1e3)](''),$(_0x4b46d3(0x205))['val'](''),$('option:selected',$(_0x4b46d3(0x20d)))[_0x4b46d3(0x1e3)](''),$(_0x4b46d3(0x19d))[_0x4b46d3(0x1e3)]($[_0x4b46d3(0x107)]['formatDate'](_0x4b46d3(0x1db),new Date())),$(_0x4b46d3(0x232),$(_0x4b46d3(0x228)))[_0x4b46d3(0x1e3)](),$(_0x4b46d3(0x232),$(_0x4b46d3(0xfb)))[_0x4b46d3(0x1e3)](),$(_0x4b46d3(0x226))[_0x4b46d3(0x127)](_0x4b46d3(0x1e6),_0x4b46d3(0x16d)),$(_0x4b46d3(0x18b))[_0x4b46d3(0x127)](_0x4b46d3(0x1e6),_0x4b46d3(0x16d)),initializePeoplePicker(_0x4b46d3(0x22a),!![]),peoplePickerDiv=$(_0x4b46d3(0x259)),initializePeoplePicker(_0x4b46d3(0x183),![]),peoplePickerDivsuper=$(_0x4b46d3(0x291));});}function GetItemToListchoice(){var _0x1804c1=a0_0x5ba68b,_0x10eabf=_0x1804c1(0x131),_0x432140=$[_0x1804c1(0x1af)]();return $[_0x1804c1(0x118)]({'url':_spPageContextInfo[_0x1804c1(0x148)]+_0x1804c1(0x224)+_0x10eabf+_0x1804c1(0x24f),'type':'get','async':![],'headers':{'accept':_0x1804c1(0x286),'X-RequestDigest':$(_0x1804c1(0x204))['val'](),'content-Type':_0x1804c1(0x286)},'success':function(_0x58fcc3){var _0x1f2705=_0x1804c1;_0x432140['resolve'](_0x58fcc3['d'][_0x1f2705(0x1dc)][0x0][_0x1f2705(0x239)][_0x1f2705(0x1dc)]),console['log'](_0x58fcc3);},'error':function(_0x517b3a){var _0x5111d5=_0x1804c1;console[_0x5111d5(0x27a)](JSON[_0x5111d5(0x27c)](_0x517b3a)),_0x432140[_0x5111d5(0x27e)](_0x517b3a);}}),_0x432140[_0x1804c1(0x23b)]();}function GetItemToList(_0x49c684){var _0x3f8448=a0_0x5ba68b,_0x3ea7bb=_0x3f8448(0x131),_0x180625=$['Deferred']();return $[_0x3f8448(0x118)]({'url':_spPageContextInfo[_0x3f8448(0x148)]+_0x3f8448(0x224)+_0x3ea7bb+_0x3f8448(0x25a)+_0x49c684+'\x27','type':_0x3f8448(0x190),'async':![],'headers':{'accept':_0x3f8448(0x286),'X-RequestDigest':$('#__REQUESTDIGEST')[_0x3f8448(0x1e3)](),'content-Type':'application/json;odata=verbose'},'success':function(_0x380dd1){var _0xb85838=_0x3f8448;_0x180625['resolve'](_0x380dd1['d'][_0xb85838(0x1dc)]),console[_0xb85838(0x27a)](_0x380dd1);},'error':function(_0x44b389){var _0x344e97=_0x3f8448;console[_0x344e97(0x27a)](JSON[_0x344e97(0x27c)](_0x44b389)),_0x180625['reject'](_0x44b389);}}),_0x180625['promise']();}function GetCategoryMaster(){var _0x53616e=a0_0x5ba68b,_0x49aff3=_0x53616e(0x290),_0x5e62a3=_spPageContextInfo[_0x53616e(0x148)]+_0x53616e(0x1d1)+_0x49aff3+_0x53616e(0x1e9);$[_0x53616e(0x118)]({'url':_0x5e62a3,'headers':{'Accept':_0x53616e(0x286)},'async':![],'success':function(_0x13b726){var _0x594610=_0x53616e,_0x65d56a=document[_0x594610(0x231)](_0x594610(0x272));_0x65d56a[_0x594610(0x10b)]='';for(var _0x243a23=0x0;_0x243a23<_0x13b726['d'][_0x594610(0x1dc)][_0x594610(0x1df)];_0x243a23++){var _0x830113=_0x13b726['d'][_0x594610(0x1dc)][_0x243a23][_0x594610(0x214)],_0x1c3a17=_0x13b726['d'][_0x594610(0x1dc)][_0x243a23][_0x594610(0x214)];opt=document['createElement'](_0x594610(0x23e)),opt[_0x594610(0x122)]=_0x1c3a17,opt[_0x594610(0x162)]=_0x830113,_0x65d56a[_0x594610(0x295)](opt);}},'error':function(_0x19f188){var _0x21de26=_0x53616e;console[_0x21de26(0x27a)](_0x19f188);}});}function readURL(_0xdd1a6f){var _0x38189f=a0_0x5ba68b;if(_0xdd1a6f[_0x38189f(0x1f5)]&&_0xdd1a6f['files'][0x0]){var _0xdb93cd=new FileReader();_0xdb93cd[_0x38189f(0x1b5)]=function(_0x41f673){var _0x733cad=_0x38189f;$('#extrenalImage')[_0x733cad(0x127)](_0x733cad(0x1e6),_0x41f673[_0x733cad(0x182)][_0x733cad(0x1f4)]);},_0xdb93cd['readAsDataURL'](_0xdd1a6f[_0x38189f(0x1f5)][0x0]);}}var DocumentLibraryUrl='';function UpdateGeustuser(_0x23ca5f){var _0x2ef8d6=a0_0x5ba68b,_0x10e2d8=_0x2ef8d6(0x131),_0x4af5c6='',_0x3c0e21=SPClientPeoplePicker[_0x2ef8d6(0x126)][peoplePickerDiv[0x0]['id']],_0x476d61=_0x3c0e21[_0x2ef8d6(0x187)](),_0xaedab4=[];UserListId=[];for(var _0x4fd1e3=0x0;_0x4fd1e3<_0x476d61[_0x2ef8d6(0x1df)];_0x4fd1e3++){var _0xf350cb=GetUserId(_0x476d61[_0x4fd1e3][_0x2ef8d6(0x25d)]['Email']);_0xf350cb==''&&(_0xf350cb=GetUserId(_0x476d61[_0x4fd1e3][_0x2ef8d6(0x1f6)][_0x2ef8d6(0x209)]('|')[0x2])),_0xaedab4['push'](_0xf350cb),UserListId[_0x2ef8d6(0x1e7)](_0xf350cb);}var _0x669a37=ClientInternalMembers[_0x2ef8d6(0x176)](function(_0x173500){var _0x464ea6=_0x2ef8d6;return _0x173500[_0x464ea6(0x21c)]==$('#txtAddOrganization')[_0x464ea6(0x1e3)]();});_0x3c0e21=SPClientPeoplePicker['SPClientPeoplePickerDict'][peoplePickerDivsuper[0x0]['id']],_0x476d61=_0x3c0e21[_0x2ef8d6(0x187)]();var _0x2eacc2=GetUserId(_0x476d61[0x0]['EntityData'][_0x2ef8d6(0xfd)]);_0x2eacc2==''&&(_0x2eacc2=GetUserId(_0x476d61[0x0]['Key'][_0x2ef8d6(0x209)]('|')[0x2]));UserListId[_0x2ef8d6(0x1e7)](_0x2eacc2),_0x4af5c6=GetUserEmail($('#txtExtEmail')['val']()),UserListId[_0x2ef8d6(0x1e7)](_0x4af5c6),GuestUserEmail=$('#txtExtEmail')[_0x2ef8d6(0x1e3)](),DocumentLibraryUrl=_spPageContextInfo[_0x2ef8d6(0x148)]+_0x2ef8d6(0x109)+$('#txtAddOrganization')[_0x2ef8d6(0x1e3)]()[_0x2ef8d6(0x1f3)]()[_0x2ef8d6(0x248)](/[^0-9A-Z]+/gi,'')+_0x2ef8d6(0x156);_0x4af5c6==''&&(GetGroupIDByGroupName(),AddUserinSharePointGroup($(_0x2ef8d6(0xf6))[_0x2ef8d6(0x1e3)](),GroupId));var _0xc20a5b,_0x272786=GetItemTypeForListName(_0x10e2d8);_0xc20a5b={'__metadata':{'type':_0x272786},'Designation':$(_0x2ef8d6(0x266))[_0x2ef8d6(0x1e3)](),'LoginNameId':_0x4af5c6,'Supervisor_GuestId':_0x4af5c6,'Organization':$(_0x2ef8d6(0x20f))[_0x2ef8d6(0x1e3)](),'ReferenceCode':$(_0x2ef8d6(0x205))[_0x2ef8d6(0x1e3)](),'TemplateType':$(_0x2ef8d6(0x232),$(_0x2ef8d6(0x20d)))[_0x2ef8d6(0x1e3)](),'InternalStakeholdersId':{'results':_0xaedab4},'SupervisorId':_0x2eacc2,'ValidUpto':$('#datepickerAD5')[_0x2ef8d6(0x1e3)](),'CollaborationType':$(_0x2ef8d6(0x232),$('#selectByUser'))[_0x2ef8d6(0x1e3)](),'Status':$(_0x2ef8d6(0x232),$(_0x2ef8d6(0xfb)))[_0x2ef8d6(0x1e3)](),'DocumentLibrary':DocumentLibraryUrl};var _0x52dfe=$['Deferred']();return $[_0x2ef8d6(0x118)]({'url':_spPageContextInfo[_0x2ef8d6(0x148)]+_0x2ef8d6(0x1d1)+_0x10e2d8+_0x2ef8d6(0x227)+_0x23ca5f+')','type':_0x2ef8d6(0x12a),'async':![],'headers':{'accept':'application/json;odata=verbose','X-RequestDigest':$(_0x2ef8d6(0x204))['val'](),'content-Type':_0x2ef8d6(0x286),'IF-MATCH':'*','X-HTTP-Method':'MERGE'},'data':JSON['stringify'](_0xc20a5b),'success':function(_0x443519){var _0x1352ff=_0x2ef8d6;if(document['getElementById'](_0x1352ff(0x1ee))[_0x1352ff(0x1f5)][_0x1352ff(0x1df)]===0x0){}else UploadAttachement(ExtrnaluserId);IsExistOrNotLibrary($(_0x1352ff(0x20f))[_0x1352ff(0x1e3)]()[_0x1352ff(0x1f3)]()['replace'](/[^0-9A-Z]+/gi,''))?AssignTheEditRole($(_0x1352ff(0x20f))[_0x1352ff(0x1e3)]()['trim']()['replace'](/[^0-9A-Z]+/gi,''),UserListId):(createNewLibraryByRest($(_0x1352ff(0x20f))[_0x1352ff(0x1e3)]()[_0x1352ff(0x1f3)]()[_0x1352ff(0x248)](/[^0-9A-Z]+/gi,'')),AssignTheEditRole($(_0x1352ff(0x20f))['val']()[_0x1352ff(0x1f3)]()[_0x1352ff(0x248)](/[^0-9A-Z]+/gi,''),UserListId));$(_0x1352ff(0x1d2))[_0x1352ff(0x1e3)]()==''&&UpdateClientMaster(_0x669a37[0x0]['ID'],_0x4af5c6);_0x669a37[0x0][_0x1352ff(0xff)]==null&&UpdateClientMasterDocLib(_0x669a37[0x0]['ID'],DocumentLibraryUrl,_0x2eacc2,_0xaedab4);createNewCustomColumn(),alert(_0x1352ff(0x1bb));for(var _0x1bc8c3 in htmlGridarray){if(htmlGridarray[_0x1bc8c3]['ID']==ExtrnaluserId){htmlGridarray[_0x1bc8c3][_0x1352ff(0x106)]='Active',htmlGridarray[_0x1bc8c3][_0x1352ff(0x13e)]='';break;}}GenerateGridHtml(htmlGridarray);},'error':function(_0x193ec9){var _0x526bad=_0x2ef8d6;console['log'](JSON[_0x526bad(0x27c)](_0x193ec9)),_0x52dfe[_0x526bad(0x27e)](_0x193ec9);}}),_0x52dfe[_0x2ef8d6(0x23b)]();}function UploadAttachement(_0x568c23){var _0x5ad5ee=a0_0x5ba68b;try{if(document['getElementById'](_0x5ad5ee(0x1ee))['files'][_0x5ad5ee(0x1df)]===0x0){}else{var _0x1dd258=_0x568c23,_0x5dd1f7=$(_0x5ad5ee(0x18b)),_0x2f26a3=_0x5dd1f7[0x0][_0x5ad5ee(0x1f5)]['length'],_0x35c3b6=[],_0x1fb0df=_0x5dd1f7[0x0][_0x5ad5ee(0x1f5)][0x0][_0x5ad5ee(0x293)];_0x1fb0df=_0x5dd1f7[0x0][_0x5ad5ee(0x1f5)][0x0][_0x5ad5ee(0x293)][_0x5ad5ee(0x248)](/[^a-zA-Z0-9-. ]/g,''),_0x1fb0df=_0x1fb0df[_0x5ad5ee(0x248)](/\s/g,'');for(var _0x48f74d=0x0;_0x48f74d<_0x2f26a3;_0x48f74d++){_0x35c3b6[_0x5ad5ee(0x1e7)](_0x5dd1f7[0x0]['files'][_0x48f74d]);}uploadFileSP('ExternalUsers',_0x1dd258,_0x35c3b6,_0x2f26a3,_0x1fb0df);}}catch(_0x5b26a2){alert(_0x5ad5ee(0x1e0));}}function uploadFileSP(_0x186be1,_0x5cc792,_0x91de5d,_0x1d33bb,_0x133145){var _0x5d866d=a0_0x5ba68b,_0x28f2f1=0x0,_0x34cb37=$[_0x5d866d(0x1af)](),_0x5004e7='',_0x3c6072=_0x91de5d[0x0],_0x4b84c7=getFileBuffer(_0x3c6072);return _0x4b84c7[_0x5d866d(0x20e)](function(_0x24a247,_0x4de6a3,_0x3f2e9d){var _0x5623b8=_0x5d866d,_0x1a8ebe=new Uint8Array(_0x24a247),_0xa8f6f6=new SP[(_0x5623b8(0x10d))](),_0x3f0348=_spPageContextInfo[_0x5623b8(0x148)]+_0x5623b8(0x104)+_0x186be1+_0x5623b8(0x227)+_0x5cc792+_0x5623b8(0x28e)+_0x133145+'\x27)',_0xf748ef=0x0;$[_0x5623b8(0x118)]({'url':_0x3f0348,'type':'POST','processData':![],'contentType':_0x5623b8(0x286),'data':_0x24a247,'headers':{'accept':_0x5623b8(0x286),'X-RequestDigest':$(_0x5623b8(0x204))[_0x5623b8(0x1e3)](),'content-length':_0x24a247[_0x5623b8(0x202)]},'success':function(_0xa72515){var _0x3eb611=_0x5623b8;_0x28f2f1++,_0x5004e7=_0x28f2f1,_0x91de5d[_0x3eb611(0x1f1)]();if(_0x91de5d[_0x3eb611(0x1df)]>0x0)uploadFileSP(_0x3eb611(0x131),_0x5cc792,_0x91de5d,_0x91de5d[_0x3eb611(0x1df)]);else{}},'error':function(_0xbe6a89){var _0x3cb9cf=_0x5623b8;alert(_0x3cb9cf(0x13b));}}),_0x34cb37['resolve'](_0x5004e7);}),_0x4b84c7['fail'](function(_0x4afbc5){var _0x36b738=_0x5d866d;_0x34cb37[_0x36b738(0x27e)](_0x4afbc5);}),_0x34cb37[_0x5d866d(0x23b)]();}function GetUserId(_0x2b0dae){var _0x1cffec=a0_0x5ba68b,_0x275597='',_0x4c4c80=_0x1cffec(0x16c),_0x4cfd75=_spPageContextInfo['siteAbsoluteUrl'],_0x5e1a98=_0x4c4c80+_0x2b0dae;return $['ajax']({'url':_0x4cfd75+_0x1cffec(0x1b8)+encodeURIComponent(_0x5e1a98)+'\x27','method':'GET','headers':{'Accept':'application/json;\x20odata=verbose'},'async':![],'success':function(_0x544c8a){_0x275597=_0x544c8a['d']['Id'];},'error':function(_0x23941d){var _0x10c40d=_0x1cffec;console[_0x10c40d(0x27a)](JSON[_0x10c40d(0x27c)](_0x23941d)),console[_0x10c40d(0x27a)](JSON[_0x10c40d(0x27c)](_0x10c40d(0x165)+_0x2b0dae));}}),_0x275597;}function GetUserEmail(_0x50f4af){var _0xe63ba4=a0_0x5ba68b,_0x36a60='',_0x5d9cea=_spPageContextInfo[_0xe63ba4(0x288)];return $[_0xe63ba4(0x118)]({'url':_0x5d9cea+'/_api/web/siteusers/getbyemail(\x27'+_0x50f4af+'\x27)','method':_0xe63ba4(0x18e),'headers':{'Accept':_0xe63ba4(0x241)},'async':![],'success':function(_0x3a58e6){_0x36a60=_0x3a58e6['d']['Id'];},'error':function(_0x2d6f6c){var _0x321bdb=_0xe63ba4;console[_0x321bdb(0x27a)](JSON[_0x321bdb(0x27c)](_0x2d6f6c)),console['log'](JSON[_0x321bdb(0x27c)]('This\x20user:-'+_0x50f4af));}}),_0x36a60;}function createNewLibraryByRest(_0x59e207){var _0x4f0da2=a0_0x5ba68b,_0x5a0c87=_0x59e207,_0x12c38c=_spPageContextInfo[_0x4f0da2(0x148)]+_0x4f0da2(0x125);$['ajax']({'url':_0x12c38c,'method':'POST','async':![],'data':JSON[_0x4f0da2(0x27c)]({'__metadata':{'type':_0x4f0da2(0x1b7)},'AllowContentTypes':!![],'BaseTemplate':0x65,'ContentTypesEnabled':!![],'Description':_0x4f0da2(0x25e),'OnQuickLaunch':!![],'Title':_0x59e207}),'headers':{'content-type':_0x4f0da2(0x286),'X-RequestDigest':$(_0x4f0da2(0x204))[_0x4f0da2(0x1e3)]()},'success':function(_0x1b2fd5){BreakRoleInheritance(_0x5a0c87);},'error':function(_0x499fef){var _0x4a1b2b=_0x4f0da2;alert(_0x499fef[_0x4a1b2b(0x135)]);}});}function BreakRoleInheritance(_0x3c80f0){var _0x43b066=a0_0x5ba68b;url=_spPageContextInfo[_0x43b066(0x148)]+_0x43b066(0x1d6)+_0x3c80f0+_0x43b066(0x17d),$[_0x43b066(0x118)]({'url':url,'type':'POST','async':![],'headers':{'accept':_0x43b066(0x158),'X-RequestDigest':$(_0x43b066(0x204))[_0x43b066(0x1e3)]()},'success':function(_0x3d3e4a){var _0x531f1f=_0x43b066;console[_0x531f1f(0x27a)](_0x3d3e4a);},'error':function(_0x373375){var _0x24efdc=_0x43b066;console[_0x24efdc(0x27a)](_0x373375);}});}function AssignTheEditRole(_0x2703b9,_0x1bedf8){var _0x1891bf=a0_0x5ba68b;for(var _0x10ed9a=0x0;_0x10ed9a<_0x1bedf8[_0x1891bf(0x1df)];_0x10ed9a++){url=_spPageContextInfo['webAbsoluteUrl']+_0x1891bf(0x1d6)+_0x2703b9+_0x1891bf(0x282)+_0x1bedf8[_0x10ed9a]+'\x27,roledefid=\x271073741830\x27)',$['ajax']({'url':url,'type':_0x1891bf(0x12a),'async':![],'headers':{'accept':_0x1891bf(0x158),'X-RequestDigest':$(_0x1891bf(0x204))[_0x1891bf(0x1e3)]()},'success':function(_0x56aeb0){var _0x3c5607=_0x1891bf;console[_0x3c5607(0x27a)](_0x56aeb0);},'error':function(_0x507403){console['log'](_0x507403);}});}}function IsExistOrNotLibrary(_0x302490){var _0x119759=a0_0x5ba68b,_0x348cc5='';return url=_spPageContextInfo[_0x119759(0x148)]+_0x119759(0x25c)+_0x302490+'\x27',$[_0x119759(0x118)]({'url':url,'type':'get','async':![],'headers':{'accept':_0x119759(0x158),'X-RequestDigest':$('#__REQUESTDIGEST')[_0x119759(0x1e3)]()},'success':function(_0x5b82e7){var _0x1728af=_0x119759;_0x5b82e7[_0x1728af(0x122)][_0x1728af(0x1df)]>0x0?_0x348cc5=!![]:_0x348cc5=![],console[_0x1728af(0x27a)](_0x5b82e7);},'error':function(_0x1914a4){console['log'](_0x1914a4);}}),_0x348cc5;}function addSpinner(_0x2f219e,_0x4f0883){var _0x1038fe=a0_0x5ba68b,_0x4b9fdd=_0x2f219e[_0x1038fe(0x1d9)](_0x1038fe(0x1b3));if(_0x4b9fdd[_0x1038fe(0x1df)]&&!_0x4b9fdd[_0x1038fe(0x277)]('spinner-remove'))return null;!_0x4b9fdd[_0x1038fe(0x1df)]&&(_0x4b9fdd=$(_0x1038fe(0x169)+(_0x4f0883?'':_0x1038fe(0x1b6))+'\x22/>')[_0x1038fe(0x24b)](_0x2f219e)),animateSpinner(_0x4b9fdd,'add');}function removeSpinner(_0x5474b0,_0x465cea){var _0x58d9e3=a0_0x5ba68b,_0x1fb586=_0x5474b0['children'](_0x58d9e3(0x1b3));_0x1fb586[_0x58d9e3(0x1df)]&&animateSpinner(_0x1fb586,'remove',_0x465cea);}function animateSpinner(_0xf39053,_0x312c88,_0x1106c5){var _0x4fa9f1=a0_0x5ba68b;_0xf39053[_0x4fa9f1(0x27b)]('animating')&&(_0xf39053[_0x4fa9f1(0x20a)](_0xf39053[_0x4fa9f1(0x27b)](_0x4fa9f1(0x141)))[_0x4fa9f1(0x27b)](_0x4fa9f1(0x141),null),_0xf39053[_0x4fa9f1(0x27b)](_0x4fa9f1(0x218))&&clearTimeout(_0xf39053[_0x4fa9f1(0x27b)](_0x4fa9f1(0x218)))),_0xf39053[_0x4fa9f1(0x256)](_0x4fa9f1(0x1fb)+_0x312c88)[_0x4fa9f1(0x27b)](_0x4fa9f1(0x141),_0x4fa9f1(0x1fb)+_0x312c88),_0xf39053['data'](_0x4fa9f1(0x218),setTimeout(function(){var _0x105d13=_0x4fa9f1;_0x312c88==_0x105d13(0x193)&&_0xf39053[_0x105d13(0x193)](),_0x1106c5&&_0x1106c5();},parseFloat(_0xf39053[_0x4fa9f1(0x26a)]('animation-duration'))*0x3e8));}function getTemplate(){var _0x3065ee=a0_0x5ba68b,_0x342cfe,_0x3c6eee=_0x3065ee(0x281),_0x6c04bd,_0x223e62=$(_0x3065ee(0x26e))['text']();_0x6c04bd=$('#TemplateType\x20option:selected')['val'](),$(_0x3065ee(0x1ba))[_0x3065ee(0x188)](),$('#CustomName')[_0x3065ee(0x188)](),$(_0x3065ee(0x25b))[_0x3065ee(0x188)](),_0x223e62!=''?_0x342cfe=_spPageContextInfo[_0x3065ee(0x148)]+_0x3065ee(0x1e8)+_0x6c04bd+_0x3065ee(0x1bf):_0x342cfe=_spPageContextInfo[_0x3065ee(0x148)]+_0x3065ee(0x171),$['ajax']({'url':_0x342cfe,'headers':{'Accept':_0x3065ee(0x286)},'async':![],'success':function(_0x394f7f){var _0x4b9a4a=_0x3065ee,_0x6bf2ba=_0x394f7f['d']['results'];for(var _0x39f14a=0x0;_0x39f14a<_0x6bf2ba[_0x4b9a4a(0x1df)];_0x39f14a++){$(_0x4b9a4a(0x1ba))[_0x4b9a4a(0x26b)](_0x6bf2ba[_0x39f14a][_0x4b9a4a(0x21c)]),$(_0x4b9a4a(0x28c))[_0x4b9a4a(0x26b)](_0x6bf2ba[_0x39f14a][_0x4b9a4a(0x2a9)]),$(_0x4b9a4a(0x25b))[_0x4b9a4a(0x26b)](_0x6bf2ba[_0x39f14a][_0x4b9a4a(0x25e)]);var _0x2dde40=$(_0x4b9a4a(0x11b));_0x223e62!=''&&_0x2dde40[_0x4b9a4a(0x127)](_0x4b9a4a(0x1e6),_0x6bf2ba[0x0][_0x4b9a4a(0x269)][_0x4b9a4a(0x1dc)][0x0]['ServerRelativeUrl']),_0x223e62==''&&$(_0x4b9a4a(0x20d))['append']($('<option/>')['val'](_0x6bf2ba[_0x39f14a][_0x4b9a4a(0x21c)])[_0x4b9a4a(0x162)](_0x6bf2ba[_0x39f14a][_0x4b9a4a(0x2a9)]));}},'error':function(_0x3b54e9){var _0x25ebe9=_0x3065ee;console[_0x25ebe9(0x27a)](_0x3b54e9);}});}function createNewCustomColumn(){var _0x2a4c3b=a0_0x5ba68b,_0x450b9b=$(_0x2a4c3b(0x20f))['val']()[_0x2a4c3b(0x1f3)]()[_0x2a4c3b(0x248)](/[^0-9A-Z]+/gi,''),_0x21454c=_spPageContextInfo[_0x2a4c3b(0x148)]+_0x2a4c3b(0x14e);for(var _0x720245=0x0;_0x720245<arrMeta[_0x2a4c3b(0x1df)];_0x720245++){var _0x3a55c2,_0x5cb182='';GetAllFieldsFromList(_0x21454c,_0x450b9b,arrMeta[_0x720245][_0x2a4c3b(0x21c)]),_0x5cb182=_0x21454c+_0x2a4c3b(0x2a4)+_0x450b9b+_0x2a4c3b(0x20c),arrMeta[_0x720245][_0x2a4c3b(0x245)]==0x6?arrMeta[_0x720245][_0x2a4c3b(0x21c)]==_0x2a4c3b(0x12f)?_0x3a55c2={'__metadata':{'type':'SP.FieldChoice','addToDefaultView':_0x2a4c3b(0x236)},'FieldTypeKind':arrMeta[_0x720245][_0x2a4c3b(0x245)],'Title':arrMeta[_0x720245][_0x2a4c3b(0x21c)],'Choices':{'results':[_0x2a4c3b(0x250),'Not\x20Required',_0x2a4c3b(0x1d0)]}}:_0x3a55c2={'__metadata':{'type':_0x2a4c3b(0x12d),'addToDefaultView':_0x2a4c3b(0x236)},'FieldTypeKind':arrMeta[_0x720245][_0x2a4c3b(0x245)],'Title':arrMeta[_0x720245][_0x2a4c3b(0x21c)],'Choices':{'results':['Draft','Approved',_0x2a4c3b(0x252),_0x2a4c3b(0x216)]}}:arrMeta[_0x720245][_0x2a4c3b(0x245)]!=0x7&&(_0x3a55c2={'__metadata':{'type':'SP.Field','addToDefaultView':_0x2a4c3b(0x236)},'FieldTypeKind':arrMeta[_0x720245][_0x2a4c3b(0x245)],'Title':arrMeta[_0x720245][_0x2a4c3b(0x21c)]}),arrMeta[_0x720245][_0x2a4c3b(0x21c)]==_0x2a4c3b(0x1a0)&&(_0x5cb182=_0x21454c+_0x2a4c3b(0x2a4)+_0x450b9b+_0x2a4c3b(0x20c),_0x3a55c2={'__metadata':{'type':_0x2a4c3b(0x200),'addToDefaultView':_0x2a4c3b(0x236)},'FieldTypeKind':arrMeta[_0x720245]['FieldTypeKind'],'Title':arrMeta[_0x720245][_0x2a4c3b(0x21c)],'AllowMultipleValues':!![]}),arrMeta[_0x720245][_0x2a4c3b(0x21c)]=='Shared\x20With'&&(_0x5cb182=_0x21454c+_0x2a4c3b(0x2a4)+_0x450b9b+_0x2a4c3b(0x20c),_0x3a55c2={'__metadata':{'type':'SP.FieldUser','addToDefaultView':_0x2a4c3b(0x236)},'FieldTypeKind':arrMeta[_0x720245][_0x2a4c3b(0x245)],'Title':arrMeta[_0x720245][_0x2a4c3b(0x21c)]}),arrMeta[_0x720245][_0x2a4c3b(0x21c)]==_0x2a4c3b(0x1cd)&&(_0x5cb182=_0x21454c+'/_api/web/lists/getByTitle(\x27'+_0x450b9b+_0x2a4c3b(0x20c),_0x3a55c2={'__metadata':{'type':'SP.FieldDateTime'},'FieldTypeKind':arrMeta[_0x720245][_0x2a4c3b(0x245)],'Title':arrMeta[_0x720245][_0x2a4c3b(0x21c)],'DisplayFormat':0x0}),arrMeta[_0x720245][_0x2a4c3b(0x21c)]=='email_date'&&(_0x5cb182=_0x21454c+_0x2a4c3b(0x2a4)+_0x450b9b+_0x2a4c3b(0x20c),_0x3a55c2={'__metadata':{'type':'SP.FieldDateTime'},'FieldTypeKind':arrMeta[_0x720245]['FieldTypeKind'],'Title':arrMeta[_0x720245][_0x2a4c3b(0x21c)],'DisplayFormat':0x0}),arrMeta[_0x720245][_0x2a4c3b(0x21c)]==_0x2a4c3b(0x220)&&(_0x5cb182=_0x21454c+_0x2a4c3b(0x2a4)+_0x450b9b+'\x27)/fields',_0x3a55c2={'__metadata':{'type':_0x2a4c3b(0x1c3)},'FieldTypeKind':arrMeta[_0x720245][_0x2a4c3b(0x245)],'Title':arrMeta[_0x720245][_0x2a4c3b(0x21c)],'DisplayFormat':0x0}),arrMeta[_0x720245]['Title']==_0x2a4c3b(0x19a)&&(_0x5cb182=_0x21454c+_0x2a4c3b(0x2a4)+_0x450b9b+'\x27)/fields',_0x3a55c2={'__metadata':{'type':_0x2a4c3b(0x200),'addToDefaultView':_0x2a4c3b(0x236)},'FieldTypeKind':arrMeta[_0x720245][_0x2a4c3b(0x245)],'Title':arrMeta[_0x720245]['Title'],'SelectionMode':0x0}),$[_0x2a4c3b(0x118)]({'url':_0x5cb182,'type':_0x2a4c3b(0x12a),'async':![],'data':JSON[_0x2a4c3b(0x27c)](_0x3a55c2),'headers':{'Accept':_0x2a4c3b(0x286),'Content-Type':'application/json;odata=verbose','X-RequestDigest':$(_0x2a4c3b(0x204))[_0x2a4c3b(0x1e3)]()},'success':function(_0x16fb19,_0x51e8d2,_0x22e30e){var _0x27ad77=_0x2a4c3b;console['log'](_0x27ad77(0x203));},'error':function(_0x1e2f6b,_0x5aea31,_0x2e2d54){var _0x2d58e7=_0x2a4c3b;console[_0x2d58e7(0x27a)](_0x2d58e7(0x2a2));}});}}function GetAllFieldsFromList(_0x390315,_0x3cf64c,_0xb861a3){var _0x4117a0=a0_0x5ba68b;arrColumn='',$['ajax']({'url':_0x390315+_0x4117a0(0x2a4)+_0x3cf64c+_0x4117a0(0x1b2)+_0xb861a3+'\x27','method':_0x4117a0(0x18e),'async':![],'headers':{'Accept':_0x4117a0(0x286)},'success':function(_0x5c1a71,_0x458afd,_0x3231c6){var _0x38cfec=_0x4117a0,_0x4f6ce9=_0x5c1a71['d'][_0x38cfec(0x1dc)];if(_0x4f6ce9[_0x38cfec(0x1df)]>0x0)for(var _0x2817ca=0x0;_0x2817ca<_0x4f6ce9[_0x38cfec(0x1df)];_0x2817ca++){ColumnTitle=_0x4f6ce9[_0x2817ca][_0x38cfec(0x21c)],DeleteListColumn(_0x390315,ColumnTitle,_0x3cf64c);}},'error':function(_0x39b0b2,_0x2ae789,_0x1a8559){alert(_0x39b0b2);}});}function DeleteListColumn(_0x5665c8,_0x13cbc1,_0x110e37){var _0x5a91f5=a0_0x5ba68b;$['ajax']({'url':_0x5665c8+'/_api/web/lists/getByTitle(\x27'+_0x110e37+_0x5a91f5(0x170)+_0x13cbc1+'\x27)','type':_0x5a91f5(0x12a),'async':![],'headers':{'Accept':_0x5a91f5(0x286),'Content-Type':_0x5a91f5(0x286),'IF-MATCH':'*','X-HTTP-Method':_0x5a91f5(0x199),'X-RequestDigest':$('#__REQUESTDIGEST')['val']()},'success':function(_0xebff61,_0x1023a8,_0x672f5e){var _0x564a2d=_0x5a91f5;console['log'](_0x564a2d(0x215)+_0x13cbc1);},'error':function(_0x1a80de,_0x443b18,_0x5e6477){var _0xa07f09=_0x5a91f5;console[_0xa07f09(0x27a)]('Failed');}});}var arrMeta=[{'FieldTypeKind':0x2,'Title':'DocumentNo'},{'FieldTypeKind':0x2,'Title':a0_0x5ba68b(0x247)},{'FieldTypeKind':0x2,'Title':a0_0x5ba68b(0x1ae)},{'FieldTypeKind':0x3,'Title':'Details'},{'FieldTypeKind':0x3,'Title':a0_0x5ba68b(0xf9)},{'FieldTypeKind':0x14,'Title':a0_0x5ba68b(0x1a0)},{'FieldTypeKind':0x2,'Title':'SubCategory'},{'FieldTypeKind':0x9,'Title':a0_0x5ba68b(0x15a)},{'FieldTypeKind':0x14,'Title':a0_0x5ba68b(0x22c)},{'FieldTypeKind':0x2,'Title':a0_0x5ba68b(0x298)},{'FieldTypeKind':0x2,'Title':a0_0x5ba68b(0x197)},{'FieldTypeKind':0x2,'Title':a0_0x5ba68b(0x137)},{'FieldTypeKind':0x2,'Title':a0_0x5ba68b(0x18a)},{'FieldTypeKind':0x6,'Title':a0_0x5ba68b(0x12f)},{'FieldTypeKind':0x2,'Title':a0_0x5ba68b(0x1be)},{'FieldTypeKind':0x14,'Title':a0_0x5ba68b(0x19a)},{'FieldTypeKind':0x4,'Title':'ApprovedDate'},{'FieldTypeKind':0x4,'Title':a0_0x5ba68b(0x220)},{'FieldTypeKind':0x4,'Title':a0_0x5ba68b(0xfa)},{'FieldTypeKind':0x2,'Title':a0_0x5ba68b(0x1f7)},{'FieldTypeKind':0x2,'Title':'ApprovedByOutsider'}];function GetAvailbleLicence(){var _0x4ff697=a0_0x5ba68b,_0x1d9098='',_0x32b7d1=_0x4ff697(0x1da);dfds=$['Deferred'](),extdfds=$[_0x4ff697(0x1af)]();var _0x438997='',_0x425e45,_0x17e331;return url=_spPageContextInfo[_0x4ff697(0x148)]+_0x4ff697(0x13c)+_0x32b7d1,$['when'](getItems(url,dfds))[_0x4ff697(0x20e)](function(_0x28558b){var _0x2f58df=_0x4ff697;response=[],_0x425e45=_0x28558b[_0x2f58df(0x1df)];var _0x686227=_spPageContextInfo['webAbsoluteUrl']+'/_api/web/lists/getbytitle(\x27ExternalUsers\x27)/items?$select=*,InternalStakeholders/Title,Supervisor_Guest/Title,Client_Name/Title,LoginName/Title\x20&$expand=\x20LoginName,Client_Name,Supervisor_Guest,InternalStakeholders\x20&$filter=(ValidUpto\x20ge\x20\x27'+new Date()[_0x2f58df(0x194)]()+_0x2f58df(0x18f);$[_0x2f58df(0x240)](getItems(_0x686227,extdfds))['done'](function(_0x5914b9){var _0x340b13=_0x2f58df;response=[],_0x17e331=_0x5914b9[_0x340b13(0x1df)];}),_0x438997=parseInt(_0x425e45)+parseInt(_0x17e331),_0x1d9098=parseInt(UsersLicenceRequired)-parseInt(_0x438997);}),_0x1d9098;}var response=response||[];function getItems(_0x3c1382,_0x3d3b09){var _0x2a09d1=a0_0x5ba68b;return $['ajax']({'url':_0x3c1382,'type':_0x2a09d1(0x18e),'async':![],'headers':{'accept':_0x2a09d1(0x286)},'success':function(_0x2ed428){var _0x3c80b0=_0x2a09d1;response=response[_0x3c80b0(0x18c)](_0x2ed428['d'][_0x3c80b0(0x1dc)]),_0x2ed428['d'][_0x3c80b0(0x23a)]?(_0x3c1382=_0x2ed428['d'][_0x3c80b0(0x23a)],getItems(_0x3c1382,_0x3d3b09)):_0x3d3b09[_0x3c80b0(0x1d4)](response);},'error':function(_0x2c94ed){var _0xb425b2=_0x2a09d1;_0x3d3b09[_0xb425b2(0x27e)](_0x2c94ed),console[_0xb425b2(0x27a)](_0x2c94ed);}}),_0x3d3b09['promise']();}