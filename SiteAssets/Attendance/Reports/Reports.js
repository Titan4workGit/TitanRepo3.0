var a0_0x38192b=a0_0x26fa;(function(_0x42f09b,_0x55c15b){var _0x240507=a0_0x26fa,_0x25f567=_0x42f09b();while(!![]){try{var _0xa19465=-parseInt(_0x240507(0xcc))/0x1+-parseInt(_0x240507(0x14f))/0x2*(parseInt(_0x240507(0xcf))/0x3)+parseInt(_0x240507(0xcb))/0x4*(-parseInt(_0x240507(0x12f))/0x5)+-parseInt(_0x240507(0xa8))/0x6*(-parseInt(_0x240507(0x100))/0x7)+parseInt(_0x240507(0xf1))/0x8+parseInt(_0x240507(0xb8))/0x9+parseInt(_0x240507(0x117))/0xa*(parseInt(_0x240507(0xa3))/0xb);if(_0xa19465===_0x55c15b)break;else _0x25f567['push'](_0x25f567['shift']());}catch(_0x4e467e){_0x25f567['push'](_0x25f567['shift']());}}}(a0_0x1aea,0x6d4b8));var GCompanyId='',GOfficeDays='';$(document)[a0_0x38192b(0xa9)](function(){var _0xe9b62d=a0_0x38192b;userActivityNotificationEntry(_spPageContextInfo[_0xe9b62d(0xbe)],window[_0xe9b62d(0xb2)]),authentication(),GCompanyId=titanForWork['getQueryStringParameter']('CompanyId'),$(_0xe9b62d(0x14a))['datepicker']({'dateFormat':'dd/mm/yy','maxDate':new Date()})[_0xe9b62d(0xf4)](_0xe9b62d(0x10a),new Date()),$(_0xe9b62d(0x108))[_0xe9b62d(0xf4)]({'dateFormat':'dd/mm/yy'})[_0xe9b62d(0xf4)]('setDate','-7d'),$(_0xe9b62d(0x124))[_0xe9b62d(0x104)](formatDateReport(ConvertDateTimeFormat($('#attendance-reportFrom')['val'](),'/'))),$('#ToDate')[_0xe9b62d(0x104)](formatDateReport(ConvertDateTimeFormat($(_0xe9b62d(0x14a))[_0xe9b62d(0xb1)](),'/')));var _0x5a6459=$('#attendance-reportFrom')[_0xe9b62d(0xf4)](_0xe9b62d(0x125)),_0x582370=$(_0xe9b62d(0x14a))[_0xe9b62d(0xf4)](_0xe9b62d(0x125));days=(_0x582370-_0x5a6459)/(0x3e8*0x3c*0x3c*0x18);var _0x55fab4=Math[_0xe9b62d(0xe1)](days);GOfficeDays=Math[_0xe9b62d(0xe1)](days),LoadAllOfficeLocation(),LoadAllDepartment(),LoadAllHolidays(),$(_0xe9b62d(0x120))[_0xe9b62d(0x104)]($(_0xe9b62d(0xb6))[_0xe9b62d(0x104)]()),initializePeoplePicker('Manager'),initializePeoplePicker(_0xe9b62d(0x15a)),$('#attendance-report-filter')['modal'](_0xe9b62d(0x130));});function initializePeoplePicker(_0x4431ed){var _0x32fca7=a0_0x38192b,_0x11f382={};_0x11f382[_0x32fca7(0x121)]=_0x32fca7(0x14e),_0x11f382[_0x32fca7(0x114)]=0xf,_0x11f382[_0x32fca7(0xd1)]=0xf,_0x11f382[_0x32fca7(0x101)]=![],_0x11f382[_0x32fca7(0x15d)]=0x32,_0x11f382[_0x32fca7(0x15b)]=_0x32fca7(0x135),this[_0x32fca7(0x10c)](_0x4431ed,null,_0x11f382);}function ensureUser(_0x11cd44){var _0x5f2a9b=a0_0x38192b,_0x19d29d=0x0,_0x34cd2a=_0x11cd44,_0x3c9d19=this[_0x5f2a9b(0xfc)][_0x5f2a9b(0x107)][_0x34cd2a],_0x356fc9=_0x3c9d19['GetAllUserInfo'](),_0x35c600=_0x356fc9[0x0];if(_0x35c600){var _0x58d6fe={'logonName':_0x35c600[_0x5f2a9b(0xd0)]};$[_0x5f2a9b(0xef)]({'url':_spPageContextInfo[_0x5f2a9b(0xa0)]+'/_api/web/ensureuser','type':_0x5f2a9b(0xaa),'async':![],'contentType':_0x5f2a9b(0xfd),'data':JSON[_0x5f2a9b(0x145)](_0x58d6fe),'headers':{'X-RequestDigest':$(_0x5f2a9b(0x14b))[_0x5f2a9b(0xb1)](),'accept':'application/json;odata=verbose'},'success':function(_0xc12343,_0x262963,_0x4ae6f5){_0x19d29d=_0xc12343['d']['Id'];},'error':function(_0x5f4014,_0x28fd37,_0x476f1c){}});}else _0x19d29d=0x0;return _0x19d29d;}function GetUserTitle(_0x471e9c){var _0x20903a=a0_0x38192b,_0x1efd26=0x0,_0xea7303=_0x471e9c,_0x1a4329=this[_0x20903a(0xfc)][_0x20903a(0x107)][_0xea7303],_0x46672c=_0x1a4329[_0x20903a(0xa2)](),_0x50a371=_0x46672c[0x0];if(_0x50a371){var _0x26b9c4={'logonName':_0x50a371[_0x20903a(0xd0)]};$[_0x20903a(0xef)]({'url':_spPageContextInfo[_0x20903a(0xa0)]+_0x20903a(0x11e),'type':_0x20903a(0xaa),'async':![],'contentType':_0x20903a(0xfd),'data':JSON['stringify'](_0x26b9c4),'headers':{'X-RequestDigest':$(_0x20903a(0x14b))[_0x20903a(0xb1)](),'accept':'application/json;odata=verbose'},'success':function(_0x107700,_0x38a4c8,_0x181f12){var _0x5caebf=_0x20903a;_0x1efd26=_0x107700['d'][_0x5caebf(0xd7)];},'error':function(_0x4e4d29,_0x582108,_0x81e55f){}});}else _0x1efd26=0x0;return _0x1efd26;}function ConvertDateTimeFormat(_0xce1f38,_0x412050){var _0x53e52d=a0_0x38192b;return _0xce1f38[_0x53e52d(0x10f)](_0x412050)[0x1]+''+_0x412050+''+_0xce1f38[_0x53e52d(0x10f)](_0x412050)[0x0]+''+_0x412050+''+_0xce1f38[_0x53e52d(0x10f)](_0x412050)[0x2];}function formatDateReport(_0x5dfda9){var _0x360553=a0_0x38192b,_0x4cf9ff=new Date(_0x5dfda9);if(isNaN(_0x4cf9ff[_0x360553(0x146)]()))return _0x5dfda9;else{var _0x400559=new Array();return _0x400559[0x0]=_0x360553(0xe8),_0x400559[0x1]=_0x360553(0x102),_0x400559[0x2]='Mar',_0x400559[0x3]='Apr',_0x400559[0x4]='May',_0x400559[0x5]=_0x360553(0x139),_0x400559[0x6]=_0x360553(0x123),_0x400559[0x7]='Aug',_0x400559[0x8]=_0x360553(0xf7),_0x400559[0x9]='Oct',_0x400559[0xa]=_0x360553(0x112),_0x400559[0xb]=_0x360553(0x15e),day=_0x4cf9ff[_0x360553(0x125)](),day<0xa&&(day='0'+day),day+'\x20'+_0x400559[_0x4cf9ff['getMonth']()]+'\x20'+_0x4cf9ff['getFullYear']();}}function LoadAllOfficeLocation(){var _0x451edd=a0_0x38192b;$(_0x451edd(0x128))[_0x451edd(0xa5)]();var _0x4d878b=_spPageContextInfo[_0x451edd(0xa0)]+'/_api/web/lists/GetByTitle(\x27OfficeLocation\x27)/items?$select=ID,OfficeName,CompanyID/ID&$expand=CompanyID&$top=5000&$filter=CompanyID/ID\x20eq\x20\x27'+GCompanyId+_0x451edd(0x119);$['ajax']({'url':_0x4d878b,'headers':{'Accept':_0x451edd(0xfd)},'async':![],'success':function(_0x371048){var _0x53ed97=_0x451edd;for(var _0x2c68fb=0x0;_0x2c68fb<_0x371048['d'][_0x53ed97(0x113)][_0x53ed97(0xc5)];_0x2c68fb++){$(_0x53ed97(0x128))['append'](_0x53ed97(0xf9)+_0x371048['d'][_0x53ed97(0x113)][_0x2c68fb]['ID']+'\x22>'+_0x371048['d']['results'][_0x2c68fb][_0x53ed97(0x142)]+_0x53ed97(0xe9));}},'myError':function(_0x1bf746){}});}function LoadAllDepartment(){var _0x3dfdec=a0_0x38192b;$('#DepartmentDDL')[_0x3dfdec(0xa5)]();var _0x3e38c8=_spPageContextInfo[_0x3dfdec(0xa0)]+'/_api/web/lists/getbytitle(\x27Departments\x27)/items?select=ID,Title&$filter=CompanyID\x20eq\x20\x27'+GCompanyId+_0x3dfdec(0x13d);$['ajax']({'url':_0x3e38c8,'headers':{'Accept':'application/json;odata=verbose'},'async':!![],'success':function(_0x4c4998){var _0x3693e9=_0x3dfdec;$(_0x3693e9(0x122))[_0x3693e9(0x115)](_0x3693e9(0x133));for(var _0x469e9c=0x0;_0x469e9c<_0x4c4998['d'][_0x3693e9(0x113)]['length'];_0x469e9c++){$('#DepartmentDDL')[_0x3693e9(0x14d)](_0x3693e9(0xf9)+_0x4c4998['d'][_0x3693e9(0x113)][_0x469e9c]['ID']+'\x22>'+_0x4c4998['d'][_0x3693e9(0x113)][_0x469e9c][_0x3693e9(0xd7)]+'</option>');}},'myError':function(_0x183383){}});}var TotalOfficeDays=0x0,GtotalHolidays=0x0;function LoadAllHolidays(){var _0x26b2cd=a0_0x38192b,_0x1cd778=$('#OfficeLoc')[_0x26b2cd(0xb1)]();TotalOfficeDays=0x0,GtotalHolidays=0x0;var _0x3860fb=new Date(ConvertDateTimeFormat($(_0x26b2cd(0x108))[_0x26b2cd(0xb1)](),'/')),_0x521278=_0x3860fb[_0x26b2cd(0x13a)]()+'-'+(_0x3860fb[_0x26b2cd(0x14c)]()+0x1)+'-'+_0x3860fb['getDate'](),_0x31c474=new Date(ConvertDateTimeFormat($(_0x26b2cd(0x14a))[_0x26b2cd(0xb1)](),'/')),_0x2e8d08=_0x31c474[_0x26b2cd(0x13a)]()+'-'+(_0x31c474[_0x26b2cd(0x14c)]()+0x1)+'-'+_0x31c474[_0x26b2cd(0x125)](),_0x4179f0=_spPageContextInfo[_0x26b2cd(0xa0)]+'/_api/web/lists/getbytitle(\x27CompanyHoliday\x27)/items?select=*,ID,Title&$filter=OfficeLocationID\x20eq\x20\x27'+_0x1cd778+_0x26b2cd(0xdb)+GCompanyId+_0x26b2cd(0x11a)+_0x521278+_0x26b2cd(0x140)+_0x2e8d08+'\x27';$[_0x26b2cd(0xef)]({'url':_0x4179f0,'headers':{'Accept':_0x26b2cd(0xfd)},'async':![],'success':function(_0x3a6572){var _0x3a1ab1=_0x26b2cd,_0x23923d=_0x3a6572['d'][_0x3a1ab1(0x113)]['length'];GtotalHolidays=_0x23923d,$('#TotalHolidays')[_0x3a1ab1(0x104)](_0x23923d),$('#TotalOfficeDays')['text'](parseInt(GOfficeDays)-parseInt(_0x23923d)),TotalOfficeDays=parseInt(GOfficeDays)-parseInt(_0x23923d);},'myError':function(_0x2a97e){}});}function Applyfilter(){var _0x507a03=a0_0x38192b;$(_0x507a03(0x124))[_0x507a03(0x104)](formatDateReport(ConvertDateTimeFormat($(_0x507a03(0x108))[_0x507a03(0xb1)](),'/'))),$(_0x507a03(0xc6))['text'](formatDateReport(ConvertDateTimeFormat($(_0x507a03(0x14a))['val'](),'/'))),$(_0x507a03(0x120))[_0x507a03(0x104)]($(_0x507a03(0xb6))[_0x507a03(0x104)]()),$(_0x507a03(0x11b))[_0x507a03(0x104)](formatDateReport(ConvertDateTimeFormat($(_0x507a03(0x108))[_0x507a03(0xb1)](),'/'))),$(_0x507a03(0x11f))[_0x507a03(0x104)](formatDateReport(ConvertDateTimeFormat($(_0x507a03(0x14a))[_0x507a03(0xb1)](),'/'))),$('#officeLocTH')['text']($(_0x507a03(0xb6))['text']()),$('#TotalWorkdayTH')[_0x507a03(0x104)](TotalOfficeDays),$(_0x507a03(0xb0))[_0x507a03(0x104)](GtotalHolidays);var _0x18066b=$(_0x507a03(0x108))[_0x507a03(0xf4)]('getDate'),_0x155872=$('#attendance-reportTo')[_0x507a03(0xf4)](_0x507a03(0x125));days=(_0x155872-_0x18066b)/(0x3e8*0x3c*0x3c*0x18),GOfficeDays=Math[_0x507a03(0xe1)](days)+0x1,LoadAllHolidays(),$(_0x507a03(0x12e))[_0x507a03(0xb1)]('');var _0x509331=$('#attendance-reportFrom')[_0x507a03(0xb1)](),_0x2e7965=moment($('#attendance-reportFrom')[_0x507a03(0xb1)](),'DD/MM/YYYY')['format'](_0x507a03(0xe2)),_0x26cb61=moment($(_0x507a03(0x14a))['val'](),'DD/MM/YYYY')[_0x507a03(0xd5)](_0x507a03(0xe2));$('#daydate')['text']($[_0x507a03(0xf4)][_0x507a03(0xfa)](_0x507a03(0xa1),new Date(_0x2e7965))),$(_0x507a03(0x152))[_0x507a03(0x104)]($['datepicker'][_0x507a03(0xfa)]('M\x20\x20yy',new Date(_0x2e7965)));var _0x4036fd='',_0x790923='';$(_0x507a03(0x128))['val']()!=_0x507a03(0xcd)&&(_0x4036fd+=_0x507a03(0x134)+$(_0x507a03(0x128))[_0x507a03(0xb1)]()+'\x27\x20',_0x790923+=_0x507a03(0xc8)+$(_0x507a03(0xb6))[_0x507a03(0x104)]()+_0x507a03(0xd2));$(_0x507a03(0x133))[_0x507a03(0xb1)]()!=_0x507a03(0xcd)&&(_0x4036fd+=_0x507a03(0xa4)+$(_0x507a03(0x133))[_0x507a03(0xb1)]()+'\x27\x20',_0x790923+='<div\x20class=\x27upload-chip\x27>'+$('#DepartmentDDL\x20option:selected')['text']()+_0x507a03(0xd2));var _0x47b312=ensureUser($(_0x507a03(0xca))[_0x507a03(0x157)]()[_0x507a03(0x157)]()[_0x507a03(0xee)]('id')),_0x24a9cd=ensureUser($(_0x507a03(0x12b))[_0x507a03(0x157)]()[_0x507a03(0x157)]()[_0x507a03(0xee)]('id'));_0x47b312!=0x0&&(_0x4036fd+=_0x507a03(0xda)+_0x47b312+'\x27\x20',_0x790923+=_0x507a03(0xc8)+GetUserTitle($('#Manager')[_0x507a03(0x157)]()['children']()[_0x507a03(0xee)]('id'))+_0x507a03(0xd2)),_0x24a9cd!=0x0&&(_0x4036fd+=_0x507a03(0xe3)+_0x24a9cd+'\x27\x20',_0x790923+='<div\x20class=\x27upload-chip\x27>'+GetUserTitle($(_0x507a03(0x12b))[_0x507a03(0x157)]()[_0x507a03(0x157)]()[_0x507a03(0xee)]('id'))+_0x507a03(0xd2)),$('#chips')[_0x507a03(0xa5)](),$(_0x507a03(0x147))['append'](_0x790923),$('#overlaysearch')['fadeIn'](),setTimeout(function(){var _0x3696f4=_0x507a03,_0xffab7d=_spPageContextInfo['webAbsoluteUrl']+_0x3696f4(0x11c)+_0x2e7965+'\x27\x20and\x20AttendanceDate\x20le\x20\x27'+_0x26cb61+'\x27\x20';$['when'](getFileData(_0xffab7d))[_0x3696f4(0x151)](function(_0x41d29f){var _0x17155b=_0x3696f4,_0x1d2778=_spPageContextInfo[_0x17155b(0xa0)]+'/_api/web/lists/GetByTitle(\x27Employees\x27)/items?$top=5000&$select=ID,FullName,Designation,LogonName/ID,LogonName/Title,ManagerLoginName/Title,Department/DepartmentName,Company/CompanyName,Company/ID,OfficeLocation/ID,OfficeLocation/OfficeName&$orderby=FullName&$expand=LogonName,ManagerLoginName,OfficeLocation,Company,Department&$filter=Status\x20eq\x20\x27Active\x27\x20and\x20Company/ID\x20\x20eq\x20\x27'+GCompanyId+'\x27'+_0x4036fd;EmployeeListDat(_0x1d2778),$(_0x17155b(0xf2))[_0x17155b(0x156)]();});},0x5dc);}var TempStore=[],unique='';function getFileData(_0x73c2f6){var _0x216a6c=a0_0x38192b;jQuery['ajax']({'url':_0x73c2f6,'headers':{'Accept':_0x216a6c(0xfd)},'async':![],'success':function(_0x32d8ad){var _0x297897=_0x216a6c;EmpAttendanceData=[];var _0x1986f6=_0x32d8ad['d'][_0x297897(0x113)];if(_0x1986f6[_0x297897(0xc5)]>0x0){TempStore=[];for(var _0x5ab35d=0x0;_0x5ab35d<_0x1986f6[_0x297897(0xc5)];_0x5ab35d++){TempStore[_0x297897(0x159)](_0x1986f6[_0x5ab35d][_0x297897(0x15a)]['ID']);}unique=TempStore[_0x297897(0xe4)](function(_0x38af65,_0x1f6fba,_0x1a7f49){var _0x3d6e4f=_0x297897;return _0x1f6fba==_0x1a7f49[_0x3d6e4f(0xfe)](_0x38af65);});if(unique['length']>0x0){EmpAttendanceData=[];for(var _0x26d867=0x0;_0x26d867<unique[_0x297897(0xc5)];_0x26d867++){var _0xe883f0=0x0,_0x3eb66a=[],_0x184368=[],_0x146d1b=moment($('#attendance-reportFrom')[_0x297897(0xb1)](),_0x297897(0x10b))[_0x297897(0xd5)](_0x297897(0xe2)),_0x295603=moment($(_0x297897(0x14a))['val'](),'DD/MM/YYYY')[_0x297897(0xd5)](_0x297897(0xe2)),_0x3973a8=unique[_0x26d867],_0x1fb392=_spPageContextInfo[_0x297897(0xa0)]+_0x297897(0x11c)+_0x146d1b+_0x297897(0xed)+_0x295603+_0x297897(0x155)+_0x3973a8+'\x27\x20';jQuery[_0x297897(0xef)]({'url':_0x1fb392,'headers':{'Accept':_0x297897(0xfd)},'async':![],'success':function(_0x44199d){var _0x568633=_0x297897,_0x5ba104=_0x44199d['d'][_0x568633(0x113)];if(_0x5ba104[_0x568633(0xc5)]>0x0){for(var _0x3ba925=0x0;_0x3ba925<_0x5ba104[_0x568633(0xc5)];_0x3ba925++){var _0x46aad7=_0x5ba104[_0x3ba925]['ID'],_0x501c50=_0x5ba104[_0x3ba925]['Employee']['Title'],_0x29f326=_0x5ba104[_0x3ba925][_0x568633(0x15a)]['ID'],_0x491d10=_0x5ba104[_0x3ba925][_0x568633(0xf8)],_0x296126=_0x5ba104[_0x3ba925]['AttendanceType'];if(_0x296126==_0x568633(0xc7)||_0x296126=='1st\x20Half'||_0x296126==_0x568633(0x10d))_0x3eb66a[_0x568633(0x159)](_0x296126);else _0x296126=='On\x20Leave'&&_0x184368['push'](_0x296126);_0x5ba104[_0x3ba925][_0x568633(0xeb)]!=null&&(_0xe883f0=parseInt(_0xe883f0)+parseInt(_0x5ba104[_0x3ba925]['WorkHours']));var _0x49d3e6=_0x5ba104[_0x3ba925]['HrAction'],_0xcee4e1=parseInt(_0x3eb66a[_0x568633(0xc5)])+parseInt(_0x184368['length']),_0x4b5cb9=parseInt(TotalOfficeDays)-parseInt(_0xcee4e1);_0x4b5cb9<0x0&&(_0x4b5cb9=0x0);}var _0x17a27e=Math['round'](parseInt(_0xcee4e1)/parseInt(TotalOfficeDays)*0x64)+'%';TotalOfficeDays=='0'&&(_0x17a27e='-'),EmpAttendanceData[_0x568633(0x159)]({'UserId':_0x29f326,'EmpName':_0x501c50,'AttendanceDate':_0x491d10,'AttendanceType':_0x296126,'AttendanceItemId':_0x46aad7,'EmpWorkHours':_0xe883f0,'HrAction':_0x49d3e6,'AttendancDays':_0x3eb66a['length'],'LeavesDay':_0x184368[_0x568633(0xc5)],'NotActionDays':_0x4b5cb9,'percentage':_0x17a27e});}},'error':function(_0x40efdf,_0x3a40c7){var _0x56feea=_0x297897;console['log'](JSON[_0x56feea(0x145)](_0x40efdf));}});}}}},'error':function(_0x5e5548,_0x4a4101,_0x3c6a5f){var _0xcbe98c=_0x216a6c;console[_0xcbe98c(0x153)](_0xcbe98c(0x154)),console[_0xcbe98c(0x153)](_0x5e5548[_0xcbe98c(0xc4)][_0xcbe98c(0x10e)][_0xcbe98c(0xbf)][_0xcbe98c(0x12a)]);var _0xef922=_0x5e5548[_0xcbe98c(0xc4)][_0xcbe98c(0x10e)][_0xcbe98c(0xbf)]['value'],_0x3723bd=_0xef922[_0xcbe98c(0xdf)](_0xcbe98c(0xd3));_0x3723bd==!![]&&(AttendanceReportUsageData=[],AttendanceReportUsageUrl=_spPageContextInfo['webAbsoluteUrl']+_0xcbe98c(0x11d),ReadEmpReportUsageData());}});}var AttendanceReportUsageData=AttendanceReportUsageData||[],AttendanceReportUsageUrl='';function ReadEmpReportUsageData(){var _0x31f065=a0_0x38192b;return dfds=$[_0x31f065(0xb7)](),$[_0x31f065(0xef)]({'url':AttendanceReportUsageUrl,'headers':{'Accept':_0x31f065(0xfd)},'async':![],'success':function(_0xe0d616){var _0x425b70=_0x31f065;FilterState=0x0,AttendanceReportUsageData=AttendanceReportUsageData[_0x425b70(0xc1)](_0xe0d616['d'][_0x425b70(0x113)]);if(_0xe0d616['d']['__next'])AttendanceReportUsageUrl=_0xe0d616['d'][_0x425b70(0x9f)],ReadEmpReportUsageData();else{if(AttendanceReportUsageData['length']>0x0){var _0x3610a1=moment(ConvertDateTimeFormat($('#attendance-reportFrom')[_0x425b70(0xb1)](),'/'))['format'](_0x425b70(0xc2)),_0x39a15b=moment(ConvertDateTimeFormat($(_0x425b70(0x14a))[_0x425b70(0xb1)](),'/'))[_0x425b70(0xd5)]('MM/DD/YYYY'),_0xdbbbb8=AttendanceReportUsageData['filter'](function(_0x50f23b){var _0x1195d8=_0x425b70;return Created=moment(_0x50f23b[_0x1195d8(0xf8)])['format'](_0x1195d8(0xc2)),(_0x3610a1==''?Created!='':Created>=_0x3610a1)&&(_0x39a15b==''?Created!='':Created<=_0x39a15b);});AttendanceReportUsageData=_0xdbbbb8;var _0x5d5092=[...new Map(AttendanceReportUsageData[_0x425b70(0xe7)](_0x85e197=>[_0x85e197[_0x425b70(0xb9)],_0x85e197]))[_0x425b70(0xd9)]()];TempStore=[];for(var _0x504a64=0x0;_0x504a64<AttendanceReportUsageData[_0x425b70(0xc5)];_0x504a64++){TempStore[_0x425b70(0x159)](AttendanceReportUsageData[_0x504a64][_0x425b70(0x15a)]['ID']);}unique=TempStore[_0x425b70(0xe4)](function(_0x5180c6,_0x439bee,_0x3f71b6){var _0x4ad958=_0x425b70;return _0x439bee==_0x3f71b6[_0x4ad958(0xfe)](_0x5180c6);});if(unique[_0x425b70(0xc5)]>0x0){EmpAttendanceData=[];for(var _0x2f0155=0x0;_0x2f0155<unique[_0x425b70(0xc5)];_0x2f0155++){var _0x2c24ed=0x0,_0x1bac5d=[],_0x1fb2a1=[],_0x573a3d=moment($(_0x425b70(0x108))[_0x425b70(0xb1)](),_0x425b70(0x10b))[_0x425b70(0xd5)](_0x425b70(0xe2)),_0x1abce9=moment($(_0x425b70(0x14a))[_0x425b70(0xb1)](),_0x425b70(0x10b))[_0x425b70(0xd5)](_0x425b70(0xe2)),_0x1967d5=unique[_0x2f0155],_0xdb5d16=$['grep'](AttendanceReportUsageData,function(_0x5049aa){var _0x15f5c9=_0x425b70;return _0x5049aa[_0x15f5c9(0x15a)]['ID']==_0x1967d5;}),_0x45bed8=_0xdb5d16;if(_0x45bed8['length']>0x0){for(var _0x45dd7f=0x0;_0x45dd7f<_0x45bed8['length'];_0x45dd7f++){var _0x2342a0=_0x45bed8[_0x45dd7f]['ID'],_0x4d7bb1=_0x45bed8[_0x45dd7f][_0x425b70(0x15a)]['Title'],_0x3bd4ec=_0x45bed8[_0x45dd7f][_0x425b70(0x15a)]['ID'],_0x35c62c=_0x45bed8[_0x45dd7f][_0x425b70(0xf8)],_0x486e3a=_0x45bed8[_0x45dd7f][_0x425b70(0x13b)];if(_0x486e3a=='Full\x20Day'||_0x486e3a=='1st\x20Half'||_0x486e3a==_0x425b70(0x10d))_0x1bac5d[_0x425b70(0x159)](_0x486e3a);else _0x486e3a==_0x425b70(0x12c)&&_0x1fb2a1['push'](_0x486e3a);_0x45bed8[_0x45dd7f][_0x425b70(0xeb)]!=null&&(_0x2c24ed=parseInt(_0x2c24ed)+parseInt(_0x45bed8[_0x45dd7f][_0x425b70(0xeb)]));var _0x54e3ba=_0x45bed8[_0x45dd7f][_0x425b70(0xd8)],_0x5e8066=parseInt(_0x1bac5d['length'])+parseInt(_0x1fb2a1[_0x425b70(0xc5)]),_0x206d76=parseInt(TotalOfficeDays)-parseInt(_0x5e8066);_0x206d76<0x0&&(_0x206d76=0x0);}var _0x42946d=Math[_0x425b70(0xe1)](parseInt(_0x5e8066)/parseInt(TotalOfficeDays)*0x64)+'%';TotalOfficeDays=='0'&&(_0x42946d='-'),EmpAttendanceData[_0x425b70(0x159)]({'UserId':_0x3bd4ec,'EmpName':_0x4d7bb1,'AttendanceDate':_0x35c62c,'AttendanceType':_0x486e3a,'AttendanceItemId':_0x2342a0,'EmpWorkHours':_0x2c24ed,'HrAction':_0x54e3ba,'AttendancDays':_0x1bac5d['length'],'LeavesDay':_0x1fb2a1[_0x425b70(0xc5)],'NotActionDays':_0x206d76,'percentage':_0x42946d});}}}}}},'error':function(_0x545732,_0x1fdfb5,_0x52fd2d){}}),dfds[_0x31f065(0x13f)]();}function OpenMyCustomLoader(){var _0x31f607=a0_0x38192b,_0x18ed5b=_0x31f607(0x127),_0x177a57=_0x31f607(0x111),_0xbd3aa7=0xc8,_0x1502c4=0x190;currentDlg=SP['UI'][_0x31f607(0xf3)][_0x31f607(0x103)](_0x18ed5b,_0x177a57,_0xbd3aa7,_0x1502c4);}function a0_0x26fa(_0x3fc5c0,_0x170fec){var _0x1aea4e=a0_0x1aea();return a0_0x26fa=function(_0x26fa7d,_0x5b6e02){_0x26fa7d=_0x26fa7d-0x9e;var _0x15bbca=_0x1aea4e[_0x26fa7d];return _0x15bbca;},a0_0x26fa(_0x3fc5c0,_0x170fec);}function a0_0x1aea(){var _0x4b7bef=['btoa','responseJSON','length','#ToDate','Full\x20Day','<div\x20class=\x27upload-chip\x27>','<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27>-</div></td>','#Manager','76ZbIxSw','7720BesSnn','All','red','495687TjCGIC','Key','ResolvePrincipalSource','</div>','it\x20exceeds\x20the\x20list\x20view\x20threshold','Attendance\x20Entry','format','<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27>0</div></td>','Title','HrAction','values','and\x20ManagerLoginName\x20eq\x20\x27','\x27\x20and\x20CompanyID\x20eq\x20\x27','/Pages/Myworkplace.aspx?WebAppId=232SHDFGHJF22B2526DFG','<td\x20class=\x27text-left\x27><div\x20class=\x27attendance-report-table-ellipsis-2\x27>','evenselected','includes','#ReportTable','round','YYYY-MM-DD','and\x20LogonName/ID\x20eq\x20\x27','filter','&start=','oddrow','map','Jan','</option>','Worksheet','WorkHours','&sourcelocation=../Pages/Report.aspx#','\x27\x20and\x20AttendanceDate\x20le\x20\x27','attr','ajax','black','416208WJAFDw','#overlaysearch','ModalDialog','datepicker','asc','Active','Sept','AttendanceDate','<option\x20value=\x22','formatDate','NotActionDays','SPClientPeoplePicker','application/json;odata=verbose','indexOf','<tr\x20class=\x27text-center\x27>','7xNGsxO','AllowMultipleValues','Feb','showWaitScreenWithNoClose','text','EmpWorkHours','<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27>00:00</div></td>','SPClientPeoplePickerDict','#attendance-reportFrom','floor','setDate','DD/MM/YYYY','SPClientPeoplePicker_InitStandaloneControlWrapper','2nd\x20Half','error','split','#totalemp','<br\x20/>Please\x20wait!!','Nov','results','SearchPrincipalSource','appendTo','tablenav','2270ISbvOH','oddselected','\x27&$orderby=OfficeName\x20asc','\x27\x20and\x20Holiday_start\x20ge\x20\x27','#FdateTH','/_api/lists/getbytitle(\x27EmpAttendance\x27)/items?$select=HrAction,ID,Title,WorkHours,AttendanceDate,AttendanceType,Employee/Title,Employee/ID&$Expand=Employee&$top=5000&$filter=AttendanceDate\x20ge\x20\x27','/_api/lists/getbytitle(\x27EmpAttendance\x27)/items?$select=HrAction,ID,Title,WorkHours,AttendanceDate,AttendanceType,Employee/Title,Employee/ID&$Expand=Employee&$top=5000','/_api/web/ensureuser','#EdateTH','#SelectedLocation','PrincipalAccountType','<option\x20value=\x22All\x22>All</option>','Jul','#FromDate','getDate','DepartmentName','Loading...','#OfficeLoc','columns','value','#Employee','On\x20Leave','<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27>','#attendencedateValue','114175JlTZCu','show','LeavesDay','\x27\x20class=\x27custom-edit-btn\x27><i\x20class=\x27fa\x20fa-chevron-right\x27></i></a></div></td>','#DepartmentDDL','and\x20OfficeLocation\x20eq\x20\x27','280px','<td><div\x20class=\x27attendance-report-edit-lock-btn-box\x20text-center\x27><a\x20href=\x27','UserId','00:00\x20(H:M)','Jun','getFullYear','AttendanceType','#ReportTableData>tbody\x20>tr','\x27&$orderby=Title\x20asc&$top=5000','<html\x20xmlns:o=\x22urn:schemas-microsoft-com:office:office\x22\x20xmlns:x=\x22urn:schemas-microsoft-com:office:excel\x22\x20xmlns=\x22http://www.w3.org/TR/REC-html40\x22><head><!--[if\x20gte\x20mso\x209]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>{table}</table></body></html>','promise','\x27\x20and\x20Holiday_start\x20le\x20\x27','ManagerLoginName','OfficeName','Manager','Department','stringify','getTime','#chips','close','join','#attendance-reportTo','#__REQUESTDIGEST','getMonth','append','User,DL,SecGroup,SPGroup','2sAYRyG','sorter','done','#monthhyear','log','Error\x20in\x20getFileData.','\x27\x20and\x20Employee\x20eq\x20\x27','fadeOut','children','href','push','Employee','Width','webServerRelativeUrl','MaximumEntitySuggestions','Dec','checked','Repstartrecord','__next','webAbsoluteUrl','D,\x20dd','GetAllUserInfo','18007PbSRvQ','and\x20Department\x20eq\x20\x27','empty','LogonName','</div></td>','398124CzkskW','ready','POST','selectedrow','AttendancDays','Rependrecord','application/json;\x20odata=verbose','getElementById','#HolidaysTH','val','location','nodeType','Repcurrentpage','data:application/vnd.ms-excel;base64,','#OfficeLoc\x20option:selected','Deferred','5080563wlclEv','AuthorId','</tr>','CompanyId','getQueryStringParameter','/Pages/EmployeeReport.aspx?EID=','userId','message','AttendanceItemId','concat','MM/DD/YYYY'];a0_0x1aea=function(){return _0x4b7bef;};return a0_0x1aea();}function CloseMyCustomLoader(){var _0x29f758=a0_0x38192b;currentDlg[_0x29f758(0x148)]();}function EmployeeListDat(_0x3392c4){var _0x3eca8f=a0_0x38192b;$[_0x3eca8f(0xef)]({'url':_0x3392c4,'headers':{'Accept':_0x3eca8f(0xfd)},'async':![],'success':function(_0x2d7103){var _0x4a4194=_0x3eca8f,_0x321a6f=_0x2d7103['d'][_0x4a4194(0x113)];$(_0x4a4194(0xe0))['empty']();var _0x346823='';if(_0x321a6f[_0x4a4194(0xc5)]>0x0){var _0x2e766e=0x0,_0x858496=0x0,_0x50440f=0x0;for(var _0x370fe9=0x0;_0x370fe9<_0x321a6f[_0x4a4194(0xc5)];_0x370fe9++){var _0x242a02=_0x321a6f[_0x370fe9]['ID'],_0x509683=_0x321a6f[_0x370fe9]['LogonName']['ID'],_0xe16858=_0x321a6f[_0x370fe9][_0x4a4194(0xa6)]['Title'],_0x29ba40=_0x321a6f[_0x370fe9]['Designation'],_0x4dfe4a=_0x321a6f[_0x370fe9][_0x4a4194(0x144)][_0x4a4194(0x126)],_0x5606da=_0x321a6f[_0x370fe9][_0x4a4194(0x141)][_0x4a4194(0xd7)];_0x5606da==undefined&&(_0x5606da='');var _0x146202=_0x4a4194(0x138),_0xd41fae='',_0x1cf0e9=_0x4a4194(0xf0);_0x29ba40==null&&(_0x29ba40='');var _0xa30fab=_0x321a6f[_0x370fe9]['OfficeLocation'][_0x4a4194(0x142)];_0xa30fab==null&&(_0xa30fab='');EmployeeId=_0x321a6f[_0x370fe9][_0x4a4194(0xa6)]['ID'];var _0x585941=moment($(_0x4a4194(0x108))[_0x4a4194(0xb1)](),_0x4a4194(0x10b))[_0x4a4194(0xd5)](_0x4a4194(0xe2)),_0x9a176d=moment($(_0x4a4194(0x14a))[_0x4a4194(0xb1)](),'DD/MM/YYYY')[_0x4a4194(0xd5)](_0x4a4194(0xe2)),_0x585941=_0x585941[_0x4a4194(0x10f)]('-')[_0x4a4194(0x149)](''),_0x9a176d=_0x9a176d[_0x4a4194(0x10f)]('-')[_0x4a4194(0x149)](''),_0x128760=_spPageContextInfo[_0x4a4194(0x15c)]+_0x4a4194(0xbd)+_0x509683+_0x4a4194(0xe5)+_0x585941+'&end='+_0x9a176d+'&WebAppId='+titanForWork[_0x4a4194(0xbc)](_0x4a4194(0xbb))+_0x4a4194(0xec),_0x4b38ba=EmpAttendanceData[_0x4a4194(0xe7)](function(_0x50e65a){var _0x23fab5=_0x4a4194;return _0x50e65a[_0x23fab5(0x137)];})[_0x4a4194(0xfe)](EmployeeId);if(_0x4b38ba!=-0x1){var _0x36ad09=EmpAttendanceData[_0x4b38ba][_0x4a4194(0x137)],_0x2a40e1=EmpAttendanceData[_0x4b38ba][_0x4a4194(0x13b)],_0x5f3cf7=EmpAttendanceData[_0x4b38ba][_0x4a4194(0xc0)];_0x146202=EmpAttendanceData[_0x4b38ba][_0x4a4194(0x105)];var _0x446a5d=EmpAttendanceData[_0x4b38ba][_0x4a4194(0x105)];_0xd41fae=EmpAttendanceData[_0x4b38ba][_0x4a4194(0xc0)];var _0x4aed6f=EmpAttendanceData[_0x4b38ba][_0x4a4194(0xac)],_0x389799=EmpAttendanceData[_0x4b38ba][_0x4a4194(0x131)],_0x5c765b=EmpAttendanceData[_0x4b38ba][_0x4a4194(0xfb)],_0x2d0191=EmpAttendanceData[_0x4b38ba]['percentage'],_0x1dec90='';EmpAttendanceData[_0x4b38ba][_0x4a4194(0xd8)]==!![]?_0x1dec90=_0x4a4194(0x15f):_0x1dec90='',_0x146202==null&&(_0x146202='00:00\x20(H:M)'),_0x2a40e1==_0x4a4194(0x12c)&&(_0x1cf0e9=_0x4a4194(0xce),_0x50440f++),_0x2a40e1=='Holiday'&&(_0x1cf0e9='blue'),_0x346823+=_0x4a4194(0xff),_0x346823+=_0x4a4194(0xdd)+_0xe16858+_0x4a4194(0xa7),_0x346823+=_0x4a4194(0xdd)+_0x29ba40+_0x4a4194(0xa7),_0x346823+=_0x4a4194(0x12d)+_0x4dfe4a+_0x4a4194(0xa7),_0x346823+=_0x4a4194(0xdd)+_0x5606da+_0x4a4194(0xa7),_0x346823+='<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27>'+_0x4aed6f+_0x4a4194(0xa7),_0x346823+=_0x4a4194(0x12d)+_0x5c765b+'</div></td>',_0x346823+='<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27>'+_0x389799+_0x4a4194(0xa7),_0x346823+='<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27>'+ConvertHHMM(_0x146202)+_0x4a4194(0xa7),_0x346823+='<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27>'+_0x2d0191+'</div></td>',_0x346823+=_0x4a4194(0x136)+_0x128760+'\x27\x20class=\x27custom-edit-btn\x27><i\x20class=\x27fa\x20fa-chevron-right\x27></i></a></div></td>',_0x346823+='</tr>';}else _0x346823+=_0x4a4194(0xff),_0x346823+=_0x4a4194(0xdd)+_0xe16858+_0x4a4194(0xa7),_0x346823+=_0x4a4194(0xdd)+_0x29ba40+_0x4a4194(0xa7),_0x346823+='<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27>'+_0x4dfe4a+_0x4a4194(0xa7),_0x346823+='<td\x20class=\x27text-left\x27><div\x20class=\x27attendance-report-table-ellipsis-2\x27>'+_0x5606da+_0x4a4194(0xa7),_0x346823+=_0x4a4194(0xd6),_0x346823+='<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27>'+TotalOfficeDays+_0x4a4194(0xa7),_0x346823+=_0x4a4194(0xd6),_0x346823+=_0x4a4194(0x106),_0x346823+=_0x4a4194(0xc9),_0x346823+='<td><div\x20class=\x27attendance-report-edit-lock-btn-box\x20text-center\x27><a\x20href=\x27'+_0x128760+_0x4a4194(0x132),_0x346823+=_0x4a4194(0xba);}}else{}_0x321a6f[_0x4a4194(0xc5)]==0x0?$('.NoRecordFound')[_0x4a4194(0x130)]():$('.NoRecordFound')['hide']();$(_0x4a4194(0xe0))['append'](_0x346823);var _0x14ee4e=$(_0x4a4194(0x13c))['length'];$('#TotalItemscount')['text'](_0x14ee4e),$(_0x4a4194(0x110))[_0x4a4194(0x104)](_0x14ee4e),_0x14ee4e>0x0&&ReportTableConfiguration();},'error':function(_0x466602){var _0x139735=_0x3eca8f;console[_0x139735(0x153)](_0x466602);}});}function ReportTableConfiguration(){var _0x2691d1=a0_0x38192b;sorter=new TINY['table'][(_0x2691d1(0x150))](_0x2691d1(0x150),'ReportTableData',{'ascclass':_0x2691d1(0xf5),'descclass':'desc','evenclass':'evenrow','oddclass':_0x2691d1(0xe6),'evenselclass':_0x2691d1(0xde),'oddselclass':_0x2691d1(0x118),'paginate':!![],'size':0xa,'colddid':_0x2691d1(0x129),'currentid':_0x2691d1(0xb4),'totalid':'Reptotalpages','startingrecid':_0x2691d1(0x9e),'endingrecid':_0x2691d1(0xad),'totalrecid':'Reptotalrecords','hoverid':_0x2691d1(0xab),'pageddid':'pagedropdown','navid':_0x2691d1(0x116),'sortdir':0x1,'init':!![]});}function ConvertHHMM(_0x58a853){var _0x3ea9f6=a0_0x38192b,_0x23beac=Math[_0x3ea9f6(0x109)](_0x58a853/0x3c),_0x35534a=_0x58a853%0x3c;_0x23beac<0xa&&(_0x23beac='0'+_0x23beac);_0x35534a<0xa&&(_0x35534a='0'+_0x35534a);var _0xd2cc11=_0x23beac+':'+_0x35534a;return _0xd2cc11;}function CloseModel(){var _0xe0f6e7=a0_0x38192b;initializePeoplePicker(_0xe0f6e7(0x143)),initializePeoplePicker(_0xe0f6e7(0x15a));}var tableToExcel=(function(){var _0x2f8ba7=a0_0x38192b,_0xf643dc=_0x2f8ba7(0xb5),_0x37cc5c=_0x2f8ba7(0x13e),_0x1ef5cc=function(_0x21b665){var _0x4557c9=_0x2f8ba7;return window[_0x4557c9(0xc3)](unescape(encodeURIComponent(_0x21b665)));},_0xaf61d3=function(_0x5a42c4,_0x319c33){return _0x5a42c4['replace'](/{(\w+)}/g,function(_0x408a43,_0x485375){return _0x319c33[_0x485375];});};return function(_0x4cc484,_0x28c812){var _0xd9e57=_0x2f8ba7;if(!_0x4cc484[_0xd9e57(0xb3)])_0x4cc484=document[_0xd9e57(0xaf)](_0x4cc484);var _0x26161a={'worksheet':_0x28c812||_0xd9e57(0xea),'table':_0x4cc484['innerHTML']};window[_0xd9e57(0xb2)][_0xd9e57(0x158)]=_0xf643dc+_0x1ef5cc(_0xaf61d3(_0x37cc5c,_0x26161a));};}()),authentication=function(){var _0xc7ba1a=a0_0x38192b,_0x207936=_spPageContextInfo['userDisplayName'],_0x5d5242=_spPageContextInfo[_0xc7ba1a(0xa0)]+'/_api/web/lists/getbytitle(\x27EnvironmentalSettings\x27)/items?$select=Title,Active,ListOfUsers/Title&$filter=Title\x20eq\x20\x27Attendance\x20Entry\x27\x20&$expand=ListOfUsers/Id';$[_0xc7ba1a(0xef)]({'url':_0x5d5242,'async':![],'type':'GET','headers':{'accept':_0xc7ba1a(0xae)},'success':function(_0x4409df){var _0x26f8c0=_0xc7ba1a;debugger;var _0x2b14de=_0x4409df['d']['results'];if(_0x2b14de[_0x26f8c0(0xc5)]>0x0)for(var _0x5a614f=0x0;_0x5a614f<_0x2b14de[_0x26f8c0(0xc5)];_0x5a614f++){if(_0x2b14de[_0x5a614f][_0x26f8c0(0xd7)]==_0x26f8c0(0xd4)){if(_0x2b14de[_0x5a614f][_0x26f8c0(0xf6)]==![])return alert('This\x20feature\x20has\x20been\x20deactivated\x20!'),window[_0x26f8c0(0xb2)]=_spPageContextInfo[_0x26f8c0(0xa0)]+_0x26f8c0(0xdc),![];}}},'error':function(_0x3f27fd){var _0x22f2ec=_0xc7ba1a;alert(JSON[_0x22f2ec(0x145)](_0x3f27fd));}});};