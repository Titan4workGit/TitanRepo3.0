var a0_0x3cfb56=a0_0x18ef;(function(_0x4b926e,_0x3710cf){var _0x45b37a=a0_0x18ef,_0x2730d4=_0x4b926e();while(!![]){try{var _0x2e962d=-parseInt(_0x45b37a(0x273))/0x1*(parseInt(_0x45b37a(0x228))/0x2)+parseInt(_0x45b37a(0x243))/0x3*(-parseInt(_0x45b37a(0x28a))/0x4)+-parseInt(_0x45b37a(0x2a4))/0x5+parseInt(_0x45b37a(0x1fb))/0x6*(parseInt(_0x45b37a(0x268))/0x7)+-parseInt(_0x45b37a(0x23f))/0x8*(-parseInt(_0x45b37a(0x2ba))/0x9)+parseInt(_0x45b37a(0x276))/0xa+-parseInt(_0x45b37a(0x25a))/0xb;if(_0x2e962d===_0x3710cf)break;else _0x2730d4['push'](_0x2730d4['shift']());}catch(_0x43866c){_0x2730d4['push'](_0x2730d4['shift']());}}}(a0_0x374f,0x865d6));var Totaldays=0x0,CompanyID='',GstartDate='',GEmpID=0x0;$(document)['ready'](function(){var _0x4489b8=a0_0x18ef;ValidateHrAdmin(),CompanyID=titanForWork[_0x4489b8(0x252)](_0x4489b8(0x24b));var _0x27d397=$[_0x4489b8(0x230)](_0x4489b8(0x291)),_0x634a8f=$[_0x4489b8(0x230)](_0x4489b8(0x234)),_0x17c9a6=$[_0x4489b8(0x230)]('end');if(_0x27d397!=null){GEmpID=_0x27d397;var _0x25a6bb=_0x634a8f[_0x4489b8(0x22f)](0x0,0x4)+'-'+_0x634a8f[_0x4489b8(0x22f)](0x4,0x6)+'-'+_0x634a8f[_0x4489b8(0x22f)](0x6,0x8),_0x3e1866=_0x17c9a6['slice'](0x0,0x4)+'-'+_0x17c9a6['slice'](0x4,0x6)+'-'+_0x17c9a6[_0x4489b8(0x22f)](0x6,0x8),_0x273236=new Date(_0x3e1866),_0x35bc4c=_0x273236[_0x4489b8(0x255)](),_0x42c9ee=_0x35bc4c[_0x4489b8(0x2a9)]('T');GstartDate=_0x25a6bb,$('#EmpreportFrom')[_0x4489b8(0x26f)]({'dateFormat':_0x4489b8(0x29e)})[_0x4489b8(0x26f)](_0x4489b8(0x2b0),new Date(_0x25a6bb)),$(_0x4489b8(0x29c))[_0x4489b8(0x26f)]({'dateFormat':'MM\x20dd,\x20yy'})[_0x4489b8(0x26f)](_0x4489b8(0x2b0),new Date(_0x3e1866));var _0xe14a42=$(_0x4489b8(0x26b))['datepicker'](_0x4489b8(0x24f)),_0x5626ce=$('#EmpreportTo')[_0x4489b8(0x26f)](_0x4489b8(0x24f));days=(_0x5626ce-_0xe14a42)/(0x3e8*0x3c*0x3c*0x18),Totaldays=Math['round'](days)+0x1,$(_0x4489b8(0x21e))[_0x4489b8(0x25b)](formatDateReportEmp($(_0x4489b8(0x26b))['val']())),$('#EndDate')[_0x4489b8(0x25b)](formatDateReportEmp($('#EmpreportTo')[_0x4489b8(0x270)]()));var _0x165c24=_spPageContextInfo[_0x4489b8(0x264)]+_0x4489b8(0x216)+_0x27d397+_0x4489b8(0x200)+CompanyID+'\x27';EmployeeListDat(_0x165c24),LoadAllHolidays();var _0x158b07=_spPageContextInfo[_0x4489b8(0x264)]+_0x4489b8(0x215)+_0x25a6bb+_0x4489b8(0x275)+_0x42c9ee[0x0]+'\x27\x20and\x20Employee\x20eq\x20\x27'+_0x27d397+'\x27\x20';getFileData(_0x158b07);var _0x165c24=_spPageContextInfo['webAbsoluteUrl']+_0x4489b8(0x216)+_0x27d397+_0x4489b8(0x200)+CompanyID+'\x27';EmployeeListDat(_0x165c24),LoadAllHolidays(),initializePeoplePicker('EmployeeName');}});var EmployeeID='',ItemID='',SelectedDate='',TDID='';function attendanceEditModal(_0x3d4bac,_0x12d84a,_0x5905c3){var _0x58e624=a0_0x18ef;EmployeeID=0x0,ItemID=0x0,SelectedDate='',TDID=_0x5905c3,EmployeeID=_0x3d4bac,ItemID=_0x12d84a;var _0x427247=_0x5905c3[_0x58e624(0x207)](),_0x2e76bf=_0x427247['slice'](0x0,0x4)+'-'+_0x427247[_0x58e624(0x22f)](0x4,0x6)+'-'+_0x427247[_0x58e624(0x22f)](0x6,0x8),_0x56cdbb=new Date(_0x2e76bf);SelectedDate=_0x56cdbb[_0x58e624(0x255)]()[_0x58e624(0x2a9)]('T')[0x0];var _0x4f1c0e=formatDateReportEmp(_0x56cdbb);$(_0x58e624(0x23e))[_0x58e624(0x25b)](_0x4f1c0e),GetHolidays(_0x2e76bf);}function UpdateAttendance(){var _0x24b3f3=a0_0x18ef;ItemID==0x0?(G_Validateholiday==!![]?confirm('This\x20is\x20a\x20Holiday,\x20are\x20you\x20sure\x20to\x20submit\x20your\x20attendance.')&&PushNewAttendance():PushNewAttendance(),Applyfilter(),LoadAllHolidays()):(G_Validateholiday==!![]?confirm(_0x24b3f3(0x29a))&&ModifyAttendance():ModifyAttendance(),Applyfilter(),LoadAllHolidays());}function PushNewAttendance(){var _0xa7d249=a0_0x18ef;$('#AttendanceDDL')[_0xa7d249(0x270)]()!='Holiday'||G_Validateholiday==!![]?$[_0xa7d249(0x23b)]({'url':_spPageContextInfo[_0xa7d249(0x264)]+_0xa7d249(0x1fe),'type':_0xa7d249(0x283),'async':![],'data':JSON[_0xa7d249(0x2a5)]({'__metadata':{'type':_0xa7d249(0x284)},'AttendanceDate':SelectedDate,'EmployeeId':EmployeeID,'AttendanceType':$(_0xa7d249(0x27f))[_0xa7d249(0x270)]()}),'headers':{'Accept':_0xa7d249(0x226),'Content-Type':_0xa7d249(0x226),'X-RequestDigest':$('#__REQUESTDIGEST')['val'](),'X-HTTP-Method':_0xa7d249(0x283)},'success':function(_0x18f476,_0x1177da,_0xe60ccd){var _0x2fb4f6=_0xa7d249;$(_0x2fb4f6(0x2aa)+TDID)['text']($(_0x2fb4f6(0x27f))[_0x2fb4f6(0x270)]()),alert(_0x2fb4f6(0x2b7)),$(_0x2fb4f6(0x25f))['modal'](_0x2fb4f6(0x259)),GetAttendanceorLeaves();},'error':function(_0x410831,_0x37d67d,_0x57f485){var _0x19482e=_0xa7d249;alert(_0x19482e(0x281));}}):alert(_0xa7d249(0x248));}function ModifyAttendance(){var _0x3fb3c7=a0_0x18ef;$(_0x3fb3c7(0x27f))[_0x3fb3c7(0x270)]()!=_0x3fb3c7(0x208)||G_Validateholiday==!![]?$['ajax']({'url':_spPageContextInfo[_0x3fb3c7(0x264)]+_0x3fb3c7(0x249)+ItemID+')','type':_0x3fb3c7(0x283),'async':![],'data':JSON[_0x3fb3c7(0x2a5)]({'__metadata':{'type':_0x3fb3c7(0x284)},'AttendanceType':$(_0x3fb3c7(0x27f))[_0x3fb3c7(0x270)]()}),'headers':{'Accept':_0x3fb3c7(0x226),'Content-Type':_0x3fb3c7(0x226),'X-RequestDigest':$(_0x3fb3c7(0x241))[_0x3fb3c7(0x270)](),'IF-MATCH':'*','X-HTTP-Method':_0x3fb3c7(0x231)},'success':function(_0xb1ade6,_0x625dac,_0x2607c8){var _0x2eeb59=_0x3fb3c7;$(_0x2eeb59(0x2aa)+TDID)['text']($(_0x2eeb59(0x27f))[_0x2eeb59(0x270)]()),$(_0x2eeb59(0x2ae)+TDID)[_0x2eeb59(0x25b)]('00:00'),alert(_0x2eeb59(0x2b7)),$(_0x2eeb59(0x25f))[_0x2eeb59(0x20e)]('hide'),GetAttendanceorLeaves();},'error':function(_0x55e893,_0x134b57,_0x511909){var _0x3d3718=_0x3fb3c7;alert(_0x3d3718(0x281));}}):alert(_0x3fb3c7(0x248));}function initializePeoplePicker(_0x578957){var _0x92012a=a0_0x18ef,_0x29c665={};_0x29c665[_0x92012a(0x2a8)]='User,DL,SecGroup,SPGroup',_0x29c665[_0x92012a(0x23a)]=0xf,_0x29c665['ResolvePrincipalSource']=0xf,_0x29c665[_0x92012a(0x24c)]=![],_0x29c665[_0x92012a(0x211)]=0x32,_0x29c665[_0x92012a(0x1ec)]=_0x92012a(0x205),this['SPClientPeoplePicker_InitStandaloneControlWrapper'](_0x578957,null,_0x29c665);}function Applyfilter(){var _0x265e6a=a0_0x18ef,_0x522b76=moment($(_0x265e6a(0x26b))[_0x265e6a(0x270)](),'LL')[_0x265e6a(0x28f)](_0x265e6a(0x20c)),_0x47ca8d=moment($(_0x265e6a(0x29c))[_0x265e6a(0x270)](),'LL')[_0x265e6a(0x28f)]('DD\x20MMM\x20YYYY');if(Date[_0x265e6a(0x1ef)](_0x522b76)>Date['parse'](_0x47ca8d))alert(_0x265e6a(0x1f8));else{$('#attendance-report-filter')['modal']('hide');var _0x14fdcc=$[_0x265e6a(0x230)](_0x265e6a(0x291)),_0x52b163=$(_0x265e6a(0x26b))[_0x265e6a(0x26f)](_0x265e6a(0x24f)),_0x2ba775=$(_0x265e6a(0x29c))['datepicker'](_0x265e6a(0x24f));days=(_0x2ba775-_0x52b163)/(0x3e8*0x3c*0x3c*0x18),Totaldays=Math['round'](days)+0x1,$(_0x265e6a(0x21e))[_0x265e6a(0x25b)](formatDateReportEmp($('#EmpreportFrom')['val']())),$(_0x265e6a(0x250))[_0x265e6a(0x25b)](formatDateReportEmp($('#EmpreportTo')[_0x265e6a(0x270)]()));var _0x522b76=moment($(_0x265e6a(0x26b))[_0x265e6a(0x270)](),'LL')[_0x265e6a(0x28f)](_0x265e6a(0x27e)),_0x47ca8d=moment($(_0x265e6a(0x29c))[_0x265e6a(0x270)](),'LL')[_0x265e6a(0x28f)](_0x265e6a(0x27e)),_0x38be52=new Date(_0x47ca8d),_0x32d166=_0x38be52['toISOString'](),_0x495da9=_0x32d166['split']('T');GstartDate=_0x522b76;var _0x2c0d06=ensureUser($('#EmployeeName')[_0x265e6a(0x22a)]()[_0x265e6a(0x22a)]()['attr']('id'));if(_0x2c0d06==0x0){_0x14fdcc=_0x14fdcc,GEmpID=_0x14fdcc;var _0x43b8cf=_spPageContextInfo[_0x265e6a(0x264)]+_0x265e6a(0x215)+_0x522b76+_0x265e6a(0x275)+_0x495da9[0x0]+'\x27\x20and\x20Employee\x20eq\x20\x27'+_0x14fdcc+'\x27\x20';getFileData(_0x43b8cf);var _0x1c853c=_spPageContextInfo[_0x265e6a(0x264)]+'/_api/web/lists/GetByTitle(\x27Employees\x27)/items?$top=5000&$select=ID,FullName,Designation,LogonName/ID,LogonName/Title,Department/DepartmentName,Company/CompanyName,Company/ID,OfficeLocation/ID,OfficeLocation/OfficeName&$orderby=FullName&$expand=LogonName,OfficeLocation,Company,Department&$filter=LogonName\x20eq\x20\x27'+_0x14fdcc+_0x265e6a(0x200)+CompanyID+'\x27';EmployeeListDat(_0x1c853c);}else{if(ISHRADMIN==!![]){_0x14fdcc=_0x2c0d06,GEmpID=_0x2c0d06;var _0x43b8cf=_spPageContextInfo[_0x265e6a(0x264)]+'/_api/lists/getbytitle(\x27EmpAttendance\x27)/items?$select=HrAction,ID,Title,WorkHours,AttendanceDate,AttendanceType,Employee/Title,Employee/ID&$Expand=Employee&$top=5000&$filter=AttendanceDate\x20ge\x20\x27'+_0x522b76+_0x265e6a(0x275)+_0x495da9[0x0]+_0x265e6a(0x292)+_0x14fdcc+'\x27\x20';getFileData(_0x43b8cf);var _0x1c853c=_spPageContextInfo[_0x265e6a(0x264)]+_0x265e6a(0x216)+_0x14fdcc+'\x27\x20and\x20Company/ID\x20\x20eq\x20\x27'+CompanyID+'\x27';EmployeeListDat(_0x1c853c);}else alert(_0x265e6a(0x27d));}LoadAllHolidays();}}var DataIdList=[],EmpAttendanceData=[],TotalLeavesorAbsent=[];function a0_0x374f(){var _0x485d83=['&sourcelocation=../Pages/Myworkplace.aspx\x27\x20><span\x20id=\x27Timeview','floor','#EmpReportTable','slice','urlParam','MERGE','\x27\x20and\x20Holiday_start\x20le\x20\x27','WorkHours','start','#EmpTitle','#EmpRow','SPClientPeoplePickerDict','/Pages/TimeSheetEntry.aspx?WebAppId=2&Recall=','getFullYear','SearchPrincipalSource','ajax','\x27>Fill</span></a>','On-LeaveWithdraw','#SelDate','80JgblLT','table','#__REQUESTDIGEST','Leave\x20withdrawal\x20Successfully\x20Completed.','458619UkaNML','log','oddselected','=([^&#]*)','css','Plese\x20select\x20proper\x20attandence.','/_api/web/lists/GetByTitle(\x27EmpAttendance\x27)/items(','AttendanceItemId','CompanyId','AllowMultipleValues','UserId','/_api/web/lists/getbytitle(\x27CompanyHoliday\x27)/items?$filter=OfficeLocationID\x20eq\x20(\x27','getDate','#EndDate','\x20\x27><a\x20href=\x27#\x27\x20class=\x27custom-edit-btn\x27\x20data-toggle=\x27modal\x27\x20data-target=\x27#attendance-reportEdit\x27\x20onclick=\x27attendanceEditModal(','getQueryStringParameter','<tr\x20class=\x27text-center\x27\x20>','HrAction','toISOString','selectedrow','<td><div\x20class=\x27checkbox\x20m-0\x27\x20style=\x27display:\x20','indexOf','hide','1918719BjXqWm','text','append','#HolidayMessage','#Total-Leave-Absent','#attendance-reportEdit','join','</a>','Key','ProcessApprovers','webAbsoluteUrl','\x27\x20class=\x27employee-report-holiday\x27></span></div></td>','getMonth','evenrow','7KyxqoQ','Dec','<a\x20href=\x27','#EmpreportFrom','\x27&$top=200&$orderby=Holiday_start\x20asc','#ResultDiv','map','datepicker','val','columns','#EmpName','47BpZYzN','EmpReportTableData','\x27\x20and\x20AttendanceDate\x20le\x20\x27','10681400bWyKzp','Employee','An\x20error\x20occurred.\x20Please\x20try\x20again.','Feb','Jul','Emptotalrecords','.NoRecordFound','Unauthorized\x20access!','YYYY-MM-DD','#AttendanceDDL','getTime','Error!\x20Something\x20went\x20wrong.','#EmployeeName','POST','SP.Data.EmpAttendanceListItem','#TotalWorkdayTH','none','Empstartrecord','push','length','4zedleQ','Apr','\x20\x27></div></td>','<td><div\x20class=\x27attendance-report-edit-lock-btn-box\x20text-center\x27\x20style=\x27display:\x20','#Total-Attendance','format','AttendanceType','EID','\x27\x20and\x20Employee\x20eq\x20\x27','Worksheet','display','#Workingdays','\x27\x20and\x20CompanyID\x20eq\x20\x27','Wednesday','tablenav','getDay','This\x20is\x20a\x20Holiday,\x20are\x20you\x20sure\x20to\x20submit\x20your\x20attendance.','\x27\x20and\x20Holiday_start\x20ge\x20\x27','#EmpreportTo','userId','MM\x20dd,\x20yy','Aug','red','LogonName','responseJSON','View','3617750fjRYgL','stringify','DD/MM/YYYY','Title','PrincipalAccountType','split','#Att','&Mode=','</div></td>','grep','#Timeview','<td\x20class=\x27text-left\x27><div\x20class=\x27attendance-report-table-ellipsis-2\x27\x20id=Att','setDate','OfficeName','error','<td><div\x20class=\x27checkbox\x20m-0\x27></div></td>','Nov','<html\x20xmlns:o=\x22urn:schemas-microsoft-com:office:office\x22\x20xmlns:x=\x22urn:schemas-microsoft-com:office:excel\x22\x20xmlns=\x22http://www.w3.org/TR/REC-html40\x22><head><!--[if\x20gte\x20mso\x209]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>{table}</table></body></html>','\x27\x20and\x20ContributorsId\x20eq\x20\x27','Data\x20has\x20been\x20saved.','asc','Jan','250362RfwJgD','#FdateTH','></div></td>','<a\x20class=\x27LinkBtn\x27\x20href=\x27','Jun','Friday','\x20\x27><label><i\x20class=\x27fa\x20fa-check\x27\x20aria-hidden=\x27true\x27\x20style=\x27color:\x20red;\x27></i></label></div></td>','\x27\x20and\x20(WebPartName\x20eq\x20\x27HR\x20Admin\x27)','replace','Width','empty','data:application/vnd.ms-excel;base64,','parse','</tr>','&sourcelocation=../Pages/Myworkplace.aspx\x27>','Holiday_start',',0,','</span><span\x20id=\x27H','<td><div\x20class=\x27attendance-report-edit-lock-btn-box\x20text-center\x27></div></td>','Tuesday','oddrow','Invalid\x20date\x20range.\x0aFrom\x20Date\x20should\x20not\x20be\x20bigger\x20than\x20To\x20Date','<td><div\x20class=\x27attendance-report-edit-lock-btn-box\x20text-center\x27><a\x20href=\x27#\x27\x20class=\x27custom-edit-btn\x27\x20data-toggle=\x27modal\x27\x20data-target=\x27#attendance-reportEdit\x27\x20onclick=\x27attendanceEditModal(','\x27)and\x20Holiday_start\x20eq\x20\x27','1921602KkQpZG','\x20,\x20','On-Leave','/_api/web/lists/GetByTitle(\x27EmpAttendance\x27)/items','#EmpTotalItemscount','\x27\x20and\x20Company/ID\x20\x20eq\x20\x27','Monday','/_api/web/lists/getbytitle(\x27CompanyHoliday\x27)/items?select=*,ID,Title&$filter=OfficeLocationID\x20eq\x20\x27','OfficeLocation','Sunday','280px','#officeLocTH','toString','Holiday','sorter',')\x27>Withdraw</a></div></td>','GetAllUserInfo','DD\x20MMM\x20YYYY','Hdate','modal','Mar','attr','MaximumEntitySuggestions','location','EmpWorkHours','#HoliaysTotal','/_api/lists/getbytitle(\x27EmpAttendance\x27)/items?$select=HrAction,ID,Title,WorkHours,AttendanceDate,AttendanceType,Employee/Title,Employee/ID&$Expand=Employee&$top=5000&$filter=AttendanceDate\x20ge\x20\x27','/_api/web/lists/GetByTitle(\x27Employees\x27)/items?$top=5000&$select=ID,FullName,Designation,LogonName/ID,LogonName/Title,Department/DepartmentName,Company/CompanyName,Company/ID,OfficeLocation/ID,OfficeLocation/OfficeName&$orderby=FullName&$expand=LogonName,OfficeLocation,Company,Department&$filter=LogonName\x20eq\x20\x27','AttendanceDate','\x27)/items?$select=*,Department/DepartmentName,Department/ID&$expand=Department&$filter=CompanyId\x20eq\x20\x27','[?&]','Emppagedropdown','href','results','#OfficeLoc','#StartDate','btoa','/_api/web/lists/getbytitle(\x27','><span>','<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27\x20id=Time','round','SPClientPeoplePicker','block','application/json;odata=verbose','getElementById','2782ihgpdm',')\x27><i\x20class=\x27fa\x20fa-pencil\x27></i></a></div></td>','children','<td\x20class=\x27text-left\x27><div\x20class=\x27attendance-report-table-ellipsis-2\x27\x20id='];a0_0x374f=function(){return _0x485d83;};return a0_0x374f();}function getFileData(_0x356ea4){var _0x1cc430=a0_0x18ef;jQuery[_0x1cc430(0x23b)]({'url':_0x356ea4,'headers':{'Accept':_0x1cc430(0x226)},'async':![],'success':function(_0x447e81){var _0x5a9325=_0x1cc430;EmpAttendanceData=[];var _0x52b619=_0x447e81['d']['results'];DataIdList=[];var _0x4fce5b=[];TotalLeavesorAbsent=[];for(var _0x3ab09f=0x0;_0x3ab09f<_0x52b619[_0x5a9325(0x289)];_0x3ab09f++){if(_0x52b619[_0x3ab09f][_0x5a9325(0x290)]!=_0x5a9325(0x1fd)&&_0x52b619[_0x3ab09f][_0x5a9325(0x290)]!='Holiday')_0x4fce5b[_0x5a9325(0x288)](_0x52b619[_0x3ab09f][_0x5a9325(0x290)]);else{if(_0x52b619[_0x3ab09f][_0x5a9325(0x290)]==_0x5a9325(0x1fd))TotalLeavesorAbsent['push'](_0x52b619[_0x3ab09f][_0x5a9325(0x290)]);else _0x52b619[_0x3ab09f]['AttendanceType']=='Holiday'&&TotalLeavesorAbsent[_0x5a9325(0x288)](_0x52b619[_0x3ab09f]['AttendanceType']);}var _0x19ad96=_0x52b619[_0x3ab09f]['ID'],_0x196c96=_0x52b619[_0x3ab09f][_0x5a9325(0x277)][_0x5a9325(0x2a7)],_0x2066b3=_0x52b619[_0x3ab09f][_0x5a9325(0x277)]['ID'],_0x3cbce5=formatDateReportEmp(_0x52b619[_0x3ab09f][_0x5a9325(0x217)]),_0xc13603=_0x52b619[_0x3ab09f][_0x5a9325(0x290)],_0x5b5482=_0x52b619[_0x3ab09f]['WorkHours'],_0x57b818=_0x52b619[_0x3ab09f][_0x5a9325(0x254)];EmpAttendanceData[_0x5a9325(0x288)]({'UserId':_0x2066b3,'EmpName':_0x196c96,'AttendanceDate':_0x3cbce5,'AttendanceType':_0xc13603,'AttendanceItemId':_0x19ad96,'EmpWorkHours':_0x5b5482,'HrAction':_0x57b818});}var _0xbbc7e6='';$(_0x5a9325(0x22e))['empty']();var _0x5c8ebb=0x0,_0x22c6c0=0x0;for(var _0x4902fb=0x0;_0x4902fb<Totaldays;_0x4902fb++){var _0x1f0c08=new Date(GstartDate);_0x1f0c08['setDate'](_0x1f0c08[_0x5a9325(0x24f)]()+_0x4902fb);var _0x5090a8=moment(_0x1f0c08,_0x5a9325(0x2a6))[_0x5a9325(0x28f)](_0x5a9325(0x27e)),_0x5090a8=_0x5090a8['split']('-')[_0x5a9325(0x260)]('');DataIdList[_0x5a9325(0x288)](_0x5090a8);var _0xb75ebf=formatDateReportEmp(_0x1f0c08),_0x5320c9=EmpAttendanceData['map'](function(_0x9cc187){var _0x27f9af=_0x5a9325;return _0x9cc187[_0x27f9af(0x217)];})[_0x5a9325(0x258)](_0xb75ebf);if(_0x5320c9!=-0x1){var _0x3cd634=EmpAttendanceData[_0x5320c9][_0x5a9325(0x290)],_0x58ea97=EmpAttendanceData[_0x5320c9][_0x5a9325(0x213)],_0x57b818=EmpAttendanceData[_0x5320c9][_0x5a9325(0x254)],_0x482345=EmpAttendanceData[_0x5320c9][_0x5a9325(0x24d)],_0x1f1569=EmpAttendanceData[_0x5320c9][_0x5a9325(0x24a)],_0x279e7a=EmpAttendanceData[_0x5320c9][_0x5a9325(0x217)],_0x42fe07=_0x5a9325(0x286),_0x47d57c=_0x5a9325(0x225);_0x57b818==!![]&&(_0x42fe07=_0x5a9325(0x225),_0x47d57c=_0x5a9325(0x286));if(_0x3cd634!='On-Leave'&&_0x3cd634!=_0x5a9325(0x208)){if(_0x58ea97==null)var _0x42e34a='<a\x20class=\x27LinkBtn\x27\x20href=\x27'+_spPageContextInfo['webAbsoluteUrl']+_0x5a9325(0x238)+_0x5090a8+'&Mode='+window[_0x5a9325(0x21f)](_0x5a9325(0x2a3))+_0x5a9325(0x22c)+_0x5090a8+_0x5a9325(0x23c);else var _0x42e34a=_0x5a9325(0x26a)+_spPageContextInfo[_0x5a9325(0x264)]+_0x5a9325(0x238)+_0x5090a8+_0x5a9325(0x2ab)+window[_0x5a9325(0x21f)](_0x5a9325(0x2a3))+_0x5a9325(0x1f1)+ConvertHHMM(_0x58ea97)+_0x5a9325(0x261);}else var _0x42e34a='';var _0x59a64e=![],_0x2064eb=Date[_0x5a9325(0x1ef)](_0x279e7a[_0x5a9325(0x2a9)](',')[0x0]),_0x21d363=new Date(),_0x1f2db1=Date[_0x5a9325(0x1ef)](moment(_0x21d363)['format'](_0x5a9325(0x20c)));_0x2064eb>_0x1f2db1&&(_0x59a64e=!![]),_0x22c6c0=_0x22c6c0+0x1,_0x59a64e!=!![]?(_0xbbc7e6+='<tr\x20class=\x27text-center\x27\x20>',_0xbbc7e6+='<td\x20class=\x27text-left\x27><div\x20class=\x27attendance-report-table-ellipsis-2\x27\x20id='+_0x5090a8+'><span>'+formatDateReportEmp(_0x1f0c08)+'</span><span\x20id=\x27H'+_0x5090a8+_0x5a9325(0x265),_0xbbc7e6+=_0x5a9325(0x2af)+_0x5090a8+'>'+_0x3cd634+_0x5a9325(0x2ac),_0xbbc7e6+='<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27\x20id=Time'+_0x5090a8+'>'+_0x42e34a+_0x5a9325(0x2ac),_0xbbc7e6+=_0x5a9325(0x257)+_0x42fe07+_0x5a9325(0x1e9),_0xbbc7e6+=_0x5a9325(0x28d)+_0x47d57c+_0x5a9325(0x251)+GEmpID+','+_0x1f1569+','+_0x5090a8+_0x5a9325(0x229),_0xbbc7e6+=_0x5a9325(0x1f0)):(_0xbbc7e6+='<tr\x20class=\x27text-center\x27\x20>',_0xbbc7e6+=_0x5a9325(0x22b)+_0x5090a8+_0x5a9325(0x221)+formatDateReportEmp(_0x1f0c08)+_0x5a9325(0x1f4)+_0x5090a8+_0x5a9325(0x265),_0xbbc7e6+=_0x5a9325(0x2af)+_0x5090a8+'>'+_0x3cd634+'<a\x20href=\x27#\x27\x20class=\x27Withdraw-Leave-link\x27\x20onclick=\x27WithdrawLeave('+_0x1f1569+','+_0x5090a8+_0x5a9325(0x20a),_0xbbc7e6+=_0x5a9325(0x222)+_0x5090a8+'>'+_0x42e34a+_0x5a9325(0x2ac),_0xbbc7e6+=_0x5a9325(0x257)+_0x42fe07+_0x5a9325(0x1e9),_0xbbc7e6+='<td><div\x20class=\x27attendance-report-edit-lock-btn-box\x20text-center\x27\x20style=\x27display:\x20'+_0x47d57c+_0x5a9325(0x28c),_0xbbc7e6+=_0x5a9325(0x1f0));}else{var _0x463332=formatDateReportEmp(_0x1f0c08),_0x59a64e=![],_0x2064eb=Date[_0x5a9325(0x1ef)](_0x463332[_0x5a9325(0x2a9)](',')[0x0]),_0x21d363=new Date(),_0x1f2db1=Date[_0x5a9325(0x1ef)](moment(_0x21d363)[_0x5a9325(0x28f)](_0x5a9325(0x20c)));_0x2064eb>_0x1f2db1&&(_0x59a64e=!![]);_0x5c8ebb=_0x5c8ebb+0x1;if(_0x59a64e!=!![]){var _0x13b30c=_0x5a9325(0x1e6)+_spPageContextInfo['webAbsoluteUrl']+'/Pages/TimeSheetEntry.aspx?WebAppId=2&Recall='+_0x5090a8+_0x5a9325(0x2ab)+window['btoa'](_0x5a9325(0x2a3))+'&sourcelocation=../Pages/Myworkplace.aspx\x27\x20><span\x20id=\x27Timeview'+_0x5090a8+_0x5a9325(0x23c);_0xbbc7e6+=_0x5a9325(0x253),_0xbbc7e6+=_0x5a9325(0x22b)+_0x5090a8+_0x5a9325(0x221)+formatDateReportEmp(_0x1f0c08)+'</span><span\x20id=\x27H'+_0x5090a8+_0x5a9325(0x265),_0xbbc7e6+='<td\x20class=\x27text-left\x27><div\x20class=\x27attendance-report-table-ellipsis-2\x27\x20id=Att'+_0x5090a8+_0x5a9325(0x1e5),_0xbbc7e6+=_0x5a9325(0x222)+_0x5090a8+_0x5a9325(0x1e5),_0xbbc7e6+=_0x5a9325(0x2b3),_0xbbc7e6+=_0x5a9325(0x1f9)+GEmpID+_0x5a9325(0x1f3)+_0x5090a8+')\x27><i\x20class=\x27fa\x20fa-pencil\x27></i></a></div></td>',_0xbbc7e6+=_0x5a9325(0x1f0);}else{var _0x13b30c=_0x5a9325(0x1e6)+_spPageContextInfo[_0x5a9325(0x264)]+_0x5a9325(0x238)+_0x5090a8+_0x5a9325(0x2ab)+window['btoa'](_0x5a9325(0x2a3))+_0x5a9325(0x22c)+_0x5090a8+'\x27>Fill</span></a>';_0xbbc7e6+=_0x5a9325(0x253),_0xbbc7e6+=_0x5a9325(0x22b)+_0x5090a8+_0x5a9325(0x221)+formatDateReportEmp(_0x1f0c08)+_0x5a9325(0x1f4)+_0x5090a8+_0x5a9325(0x265),_0xbbc7e6+=_0x5a9325(0x2af)+_0x5090a8+'></div></td>',_0xbbc7e6+=_0x5a9325(0x222)+_0x5090a8+_0x5a9325(0x1e5),_0xbbc7e6+=_0x5a9325(0x2b3),_0xbbc7e6+=_0x5a9325(0x1f5),_0xbbc7e6+=_0x5a9325(0x1f0);}}}var _0x25f11a=$[_0x5a9325(0x2ad)](_0x52b619,function(_0x18faa2){var _0x177382=_0x5a9325;return _0x18faa2[_0x177382(0x290)]!=_0x177382(0x1fd)&&_0x18faa2[_0x177382(0x290)]!=_0x177382(0x208);}),_0x434b89=parseInt(TotalLeavesorAbsent[_0x5a9325(0x289)])+parseInt(_0x5c8ebb)-parseInt($(_0x5a9325(0x214))['text']());_0x434b89<0x0&&(_0x434b89=0x0);$(_0x5a9325(0x27c))['hide'](),$(_0x5a9325(0x1ff))['text'](Totaldays);var _0xd127fa=parseInt(_0x22c6c0)-parseInt(TotalLeavesorAbsent[_0x5a9325(0x289)]);$(_0x5a9325(0x28e))[_0x5a9325(0x25b)](_0x25f11a['length']),$(_0x5a9325(0x22e))[_0x5a9325(0x25c)](_0xbbc7e6),EmpTableConfiguration();},'error':function(_0x32de5b,_0x46100c){var _0x20e9df=_0x1cc430;console[_0x20e9df(0x244)](JSON[_0x20e9df(0x2a5)](_0x32de5b));}});}function WithdrawLeave(_0x430938,_0x4d5b27){var _0x14b3f5=a0_0x18ef;confirm('Are\x20you\x20sure\x20to\x20withdraw\x20the\x20Leave?')&&$[_0x14b3f5(0x23b)]({'url':_spPageContextInfo['webAbsoluteUrl']+_0x14b3f5(0x249)+_0x430938+')','type':_0x14b3f5(0x283),'headers':{'X-RequestDigest':$(_0x14b3f5(0x241))[_0x14b3f5(0x270)](),'IF-MATCH':'*','X-HTTP-Method':'DELETE'},'success':function(_0x5d109c,_0x4064ee,_0x39ea39){var _0x4556d6=_0x14b3f5;$(_0x4556d6(0x2aa)+_0x4d5b27)[_0x4556d6(0x247)](_0x4556d6(0x294),'none'),alert(_0x4556d6(0x242));},'error':function(_0x270334,_0x326d9c,_0x41503f){var _0x34a0ad=_0x14b3f5;$(_0x34a0ad(0x26d))[_0x34a0ad(0x1ed)]()['text'](data['responseJSON'][_0x34a0ad(0x2b2)]);}});}function ConvertDateTimeFormat(_0x2ad8a2,_0x12da72){var _0xee82bd=a0_0x18ef;return _0x2ad8a2[_0xee82bd(0x2a9)](_0x12da72)[0x1]+''+_0x12da72+''+_0x2ad8a2['split'](_0x12da72)[0x0]+''+_0x12da72+''+_0x2ad8a2[_0xee82bd(0x2a9)](_0x12da72)[0x2];}var GEmployeeID=0x0,LocID=0x0;function EmployeeListDat(_0x1e1d9d){var _0x4dbe93=a0_0x18ef;GEmployeeID=0x0,$[_0x4dbe93(0x23b)]({'url':_0x1e1d9d,'headers':{'Accept':_0x4dbe93(0x226)},'async':![],'success':function(_0x2c16d0){var _0x5613f0=_0x4dbe93,_0x1e52a5=_0x2c16d0['d']['results'];_0x1e52a5[_0x5613f0(0x289)]>0x0?($(_0x5613f0(0x272))[_0x5613f0(0x25b)](_0x1e52a5[0x0][_0x5613f0(0x2a1)]['Title']),GEmployeeID=_0x1e52a5[0x0][_0x5613f0(0x2a1)]['ID'],$(_0x5613f0(0x235))['text'](_0x1e52a5[0x0][_0x5613f0(0x2a1)][_0x5613f0(0x2a7)]),$(_0x5613f0(0x21d))[_0x5613f0(0x25b)](_0x1e52a5[0x0][_0x5613f0(0x203)][_0x5613f0(0x2b1)]),$(_0x5613f0(0x206))[_0x5613f0(0x25b)](_0x1e52a5[0x0][_0x5613f0(0x203)][_0x5613f0(0x2b1)]),LocID=_0x1e52a5[0x0][_0x5613f0(0x203)]['ID']):($(_0x5613f0(0x272))['text'](''),$(_0x5613f0(0x21d))[_0x5613f0(0x25b)](''),LocID=0x0);},'error':function(_0x1f7331){console['log'](_0x1f7331);}});}function EmpTableConfiguration(){var _0x1fa623=a0_0x18ef;sorter=new TINY[(_0x1fa623(0x240))]['sorter'](_0x1fa623(0x209),_0x1fa623(0x274),{'ascclass':_0x1fa623(0x2b8),'descclass':'desc','evenclass':_0x1fa623(0x267),'oddclass':_0x1fa623(0x1f7),'evenselclass':'evenselected','oddselclass':_0x1fa623(0x245),'paginate':!![],'size':0xa,'colddid':_0x1fa623(0x271),'currentid':'Empcurrentpage','totalid':'Emptotalpages','startingrecid':_0x1fa623(0x287),'endingrecid':'Empendrecord','totalrecid':_0x1fa623(0x27b),'hoverid':_0x1fa623(0x256),'pageddid':_0x1fa623(0x21a),'navid':_0x1fa623(0x298),'sortdir':0x1,'init':!![]});}$[a0_0x3cfb56(0x230)]=function(_0x1908cd){var _0x24bfdb=a0_0x3cfb56,_0x33afbf=new RegExp(_0x24bfdb(0x219)+_0x1908cd+_0x24bfdb(0x246))['exec'](window[_0x24bfdb(0x212)][_0x24bfdb(0x21b)]);if(_0x33afbf==null)return null;return decodeURI(_0x33afbf[0x1])||0x0;};function formatDateReportEmp(_0x16ae80){var _0x3b79ca=a0_0x3cfb56,_0x430f2f=[_0x3b79ca(0x204),_0x3b79ca(0x201),_0x3b79ca(0x1f6),_0x3b79ca(0x297),'Thursday',_0x3b79ca(0x1e8),'Saturday'],_0x4a3c3f=new Date(_0x16ae80);if(isNaN(_0x4a3c3f[_0x3b79ca(0x280)]()))return _0x16ae80;else{var _0x1b14a9=new Array();return _0x1b14a9[0x0]=_0x3b79ca(0x2b9),_0x1b14a9[0x1]=_0x3b79ca(0x279),_0x1b14a9[0x2]=_0x3b79ca(0x20f),_0x1b14a9[0x3]=_0x3b79ca(0x28b),_0x1b14a9[0x4]='May',_0x1b14a9[0x5]=_0x3b79ca(0x1e7),_0x1b14a9[0x6]=_0x3b79ca(0x27a),_0x1b14a9[0x7]=_0x3b79ca(0x29f),_0x1b14a9[0x8]='Sept',_0x1b14a9[0x9]='Oct',_0x1b14a9[0xa]=_0x3b79ca(0x2b4),_0x1b14a9[0xb]=_0x3b79ca(0x269),day=_0x4a3c3f[_0x3b79ca(0x24f)](),day<0xa&&(day='0'+day),day+'\x20'+_0x1b14a9[_0x4a3c3f['getMonth']()]+'\x20'+_0x4a3c3f['getFullYear']()+',\x20'+_0x430f2f[_0x4a3c3f[_0x3b79ca(0x299)]()];}}function ConvertHHMM(_0x72c5ff){var _0x3181b9=a0_0x3cfb56;if(_0x72c5ff!=null){var _0x3730e7=Math[_0x3181b9(0x22d)](_0x72c5ff/0x3c),_0x3a980a=_0x72c5ff%0x3c;_0x3730e7<0xa&&(_0x3730e7='0'+_0x3730e7);_0x3a980a<0xa&&(_0x3a980a='0'+_0x3a980a);var _0x564bf6=_0x3730e7+':'+_0x3a980a;}else var _0x564bf6='';return _0x564bf6;}var AttandenceOnHolidays=0x0,HolidaysListDTL=[];function a0_0x18ef(_0x38a32d,_0x17ebd5){var _0x374fa1=a0_0x374f();return a0_0x18ef=function(_0x18efc9,_0x15ea13){_0x18efc9=_0x18efc9-0x1e5;var _0x144c9d=_0x374fa1[_0x18efc9];return _0x144c9d;},a0_0x18ef(_0x38a32d,_0x17ebd5);}function LoadAllHolidays(){var _0x280b6b=a0_0x3cfb56;TotalOfficeDays=0x0,HolidaysListDTL=[];var _0x470310=new Date($(_0x280b6b(0x26b))[_0x280b6b(0x270)]()),_0x536e9=_0x470310['getFullYear']()+'-'+(_0x470310[_0x280b6b(0x266)]()+0x1)+'-'+_0x470310['getDate'](),_0x2d85a7=new Date($(_0x280b6b(0x29c))['val']()),_0x383d4e=_0x2d85a7[_0x280b6b(0x239)]()+'-'+(_0x2d85a7[_0x280b6b(0x266)]()+0x1)+'-'+_0x2d85a7['getDate'](),_0x2460f9=_spPageContextInfo['webAbsoluteUrl']+_0x280b6b(0x202)+LocID+_0x280b6b(0x296)+CompanyID+_0x280b6b(0x29b)+_0x536e9+_0x280b6b(0x232)+_0x383d4e+'\x27';$['ajax']({'url':_0x2460f9,'headers':{'Accept':_0x280b6b(0x226)},'async':![],'success':function(_0x3f9928){var _0x574f98=_0x280b6b,_0x11de2e=_0x3f9928['d'][_0x574f98(0x21c)]['length'],_0x2b56f6=0x0;for(var _0x152533=0x0;_0x152533<_0x11de2e;_0x152533++){var _0x37f03b=new Date(_0x3f9928['d'][_0x574f98(0x21c)][_0x152533][_0x574f98(0x1f2)]),_0x182651=moment(_0x37f03b,'DD/MM/YYYY')[_0x574f98(0x28f)]('YYYY-MM-DD'),_0x182651=_0x182651[_0x574f98(0x2a9)]('-')[_0x574f98(0x260)](''),_0x1313a7=_0x3f9928['d']['results'][_0x152533][_0x574f98(0x2a7)];HolidaysListDTL[_0x574f98(0x288)]({'Hdate':_0x182651,'Title':_0x1313a7}),$('#'+_0x182651)['css']('color',_0x574f98(0x2a0)),$('#H'+_0x182651)[_0x574f98(0x25b)](_0x574f98(0x1fc)+_0x1313a7),$(_0x574f98(0x2aa)+_0x182651)[_0x574f98(0x25b)]()!=''&&(_0x2b56f6=_0x2b56f6+0x1);}AttandenceOnHolidays=0x0;for(var _0x4fce4d=0x0;_0x4fce4d<HolidaysListDTL[_0x574f98(0x289)];_0x4fce4d++){var _0x5bd0b2=$('#Att'+HolidaysListDTL[_0x4fce4d][_0x574f98(0x20d)])['text']();_0x5bd0b2!=''&&_0x5bd0b2!='On-Leave'&&_0x5bd0b2!=_0x574f98(0x208)&&(AttandenceOnHolidays=AttandenceOnHolidays+0x1);}var _0x5a767d=0x0,_0x5c3e78=0x0,_0x12a18f=0x0;for(var _0x5df0ee=0x0;_0x5df0ee<DataIdList[_0x574f98(0x289)];_0x5df0ee++){var _0x233bf7=$(_0x574f98(0x2aa)+DataIdList[_0x5df0ee])[_0x574f98(0x25b)]();_0x233bf7==_0x574f98(0x23d)&&(_0x233bf7=_0x233bf7[_0x574f98(0x2a9)]('Withdraw')[0x0]),(_0x233bf7==''||_0x233bf7==_0x574f98(0x1fd))&&(_0x5c3e78=_0x5c3e78+0x1),_0x233bf7==_0x574f98(0x1fd)&&(_0x12a18f=_0x12a18f+0x1),_0x233bf7==_0x574f98(0x208)&&(_0x5a767d=_0x5a767d+0x1);}var _0x56632a=_0x5c3e78+AttandenceOnHolidays-(_0x11de2e-_0x5a767d);_0x56632a<0x0&&(_0x56632a=0x0),_0x56632a!='0'?$(_0x574f98(0x25e))[_0x574f98(0x25b)](_0x56632a):_0x12a18f>0x0&&$('#Total-Leave-Absent')[_0x574f98(0x25b)](_0x12a18f),$(_0x574f98(0x214))['text'](_0x11de2e),$(_0x574f98(0x295))['text'](parseInt(Totaldays)-parseInt(_0x11de2e)),$(_0x574f98(0x2bb))['text'](formatDateReportEmp(ConvertDateTimeFormat($(_0x574f98(0x26b))[_0x574f98(0x270)](),'/'))),$('#EdateTH')[_0x574f98(0x25b)](formatDateReportEmp(ConvertDateTimeFormat($(_0x574f98(0x29c))[_0x574f98(0x270)](),'/'))),$(_0x574f98(0x285))[_0x574f98(0x25b)](parseInt(Totaldays)-parseInt(_0x11de2e)),$('#HolidaysTH')[_0x574f98(0x25b)](_0x11de2e);},'myError':function(_0x49b72a){}});}function ensureUser(_0x11982c){var _0x8e4fd1=a0_0x3cfb56,_0x23d081=0x0,_0x151671=_0x11982c,_0x1556b8=this[_0x8e4fd1(0x224)][_0x8e4fd1(0x237)][_0x151671],_0x5b4dd9=_0x1556b8[_0x8e4fd1(0x20b)](),_0x9a2926=_0x5b4dd9[0x0];if(_0x9a2926){var _0x42747c={'logonName':_0x9a2926[_0x8e4fd1(0x262)]};$['ajax']({'url':_spPageContextInfo[_0x8e4fd1(0x264)]+'/_api/web/ensureuser','type':'POST','async':![],'contentType':_0x8e4fd1(0x226),'data':JSON[_0x8e4fd1(0x2a5)](_0x42747c),'headers':{'X-RequestDigest':$('#__REQUESTDIGEST')[_0x8e4fd1(0x270)](),'accept':'application/json;odata=verbose'},'success':function(_0x214d83,_0x4b226c,_0x2f26c6){_0x23d081=_0x214d83['d']['Id'];},'error':function(_0x2bc94a,_0x5670c6,_0x3b8daf){}});}else _0x23d081=0x0;return _0x23d081;}var tableToExcel=(function(){var _0x566a88=a0_0x3cfb56,_0x168e2d=_0x566a88(0x1ee),_0x328a2c=_0x566a88(0x2b5),_0x3e8834=function(_0x5b7ffe){var _0xb9a4b4=_0x566a88;return window[_0xb9a4b4(0x21f)](unescape(encodeURIComponent(_0x5b7ffe)));},_0x4c5e12=function(_0xe3b06e,_0x43a680){var _0x12a678=_0x566a88;return _0xe3b06e[_0x12a678(0x1eb)](/{(\w+)}/g,function(_0x2b49cd,_0x27483d){return _0x43a680[_0x27483d];});};return function(_0x551d76,_0x651893){var _0x497e62=_0x566a88;if(!_0x551d76['nodeType'])_0x551d76=document[_0x497e62(0x227)](_0x551d76);var _0x3c909a={'worksheet':_0x651893||_0x497e62(0x293),'table':_0x551d76['innerHTML']};window[_0x497e62(0x212)][_0x497e62(0x21b)]=_0x168e2d+_0x3e8834(_0x4c5e12(_0x328a2c,_0x3c909a));};}()),ISHRADMIN=![];function ValidateHrAdmin(){var _0x586d07=a0_0x3cfb56,_0x2a4c1c=_0x586d07(0x263),_0x5cf3a6=_spPageContextInfo[_0x586d07(0x264)]+_0x586d07(0x220)+_0x2a4c1c+_0x586d07(0x218)+titanForWork['getQueryStringParameter']('CompanyId')+_0x586d07(0x2b6)+_spPageContextInfo[_0x586d07(0x29d)]+_0x586d07(0x1ea);$[_0x586d07(0x23b)]({'url':_0x5cf3a6,'async':![],'type':'get','headers':{'Accept':_0x586d07(0x226)},'success':function(_0x34b878){var _0x2427ae=_0x586d07,_0x454a0a=_0x34b878['d']['results'];_0x454a0a['length']>0x0?($(_0x2427ae(0x236))[_0x2427ae(0x247)]('display',_0x2427ae(0x225)),ISHRADMIN=!![]):(ISHRADMIN=![],$(_0x2427ae(0x236))['hide']());},'error':function(_0x3fa384){var _0x2390c1=_0x586d07;console['log'](_0x3fa384[_0x2390c1(0x2a2)]['error']);}});}function GetAttendanceorLeaves(){var _0x53a25c=a0_0x3cfb56,_0x670d2f=$[_0x53a25c(0x230)](_0x53a25c(0x291)),_0xa30502=$(_0x53a25c(0x26b))[_0x53a25c(0x26f)](_0x53a25c(0x24f)),_0x49a07f=$(_0x53a25c(0x29c))['datepicker']('getDate');days=(_0x49a07f-_0xa30502)/(0x3e8*0x3c*0x3c*0x18),Totaldays=Math[_0x53a25c(0x223)](days)+0x1,$('#StartDate')['text'](formatDateReportEmp($(_0x53a25c(0x26b))['val']())),$('#EndDate')[_0x53a25c(0x25b)](formatDateReportEmp($(_0x53a25c(0x29c))['val']()));var _0xe4a04c=moment($(_0x53a25c(0x26b))[_0x53a25c(0x270)](),'LL')['format'](_0x53a25c(0x27e)),_0x3c90a9=moment($(_0x53a25c(0x29c))[_0x53a25c(0x270)](),'LL')['format']('YYYY-MM-DD'),_0x59cb73=new Date(_0x3c90a9),_0x208167=_0x59cb73[_0x53a25c(0x255)](),_0x23e37b=_0x208167['split']('T');GstartDate=_0xe4a04c;var _0x2fc9f2=ensureUser($(_0x53a25c(0x282))['children']()[_0x53a25c(0x22a)]()[_0x53a25c(0x210)]('id'));if(_0x2fc9f2==0x0){var _0x3c44f9=_spPageContextInfo[_0x53a25c(0x264)]+_0x53a25c(0x216)+_0x670d2f+'\x27\x20and\x20Company/ID\x20\x20eq\x20\x27'+CompanyID+'\x27';EmployeeListDat(_0x3c44f9),LoadAllHolidays(),_0x670d2f=_0x670d2f,GEmpID=_0x670d2f;var _0x50c806=_spPageContextInfo[_0x53a25c(0x264)]+_0x53a25c(0x215)+_0xe4a04c+_0x53a25c(0x275)+_0x23e37b+_0x53a25c(0x292)+_0x670d2f+'\x27\x20';UpdateHeaderfields(_0x50c806);}else{if(ISHRADMIN==!![]){_0x670d2f=_0x2fc9f2,GEmpID=_0x2fc9f2;var _0x3c44f9=_spPageContextInfo[_0x53a25c(0x264)]+_0x53a25c(0x216)+_0x670d2f+'\x27\x20and\x20Company/ID\x20\x20eq\x20\x27'+CompanyID+'\x27';EmployeeListDat(_0x3c44f9),LoadAllHolidays();var _0x50c806=_spPageContextInfo['webAbsoluteUrl']+_0x53a25c(0x215)+_0xe4a04c+_0x53a25c(0x275)+_0x23e37b+'\x27\x20and\x20Employee\x20eq\x20\x27'+_0x670d2f+'\x27\x20';UpdateHeaderfields(_0x50c806);var _0x3c44f9=_spPageContextInfo['webAbsoluteUrl']+_0x53a25c(0x216)+_0x670d2f+_0x53a25c(0x200)+CompanyID+'\x27';}else alert(_0x53a25c(0x27d));}LoadAllHolidays();}function GetFilterData(_0x182a83){var _0xdc8bb4=a0_0x3cfb56;jQuery[_0xdc8bb4(0x23b)]({'url':_0x182a83,'headers':{'Accept':_0xdc8bb4(0x226)},'async':![],'success':function(_0x5ea7f2){var _0x17a5a2=_0xdc8bb4,_0x33ebf0=_0x5ea7f2['d'][_0x17a5a2(0x21c)],_0x143987=[];TotalLeavesorAbsent=[];for(var _0x2884fb=0x0;_0x2884fb<_0x33ebf0[_0x17a5a2(0x289)];_0x2884fb++){if(_0x33ebf0[_0x2884fb][_0x17a5a2(0x290)]!=_0x17a5a2(0x1fd)&&_0x33ebf0[_0x2884fb][_0x17a5a2(0x290)]!=_0x17a5a2(0x208))_0x143987['push'](_0x33ebf0[_0x2884fb][_0x17a5a2(0x290)]);else _0x33ebf0[_0x2884fb]['AttendanceType']==_0x17a5a2(0x1fd)&&TotalLeavesorAbsent[_0x17a5a2(0x288)](_0x33ebf0[_0x2884fb][_0x17a5a2(0x290)]);}var _0xd59452=$['grep'](_0x33ebf0,function(_0x350308){var _0x40f7d8=_0x17a5a2;return _0x350308[_0x40f7d8(0x290)]!='On-Leave'&&_0x350308[_0x40f7d8(0x290)]!=_0x40f7d8(0x208);});$(_0x17a5a2(0x28e))['text'](_0xd59452[_0x17a5a2(0x289)]);},'error':function(_0x97899b,_0x27a6b5){var _0x2d70d3=_0xdc8bb4;console[_0x2d70d3(0x244)](JSON[_0x2d70d3(0x2a5)](_0x97899b));}});}var G_Validateholiday=![];function GetHolidays(_0x333da7){var _0x241a88=a0_0x3cfb56,_0x2b4c2b=_spPageContextInfo[_0x241a88(0x264)]+_0x241a88(0x24e)+LocID+_0x241a88(0x1fa)+_0x333da7+_0x241a88(0x296)+titanForWork[_0x241a88(0x252)](_0x241a88(0x24b))+_0x241a88(0x26c);$[_0x241a88(0x23b)]({'url':_0x2b4c2b,'headers':{'Accept':_0x241a88(0x226)},'async':![],'success':function(_0x4870c0){var _0x2635a0=_0x241a88,_0x4d2539=_0x4870c0['d'][_0x2635a0(0x21c)];_0x4d2539['length']>0x0?($('#HolidayMessagediv')[_0x2635a0(0x25b)](_0x4d2539[0x0][_0x2635a0(0x2a7)]),$(_0x2635a0(0x25d))[_0x2635a0(0x247)](_0x2635a0(0x294),_0x2635a0(0x225)),G_Validateholiday=!![]):($('#HolidayMessagediv')['text'](''),$(_0x2635a0(0x25d))[_0x2635a0(0x247)](_0x2635a0(0x294),_0x2635a0(0x286)),G_Validateholiday=![]);},'error':function(_0x4385d5){var _0x54e23c=_0x241a88;alert(_0x54e23c(0x278));}});}var EmpAttendanceData=[],TotalLeavesorAbsent=[];function UpdateHeaderfields(_0x228832){var _0x2e6885=a0_0x3cfb56;jQuery[_0x2e6885(0x23b)]({'url':_0x228832,'headers':{'Accept':_0x2e6885(0x226)},'async':!![],'success':function(_0x2e345d){var _0x3d334c=_0x2e6885;EmpAttendanceData=[];var _0x417b0b=_0x2e345d['d']['results'],_0x357e10=[];TotalLeavesorAbsent=[];for(var _0x240e59=0x0;_0x240e59<_0x417b0b['length'];_0x240e59++){if(_0x417b0b[_0x240e59][_0x3d334c(0x290)]!=_0x3d334c(0x1fd)&&_0x417b0b[_0x240e59][_0x3d334c(0x290)]!=_0x3d334c(0x208))_0x357e10[_0x3d334c(0x288)](_0x417b0b[_0x240e59][_0x3d334c(0x290)]);else{if(_0x417b0b[_0x240e59][_0x3d334c(0x290)]=='On-Leave')TotalLeavesorAbsent['push'](_0x417b0b[_0x240e59]['AttendanceType']);else _0x417b0b[_0x240e59][_0x3d334c(0x290)]=='Holiday'&&TotalLeavesorAbsent[_0x3d334c(0x288)](_0x417b0b[_0x240e59][_0x3d334c(0x290)]);}var _0x112e89=_0x417b0b[_0x240e59]['ID'],_0x14b84b=_0x417b0b[_0x240e59]['Employee'][_0x3d334c(0x2a7)],_0x3b1153=_0x417b0b[_0x240e59]['Employee']['ID'],_0x5cb0bb=formatDateReportEmp(_0x417b0b[_0x240e59]['AttendanceDate']),_0x3b8ea=_0x417b0b[_0x240e59][_0x3d334c(0x290)],_0x556160=_0x417b0b[_0x240e59][_0x3d334c(0x233)],_0x43c578=_0x417b0b[_0x240e59]['HrAction'];EmpAttendanceData[_0x3d334c(0x288)]({'UserId':_0x3b1153,'EmpName':_0x14b84b,'AttendanceDate':_0x5cb0bb,'AttendanceType':_0x3b8ea,'AttendanceItemId':_0x112e89,'EmpWorkHours':_0x556160,'HrAction':_0x43c578});}var _0x1a6654='',_0x275e87=0x0,_0x57af61=0x0;for(var _0x361690=0x0;_0x361690<Totaldays;_0x361690++){var _0x4f2e2a=new Date(GstartDate);_0x4f2e2a[_0x3d334c(0x2b0)](_0x4f2e2a['getDate']()+_0x361690);var _0x2a5860=moment(_0x4f2e2a,_0x3d334c(0x2a6))['format']('YYYY-MM-DD'),_0x2a5860=_0x2a5860[_0x3d334c(0x2a9)]('-')[_0x3d334c(0x260)](''),_0x503b85=formatDateReportEmp(_0x4f2e2a),_0x901986=EmpAttendanceData[_0x3d334c(0x26e)](function(_0x4d84ee){var _0x33256d=_0x3d334c;return _0x4d84ee[_0x33256d(0x217)];})['indexOf'](_0x503b85);if(_0x901986!=-0x1){var _0x5d7339=EmpAttendanceData[_0x901986][_0x3d334c(0x290)],_0x11576e=EmpAttendanceData[_0x901986][_0x3d334c(0x213)],_0x43c578=EmpAttendanceData[_0x901986][_0x3d334c(0x254)],_0x35fe82=EmpAttendanceData[_0x901986]['UserId'],_0x4a17e3=EmpAttendanceData[_0x901986][_0x3d334c(0x24a)];_0x57af61=_0x57af61+0x1;}else _0x275e87=_0x275e87+0x1;}var _0x40c668=parseInt(TotalLeavesorAbsent[_0x3d334c(0x289)])+parseInt(_0x275e87)-parseInt($(_0x3d334c(0x214))[_0x3d334c(0x25b)]());_0x40c668<0x0&&(_0x40c668=0x0);$('#EmpTotalItemscount')[_0x3d334c(0x25b)](Totaldays);var _0x2c1605=parseInt(_0x57af61)-parseInt(TotalLeavesorAbsent['length']),_0x2fdb5e=$[_0x3d334c(0x2ad)](_0x417b0b,function(_0x3a9c21){var _0x5727fa=_0x3d334c;return _0x3a9c21[_0x5727fa(0x290)]!=_0x5727fa(0x1fd)&&_0x3a9c21[_0x5727fa(0x290)]!='Holiday';});$(_0x3d334c(0x28e))[_0x3d334c(0x25b)](_0x2fdb5e[_0x3d334c(0x289)]);},'error':function(_0x2c2f82,_0x20a9c9){var _0x20698b=_0x2e6885;console[_0x20698b(0x244)](JSON[_0x20698b(0x2a5)](_0x2c2f82));}});}