var a0_0x52f229=a0_0x3a6e;(function(_0x21287c,_0x106345){var _0x57a192=a0_0x3a6e,_0x132700=_0x21287c();while(!![]){try{var _0x2c4a49=-parseInt(_0x57a192(0x151))/0x1+parseInt(_0x57a192(0xbe))/0x2*(parseInt(_0x57a192(0x141))/0x3)+-parseInt(_0x57a192(0xef))/0x4*(parseInt(_0x57a192(0xc8))/0x5)+-parseInt(_0x57a192(0x83))/0x6*(-parseInt(_0x57a192(0x105))/0x7)+-parseInt(_0x57a192(0x90))/0x8*(parseInt(_0x57a192(0x122))/0x9)+-parseInt(_0x57a192(0xa0))/0xa*(parseInt(_0x57a192(0xf7))/0xb)+parseInt(_0x57a192(0x14a))/0xc*(parseInt(_0x57a192(0x14b))/0xd);if(_0x2c4a49===_0x106345)break;else _0x132700['push'](_0x132700['shift']());}catch(_0x51511d){_0x132700['push'](_0x132700['shift']());}}}(a0_0x13b5,0xbba7f));var Totaldays=0x0,CompanyID='',GstartDate='',GEmpID=0x0;$(document)[a0_0x52f229(0x85)](function(){var _0x2bb52d=a0_0x52f229;ValidateHrAdmin(),CompanyID=titanForWork[_0x2bb52d(0xd0)](_0x2bb52d(0x8c));var _0x1be6aa=$[_0x2bb52d(0xd7)](_0x2bb52d(0x11a)),_0x51ac53=$[_0x2bb52d(0xd7)]('start'),_0x2fe60a=$[_0x2bb52d(0xd7)](_0x2bb52d(0x139));if(_0x1be6aa!=null){GEmpID=_0x1be6aa;var _0x3390d1=_0x51ac53[_0x2bb52d(0x111)](0x0,0x4)+'-'+_0x51ac53[_0x2bb52d(0x111)](0x4,0x6)+'-'+_0x51ac53['slice'](0x6,0x8),_0x46aed7=_0x2fe60a[_0x2bb52d(0x111)](0x0,0x4)+'-'+_0x2fe60a['slice'](0x4,0x6)+'-'+_0x2fe60a['slice'](0x6,0x8),_0x505b7f=new Date(_0x46aed7),_0x5f1ef9=_0x505b7f['toISOString'](),_0x4fe685=_0x5f1ef9[_0x2bb52d(0xb6)]('T');GstartDate=_0x3390d1,$(_0x2bb52d(0xe3))[_0x2bb52d(0x91)]({'dateFormat':_0x2bb52d(0xc1)})['datepicker'](_0x2bb52d(0x132),new Date(_0x3390d1)),$('#EmpreportTo')['datepicker']({'dateFormat':_0x2bb52d(0xc1)})[_0x2bb52d(0x91)](_0x2bb52d(0x132),new Date(_0x46aed7));var _0x32f445=$('#EmpreportFrom')['datepicker'](_0x2bb52d(0x154)),_0x40467f=$(_0x2bb52d(0xda))[_0x2bb52d(0x91)](_0x2bb52d(0x154));days=(_0x40467f-_0x32f445)/(0x3e8*0x3c*0x3c*0x18),Totaldays=Math['round'](days)+0x1,$(_0x2bb52d(0x12e))[_0x2bb52d(0x143)](formatDateReportEmp($(_0x2bb52d(0xe3))[_0x2bb52d(0xec)]())),$(_0x2bb52d(0xc2))[_0x2bb52d(0x143)](formatDateReportEmp($(_0x2bb52d(0xda))[_0x2bb52d(0xec)]()));var _0x1960a2=_spPageContextInfo[_0x2bb52d(0x95)]+_0x2bb52d(0xe0)+_0x1be6aa+_0x2bb52d(0xcb)+CompanyID+'\x27';EmployeeListDat(_0x1960a2),LoadAllHolidays();var _0x3b16a4=_spPageContextInfo['webAbsoluteUrl']+_0x2bb52d(0xa6)+_0x3390d1+_0x2bb52d(0x12c)+_0x4fe685[0x0]+_0x2bb52d(0xd8)+_0x1be6aa+'\x27\x20';getFileData(_0x3b16a4);var _0x1960a2=_spPageContextInfo[_0x2bb52d(0x95)]+_0x2bb52d(0xe0)+_0x1be6aa+_0x2bb52d(0xcb)+CompanyID+'\x27';EmployeeListDat(_0x1960a2),LoadAllHolidays(),initializePeoplePicker('EmployeeName');}});var EmployeeID='',ItemID='',SelectedDate='',TDID='';function attendanceEditModal(_0x3ef2ce,_0x31f8eb,_0x552cd9){var _0x21bed2=a0_0x52f229;EmployeeID=0x0,ItemID=0x0,SelectedDate='',TDID=_0x552cd9,EmployeeID=_0x3ef2ce,ItemID=_0x31f8eb;var _0x1efe99=_0x552cd9['toString'](),_0x4f8695=_0x1efe99[_0x21bed2(0x111)](0x0,0x4)+'-'+_0x1efe99[_0x21bed2(0x111)](0x4,0x6)+'-'+_0x1efe99[_0x21bed2(0x111)](0x6,0x8),_0x422d91=new Date(_0x4f8695);SelectedDate=_0x422d91[_0x21bed2(0x107)]()[_0x21bed2(0xb6)]('T')[0x0];var _0x5dbdb5=formatDateReportEmp(_0x422d91);$(_0x21bed2(0x116))['text'](_0x5dbdb5),GetHolidays(_0x4f8695);}function UpdateAttendance(){var _0xd6546b=a0_0x52f229;ItemID==0x0?(G_Validateholiday==!![]?confirm(_0xd6546b(0xdd))&&PushNewAttendance():PushNewAttendance(),Applyfilter(),LoadAllHolidays()):(G_Validateholiday==!![]?confirm(_0xd6546b(0xdd))&&ModifyAttendance():ModifyAttendance(),Applyfilter(),LoadAllHolidays());}function PushNewAttendance(){var _0x3882e7=a0_0x52f229;$(_0x3882e7(0x12a))['val']()!=_0x3882e7(0x88)||G_Validateholiday==!![]?$[_0x3882e7(0x131)]({'url':_spPageContextInfo[_0x3882e7(0x95)]+_0x3882e7(0x153),'type':_0x3882e7(0x8a),'async':![],'data':JSON[_0x3882e7(0xc7)]({'__metadata':{'type':_0x3882e7(0x11e)},'AttendanceDate':SelectedDate,'EmployeeId':EmployeeID,'AttendanceType':$(_0x3882e7(0x12a))[_0x3882e7(0xec)]()}),'headers':{'Accept':'application/json;odata=verbose','Content-Type':'application/json;odata=verbose','X-RequestDigest':$('#__REQUESTDIGEST')[_0x3882e7(0xec)](),'X-HTTP-Method':_0x3882e7(0x8a)},'success':function(_0x5aeb6e,_0x399541,_0x4a379d){var _0x4a5b86=_0x3882e7;$(_0x4a5b86(0xca)+TDID)[_0x4a5b86(0x143)]($(_0x4a5b86(0x12a))[_0x4a5b86(0xec)]()),alert(_0x4a5b86(0xb5)),$(_0x4a5b86(0x10b))[_0x4a5b86(0xdb)](_0x4a5b86(0x110)),GetAttendanceorLeaves();},'error':function(_0x294671,_0x47e8c0,_0x41a620){var _0x5d5b99=_0x3882e7;alert(_0x5d5b99(0x119));}}):alert('Plese\x20select\x20proper\x20attandence.');}function ModifyAttendance(){var _0xcb1633=a0_0x52f229;$(_0xcb1633(0x12a))['val']()!='Holiday'||G_Validateholiday==!![]?$[_0xcb1633(0x131)]({'url':_spPageContextInfo[_0xcb1633(0x95)]+_0xcb1633(0xbd)+ItemID+')','type':_0xcb1633(0x8a),'async':![],'data':JSON[_0xcb1633(0xc7)]({'__metadata':{'type':_0xcb1633(0x11e)},'AttendanceType':$(_0xcb1633(0x12a))[_0xcb1633(0xec)]()}),'headers':{'Accept':'application/json;odata=verbose','Content-Type':_0xcb1633(0xea),'X-RequestDigest':$('#__REQUESTDIGEST')[_0xcb1633(0xec)](),'IF-MATCH':'*','X-HTTP-Method':'MERGE'},'success':function(_0x4c4ad7,_0x99e9ae,_0xc9f733){var _0x3a0c68=_0xcb1633;$(_0x3a0c68(0xca)+TDID)['text']($('#AttendanceDDL')['val']()),$(_0x3a0c68(0xde)+TDID)[_0x3a0c68(0x143)](_0x3a0c68(0x102)),alert(_0x3a0c68(0xb5)),$(_0x3a0c68(0x10b))[_0x3a0c68(0xdb)](_0x3a0c68(0x110)),GetAttendanceorLeaves();},'error':function(_0x2d0b9f,_0x1c866d,_0x21a655){var _0x2d692e=_0xcb1633;alert(_0x2d692e(0x119));}}):alert(_0xcb1633(0x142));}function initializePeoplePicker(_0x3f80dc){var _0x42e144=a0_0x52f229,_0x2246a6={};_0x2246a6[_0x42e144(0x126)]='User,DL,SecGroup,SPGroup',_0x2246a6['SearchPrincipalSource']=0xf,_0x2246a6[_0x42e144(0x118)]=0xf,_0x2246a6[_0x42e144(0xd5)]=![],_0x2246a6[_0x42e144(0xba)]=0x32,_0x2246a6[_0x42e144(0xf4)]=_0x42e144(0xc3),this[_0x42e144(0x8e)](_0x3f80dc,null,_0x2246a6);}function Applyfilter(){var _0x48d8af=a0_0x52f229,_0x5e0db1=moment($(_0x48d8af(0xe3))[_0x48d8af(0xec)](),'LL')[_0x48d8af(0xb9)]('DD\x20MMM\x20YYYY'),_0x27f6d0=moment($(_0x48d8af(0xda))[_0x48d8af(0xec)](),'LL')[_0x48d8af(0xb9)](_0x48d8af(0x10e));if(Date[_0x48d8af(0x14e)](_0x5e0db1)>Date[_0x48d8af(0x14e)](_0x27f6d0))alert(_0x48d8af(0x7b));else{$(_0x48d8af(0x13b))[_0x48d8af(0xdb)](_0x48d8af(0x110));var _0x5d3d20=$[_0x48d8af(0xd7)](_0x48d8af(0x11a)),_0x24d5a4=$(_0x48d8af(0xe3))[_0x48d8af(0x91)]('getDate'),_0x3a3f49=$(_0x48d8af(0xda))[_0x48d8af(0x91)](_0x48d8af(0x154));days=(_0x3a3f49-_0x24d5a4)/(0x3e8*0x3c*0x3c*0x18),Totaldays=Math[_0x48d8af(0xa1)](days)+0x1,$(_0x48d8af(0x12e))['text'](formatDateReportEmp($('#EmpreportFrom')[_0x48d8af(0xec)]())),$(_0x48d8af(0xc2))[_0x48d8af(0x143)](formatDateReportEmp($('#EmpreportTo')[_0x48d8af(0xec)]()));var _0x5e0db1=moment($('#EmpreportFrom')[_0x48d8af(0xec)](),'LL')[_0x48d8af(0xb9)]('YYYY-MM-DD'),_0x27f6d0=moment($(_0x48d8af(0xda))[_0x48d8af(0xec)](),'LL')[_0x48d8af(0xb9)]('YYYY-MM-DD'),_0x1a3991=new Date(_0x27f6d0),_0x5945af=_0x1a3991[_0x48d8af(0x107)](),_0x553cd5=_0x5945af['split']('T');GstartDate=_0x5e0db1;var _0xc6fe2e=ensureUser($(_0x48d8af(0x82))[_0x48d8af(0x12f)]()[_0x48d8af(0x12f)]()[_0x48d8af(0xfb)]('id'));if(_0xc6fe2e==0x0){_0x5d3d20=_0x5d3d20,GEmpID=_0x5d3d20;var _0x299105=_spPageContextInfo[_0x48d8af(0x95)]+'/_api/lists/getbytitle(\x27EmpAttendance\x27)/items?$select=HrAction,ID,Title,WorkHours,AttendanceDate,AttendanceType,Employee/Title,Employee/ID&$Expand=Employee&$top=5000&$filter=AttendanceDate\x20ge\x20\x27'+_0x5e0db1+_0x48d8af(0x12c)+_0x553cd5[0x0]+'\x27\x20and\x20Employee\x20eq\x20\x27'+_0x5d3d20+'\x27\x20';getFileData(_0x299105);var _0x444e7e=_spPageContextInfo[_0x48d8af(0x95)]+_0x48d8af(0xe0)+_0x5d3d20+_0x48d8af(0xcb)+CompanyID+'\x27';EmployeeListDat(_0x444e7e);}else{if(ISHRADMIN==!![]){_0x5d3d20=_0xc6fe2e,GEmpID=_0xc6fe2e;var _0x299105=_spPageContextInfo[_0x48d8af(0x95)]+_0x48d8af(0xa6)+_0x5e0db1+_0x48d8af(0x12c)+_0x553cd5[0x0]+_0x48d8af(0xd8)+_0x5d3d20+'\x27\x20';getFileData(_0x299105);var _0x444e7e=_spPageContextInfo[_0x48d8af(0x95)]+'/_api/web/lists/GetByTitle(\x27Employees\x27)/items?$top=5000&$select=ID,FullName,Designation,LogonName/ID,LogonName/Title,Department/DepartmentName,Company/CompanyName,Company/ID,OfficeLocation/ID,OfficeLocation/OfficeName&$orderby=FullName&$expand=LogonName,OfficeLocation,Company,Department&$filter=LogonName\x20eq\x20\x27'+_0x5d3d20+_0x48d8af(0xcb)+CompanyID+'\x27';EmployeeListDat(_0x444e7e);}else alert(_0x48d8af(0xbf));}LoadAllHolidays();}}var DataIdList=[],EmpAttendanceData=[],TotalLeavesorAbsent=[];function getFileData(_0x11b717){var _0x194ccf=a0_0x52f229;jQuery['ajax']({'url':_0x11b717,'headers':{'Accept':_0x194ccf(0xea)},'async':![],'success':function(_0x94fc55){var _0x356792=_0x194ccf;EmpAttendanceData=[];var _0x2f5958=_0x94fc55['d']['results'];DataIdList=[];var _0x1a7560=[];TotalLeavesorAbsent=[];for(var _0x4ab7c7=0x0;_0x4ab7c7<_0x2f5958[_0x356792(0x12b)];_0x4ab7c7++){if(_0x2f5958[_0x4ab7c7][_0x356792(0x117)]!='On-Leave'&&_0x2f5958[_0x4ab7c7][_0x356792(0x117)]!='Holiday')_0x1a7560[_0x356792(0xac)](_0x2f5958[_0x4ab7c7][_0x356792(0x117)]);else{if(_0x2f5958[_0x4ab7c7][_0x356792(0x117)]==_0x356792(0x10c))TotalLeavesorAbsent['push'](_0x2f5958[_0x4ab7c7][_0x356792(0x117)]);else _0x2f5958[_0x4ab7c7]['AttendanceType']==_0x356792(0x88)&&TotalLeavesorAbsent[_0x356792(0xac)](_0x2f5958[_0x4ab7c7][_0x356792(0x117)]);}var _0x5dd603=_0x2f5958[_0x4ab7c7]['ID'],_0x5b392f=_0x2f5958[_0x4ab7c7]['Employee'][_0x356792(0x8b)],_0x226675=_0x2f5958[_0x4ab7c7]['Employee']['ID'],_0x5bd9a6=formatDateReportEmp(_0x2f5958[_0x4ab7c7][_0x356792(0x87)]),_0x2d2823=_0x2f5958[_0x4ab7c7][_0x356792(0x117)],_0x193b44=_0x2f5958[_0x4ab7c7]['WorkHours'],_0x410bd0=_0x2f5958[_0x4ab7c7][_0x356792(0x84)];EmpAttendanceData[_0x356792(0xac)]({'UserId':_0x226675,'EmpName':_0x5b392f,'AttendanceDate':_0x5bd9a6,'AttendanceType':_0x2d2823,'AttendanceItemId':_0x5dd603,'EmpWorkHours':_0x193b44,'HrAction':_0x410bd0});}var _0x4663ac='';$(_0x356792(0x79))[_0x356792(0x138)]();var _0x2e0b3f=0x0,_0x4bbb1a=0x0;for(var _0x1a8098=0x0;_0x1a8098<Totaldays;_0x1a8098++){var _0x5cfc13=new Date(GstartDate);_0x5cfc13['setDate'](_0x5cfc13[_0x356792(0x154)]()+_0x1a8098);var _0x5b56b7=moment(_0x5cfc13,_0x356792(0xf6))[_0x356792(0xb9)](_0x356792(0x147)),_0x5b56b7=_0x5b56b7[_0x356792(0xb6)]('-')[_0x356792(0xd9)]('');DataIdList[_0x356792(0xac)](_0x5b56b7);var _0x505d82=formatDateReportEmp(_0x5cfc13),_0xee1294=EmpAttendanceData[_0x356792(0x129)](function(_0x52ec16){return _0x52ec16['AttendanceDate'];})['indexOf'](_0x505d82);if(_0xee1294!=-0x1){var _0x369495=EmpAttendanceData[_0xee1294][_0x356792(0x117)],_0x1657c4=EmpAttendanceData[_0xee1294][_0x356792(0xd3)],_0x410bd0=EmpAttendanceData[_0xee1294][_0x356792(0x84)],_0x4b202e=EmpAttendanceData[_0xee1294]['UserId'],_0x37e95c=EmpAttendanceData[_0xee1294][_0x356792(0x149)],_0x46fcd4=EmpAttendanceData[_0xee1294]['AttendanceDate'],_0x1a823e=_0x356792(0xae),_0x4c949a='block';_0x410bd0==!![]&&(_0x1a823e='block',_0x4c949a=_0x356792(0xae));if(_0x369495!=_0x356792(0x10c)&&_0x369495!=_0x356792(0x88)){if(_0x1657c4==null)var _0x2bb35a=_0x356792(0x11c)+_spPageContextInfo[_0x356792(0x95)]+_0x356792(0x101)+_0x5b56b7+_0x356792(0xd4)+window[_0x356792(0xab)](_0x356792(0xf5))+_0x356792(0x98)+_0x5b56b7+'\x27>Fill</span></a>';else var _0x2bb35a='<a\x20href=\x27'+_spPageContextInfo[_0x356792(0x95)]+_0x356792(0x101)+_0x5b56b7+'&Mode='+window[_0x356792(0xab)](_0x356792(0xf5))+_0x356792(0xad)+ConvertHHMM(_0x1657c4)+'</a>';}else var _0x2bb35a='';var _0x34fe40=![],_0x26bd29=Date[_0x356792(0x14e)](_0x46fcd4[_0x356792(0xb6)](',')[0x0]),_0x1adb3b=new Date(),_0x52f3f0=Date['parse'](moment(_0x1adb3b)['format'](_0x356792(0x10e)));_0x26bd29>_0x52f3f0&&(_0x34fe40=!![]),_0x4bbb1a=_0x4bbb1a+0x1,_0x34fe40!=!![]?(_0x4663ac+=_0x356792(0xbc),_0x4663ac+=_0x356792(0x150)+_0x5b56b7+_0x356792(0x9f)+formatDateReportEmp(_0x5cfc13)+'</span><span\x20id=\x27H'+_0x5b56b7+_0x356792(0x145),_0x4663ac+=_0x356792(0xb4)+_0x5b56b7+'>'+_0x369495+_0x356792(0x135),_0x4663ac+=_0x356792(0x13a)+_0x5b56b7+'>'+_0x2bb35a+_0x356792(0x135),_0x4663ac+=_0x356792(0xe2)+_0x1a823e+_0x356792(0xbb),_0x4663ac+=_0x356792(0xb7)+_0x4c949a+'\x20\x27><a\x20href=\x27#\x27\x20class=\x27custom-edit-btn\x27\x20data-toggle=\x27modal\x27\x20data-target=\x27#attendance-reportEdit\x27\x20onclick=\x27attendanceEditModal('+GEmpID+','+_0x37e95c+','+_0x5b56b7+_0x356792(0xf0),_0x4663ac+=_0x356792(0xfe)):(_0x4663ac+=_0x356792(0xbc),_0x4663ac+=_0x356792(0x150)+_0x5b56b7+'><span>'+formatDateReportEmp(_0x5cfc13)+_0x356792(0x128)+_0x5b56b7+_0x356792(0x145),_0x4663ac+='<td\x20class=\x27text-left\x27><div\x20class=\x27attendance-report-table-ellipsis-2\x27\x20id=Att'+_0x5b56b7+'>'+_0x369495+'<a\x20href=\x27#\x27\x20class=\x27Withdraw-Leave-link\x27\x20onclick=\x27WithdrawLeave('+_0x37e95c+','+_0x5b56b7+_0x356792(0xf8),_0x4663ac+='<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27\x20id=Time'+_0x5b56b7+'>'+_0x2bb35a+_0x356792(0x135),_0x4663ac+=_0x356792(0xe2)+_0x1a823e+'\x20\x27><label><i\x20class=\x27fa\x20fa-check\x27\x20aria-hidden=\x27true\x27\x20style=\x27color:\x20red;\x27></i></label></div></td>',_0x4663ac+=_0x356792(0xb7)+_0x4c949a+_0x356792(0xa8),_0x4663ac+='</tr>');}else{var _0x39da9b=formatDateReportEmp(_0x5cfc13),_0x34fe40=![],_0x26bd29=Date['parse'](_0x39da9b[_0x356792(0xb6)](',')[0x0]),_0x1adb3b=new Date(),_0x52f3f0=Date[_0x356792(0x14e)](moment(_0x1adb3b)[_0x356792(0xb9)](_0x356792(0x10e)));_0x26bd29>_0x52f3f0&&(_0x34fe40=!![]);_0x2e0b3f=_0x2e0b3f+0x1;if(_0x34fe40!=!![]){var _0x3e6851=_0x356792(0x11c)+_spPageContextInfo['webAbsoluteUrl']+_0x356792(0x101)+_0x5b56b7+'&Mode='+window['btoa']('View')+'&sourcelocation=../Pages/Myworkplace.aspx\x27\x20><span\x20id=\x27Timeview'+_0x5b56b7+_0x356792(0x109);_0x4663ac+=_0x356792(0xbc),_0x4663ac+=_0x356792(0x150)+_0x5b56b7+_0x356792(0x9f)+formatDateReportEmp(_0x5cfc13)+'</span><span\x20id=\x27H'+_0x5b56b7+_0x356792(0x145),_0x4663ac+='<td\x20class=\x27text-left\x27><div\x20class=\x27attendance-report-table-ellipsis-2\x27\x20id=Att'+_0x5b56b7+'></div></td>',_0x4663ac+='<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27\x20id=Time'+_0x5b56b7+_0x356792(0x136),_0x4663ac+='<td><div\x20class=\x27checkbox\x20m-0\x27></div></td>',_0x4663ac+=_0x356792(0x120)+GEmpID+_0x356792(0x103)+_0x5b56b7+_0x356792(0xf0),_0x4663ac+=_0x356792(0xfe);}else{var _0x3e6851='<a\x20class=\x27LinkBtn\x27\x20href=\x27'+_spPageContextInfo[_0x356792(0x95)]+'/Pages/TimeSheetEntry.aspx?WebAppId=2&Recall='+_0x5b56b7+_0x356792(0xd4)+window[_0x356792(0xab)](_0x356792(0xf5))+_0x356792(0x98)+_0x5b56b7+_0x356792(0x109);_0x4663ac+=_0x356792(0xbc),_0x4663ac+=_0x356792(0x150)+_0x5b56b7+_0x356792(0x9f)+formatDateReportEmp(_0x5cfc13)+_0x356792(0x128)+_0x5b56b7+'\x27\x20class=\x27employee-report-holiday\x27></span></div></td>',_0x4663ac+='<td\x20class=\x27text-left\x27><div\x20class=\x27attendance-report-table-ellipsis-2\x27\x20id=Att'+_0x5b56b7+_0x356792(0x136),_0x4663ac+='<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27\x20id=Time'+_0x5b56b7+_0x356792(0x136),_0x4663ac+=_0x356792(0x137),_0x4663ac+=_0x356792(0x13d),_0x4663ac+=_0x356792(0xfe);}}}var _0x3307b=$[_0x356792(0xe6)](_0x2f5958,function(_0x3e3aed){var _0x25fac5=_0x356792;return _0x3e3aed[_0x25fac5(0x117)]!=_0x25fac5(0x10c)&&_0x3e3aed['AttendanceType']!=_0x25fac5(0x88);}),_0x52a35f=parseInt(TotalLeavesorAbsent[_0x356792(0x12b)])+parseInt(_0x2e0b3f)-parseInt($(_0x356792(0x13c))[_0x356792(0x143)]());_0x52a35f<0x0&&(_0x52a35f=0x0);$(_0x356792(0x130))[_0x356792(0x110)](),$(_0x356792(0x13e))[_0x356792(0x143)](Totaldays);var _0xda9b81=parseInt(_0x4bbb1a)-parseInt(TotalLeavesorAbsent[_0x356792(0x12b)]);$('#Total-Attendance')[_0x356792(0x143)](_0x3307b[_0x356792(0x12b)]),$(_0x356792(0x79))['append'](_0x4663ac),EmpTableConfiguration();},'error':function(_0x1c3891,_0x3356e6){var _0x1f8a2e=_0x194ccf;console['log'](JSON[_0x1f8a2e(0xc7)](_0x1c3891));}});}function WithdrawLeave(_0x4feaed,_0x46543f){var _0x1066fa=a0_0x52f229;confirm(_0x1066fa(0x11b))&&$[_0x1066fa(0x131)]({'url':_spPageContextInfo[_0x1066fa(0x95)]+_0x1066fa(0xbd)+_0x4feaed+')','type':_0x1066fa(0x8a),'headers':{'X-RequestDigest':$(_0x1066fa(0xe8))[_0x1066fa(0xec)](),'IF-MATCH':'*','X-HTTP-Method':'DELETE'},'success':function(_0x5c66cc,_0x588af3,_0x19942d){var _0x8a5ab1=_0x1066fa;$(_0x8a5ab1(0xca)+_0x46543f)[_0x8a5ab1(0xc0)](_0x8a5ab1(0xe1),_0x8a5ab1(0xae)),alert(_0x8a5ab1(0xed));},'error':function(_0x3014cc,_0x268c60,_0x59d9f1){var _0x1f0129=_0x1066fa;$(_0x1f0129(0xff))['empty']()[_0x1f0129(0x143)](data[_0x1f0129(0x7a)][_0x1f0129(0x11d)]);}});}function ConvertDateTimeFormat(_0x13dcf1,_0x3f8d1d){var _0x1dbff6=a0_0x52f229;return _0x13dcf1[_0x1dbff6(0xb6)](_0x3f8d1d)[0x1]+''+_0x3f8d1d+''+_0x13dcf1[_0x1dbff6(0xb6)](_0x3f8d1d)[0x0]+''+_0x3f8d1d+''+_0x13dcf1[_0x1dbff6(0xb6)](_0x3f8d1d)[0x2];}var GEmployeeID=0x0,LocID=0x0;function EmployeeListDat(_0x4e9010){var _0x4e57cc=a0_0x52f229;GEmployeeID=0x0,$['ajax']({'url':_0x4e9010,'headers':{'Accept':_0x4e57cc(0xea)},'async':![],'success':function(_0x26f14e){var _0x3fede6=_0x4e57cc,_0x4dadce=_0x26f14e['d']['results'];_0x4dadce['length']>0x0?($(_0x3fede6(0x114))[_0x3fede6(0x143)](_0x4dadce[0x0][_0x3fede6(0x9e)][_0x3fede6(0x8b)]),GEmployeeID=_0x4dadce[0x0]['LogonName']['ID'],$(_0x3fede6(0xc6))['text'](_0x4dadce[0x0]['LogonName'][_0x3fede6(0x8b)]),$(_0x3fede6(0xa5))[_0x3fede6(0x143)](_0x4dadce[0x0]['OfficeLocation']['OfficeName']),$(_0x3fede6(0xaf))[_0x3fede6(0x143)](_0x4dadce[0x0][_0x3fede6(0x134)][_0x3fede6(0xcd)]),LocID=_0x4dadce[0x0][_0x3fede6(0x134)]['ID']):($('#EmpName')[_0x3fede6(0x143)](''),$(_0x3fede6(0xa5))['text'](''),LocID=0x0);},'error':function(_0x353874){var _0x4e42da=_0x4e57cc;console[_0x4e42da(0xf2)](_0x353874);}});}function EmpTableConfiguration(){var _0x508ec6=a0_0x52f229;sorter=new TINY[(_0x508ec6(0x112))][(_0x508ec6(0x9b))](_0x508ec6(0x9b),_0x508ec6(0x94),{'ascclass':_0x508ec6(0x14d),'descclass':_0x508ec6(0xe9),'evenclass':_0x508ec6(0x7e),'oddclass':'oddrow','evenselclass':_0x508ec6(0x140),'oddselclass':_0x508ec6(0xc5),'paginate':!![],'size':0xa,'colddid':_0x508ec6(0x92),'currentid':'Empcurrentpage','totalid':_0x508ec6(0x113),'startingrecid':_0x508ec6(0xb3),'endingrecid':_0x508ec6(0x115),'totalrecid':_0x508ec6(0x144),'hoverid':_0x508ec6(0xa9),'pageddid':_0x508ec6(0x100),'navid':'tablenav','sortdir':0x1,'init':!![]});}$[a0_0x52f229(0xd7)]=function(_0x18bf15){var _0x5add54=a0_0x52f229,_0x16cfe9=new RegExp('[?&]'+_0x18bf15+_0x5add54(0xfc))[_0x5add54(0xf1)](window[_0x5add54(0xeb)][_0x5add54(0xc4)]);if(_0x16cfe9==null)return null;return decodeURI(_0x16cfe9[0x1])||0x0;};function a0_0x13b5(){var _0x1122d0=['EmpWorkHours','&Mode=','AllowMultipleValues','nodeType','urlParam','\x27\x20and\x20Employee\x20eq\x20\x27','join','#EmpreportTo','modal','Employee','This\x20is\x20a\x20Holiday,\x20are\x20you\x20sure\x20to\x20submit\x20your\x20attendance.','#Timeview','#EdateTH','/_api/web/lists/GetByTitle(\x27Employees\x27)/items?$top=5000&$select=ID,FullName,Designation,LogonName/ID,LogonName/Title,Department/DepartmentName,Company/CompanyName,Company/ID,OfficeLocation/ID,OfficeLocation/OfficeName&$orderby=FullName&$expand=LogonName,OfficeLocation,Company,Department&$filter=LogonName\x20eq\x20\x27','display','<td><div\x20class=\x27checkbox\x20m-0\x27\x20style=\x27display:\x20','#EmpreportFrom','floor','On-LeaveWithdraw','grep','getFullYear','#__REQUESTDIGEST','desc','application/json;odata=verbose','location','val','Leave\x20withdrawal\x20Successfully\x20Completed.','Apr','368324KSpajN',')\x27><i\x20class=\x27fa\x20fa-pencil\x27></i></a></div></td>','exec','log','SPClientPeoplePicker','Width','View','DD/MM/YYYY','9581mSobVO',')\x27>Withdraw</a></div></td>','data:application/vnd.ms-excel;base64,','color','attr','=([^&#]*)','Sunday','</tr>','#ResultDiv','Emppagedropdown','/Pages/TimeSheetEntry.aspx?WebAppId=2&Recall=','00:00',',0,','Wednesday','105JpJaki','SPClientPeoplePickerDict','toISOString','/_api/web/lists/getbytitle(\x27CompanyHoliday\x27)/items?select=*,ID,Title&$filter=OfficeLocationID\x20eq\x20\x27','\x27>Fill</span></a>','userId','#attendance-reportEdit','On-Leave','Oct','DD\x20MMM\x20YYYY','Worksheet','hide','slice','table','Emptotalpages','#EmpName','Empendrecord','#SelDate','AttendanceType','ResolvePrincipalSource','Error!\x20Something\x20went\x20wrong.','EID','Are\x20you\x20sure\x20to\x20withdraw\x20the\x20Leave?','<a\x20class=\x27LinkBtn\x27\x20href=\x27','error','SP.Data.EmpAttendanceListItem','Dec','<td><div\x20class=\x27attendance-report-edit-lock-btn-box\x20text-center\x27><a\x20href=\x27#\x27\x20class=\x27custom-edit-btn\x27\x20data-toggle=\x27modal\x27\x20data-target=\x27#attendance-reportEdit\x27\x20onclick=\x27attendanceEditModal(','#TotalWorkdayTH','270ggWjVW','/_api/web/lists/getbytitle(\x27CompanyHoliday\x27)/items?$filter=OfficeLocationID\x20eq\x20(\x27','\x20,\x20','Mar','PrincipalAccountType','results','</span><span\x20id=\x27H','map','#AttendanceDDL','length','\x27\x20and\x20AttendanceDate\x20le\x20\x27','#Total-Attendance','#StartDate','children','.NoRecordFound','ajax','setDate','getDay','OfficeLocation','</div></td>','></div></td>','<td><div\x20class=\x27checkbox\x20m-0\x27></div></td>','empty','end','<td><div\x20class=\x27attendance-report-table-ellipsis-2\x27\x20id=Time','#attendance-report-filter','#HoliaysTotal','<td><div\x20class=\x27attendance-report-edit-lock-btn-box\x20text-center\x27></div></td>','#EmpTotalItemscount','get','evenselected','233499PpPeDp','Plese\x20select\x20proper\x20attandence.','text','Emptotalrecords','\x27\x20class=\x27employee-report-holiday\x27></span></div></td>','/_api/web/lists/getbytitle(\x27','YYYY-MM-DD','red','AttendanceItemId','21389220ABbUfR','13xatEbi','Sept','asc','parse','UserId','<td\x20class=\x27text-left\x27><div\x20class=\x27attendance-report-table-ellipsis-2\x27\x20id=','1353265wkWeaZ','Key','/_api/web/lists/GetByTitle(\x27EmpAttendance\x27)/items','getDate','#EmpReportTable','responseJSON','Invalid\x20date\x20range.\x0aFrom\x20Date\x20should\x20not\x20be\x20bigger\x20than\x20To\x20Date','#HolidayMessage','#Total-Leave-Absent','evenrow','#FdateTH','Jul','Nov','#EmployeeName','238296hRSYzh','HrAction','ready','getMonth','AttendanceDate','Holiday','indexOf','POST','Title','CompanyId','Jun','SPClientPeoplePicker_InitStandaloneControlWrapper','\x27&$top=200&$orderby=Holiday_start\x20asc','116040jnkNPM','datepicker','columns','WorkHours','EmpReportTableData','webAbsoluteUrl','Holiday_start','GetAllUserInfo','&sourcelocation=../Pages/Myworkplace.aspx\x27\x20><span\x20id=\x27Timeview','\x27)and\x20Holiday_start\x20eq\x20\x27','#HolidayMessagediv','sorter','May','\x27\x20and\x20Holiday_start\x20le\x20\x27','LogonName','><span>','2490xxQHuC','round','Withdraw','\x27)/items?$select=*,Department/DepartmentName,Department/ID&$expand=Department&$filter=CompanyId\x20eq\x20\x27','replace','#OfficeLoc','/_api/lists/getbytitle(\x27EmpAttendance\x27)/items?$select=HrAction,ID,Title,WorkHours,AttendanceDate,AttendanceType,Employee/Title,Employee/ID&$Expand=Employee&$top=5000&$filter=AttendanceDate\x20ge\x20\x27','\x27\x20and\x20ContributorsId\x20eq\x20\x27','\x20\x27></div></td>','selectedrow','/_api/web/ensureuser','btoa','push','&sourcelocation=../Pages/Myworkplace.aspx\x27>','none','#officeLocTH','block','An\x20error\x20occurred.\x20Please\x20try\x20again.','Jan','Empstartrecord','<td\x20class=\x27text-left\x27><div\x20class=\x27attendance-report-table-ellipsis-2\x27\x20id=Att','Data\x20has\x20been\x20saved.','split','<td><div\x20class=\x27attendance-report-edit-lock-btn-box\x20text-center\x27\x20style=\x27display:\x20','\x27\x20and\x20CompanyID\x20eq\x20\x27','format','MaximumEntitySuggestions','\x20\x27><label><i\x20class=\x27fa\x20fa-check\x27\x20aria-hidden=\x27true\x27\x20style=\x27color:\x20red;\x27></i></label></div></td>','<tr\x20class=\x27text-center\x27\x20>','/_api/web/lists/GetByTitle(\x27EmpAttendance\x27)/items(','22iaIeHq','Unauthorized\x20access!','css','MM\x20dd,\x20yy','#EndDate','280px','href','oddselected','#EmpTitle','stringify','25CMUTeP','getTime','#Att','\x27\x20and\x20Company/ID\x20\x20eq\x20\x27','#HolidaysTH','OfficeName','#EmpRow','Tuesday','getQueryStringParameter','#Workingdays','Hdate'];a0_0x13b5=function(){return _0x1122d0;};return a0_0x13b5();}function formatDateReportEmp(_0x10cacd){var _0x29346f=a0_0x52f229,_0x4a7c78=[_0x29346f(0xfd),'Monday',_0x29346f(0xcf),_0x29346f(0x104),'Thursday','Friday','Saturday'],_0x2a21fc=new Date(_0x10cacd);if(isNaN(_0x2a21fc[_0x29346f(0xc9)]()))return _0x10cacd;else{var _0x21cd4a=new Array();return _0x21cd4a[0x0]=_0x29346f(0xb2),_0x21cd4a[0x1]='Feb',_0x21cd4a[0x2]=_0x29346f(0x125),_0x21cd4a[0x3]=_0x29346f(0xee),_0x21cd4a[0x4]=_0x29346f(0x9c),_0x21cd4a[0x5]=_0x29346f(0x8d),_0x21cd4a[0x6]=_0x29346f(0x80),_0x21cd4a[0x7]='Aug',_0x21cd4a[0x8]=_0x29346f(0x14c),_0x21cd4a[0x9]=_0x29346f(0x10d),_0x21cd4a[0xa]=_0x29346f(0x81),_0x21cd4a[0xb]=_0x29346f(0x11f),day=_0x2a21fc[_0x29346f(0x154)](),day<0xa&&(day='0'+day),day+'\x20'+_0x21cd4a[_0x2a21fc[_0x29346f(0x86)]()]+'\x20'+_0x2a21fc[_0x29346f(0xe7)]()+',\x20'+_0x4a7c78[_0x2a21fc[_0x29346f(0x133)]()];}}function ConvertHHMM(_0x2fb92d){var _0x2b2367=a0_0x52f229;if(_0x2fb92d!=null){var _0x3388fa=Math[_0x2b2367(0xe4)](_0x2fb92d/0x3c),_0x37c715=_0x2fb92d%0x3c;_0x3388fa<0xa&&(_0x3388fa='0'+_0x3388fa);_0x37c715<0xa&&(_0x37c715='0'+_0x37c715);var _0x19e351=_0x3388fa+':'+_0x37c715;}else var _0x19e351='';return _0x19e351;}var AttandenceOnHolidays=0x0,HolidaysListDTL=[];function LoadAllHolidays(){var _0x48367f=a0_0x52f229;TotalOfficeDays=0x0,HolidaysListDTL=[];var _0x116846=new Date($('#EmpreportFrom')[_0x48367f(0xec)]()),_0xa29fc8=_0x116846['getFullYear']()+'-'+(_0x116846[_0x48367f(0x86)]()+0x1)+'-'+_0x116846['getDate'](),_0x34fc47=new Date($(_0x48367f(0xda))[_0x48367f(0xec)]()),_0x279056=_0x34fc47['getFullYear']()+'-'+(_0x34fc47[_0x48367f(0x86)]()+0x1)+'-'+_0x34fc47['getDate'](),_0x324493=_spPageContextInfo[_0x48367f(0x95)]+_0x48367f(0x108)+LocID+_0x48367f(0xb8)+CompanyID+'\x27\x20and\x20Holiday_start\x20ge\x20\x27'+_0xa29fc8+_0x48367f(0x9d)+_0x279056+'\x27';$[_0x48367f(0x131)]({'url':_0x324493,'headers':{'Accept':'application/json;odata=verbose'},'async':![],'success':function(_0x2a8cff){var _0x3ed1df=_0x48367f,_0x367d72=_0x2a8cff['d'][_0x3ed1df(0x127)][_0x3ed1df(0x12b)],_0x18c05b=0x0;for(var _0x865457=0x0;_0x865457<_0x367d72;_0x865457++){var _0x213426=new Date(_0x2a8cff['d'][_0x3ed1df(0x127)][_0x865457][_0x3ed1df(0x96)]),_0x434b1c=moment(_0x213426,_0x3ed1df(0xf6))['format']('YYYY-MM-DD'),_0x434b1c=_0x434b1c[_0x3ed1df(0xb6)]('-')[_0x3ed1df(0xd9)](''),_0x8d2e58=_0x2a8cff['d'][_0x3ed1df(0x127)][_0x865457][_0x3ed1df(0x8b)];HolidaysListDTL['push']({'Hdate':_0x434b1c,'Title':_0x8d2e58}),$('#'+_0x434b1c)[_0x3ed1df(0xc0)](_0x3ed1df(0xfa),_0x3ed1df(0x148)),$('#H'+_0x434b1c)['text'](_0x3ed1df(0x124)+_0x8d2e58),$(_0x3ed1df(0xca)+_0x434b1c)[_0x3ed1df(0x143)]()!=''&&(_0x18c05b=_0x18c05b+0x1);}AttandenceOnHolidays=0x0;for(var _0x1dc0da=0x0;_0x1dc0da<HolidaysListDTL[_0x3ed1df(0x12b)];_0x1dc0da++){var _0x362cee=$('#Att'+HolidaysListDTL[_0x1dc0da][_0x3ed1df(0xd2)])['text']();_0x362cee!=''&&_0x362cee!=_0x3ed1df(0x10c)&&_0x362cee!=_0x3ed1df(0x88)&&(AttandenceOnHolidays=AttandenceOnHolidays+0x1);}var _0x30f622=0x0,_0x100675=0x0,_0x5e0a45=0x0;for(var _0x3e72c6=0x0;_0x3e72c6<DataIdList[_0x3ed1df(0x12b)];_0x3e72c6++){var _0x3b4341=$(_0x3ed1df(0xca)+DataIdList[_0x3e72c6])[_0x3ed1df(0x143)]();_0x3b4341==_0x3ed1df(0xe5)&&(_0x3b4341=_0x3b4341[_0x3ed1df(0xb6)](_0x3ed1df(0xa2))[0x0]),(_0x3b4341==''||_0x3b4341==_0x3ed1df(0x10c))&&(_0x100675=_0x100675+0x1),_0x3b4341==_0x3ed1df(0x10c)&&(_0x5e0a45=_0x5e0a45+0x1),_0x3b4341==_0x3ed1df(0x88)&&(_0x30f622=_0x30f622+0x1);}var _0x4c492a=_0x100675+AttandenceOnHolidays-(_0x367d72-_0x30f622);_0x4c492a<0x0&&(_0x4c492a=0x0),_0x4c492a!='0'?$(_0x3ed1df(0x7d))[_0x3ed1df(0x143)](_0x4c492a):_0x5e0a45>0x0&&$(_0x3ed1df(0x7d))['text'](_0x5e0a45),$(_0x3ed1df(0x13c))[_0x3ed1df(0x143)](_0x367d72),$(_0x3ed1df(0xd1))['text'](parseInt(Totaldays)-parseInt(_0x367d72)),$(_0x3ed1df(0x7f))[_0x3ed1df(0x143)](formatDateReportEmp(ConvertDateTimeFormat($('#EmpreportFrom')[_0x3ed1df(0xec)](),'/'))),$(_0x3ed1df(0xdf))[_0x3ed1df(0x143)](formatDateReportEmp(ConvertDateTimeFormat($(_0x3ed1df(0xda))[_0x3ed1df(0xec)](),'/'))),$(_0x3ed1df(0x121))['text'](parseInt(Totaldays)-parseInt(_0x367d72)),$(_0x3ed1df(0xcc))[_0x3ed1df(0x143)](_0x367d72);},'myError':function(_0x49b2b3){}});}function ensureUser(_0x35f159){var _0x170646=a0_0x52f229,_0x382dbf=0x0,_0x169fd3=_0x35f159,_0x4e7779=this[_0x170646(0xf3)][_0x170646(0x106)][_0x169fd3],_0x15c681=_0x4e7779[_0x170646(0x97)](),_0x51bc5d=_0x15c681[0x0];if(_0x51bc5d){var _0x2a1b0b={'logonName':_0x51bc5d[_0x170646(0x152)]};$[_0x170646(0x131)]({'url':_spPageContextInfo['webAbsoluteUrl']+_0x170646(0xaa),'type':_0x170646(0x8a),'async':![],'contentType':_0x170646(0xea),'data':JSON[_0x170646(0xc7)](_0x2a1b0b),'headers':{'X-RequestDigest':$('#__REQUESTDIGEST')[_0x170646(0xec)](),'accept':_0x170646(0xea)},'success':function(_0x3165f9,_0x25dd71,_0x18acb0){_0x382dbf=_0x3165f9['d']['Id'];},'error':function(_0x1890d1,_0x3cc74c,_0x10b44b){}});}else _0x382dbf=0x0;return _0x382dbf;}var tableToExcel=(function(){var _0x3a0de7=a0_0x52f229,_0x9ba7c9=_0x3a0de7(0xf9),_0x3efcad='<html\x20xmlns:o=\x22urn:schemas-microsoft-com:office:office\x22\x20xmlns:x=\x22urn:schemas-microsoft-com:office:excel\x22\x20xmlns=\x22http://www.w3.org/TR/REC-html40\x22><head><!--[if\x20gte\x20mso\x209]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>{table}</table></body></html>',_0x5dabfd=function(_0x28c21e){var _0x3bc8bb=_0x3a0de7;return window[_0x3bc8bb(0xab)](unescape(encodeURIComponent(_0x28c21e)));},_0x42e7e5=function(_0x1487b0,_0x3ac52d){var _0x43752c=_0x3a0de7;return _0x1487b0[_0x43752c(0xa4)](/{(\w+)}/g,function(_0x45b7ec,_0x50a831){return _0x3ac52d[_0x50a831];});};return function(_0x8f06f9,_0x48b4da){var _0xac8472=_0x3a0de7;if(!_0x8f06f9[_0xac8472(0xd6)])_0x8f06f9=document['getElementById'](_0x8f06f9);var _0x415444={'worksheet':_0x48b4da||_0xac8472(0x10f),'table':_0x8f06f9['innerHTML']};window[_0xac8472(0xeb)]['href']=_0x9ba7c9+_0x5dabfd(_0x42e7e5(_0x3efcad,_0x415444));};}()),ISHRADMIN=![];function ValidateHrAdmin(){var _0x3f5afb=a0_0x52f229,_0xa9f277='ProcessApprovers',_0x199061=_spPageContextInfo[_0x3f5afb(0x95)]+_0x3f5afb(0x146)+_0xa9f277+_0x3f5afb(0xa3)+titanForWork[_0x3f5afb(0xd0)]('CompanyId')+_0x3f5afb(0xa7)+_spPageContextInfo[_0x3f5afb(0x10a)]+'\x27\x20and\x20(WebPartName\x20eq\x20\x27HR\x20Admin\x27)';$['ajax']({'url':_0x199061,'async':![],'type':_0x3f5afb(0x13f),'headers':{'Accept':_0x3f5afb(0xea)},'success':function(_0x48ec4c){var _0xe9b5cf=_0x3f5afb,_0xb2aeda=_0x48ec4c['d'][_0xe9b5cf(0x127)];_0xb2aeda[_0xe9b5cf(0x12b)]>0x0?($(_0xe9b5cf(0xce))['css'](_0xe9b5cf(0xe1),_0xe9b5cf(0xb0)),ISHRADMIN=!![]):(ISHRADMIN=![],$(_0xe9b5cf(0xce))[_0xe9b5cf(0x110)]());},'error':function(_0x5bbdf0){var _0x47e008=_0x3f5afb;console[_0x47e008(0xf2)](_0x5bbdf0[_0x47e008(0x7a)][_0x47e008(0x11d)]);}});}function GetAttendanceorLeaves(){var _0x21e42c=a0_0x52f229,_0x3bb96e=$['urlParam'](_0x21e42c(0x11a)),_0x159239=$(_0x21e42c(0xe3))['datepicker']('getDate'),_0x172dfb=$(_0x21e42c(0xda))[_0x21e42c(0x91)](_0x21e42c(0x154));days=(_0x172dfb-_0x159239)/(0x3e8*0x3c*0x3c*0x18),Totaldays=Math[_0x21e42c(0xa1)](days)+0x1,$(_0x21e42c(0x12e))[_0x21e42c(0x143)](formatDateReportEmp($(_0x21e42c(0xe3))['val']())),$(_0x21e42c(0xc2))[_0x21e42c(0x143)](formatDateReportEmp($(_0x21e42c(0xda))['val']()));var _0x2cb388=moment($('#EmpreportFrom')[_0x21e42c(0xec)](),'LL')[_0x21e42c(0xb9)](_0x21e42c(0x147)),_0x186185=moment($(_0x21e42c(0xda))['val'](),'LL')[_0x21e42c(0xb9)](_0x21e42c(0x147)),_0x495956=new Date(_0x186185),_0x499599=_0x495956[_0x21e42c(0x107)](),_0x50726f=_0x499599[_0x21e42c(0xb6)]('T');GstartDate=_0x2cb388;var _0xb9f41b=ensureUser($(_0x21e42c(0x82))[_0x21e42c(0x12f)]()[_0x21e42c(0x12f)]()[_0x21e42c(0xfb)]('id'));if(_0xb9f41b==0x0){var _0x3469a4=_spPageContextInfo[_0x21e42c(0x95)]+_0x21e42c(0xe0)+_0x3bb96e+'\x27\x20and\x20Company/ID\x20\x20eq\x20\x27'+CompanyID+'\x27';EmployeeListDat(_0x3469a4),LoadAllHolidays(),_0x3bb96e=_0x3bb96e,GEmpID=_0x3bb96e;var _0x39fa3f=_spPageContextInfo[_0x21e42c(0x95)]+_0x21e42c(0xa6)+_0x2cb388+_0x21e42c(0x12c)+_0x50726f+_0x21e42c(0xd8)+_0x3bb96e+'\x27\x20';UpdateHeaderfields(_0x39fa3f);}else{if(ISHRADMIN==!![]){_0x3bb96e=_0xb9f41b,GEmpID=_0xb9f41b;var _0x3469a4=_spPageContextInfo[_0x21e42c(0x95)]+'/_api/web/lists/GetByTitle(\x27Employees\x27)/items?$top=5000&$select=ID,FullName,Designation,LogonName/ID,LogonName/Title,Department/DepartmentName,Company/CompanyName,Company/ID,OfficeLocation/ID,OfficeLocation/OfficeName&$orderby=FullName&$expand=LogonName,OfficeLocation,Company,Department&$filter=LogonName\x20eq\x20\x27'+_0x3bb96e+_0x21e42c(0xcb)+CompanyID+'\x27';EmployeeListDat(_0x3469a4),LoadAllHolidays();var _0x39fa3f=_spPageContextInfo[_0x21e42c(0x95)]+'/_api/lists/getbytitle(\x27EmpAttendance\x27)/items?$select=HrAction,ID,Title,WorkHours,AttendanceDate,AttendanceType,Employee/Title,Employee/ID&$Expand=Employee&$top=5000&$filter=AttendanceDate\x20ge\x20\x27'+_0x2cb388+_0x21e42c(0x12c)+_0x50726f+_0x21e42c(0xd8)+_0x3bb96e+'\x27\x20';UpdateHeaderfields(_0x39fa3f);var _0x3469a4=_spPageContextInfo[_0x21e42c(0x95)]+_0x21e42c(0xe0)+_0x3bb96e+_0x21e42c(0xcb)+CompanyID+'\x27';}else alert(_0x21e42c(0xbf));}LoadAllHolidays();}function a0_0x3a6e(_0x106d74,_0x51afe0){var _0x13b57f=a0_0x13b5();return a0_0x3a6e=function(_0x3a6eef,_0x40d8f8){_0x3a6eef=_0x3a6eef-0x79;var _0x486ebe=_0x13b57f[_0x3a6eef];return _0x486ebe;},a0_0x3a6e(_0x106d74,_0x51afe0);}function GetFilterData(_0x13f9db){var _0x1bd85c=a0_0x52f229;jQuery[_0x1bd85c(0x131)]({'url':_0x13f9db,'headers':{'Accept':'application/json;odata=verbose'},'async':![],'success':function(_0x3a91f4){var _0x3f7ad6=_0x1bd85c,_0x4229da=_0x3a91f4['d'][_0x3f7ad6(0x127)],_0x3ad342=[];TotalLeavesorAbsent=[];for(var _0x4b9d90=0x0;_0x4b9d90<_0x4229da[_0x3f7ad6(0x12b)];_0x4b9d90++){if(_0x4229da[_0x4b9d90][_0x3f7ad6(0x117)]!=_0x3f7ad6(0x10c)&&_0x4229da[_0x4b9d90][_0x3f7ad6(0x117)]!=_0x3f7ad6(0x88))_0x3ad342['push'](_0x4229da[_0x4b9d90]['AttendanceType']);else _0x4229da[_0x4b9d90]['AttendanceType']==_0x3f7ad6(0x10c)&&TotalLeavesorAbsent[_0x3f7ad6(0xac)](_0x4229da[_0x4b9d90][_0x3f7ad6(0x117)]);}var _0x441266=$[_0x3f7ad6(0xe6)](_0x4229da,function(_0x2518ab){var _0x401789=_0x3f7ad6;return _0x2518ab[_0x401789(0x117)]!=_0x401789(0x10c)&&_0x2518ab[_0x401789(0x117)]!='Holiday';});$(_0x3f7ad6(0x12d))[_0x3f7ad6(0x143)](_0x441266['length']);},'error':function(_0x18ecde,_0x51ae78){var _0x1370c2=_0x1bd85c;console[_0x1370c2(0xf2)](JSON[_0x1370c2(0xc7)](_0x18ecde));}});}var G_Validateholiday=![];function GetHolidays(_0x517678){var _0x5a9048=a0_0x52f229,_0x19fbcd=_spPageContextInfo[_0x5a9048(0x95)]+_0x5a9048(0x123)+LocID+_0x5a9048(0x99)+_0x517678+_0x5a9048(0xb8)+titanForWork[_0x5a9048(0xd0)](_0x5a9048(0x8c))+_0x5a9048(0x8f);$[_0x5a9048(0x131)]({'url':_0x19fbcd,'headers':{'Accept':_0x5a9048(0xea)},'async':![],'success':function(_0x4edc38){var _0xb2c7eb=_0x5a9048,_0x5d9352=_0x4edc38['d']['results'];_0x5d9352[_0xb2c7eb(0x12b)]>0x0?($(_0xb2c7eb(0x9a))[_0xb2c7eb(0x143)](_0x5d9352[0x0][_0xb2c7eb(0x8b)]),$(_0xb2c7eb(0x7c))[_0xb2c7eb(0xc0)]('display','block'),G_Validateholiday=!![]):($('#HolidayMessagediv')[_0xb2c7eb(0x143)](''),$('#HolidayMessage')[_0xb2c7eb(0xc0)]('display','none'),G_Validateholiday=![]);},'error':function(_0xde943d){var _0x47025e=_0x5a9048;alert(_0x47025e(0xb1));}});}var EmpAttendanceData=[],TotalLeavesorAbsent=[];function UpdateHeaderfields(_0x4cc9de){var _0x242aca=a0_0x52f229;jQuery[_0x242aca(0x131)]({'url':_0x4cc9de,'headers':{'Accept':_0x242aca(0xea)},'async':!![],'success':function(_0x39d3e9){var _0x729aa0=_0x242aca;EmpAttendanceData=[];var _0x57aad6=_0x39d3e9['d']['results'],_0x1f1f5c=[];TotalLeavesorAbsent=[];for(var _0x2c6a9f=0x0;_0x2c6a9f<_0x57aad6[_0x729aa0(0x12b)];_0x2c6a9f++){if(_0x57aad6[_0x2c6a9f][_0x729aa0(0x117)]!='On-Leave'&&_0x57aad6[_0x2c6a9f][_0x729aa0(0x117)]!=_0x729aa0(0x88))_0x1f1f5c[_0x729aa0(0xac)](_0x57aad6[_0x2c6a9f]['AttendanceType']);else{if(_0x57aad6[_0x2c6a9f][_0x729aa0(0x117)]==_0x729aa0(0x10c))TotalLeavesorAbsent[_0x729aa0(0xac)](_0x57aad6[_0x2c6a9f]['AttendanceType']);else _0x57aad6[_0x2c6a9f]['AttendanceType']=='Holiday'&&TotalLeavesorAbsent[_0x729aa0(0xac)](_0x57aad6[_0x2c6a9f][_0x729aa0(0x117)]);}var _0x4e7590=_0x57aad6[_0x2c6a9f]['ID'],_0x3472ff=_0x57aad6[_0x2c6a9f][_0x729aa0(0xdc)][_0x729aa0(0x8b)],_0x1068e8=_0x57aad6[_0x2c6a9f][_0x729aa0(0xdc)]['ID'],_0x22ccb2=formatDateReportEmp(_0x57aad6[_0x2c6a9f][_0x729aa0(0x87)]),_0x3649aa=_0x57aad6[_0x2c6a9f][_0x729aa0(0x117)],_0x211e08=_0x57aad6[_0x2c6a9f][_0x729aa0(0x93)],_0x150c57=_0x57aad6[_0x2c6a9f][_0x729aa0(0x84)];EmpAttendanceData[_0x729aa0(0xac)]({'UserId':_0x1068e8,'EmpName':_0x3472ff,'AttendanceDate':_0x22ccb2,'AttendanceType':_0x3649aa,'AttendanceItemId':_0x4e7590,'EmpWorkHours':_0x211e08,'HrAction':_0x150c57});}var _0x5bba6a='',_0x9ca556=0x0,_0x376946=0x0;for(var _0x4f0a00=0x0;_0x4f0a00<Totaldays;_0x4f0a00++){var _0xd7816d=new Date(GstartDate);_0xd7816d['setDate'](_0xd7816d[_0x729aa0(0x154)]()+_0x4f0a00);var _0x4c3240=moment(_0xd7816d,'DD/MM/YYYY')[_0x729aa0(0xb9)]('YYYY-MM-DD'),_0x4c3240=_0x4c3240[_0x729aa0(0xb6)]('-')[_0x729aa0(0xd9)](''),_0xdfa266=formatDateReportEmp(_0xd7816d),_0x1a4966=EmpAttendanceData[_0x729aa0(0x129)](function(_0x428c09){var _0x4ae8e7=_0x729aa0;return _0x428c09[_0x4ae8e7(0x87)];})[_0x729aa0(0x89)](_0xdfa266);if(_0x1a4966!=-0x1){var _0x5a1ac8=EmpAttendanceData[_0x1a4966][_0x729aa0(0x117)],_0x4c0993=EmpAttendanceData[_0x1a4966]['EmpWorkHours'],_0x150c57=EmpAttendanceData[_0x1a4966]['HrAction'],_0x293fbd=EmpAttendanceData[_0x1a4966][_0x729aa0(0x14f)],_0x1ad918=EmpAttendanceData[_0x1a4966]['AttendanceItemId'];_0x376946=_0x376946+0x1;}else _0x9ca556=_0x9ca556+0x1;}var _0x49d646=parseInt(TotalLeavesorAbsent[_0x729aa0(0x12b)])+parseInt(_0x9ca556)-parseInt($(_0x729aa0(0x13c))[_0x729aa0(0x143)]());_0x49d646<0x0&&(_0x49d646=0x0);$(_0x729aa0(0x13e))[_0x729aa0(0x143)](Totaldays);var _0x2b47f7=parseInt(_0x376946)-parseInt(TotalLeavesorAbsent[_0x729aa0(0x12b)]),_0x4e890a=$[_0x729aa0(0xe6)](_0x57aad6,function(_0x5261f7){var _0x28ed2f=_0x729aa0;return _0x5261f7[_0x28ed2f(0x117)]!=_0x28ed2f(0x10c)&&_0x5261f7[_0x28ed2f(0x117)]!='Holiday';});$(_0x729aa0(0x12d))['text'](_0x4e890a[_0x729aa0(0x12b)]);},'error':function(_0x34107f,_0x5321d3){var _0x27e864=_0x242aca;console[_0x27e864(0xf2)](JSON[_0x27e864(0xc7)](_0x34107f));}});}