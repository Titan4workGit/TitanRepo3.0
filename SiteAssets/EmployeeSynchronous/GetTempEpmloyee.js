var a0_0x5289b7=a0_0x3bde;(function(_0x7e11d9,_0x4ff966){var _0x1f3e3d=a0_0x3bde,_0x3856e8=_0x7e11d9();while(!![]){try{var _0xe34625=-parseInt(_0x1f3e3d(0x26c))/0x1*(parseInt(_0x1f3e3d(0x292))/0x2)+parseInt(_0x1f3e3d(0x219))/0x3*(parseInt(_0x1f3e3d(0x278))/0x4)+-parseInt(_0x1f3e3d(0x252))/0x5*(-parseInt(_0x1f3e3d(0x1dc))/0x6)+parseInt(_0x1f3e3d(0x1d5))/0x7*(-parseInt(_0x1f3e3d(0x226))/0x8)+-parseInt(_0x1f3e3d(0x24d))/0x9+-parseInt(_0x1f3e3d(0x295))/0xa*(parseInt(_0x1f3e3d(0x27e))/0xb)+parseInt(_0x1f3e3d(0x1ed))/0xc*(parseInt(_0x1f3e3d(0x22b))/0xd);if(_0xe34625===_0x4ff966)break;else _0x3856e8['push'](_0x3856e8['shift']());}catch(_0x44e8f0){_0x3856e8['push'](_0x3856e8['shift']());}}}(a0_0x47f2,0x2db24));var currentCompanyid='',contributersGroupId='';$(document)[a0_0x5289b7(0x1de)](function(){var _0x1ca7b3=a0_0x5289b7;WaitMessage(),$(_0x1ca7b3(0x23b))[_0x1ca7b3(0x290)](),currentCompanyid=titanForWork['getQueryStringParameter'](_0x1ca7b3(0x1d4)),GetGroupIDByGroupName(),currentCompanyid!=null&&currentCompanyid!=''&&(currentCompanyid['indexOf']('#')!=-0x1&&(currentCompanyid=currentCompanyid['split']('#')[0x0]),currentCompanyid=currentCompanyid),$(_0x1ca7b3(0x29d))[_0x1ca7b3(0x249)](_0x1ca7b3(0x2ac),_0x1ca7b3(0x28f)+currentCompanyid),GetOfficeLocation('No'),GetEmployeeList(0x0),GetCompanies(),GetDepartment(0x0),$(_0x1ca7b3(0x1e3))[_0x1ca7b3(0x22e)](function(){var _0x2a64ca=_0x1ca7b3;parseInt($('#ddlTempCompany')[_0x2a64ca(0x284)]())==0x0||parseInt($(_0x2a64ca(0x270))[_0x2a64ca(0x284)]())==0x0||parseInt($(_0x2a64ca(0x24c))[_0x2a64ca(0x284)]())==0x0?alert(_0x2a64ca(0x262)):ValidationCheckBox()==!![]?ValidationLicencedCheckBox()==!![]&&(WaitMessage(),$[_0x2a64ca(0x258)](AddEmployeeData())[_0x2a64ca(0x248)](function(_0x47b414){var _0x119cb7=_0x2a64ca;GetEmployeeList(0x1),GetCompanies(),GetOfficeLocation('No'),GetDepartment(0x0),$(_0x119cb7(0x255))['val']('');})):alert('Please\x20select\x20at\x20least\x20one\x20record\x20from\x20list.');}),$(_0x1ca7b3(0x275))[_0x1ca7b3(0x22e)](function(){var _0xfa82e9=_0x1ca7b3;ValidationCheckBox()==![]?alert('Please\x20select\x20at\x20least\x20one\x20record\x20from\x20list.'):(WaitMessage(),$[_0xfa82e9(0x258)](UpdateEmployeeData())[_0xfa82e9(0x248)](function(_0x25fbf0){var _0x401360=_0xfa82e9;GetEmployeeList(0x1),GetCompanies(),GetOfficeLocation('No'),GetDepartment(0x0),$(_0x401360(0x255))['val']('');}));}),PageLoad(),$(_0x1ca7b3(0x23d))['click'](function(){}),keyWordSearch(),$(_0x1ca7b3(0x26d))[_0x1ca7b3(0x215)](function(){var _0x3e4b3c=_0x1ca7b3;GetDepartment($(this)['val']()),GetOfficeLocation($(this)[_0x3e4b3c(0x284)]());}),setTimeout(function(){CloseWaitDialog();},0x4e20);});function keyWordSearch(){var _0xbcd297=a0_0x5289b7;$(_0xbcd297(0x231))['on'](_0xbcd297(0x2a7),function(){var _0x2f7763=_0xbcd297,_0xbba711=$(this)[_0x2f7763(0x284)](),_0x1da4c3=new RegExp(_0xbba711,'i');$(_0x2f7763(0x280))[_0x2f7763(0x21c)]('tr')['each'](function(){var _0x2a8a0b=_0x2f7763;!($(this)[_0x2a8a0b(0x21c)]('td')[_0x2a8a0b(0x224)]()[_0x2a8a0b(0x24a)](_0x1da4c3)>=0x0)&&$(this)['not'](_0x2a8a0b(0x296))[_0x2a8a0b(0x25b)](),$(this)[_0x2a8a0b(0x21c)]('td')['text']()['search'](_0x1da4c3)>=0x0&&$(this)[_0x2a8a0b(0x21a)]();});});}function GetGroupIDByGroupName(){var _0x415efd=a0_0x5289b7,_0x4cda30=_spPageContextInfo[_0x415efd(0x242)]+_0x415efd(0x22f);$[_0x415efd(0x1ef)]({'url':_0x4cda30,'method':'GET','async':![],'headers':{'Accept':_0x415efd(0x291)},'success':function(_0x4e0e2f){contributersGroupId=_0x4e0e2f['d']['Id'];},'error':function(_0x32286a){var _0x57dbe7=_0x415efd;console[_0x57dbe7(0x207)](_0x32286a);}});}function AddUserinSharePointGroup(_0x25f83f){var _0x52beb6=a0_0x5289b7,_0x7bcbe6=_spPageContextInfo[_0x52beb6(0x242)]+'/_api/web/sitegroups('+contributersGroupId+_0x52beb6(0x27f);$[_0x52beb6(0x1ef)]({'url':_0x7bcbe6,'type':_0x52beb6(0x25c),'async':![],'data':JSON[_0x52beb6(0x250)]({'__metadata':{'type':_0x52beb6(0x299)},'LoginName':_0x25f83f}),'headers':{'accept':_0x52beb6(0x22a),'content-type':_0x52beb6(0x22a),'X-RequestDigest':$(_0x52beb6(0x28e))[_0x52beb6(0x284)]()},'success':_0x166f56,'error':_0x18adb8});function _0x166f56(_0x15f138){var _0x402777=_0x52beb6;console['log'](_0x402777(0x24b));}function _0x18adb8(_0x7f7518){var _0x556a96=_0x52beb6;console[_0x556a96(0x207)](JSON[_0x556a96(0x250)](_0x7f7518));}}function UpdateEmployeeData(){var _0x2deaea=a0_0x5289b7,_0x4dd4c1=$('#tableTempEmp\x20tbody\x20tr')[_0x2deaea(0x227)];return $('#tableTempEmp\x20tbody\x20tr')[_0x2deaea(0x213)](function(_0x442e6a){var _0x12457f=_0x2deaea,_0x34677b=$(this)['is'](_0x12457f(0x27c));if(_0x34677b==!![]){var _0xd58a4f=$(this)['find'](_0x12457f(0x1f0))[_0x12457f(0x249)]('checked');if(_0xd58a4f==!![]){var _0x5cdeaa=$(this)['find'](_0x12457f(0x1f0))[_0x12457f(0x284)](),_0x318b7f=$(this)[_0x12457f(0x21c)]('td')[0x1][_0x12457f(0x20a)],_0x4db579=$(this)[_0x12457f(0x21c)]('td')[0x2][_0x12457f(0x20a)],_0xb9fe5c=$(this)[_0x12457f(0x21c)]('td')[0x3][_0x12457f(0x20a)],_0x11a9e1=$(this)['find']('td')[0x4]['innerText'],_0x5912db=$(this)[_0x12457f(0x21c)](_0x12457f(0x221))[_0x12457f(0x284)](),_0x218322=$(this)[_0x12457f(0x21c)](_0x12457f(0x1f2))[_0x12457f(0x284)](),_0x45984a=$(this)['find'](_0x12457f(0x208))[_0x12457f(0x284)](),_0x34a30b=$(this)['find']('.dob')[_0x12457f(0x284)](),_0x33c228=$(this)[_0x12457f(0x21c)](_0x12457f(0x259))[_0x12457f(0x284)](),_0x9539a7=$(this)[_0x12457f(0x21c)](_0x12457f(0x271))[_0x12457f(0x284)](),_0x3f27af='';_0x34a30b!=null&&_0x34a30b!=''&&(_0x3f27af=GetDateStandardFormat(_0x34a30b));var _0x2995b7='';_0x33c228!=null&&_0x33c228!=''&&(_0x2995b7=GetDateStandardFormat(_0x33c228));var _0x2fe2d4='';_0x9539a7!=null&&_0x9539a7!=''&&(_0x2fe2d4=GetDateStandardFormat(_0x9539a7)),(_0xb9fe5c==null||_0xb9fe5c=='')&&(_0xb9fe5c=_0x4db579),updateManager(_0x12457f(0x246),_0x5912db,_0x218322,_0x45984a,_0x3f27af,_0x2995b7,_0x2fe2d4,_0x5cdeaa);}}}),!![];}function updateManager(_0x176ce3,_0x2ce58a,_0xe4ec6,_0x3fba74,_0x7cca6,_0x595999,_0x541027,_0x38efdc){var _0x6d6496=a0_0x5289b7;try{var _0x146b1b,_0x53d699=GetItemTypeForListName(_0x176ce3);_0x146b1b={'__metadata':{'type':_0x53d699},'Designation':_0x2ce58a,'Manager':_0xe4ec6,'MobileNumber':_0x3fba74,'DOB':_0x7cca6,'DOA':_0x595999,'DOJ':_0x541027},$['when'](updateItemWithID(_0x176ce3,_0x146b1b,_0x38efdc))[_0x6d6496(0x248)](function(_0x33466c){});}catch(_0x5d7c8b){console['log'](_0x5d7c8b[_0x6d6496(0x238)]);}}function updateItemWithID(_0x34b19c,_0x57619c,_0x2d4f4b){var _0x3386b3=a0_0x5289b7,_0x5d19b2=$['Deferred']();return $[_0x3386b3(0x1ef)]({'url':_spPageContextInfo[_0x3386b3(0x242)]+_0x3386b3(0x1d9)+_0x34b19c+_0x3386b3(0x1f6)+_0x2d4f4b+'\x27)','type':_0x3386b3(0x25c),'headers':{'accept':'application/json;odata=verbose','X-RequestDigest':$(_0x3386b3(0x28e))[_0x3386b3(0x284)](),'content-Type':_0x3386b3(0x22a),'X-Http-Method':'PATCH','If-Match':'*'},'data':JSON[_0x3386b3(0x250)](_0x57619c),'async':![],'success':function(_0x302f31){var _0x4b1e41=_0x3386b3;_0x5d19b2[_0x4b1e41(0x1fe)](!![]);},'error':function(_0x1bcfb4){var _0x2a0bcd=_0x3386b3;CloseWaitDialog(),alert(JSON[_0x2a0bcd(0x250)](_0x1bcfb4)),_0x5d19b2['reject'](_0x1bcfb4);}}),_0x5d19b2['promise']();}function AddEmployeeData(){var _0x169950=a0_0x5289b7,_0x24cc09=$(_0x169950(0x218))['length'];return $(_0x169950(0x218))['each'](function(_0xb7ccb1){var _0x5489be=_0x169950,_0x34a99a=$(this)['is'](_0x5489be(0x27c));if(_0x34a99a==!![]){var _0x51588d=$(this)[_0x5489be(0x21c)](_0x5489be(0x1f0))[_0x5489be(0x249)](_0x5489be(0x264));if(_0x51588d==!![]){var _0x1e42cf=$(this)[_0x5489be(0x21c)]('td')[0x1]['innerText'],_0x2b02a7=$(this)[_0x5489be(0x21c)]('td')[0x2]['innerText'],_0x295cba=$(this)[_0x5489be(0x21c)]('td')[0x3]['innerText'],_0x3d27ed=$(this)['find']('td')[0x4][_0x5489be(0x20a)],_0x34ccb3=$(this)['find']('.desgination')[_0x5489be(0x284)](),_0x5bb776=$(this)[_0x5489be(0x21c)](_0x5489be(0x1f2))[_0x5489be(0x284)](),_0x458db9=$(this)['find'](_0x5489be(0x208))[_0x5489be(0x284)](),_0x2eb767=$(this)[_0x5489be(0x21c)](_0x5489be(0x2ab))['val'](),_0x2eee7f=$(this)[_0x5489be(0x21c)]('.doa')['val'](),_0xcef45c=$(this)['find'](_0x5489be(0x271))[_0x5489be(0x284)](),_0x1bf705='';_0x2eb767!=null&&_0x2eb767!=''&&(_0x1bf705=GetDateStandardFormat(_0x2eb767));var _0xe672fd='';_0x2eee7f!=null&&_0x2eee7f!=''&&(_0xe672fd=GetDateStandardFormat(_0x2eee7f));var _0x153d71='';_0xcef45c!=null&&_0xcef45c!=''&&(_0x153d71=GetDateStandardFormat(_0xcef45c)),(_0x295cba==null||_0x295cba=='')&&(_0x295cba=_0x2b02a7),AddUserinSharePointGroup(_0x5489be(0x1e1)+_0x2b02a7),AddNewEmployee(_0x5489be(0x286),_0x1e42cf,_0x295cba,_0x2b02a7,_0x34ccb3,_0x5bb776,_0x5bb776,_0x458db9,_0x1bf705,_0xe672fd,_0x153d71);}}}),!![];}function GetDateStandardFormat(_0x57bb33){var _0x3951cc=a0_0x5289b7,_0x2f357d=ConvertDateFormatToddMMyyyy(_0x57bb33),_0x5a721a=new Date(_0x2f357d),_0x72d29=0x3c*0x3c*0x18*0x3e8,_0x1126da=new Date(_0x5a721a['getTime']()),_0x2eb705=_0x1126da[_0x3951cc(0x2ae)]();return _0x2eb705;}function GetOfficeLocation(_0x1d27cd){var _0x1dc160=a0_0x5289b7;$(_0x1dc160(0x24c))['empty']()[_0x1dc160(0x1ee)]('<option\x20value=\x220\x22>-Select\x20Office\x20Location-</option>');var _0x4c167e=_spPageContextInfo[_0x1dc160(0x242)]+'/_api/web/lists/GetByTitle(\x27OfficeLocation\x27)/items?$select=ID,OfficeName,CompanyID/ID&$expand=CompanyID&$filter=OfficeLocationId\x20eq\x20\x270\x27\x20and\x20CompanyID/ID\x20eq\x20\x27'+_0x1d27cd+'\x27';$[_0x1dc160(0x1ef)]({'url':_0x4c167e,'headers':{'Accept':_0x1dc160(0x22a)},'async':![],'success':function(_0x4516a3){var _0xafcc36=_0x1dc160,_0x3fd3e1=_0x4516a3['d'][_0xafcc36(0x1ff)];for(var _0x58df6e=0x0;_0x58df6e<_0x3fd3e1[_0xafcc36(0x227)];_0x58df6e++){$('#ddlTempOfficeLocation')[_0xafcc36(0x1ee)]($(_0xafcc36(0x21b))['attr'](_0xafcc36(0x1e9),_0x4516a3['d']['results'][_0x58df6e]['ID'])['text'](_0x4516a3['d'][_0xafcc36(0x1ff)][_0x58df6e][_0xafcc36(0x1f7)]));}},'eror':function(_0x1d9fb9){var _0x4b96e4=_0x1dc160;console[_0x4b96e4(0x207)](_0x4b96e4(0x287));}});}function GetTempEmployeeList(_0x3dc9fc){var _0x2ea850=a0_0x5289b7,_0x4faff9=0x0,_0x42827=_spPageContextInfo[_0x2ea850(0x242)]+'/_api/web/lists/getbytitle(\x27TempEmployee\x27)/items?$select=ID,FullName,LogonName,Email,Department,Designation,Company,Manager,MobileNumber,OfficeLocation,DOB,DOA,DOJ&$top=1000';$[_0x2ea850(0x1ef)]({'url':_0x42827,'headers':{'Accept':_0x2ea850(0x22a)},'async':!![],'success':function(_0x584e29){var _0x3af3e2=_0x2ea850,_0x1bec75=_0x584e29['d'][_0x3af3e2(0x1ff)],_0x1fce59=_0x3af3e2(0x202),_0x38b9f4='';for(var _0x19a58f=0x0;_0x19a58f<_0x1bec75['length'];_0x19a58f++){var _0x6ed4a8=_0x1bec75[_0x19a58f][_0x3af3e2(0x2a6)];(_0x6ed4a8==null||_0x6ed4a8=='')&&(_0x6ed4a8='');var _0x3cadd5=_0x1bec75[_0x19a58f]['LogonName'];(_0x3cadd5==null||_0x3cadd5=='')&&(_0x3cadd5='');var _0x36de06=_0x1bec75[_0x19a58f][_0x3af3e2(0x239)];(_0x36de06==null||_0x36de06=='')&&(_0x36de06='');var _0x42605e=_0x1bec75[_0x19a58f][_0x3af3e2(0x1d7)];(_0x42605e==null||_0x42605e=='')&&(_0x42605e='');var _0x3c852c=_0x1bec75[_0x19a58f][_0x3af3e2(0x289)];(_0x3c852c==null||_0x3c852c=='')&&(_0x3c852c='');var _0x18433c=_0x1bec75[_0x19a58f]['Company'];(_0x18433c==null||_0x18433c=='')&&(_0x18433c='');var _0x29ef55=_0x1bec75[_0x19a58f][_0x3af3e2(0x1db)];(_0x29ef55==null||_0x29ef55=='')&&(_0x29ef55='');var _0x3d1384=_0x1bec75[_0x19a58f]['MobileNumber'];(_0x3d1384==null||_0x3d1384=='')&&(_0x3d1384='');var _0x47c80b=_0x1bec75[_0x19a58f][_0x3af3e2(0x26a)];(_0x47c80b==null||_0x47c80b=='')&&(_0x47c80b='');var _0x1fbed9=_0x1bec75[_0x19a58f][_0x3af3e2(0x235)],_0x5a38c7='';if(_0x1fbed9==null||_0x1fbed9=='')_0x1fbed9='';else{var _0x197964=new Date(_0x1fbed9);_0x1fbed9=$[_0x3af3e2(0x228)][_0x3af3e2(0x25f)](_0x3af3e2(0x293),_0x197964);}var _0x25278a=_0x1bec75[_0x19a58f][_0x3af3e2(0x1f8)];if(_0x25278a==null||_0x25278a=='')_0x25278a='';else{var _0x197964=new Date(_0x25278a);_0x25278a=$[_0x3af3e2(0x228)][_0x3af3e2(0x25f)](_0x3af3e2(0x293),_0x197964);}var _0x254c3b=_0x1bec75[_0x19a58f][_0x3af3e2(0x211)];if(_0x254c3b==null||_0x254c3b=='')_0x254c3b='';else{var _0x197964=new Date(_0x254c3b);_0x254c3b=$[_0x3af3e2(0x228)][_0x3af3e2(0x25f)](_0x3af3e2(0x293),_0x197964);}var _0x22f92a=_0x3af3e2(0x2a9)+_0x3cadd5+'\x27)';employeeList[_0x3af3e2(0x1d6)](_0x3cadd5[_0x3af3e2(0x1e5)]())==-0x1?(tempemployeeList['indexOf'](_0x3cadd5['toLowerCase']())==-0x1&&_0x4faff9++,_0x38b9f4=_0x38b9f4+_0x3af3e2(0x23a)+_0x1bec75[_0x19a58f]['ID']+_0x3af3e2(0x220)+_0x6ed4a8+_0x3af3e2(0x217)+_0x3cadd5+_0x3af3e2(0x217)+_0x36de06+_0x3af3e2(0x217)+_0x42605e+_0x3af3e2(0x29f)+_0x3c852c+_0x3af3e2(0x29c)+_0x29ef55+'\x27/></td><td><input\x20style=\x27width:\x20100%\x27\x20type=\x27text\x27\x20class=\x27mobile\x27\x20value=\x27'+_0x3d1384+_0x3af3e2(0x2a5)+_0x1fbed9+_0x3af3e2(0x1e8)+_0x25278a+_0x3af3e2(0x2a8)+_0x254c3b+_0x3af3e2(0x254)):tempemployeeList[_0x3af3e2(0x1d6)](_0x3cadd5[_0x3af3e2(0x1e5)]())==-0x1&&_0x4faff9++;}var _0x4c1465=_0x1fce59+_0x38b9f4+_0x3af3e2(0x272),_0x13f381=$(_0x3af3e2(0x20d));_0x13f381[_0x3af3e2(0x1fa)](''),_0x13f381[_0x3af3e2(0x1ee)](_0x4c1465),$(_0x3af3e2(0x2ad))[_0x3af3e2(0x249)](_0x3af3e2(0x2a2),0x1),$('.dob')[_0x3af3e2(0x228)]({'changeMonth':!![],'changeYear':!![],'yearRange':'-70:+0'}),$('.dob')[_0x3af3e2(0x228)]('option',_0x3af3e2(0x214),_0x3af3e2(0x24e)),$(_0x3af3e2(0x259))[_0x3af3e2(0x228)]({'changeMonth':!![],'changeYear':!![],'yearRange':_0x3af3e2(0x1ec)}),$(_0x3af3e2(0x259))[_0x3af3e2(0x228)]('option','dateFormat',_0x3af3e2(0x24e)),$(_0x3af3e2(0x271))[_0x3af3e2(0x228)]({'changeMonth':!![],'changeYear':!![],'yearRange':_0x3af3e2(0x1ec)}),$(_0x3af3e2(0x271))['datepicker'](_0x3af3e2(0x269),_0x3af3e2(0x214),'dd/mm/yy'),$('.dob')[_0x3af3e2(0x213)](function(){var _0xf66615=_0x3af3e2;$(this)[_0xf66615(0x249)]('readonly',!![]);}),$('.doa')['each'](function(){var _0x107c34=_0x3af3e2;$(this)[_0x107c34(0x249)]('readonly',!![]);}),$(_0x3af3e2(0x271))['each'](function(){var _0x14b05d=_0x3af3e2;$(this)['prop'](_0x14b05d(0x1f3),!![]);}),_0x3dc9fc==0x0&&($('#synchedMessage')['show'](),$('#synchedMessage')[_0x3af3e2(0x224)](_0x3af3e2(0x1ea)),setTimeout(function(){var _0x419fec=_0x3af3e2;$('#synchedMessage')[_0x419fec(0x25b)]();},0x2710)),GenerateTable(),CloseWaitDialog();},'eror':function(_0x101267){var _0xde6a98=_0x2ea850;CloseWaitDialog(),console[_0xde6a98(0x207)]('error');}});}var sorter;function GenerateTable(){var _0x5c5194=a0_0x5289b7;sorter=new TINY[(_0x5c5194(0x1f1))]['sorter'](_0x5c5194(0x1f9),_0x5c5194(0x298),{'headclass':_0x5c5194(0x253),'ascclass':_0x5c5194(0x204),'descclass':_0x5c5194(0x2af),'evenclass':_0x5c5194(0x212),'oddclass':'oddrow','evenselclass':_0x5c5194(0x1e4),'oddselclass':_0x5c5194(0x1e6),'paginate':!![],'size':0xa,'colddid':_0x5c5194(0x265),'currentid':_0x5c5194(0x21e),'totalid':'totalpages','startingrecid':_0x5c5194(0x263),'endingrecid':_0x5c5194(0x23f),'totalrecid':_0x5c5194(0x1fb),'hoverid':'selectedrow','pageddid':_0x5c5194(0x206),'navid':_0x5c5194(0x210),'sortdir':0x1,'init':!![]});}function getFormattedDate(_0x242ec5){var _0x9b9c0a=a0_0x5289b7,_0x5e3853=new Date(_0x242ec5),_0x11452c=_0x5e3853[_0x9b9c0a(0x20e)](),_0x4413ac=(0x1+_0x5e3853[_0x9b9c0a(0x201)]())['toString']();_0x4413ac=_0x4413ac['length']>0x1?_0x4413ac:'0'+_0x4413ac;var _0x40521c=_0x5e3853[_0x9b9c0a(0x23e)]()[_0x9b9c0a(0x274)]();return _0x40521c=_0x40521c[_0x9b9c0a(0x227)]>0x1?_0x40521c:'0'+_0x40521c,_0x40521c+'/'+_0x4413ac+'/'+_0x11452c;}function EmployeesCompanies(_0x18a47b){var _0x463fbd=a0_0x5289b7;try{var _0x4469b7=_spPageContextInfo['webAbsoluteUrl']+_0x463fbd(0x2a4)+_0x18a47b+'\x27';$[_0x463fbd(0x1ef)]({'url':_0x4469b7,'headers':{'Accept':_0x463fbd(0x22a)},'async':!![],'success':function(_0x38aa1e){var _0x5e76a8=_0x463fbd,_0x247663=_0x38aa1e['d'][_0x5e76a8(0x1ff)],_0x2a6e39='<ul><li><strong></strong></li>',_0x3c57ae='';for(var _0x16e0e4=0x0;_0x16e0e4<_0x247663[_0x5e76a8(0x227)];_0x16e0e4++){var _0x3f8c80=_0x247663[_0x16e0e4][_0x5e76a8(0x1e2)][_0x5e76a8(0x1d8)];(_0x3f8c80==null||_0x3f8c80=='')&&(_0x3f8c80='');var _0x751fd9=_0x247663[_0x16e0e4][_0x5e76a8(0x24f)][_0x5e76a8(0x29b)];(_0x751fd9==null||_0x751fd9=='')&&(_0x751fd9='');var _0x4c8dd4=_0x247663[_0x16e0e4][_0x5e76a8(0x1d7)]['DepartmentName'];(_0x4c8dd4==null||_0x4c8dd4=='')&&(_0x4c8dd4=''),_0x3c57ae=_0x3c57ae+_0x5e76a8(0x27a)+_0x751fd9+_0x5e76a8(0x233)+_0x4c8dd4+_0x5e76a8(0x2a1);}var _0x11f200=_0x2a6e39+_0x3c57ae+_0x5e76a8(0x20f),_0x2f9a57=$(_0x5e76a8(0x240));_0x2f9a57[_0x5e76a8(0x1fa)](''),_0x247663[_0x5e76a8(0x227)]==0x0&&(_0x11f200=_0x11f200+'<div\x20style=\x27width:100%;text-align:\x20center;font-size:14px\x27>Not\x20Defined\x20Yet</div>'),_0x2f9a57[_0x5e76a8(0x1ee)](_0x11f200),CloseWaitDialog(),$(_0x5e76a8(0x232))['modal'](_0x5e76a8(0x21a));},'eror':function(_0x21a564){var _0x123f30=_0x463fbd;CloseWaitDialog(),console['log'](_0x123f30(0x287));}});}catch(_0x121b57){CloseWaitDialog(),alert(_0x463fbd(0x203));}}function a0_0x3bde(_0xdeac2d,_0x54684e){var _0x47f2db=a0_0x47f2();return a0_0x3bde=function(_0x3bde11,_0x4a6c98){_0x3bde11=_0x3bde11-0x1d4;var _0x24cb27=_0x47f2db[_0x3bde11];return _0x24cb27;},a0_0x3bde(_0xdeac2d,_0x54684e);}function EmployeeCheckListValidation(_0x6e48a7,_0x14dc0e,_0x521862){var _0x5ed1d6=a0_0x5289b7,_0x5e878e=![];try{var _0x3b23e8=_spPageContextInfo[_0x5ed1d6(0x242)]+_0x5ed1d6(0x237)+_0x6e48a7+_0x5ed1d6(0x241)+_0x14dc0e+'\x27';$['ajax']({'url':_0x3b23e8,'headers':{'Accept':'application/json;odata=verbose'},'async':![],'success':function(_0x51dbd5){var _0x54d137=_0x5ed1d6,_0x28f93f=_0x51dbd5['d']['results'];_0x28f93f[_0x54d137(0x227)]>0x0&&(_0x5e878e=!![]);},'eror':function(_0x5268aa){var _0xcd2ca0=_0x5ed1d6;CloseWaitDialog(),console[_0xcd2ca0(0x207)]('error');}});}catch(_0x1fbfa4){alert(_0x5ed1d6(0x203));}return _0x5e878e;}function GetCompanies(){var _0x525f22=a0_0x5289b7;$(_0x525f22(0x26d))[_0x525f22(0x251)]()[_0x525f22(0x1ee)](_0x525f22(0x1dd));var _0x855be0=_spPageContextInfo['webAbsoluteUrl']+_0x525f22(0x22d);$[_0x525f22(0x1ef)]({'url':_0x855be0,'headers':{'Accept':_0x525f22(0x22a)},'async':![],'success':function(_0x2ac1c7){var _0x3d84f0=_0x525f22,_0x504f07=_0x2ac1c7['d'][_0x3d84f0(0x1ff)];for(var _0x33be6a=0x0;_0x33be6a<_0x504f07[_0x3d84f0(0x227)];_0x33be6a++){$('#ddlTempCompany')[_0x3d84f0(0x1ee)]($('<option></option>')[_0x3d84f0(0x22c)](_0x3d84f0(0x1e9),_0x2ac1c7['d'][_0x3d84f0(0x1ff)][_0x33be6a]['ID'])[_0x3d84f0(0x224)](_0x2ac1c7['d']['results'][_0x33be6a][_0x3d84f0(0x29b)]));}},'eror':function(_0x16f32d){var _0xa6126d=_0x525f22;console[_0xa6126d(0x207)](_0xa6126d(0x287));}});}function ValidationCheckBox(){var _0x5259b9=a0_0x5289b7,_0x5c3de1=![];return $('#tableTempEmp\x20tbody\x20tr')[_0x5259b9(0x213)](function(_0x5590f5){var _0x1dd9eb=_0x5259b9,_0x40dc9d=$(this)['is'](_0x1dd9eb(0x27c));if(_0x40dc9d==!![]){var _0x3358c2=$(this)[_0x1dd9eb(0x21c)]('.empidchk')['prop'](_0x1dd9eb(0x264));_0x3358c2==!![]&&(_0x5c3de1=!![]);}}),_0x5c3de1;}function ValidationLicencedCheckBox(){var _0x43ca9d=a0_0x5289b7,_0x578882=!![],_0x48a966=0x0;$(_0x43ca9d(0x218))[_0x43ca9d(0x213)](function(_0x34ae23){var _0xb1d66e=_0x43ca9d,_0x31c2d2=$(this)['is'](':visible');if(_0x31c2d2==!![]){var _0xeb6dde=$(this)[_0xb1d66e(0x21c)]('.empidchk')[_0xb1d66e(0x249)](_0xb1d66e(0x264));_0xeb6dde==!![]&&_0x48a966++;}}),console[_0x43ca9d(0x207)]('selectedItemsCount\x20:'+_0x48a966);var _0x5c60b4=GetLicencedUsersCount(),_0x4a03f7=_0x5c60b4+_0x48a966,_0x2fddfa=UsersLicenceRequired;console[_0x43ca9d(0x207)](_0x43ca9d(0x1fc)+_0x2fddfa);if(_0x4a03f7>_0x2fddfa){_0x578882=![];var _0x5448f9=_0x2fddfa-_0x5c60b4;alert(_0x43ca9d(0x256)+_0x5c60b4+_0x43ca9d(0x1eb)+_0x5448f9);}return _0x578882;}function ValidationCheckBoxAllocated(){var _0x318415=a0_0x5289b7,_0x52ab7a=![];return $(_0x318415(0x283))[_0x318415(0x213)](function(_0x28ecb3){var _0x2402b1=_0x318415,_0x547db9=$(this)['is'](_0x2402b1(0x27c));if(_0x547db9==!![]){var _0x32db1a=$(this)[_0x2402b1(0x21c)](_0x2402b1(0x1f0))['prop']('checked');_0x32db1a==!![]&&(_0x52ab7a=!![]);}}),_0x52ab7a;}function GetDepartment(_0x3aba57){var _0x2795a0=a0_0x5289b7;$(_0x2795a0(0x270))[_0x2795a0(0x251)]()[_0x2795a0(0x1ee)](_0x2795a0(0x230));var _0x2b7a65=_spPageContextInfo['webAbsoluteUrl']+_0x2795a0(0x25d)+_0x3aba57+'\x27';$[_0x2795a0(0x1ef)]({'url':_0x2b7a65,'headers':{'Accept':_0x2795a0(0x22a)},'async':![],'success':function(_0x556911){var _0x3d5259=_0x2795a0,_0x203c7d=_0x556911['d'][_0x3d5259(0x1ff)];for(var _0x3ce496=0x0;_0x3ce496<_0x203c7d[_0x3d5259(0x227)];_0x3ce496++){$(_0x3d5259(0x270))[_0x3d5259(0x1ee)]($(_0x3d5259(0x21b))[_0x3d5259(0x22c)](_0x3d5259(0x1e9),_0x556911['d'][_0x3d5259(0x1ff)][_0x3ce496]['ID'])[_0x3d5259(0x224)](_0x556911['d'][_0x3d5259(0x1ff)][_0x3ce496][_0x3d5259(0x1e7)]));}},'eror':function(_0x55d341){console['log']('error');}});}function AddNewEmployee(_0x258e15,_0xe0b38,_0x13d890,_0xb10be0,_0x66867a,_0x19d743,_0x1ac06e,_0x1012cf,_0x20046a,_0x494e97,_0x4c8774){var _0xffc5fb=a0_0x5289b7;try{var _0xda4802=GetUserId(_0xb10be0);if(_0xda4802==''||_0xda4802==null)alert('User\x20:'+_0xb10be0+_0xffc5fb(0x28b));else{var _0xdf1b09=parseInt($(_0xffc5fb(0x26d))[_0xffc5fb(0x284)]()),_0x4bd3f5=parseInt($(_0xffc5fb(0x270))[_0xffc5fb(0x284)]()),_0x2a68c0=parseInt($(_0xffc5fb(0x24c))[_0xffc5fb(0x284)]()),_0x2e777f,_0x4600a4=GetItemTypeForListName(_0x258e15);_0x2e777f={'__metadata':{'type':_0x4600a4},'CompanyId':_0xdf1b09,'DepartmentId':_0x4bd3f5,'FullName':_0xe0b38,'Email':_0x13d890,'ParentId':'-1','LogonNameId':_0xda4802,'Manager':_0x19d743,'OfficeLocationId':_0x2a68c0,'MobileNumber':_0x1012cf,'DateOfBirth':_0x20046a,'DateOfAnniversary':_0x494e97,'JoiningDate':_0x4c8774,'Designation':_0x66867a,'PrimaryCompany':_0xffc5fb(0x28c),'Status':_0xffc5fb(0x279)},(_0xda4802==''||_0xda4802==null)&&delete _0x2e777f[_0xffc5fb(0x1d4)],(_0x20046a==null||_0x20046a=='')&&delete _0x2e777f[_0xffc5fb(0x2a3)],(_0x494e97==null||_0x494e97=='')&&delete _0x2e777f[_0xffc5fb(0x288)],(_0x4c8774==null||_0x4c8774=='')&&delete _0x2e777f['JoiningDate'],AddItemToList(_0x258e15,_0x2e777f,![]);}}catch(_0x4a5a5c){console[_0xffc5fb(0x207)](_0x4a5a5c[_0xffc5fb(0x238)]);}}function GetItemTypeForListName(_0x2ed856){var _0x597a69=a0_0x5289b7;return _0x597a69(0x245)+_0x2ed856['charAt'](0x0)[_0x597a69(0x2aa)]()+_0x2ed856[_0x597a69(0x21d)]('\x20')[_0x597a69(0x205)]('')['slice'](0x1)+'ListItem';}function AddItemToList(_0x2747df,_0x10f988,_0x289b54){var _0xf5b841=a0_0x5289b7,_0x4ab5e7=$[_0xf5b841(0x25e)]();return $[_0xf5b841(0x1ef)]({'url':_spPageContextInfo[_0xf5b841(0x242)]+_0xf5b841(0x1d9)+_0x2747df+_0xf5b841(0x261),'type':_0xf5b841(0x25c),'async':_0x289b54,'headers':{'accept':'application/json;odata=verbose','X-RequestDigest':$('#__REQUESTDIGEST')['val'](),'content-Type':_0xf5b841(0x22a)},'data':JSON[_0xf5b841(0x250)](_0x10f988),'success':function(_0x3e6c10){_0x4ab5e7['resolve'](_0x3e6c10);},'error':function(_0x25decf){var _0x952cb=_0xf5b841;alert(JSON[_0x952cb(0x250)](_0x25decf)),_0x4ab5e7[_0x952cb(0x247)](_0x25decf);}}),_0x4ab5e7[_0xf5b841(0x277)]();}function GetUserId(_0x2d8453){var _0x54732c=a0_0x5289b7,_0x390026='',_0x479592=_0x54732c(0x1e1),_0x21bd25=_spPageContextInfo['siteAbsoluteUrl'],_0x466859=_0x479592+_0x2d8453;return $['ajax']({'url':_0x21bd25+'/_api/web/siteusers(@v)?@v=\x27'+encodeURIComponent(_0x466859)+'\x27','method':_0x54732c(0x222),'headers':{'Accept':'application/json;\x20odata=verbose'},'async':![],'success':function(_0x1190e2){_0x390026=_0x1190e2['d']['Id'];},'error':function(_0x254584){var _0x3011e5=_0x54732c;console[_0x3011e5(0x207)](JSON['stringify'](_0x254584));}}),_0x390026;}function ConvertDateFormatToddMMyyyy(_0x2a5277){var _0x52c658=a0_0x5289b7,_0x28fa40=stringToDate(_0x2a5277,_0x52c658(0x26e),'/');return _0x28fa40;}function stringToDate(_0x1387ae,_0x525693,_0x37dd8a){var _0x3b8461=a0_0x5289b7,_0x2d971b=_0x525693[_0x3b8461(0x1e5)](),_0xa79707=_0x2d971b[_0x3b8461(0x21d)](_0x37dd8a),_0x4472f=_0x1387ae[_0x3b8461(0x21d)](_0x37dd8a),_0x427e85=_0xa79707['indexOf']('mm'),_0x3ec503=_0xa79707[_0x3b8461(0x1d6)]('dd'),_0x42e7d7=_0xa79707[_0x3b8461(0x1d6)](_0x3b8461(0x236)),_0x171aa4=parseInt(_0x4472f[_0x427e85]);_0x171aa4-=0x1;var _0x4c8034=new Date(_0x4472f[_0x42e7d7],_0x171aa4,_0x4472f[_0x3ec503]);return _0x4c8034;}var employeeList=new Array(),tempemployeeList=new Array();function a0_0x47f2(){var _0x26e47b=['</td><td><input\x20type=\x27text\x27\x20style=\x27width:\x20100%\x27\x20class=\x27desgination\x27\x20value=\x27','json','</li>','selectedIndex','DateOfBirth','/_api/web/lists/getbytitle(\x27Employees\x27)/items?$select=ID,FullName,LogonName/UserName,Department/DepartmentName,Company/CompanyName,Company/ID&$expand=LogonName,Company,Department&$filter=LogonName/UserName\x20\x20eq\x20\x27','\x27/></td><td><input\x20style=\x27width:\x20100%\x27\x20type=\x27text\x27\x20class=\x27dob\x27\x20value=\x27','FullName','keyup','\x27/></td><td><input\x20type=\x27text\x27\x20style=\x27width:\x20100%\x27\x20class=\x27doj\x27\x20value=\x27','javascript:EmployeesCompanies(\x27','toUpperCase','.dob','href','.ddlpagingNotAllocated','toISOString','desc','CompanyId','123893DqFUBw','indexOf','Department','UserName','/_api/web/lists/getbytitle(\x27','/_api/SP.OAuth.Token/Acquire','Manager','6366hYVCPG','<option\x20value=\x220\x22>-Select\x20Company-</option>','ready','application/json;odata.metadata=none','parent','i:0#.f|membership|','LogonName','#btnEmpSubmit','evenselected','toLowerCase','oddselected','DepartmentName','\x27/></td><td><input\x20style=\x27width:\x20100%\x27\x20type=\x27text\x27\x20class=\x27doa\x27\x20value=\x27','value','Successfully\x20synced.',',\x0a\x20\x20Remaining\x20Licence\x20is\x20:\x20\x20','-70:+0','12nGjGvk','append','ajax','.empidchk','table','.manager','readonly','https://graph.microsoft.com/v1.0/users?$top=100','#EXT#','\x27)/GetItemById(\x27','OfficeName','DOA','sorter','html','totalrecords','Total\x20Licenced\x20:','waitDialog','resolve','results','access_token','getMonth','<div\x20id=\x27mainTablearea\x27\x20class=\x27table-responsive\x27><table\x20cellpadding=\x270\x27\x20\x20cellspacing=\x270\x27\x20border=\x271\x27\x20id=\x27tableTempEmp\x27\x20class=\x27table-width\x20tinytable\x20table\x20table-bordered\x20table-striped\x20table-hover\x20js-basic-example\x20dataTable\x20no-footer\x20employee_syn_table\x27></div><thead\x20class=\x27panel-heading\x27><tr><th\x20class=\x27nosort\x27\x20style=\x27width:40px;text-align:center;\x27><h6></h6></th><th\x20class=\x27nosort\x27><h6>Name</h6></th><th\x20\x20class=\x27nosort\x27><h6>Login</h6></th><th\x20\x20class=\x27nosort\x27><h6>Email</h6></th><th\x20class=\x27nosort\x27><h6>Department</h6></th><th\x20class=\x27nosort\x27><h6>Designation</h6></th><th\x20class=\x27nosort\x27><h6>Manager</h6></th><th\x20class=\x27nosort\x27><h6>MobileNo</h6></th><th\x20class=\x27nosort\x27><h6>DOB</h6></th><th\x20class=\x27nosort\x27><h6>DOA</h6></th><th\x20class=\x27nosort\x27><h6>DOJ</h6></th></tr></thead><tbody\x20class=\x27panel\x27>','LogonName\x20is\x20not\x20in\x20valid\x20format\x20!','asc','join','pagedropdown','log','.mobile','userPrincipalName','innerText','mobilePhone','SP.js','#mainDivArea','getFullYear','</ul>','tablenav','DOJ','evenrow','each','dateFormat','change','frameElement','</td><td>','#tableTempEmp\x20tbody\x20tr','3PfLGzt','show','<option></option>','find','split','currentpage','.btnMoreEmployeeListSynch','></td><td>','.desgination','GET','siteAbsoluteUrl','text','https://graph.microsoft.com','8MCTwpE','length','datepicker','getScript','application/json;odata=verbose','4956419LuvbFy','attr','/_api/web/lists/getbytitle(\x27Companies\x27)/items?$select=ID,CompanyName','click','/_api/web/sitegroups/getbyname(\x27Contributors\x27)?$select=id','<option\x20value=\x220\x22>-Select\x20Department-</option>','#search_field','#modalTitanPreview','==>','@odata.nextLink','DOB','yyyy','/_api/web/lists/getbytitle(\x27Employees\x27)/items?$select=ID,DepartmentId,LogonName/UserName,Company/ID&$expand=LogonName,Company&$filter=LogonName/UserName\x20\x20eq\x20\x27','message','Email','<tr><td\x20style=\x27text-align:center;\x27><input\x20type=\x27checkbox\x27\x20class=\x27empidchk\x27\x20name=\x27empid\x27\x20value=','[data-toggle=\x22tooltip\x22]','DELETE','#btnGetEmp','getDate','endrecord','#mainDivCompanies','\x27\x20and\x20CompanyId\x20eq\x20\x27','webAbsoluteUrl','Title','/_api/web/lists/getbytitle(\x27Employees\x27)/items','SP.Data.','TempEmployee','reject','done','prop','search','User\x20Added','#ddlTempOfficeLocation','1745415ZnoTMn','dd/mm/yy','Company','stringify','empty','995uIvLmO','head','\x27/></td></tr>','#query','You\x20don\x27t\x20have\x20enough\x20licence\x20\x0a\x20Consumed\x20Licence\x20\x20:\x20','/_layouts/15/','when','.doa','mail','hide','POST','/_api/web/lists/getbytitle(\x27Departments\x27)/items?$select=ID,CompanyIDId/ID,DepartmentName&$filter=CompanyIDId\x20\x20eq\x20\x27','Deferred','formatDate','displayName','\x27)/items','Please\x20select\x20company,department\x20and\x20office\x20location.','startrecord','checked','columns','surname','OtherMobileNumber','MobileNumber','option','OfficeLocation','responseText','221OhZTpu','#ddlTempCompany','dd/MM/yyyy','FirstName','#ddlTempDepartment','.doj','</tbody></table>','MiddleName','toString','#btnEmpUpdate','push','promise','1326284kVUaJV','Active','<li>','jobTitle',':visible','Bearer\x20','55LiGFnv',')/users','#tableTempEmp\x20tbody','?$top=100&$select=ID,LogonName','close','#tableTempEmpAllocated\x20tbody\x20tr','val','Error:\x20','Employees','error','DateOfAnniversary','Designation','HomePhone','\x20is\x20not\x20valid\x20user\x20!','Primary','?$top=100&$expand=LogonName&$select=ID,LogonName/UserName&$filter=Status\x20eq\x20\x27Active\x27','#__REQUESTDIGEST','../Pages/EmployeeSynchronous.aspx?WebAppId=','tooltip','application/json;\x20odata=verbose','2434lzsXED','mm/dd/yy','/_api/web/siteusers(@v)?@v=\x27','512420KIKYXi','.myHead','Item\x20Added','tableTempEmp','SP.User','givenName','CompanyName','\x27/></td><td><input\x20style=\x27width:\x20100%\x27\x20type=\x27text\x27\x20class=\x27manager\x27\x20value=\x27','#idsynch','LastName'];a0_0x47f2=function(){return _0x26e47b;};return a0_0x47f2();}function GetEmployeeList(_0x10ede9){var _0x5110db=a0_0x5289b7;employeeList=[],WaitMessage();var _0x3e43cd='?$top=1000&$expand=LogonName&$select=ID,LogonName/UserName',_0x3ca939=_spPageContextInfo[_0x5110db(0x242)]+_0x5110db(0x244)+_0x3e43cd;$[_0x5110db(0x1ef)]({'url':_0x3ca939,'data':{'format':_0x5110db(0x2a0)},'type':_0x5110db(0x222),'dataType':'json','async':![],'success':function(_0x3e9652){var _0x47f693=_0x5110db,_0x498665=_0x3e9652;for(var _0x242436=0x0;_0x242436<_0x498665[_0x47f693(0x1e9)][_0x47f693(0x227)];_0x242436++){if(_0x498665[_0x47f693(0x1e9)][_0x242436][_0x47f693(0x1e2)]!=undefined){var _0x1ca99c=_0x498665[_0x47f693(0x1e9)][_0x242436][_0x47f693(0x1e2)][_0x47f693(0x1d8)];_0x1ca99c!=null&&(employeeList['indexOf'](_0x1ca99c[_0x47f693(0x1e5)]())==-0x1&&employeeList[_0x47f693(0x276)](_0x1ca99c[_0x47f693(0x1e5)]()));}}}}),_0x10ede9==0x1&&GetTempEmployeeList(_0x10ede9);}function GetTempEmployee(){var _0x3a3f9e=a0_0x5289b7;tempemployeeList=[];var _0x1187ac=_0x3a3f9e(0x281),_0x5d0406=_spPageContextInfo[_0x3a3f9e(0x242)]+'/_api/web/lists/getbytitle(\x27TempEmployee\x27)/items'+_0x1187ac;$[_0x3a3f9e(0x1ef)]({'url':_0x5d0406,'data':{'format':'json'},'type':_0x3a3f9e(0x222),'dataType':_0x3a3f9e(0x2a0),'async':![],'success':function(_0x15b853){var _0x20830d=_0x3a3f9e,_0x1168f9=_0x15b853;for(var _0x236eb4=0x0;_0x236eb4<_0x1168f9[_0x20830d(0x1e9)][_0x20830d(0x227)];_0x236eb4++){var _0x18a6e7=_0x1168f9['value'][_0x236eb4]['LogonName'];tempemployeeList[_0x20830d(0x1d6)](_0x18a6e7[_0x20830d(0x1e5)]())==-0x1&&tempemployeeList['push'](_0x18a6e7[_0x20830d(0x1e5)]());}}});}function WaitMessage(){var _0x44d2f9=a0_0x5289b7;waitingDialog[_0x44d2f9(0x21a)]();}function CloseWaitDialog(){waitingDialog['hide']();}function CloseWaitDialog2(){var _0x117152=a0_0x5289b7;window[_0x117152(0x216)]!=null?window['parent'][_0x117152(0x1fd)]!=null&&window['parent']['waitDialog'][_0x117152(0x282)]():window['parent'][_0x117152(0x1fd)]!=null&&window[_0x117152(0x1e0)][_0x117152(0x1fd)][_0x117152(0x282)]();}var scriptbase=_spPageContextInfo[a0_0x5289b7(0x242)]+a0_0x5289b7(0x257);function PageLoad(){var _0x57c9e1=a0_0x5289b7;$(_0x57c9e1(0x21f))['click'](function(){GraphAccessTokenTogetUserDetails();}),$['getScript'](scriptbase+_0x57c9e1(0x20c),function(){var _0x37d6f3=_0x57c9e1;$[_0x37d6f3(0x229)](scriptbase+'SP.UserProfiles.js',ReadyFucnction);});}function ReadyFucnction(){var _0x3ac967=a0_0x5289b7;$[_0x3ac967(0x258)](GetTempEmployee())['done'](function(_0x1da963){GraphAccessTokenTogetUserDetails();});}function GraphAccessTokenTogetUserDetails(){var _0x4b35bd=a0_0x5289b7,_0x563c9c=new jQuery[(_0x4b35bd(0x25e))](),_0x3bb902={'X-RequestDigest':$(_0x4b35bd(0x28e))[_0x4b35bd(0x284)](),'accept':'application/json;odata=nometadata','content-type':'application/json;odata=nometadata'},_0x109f45={'resource':_0x4b35bd(0x225)};return $['ajax']({'url':_spPageContextInfo['webAbsoluteUrl']+_0x4b35bd(0x1da),'headers':_0x3bb902,'type':_0x4b35bd(0x25c),'data':JSON[_0x4b35bd(0x250)](_0x109f45),'success':function(_0x2704be){var _0xc8be6e=_0x4b35bd,_0x537580=_0x2704be[_0xc8be6e(0x200)];GetUsersDtails(_0x537580),_0x563c9c[_0xc8be6e(0x1fe)](_0x537580);},'error':function(_0x5268ec,_0x27265e,_0x9bd66e){var _0x2f6178=_0x4b35bd;console[_0x2f6178(0x207)](_0x5268ec['responseText']),_0x563c9c['reject'](_0x5268ec[_0x2f6178(0x26b)]);}}),_0x563c9c[_0x4b35bd(0x277)]();}var odurlGraphUserRestQuery=a0_0x5289b7(0x1f4),_NextToken;function GetUsersDtails(_0x4865f3){var _0x50d761=a0_0x5289b7;_NextToken=_0x4865f3,$[_0x50d761(0x1ef)]({'url':odurlGraphUserRestQuery,'dataType':_0x50d761(0x2a0),'headers':{'Authorization':_0x50d761(0x27d)+_0x4865f3},'accept':_0x50d761(0x1df),'success':function(_0x504041){var _0x5c854a=_0x50d761,_0x9a183c=new Array(),_0x2a50d1=_0x504041['value'];for(var _0x4d59a3=0x0;_0x4d59a3<_0x504041[_0x5c854a(0x1e9)]['length'];_0x4d59a3++){var _0xa3788=_0x2a50d1[_0x4d59a3][_0x5c854a(0x29a)],_0x5e0173='',_0x45d364=_0x2a50d1[_0x4d59a3][_0x5c854a(0x266)],_0x115413=_0x2a50d1[_0x4d59a3][_0x5c854a(0x260)],_0x4d85ae=_0x2a50d1[_0x4d59a3][_0x5c854a(0x209)],_0x537c6b=_0x2a50d1[_0x4d59a3][_0x5c854a(0x25a)],_0x4781ec='',_0x2a3d00=_0x2a50d1[_0x4d59a3][_0x5c854a(0x27b)],_0x3c5f3e='',_0x3b791c='',_0xafd8d9=_0x2a50d1[_0x4d59a3][_0x5c854a(0x20b)],_0x3c5b01='',_0x366ea6='',_0x3b38d6='';if(_0x4d85ae[_0x5c854a(0x1d6)](_0x5c854a(0x1f5))==-0x1){var _0x3c05a4=UserProfileProperties(_0xa3788,_0x5e0173,_0x45d364,_0x115413,_0x4d85ae,_0x537c6b,_0x4781ec,_0x2a3d00,_0x3c5f3e,_0x3b791c,_0xafd8d9,_0x3c5b01,_0x366ea6,_0x3b38d6);_0x9a183c[_0x5c854a(0x276)](_0x3c05a4);}else{var _0x3c05a4=UserProfileProperties(_0xa3788,_0x5e0173,_0x45d364,_0x115413,_0x4d85ae,_0x537c6b,_0x4781ec,_0x2a3d00,_0x3c5f3e,_0x3b791c,_0xafd8d9,_0x3c5b01,_0x366ea6,_0x3b38d6);_0x9a183c['push'](_0x3c05a4);}}for(var _0x4d59a3=0x0;_0x4d59a3<_0x9a183c[_0x5c854a(0x227)];_0x4d59a3++){var _0xa3788=_0x9a183c[_0x4d59a3][_0x5c854a(0x26f)],_0x5e0173=_0x9a183c[_0x4d59a3][_0x5c854a(0x273)],_0x45d364=_0x9a183c[_0x4d59a3][_0x5c854a(0x29e)],_0x115413=_0x9a183c[_0x4d59a3][_0x5c854a(0x2a6)],_0x4d85ae=_0x9a183c[_0x4d59a3][_0x5c854a(0x1e2)],_0x537c6b=_0x9a183c[_0x4d59a3][_0x5c854a(0x239)],_0x4781ec=_0x9a183c[_0x4d59a3][_0x5c854a(0x1d7)],_0x2a3d00=_0x9a183c[_0x4d59a3][_0x5c854a(0x289)],_0x3c5f3e=_0x9a183c[_0x4d59a3][_0x5c854a(0x24f)],_0x3b791c=_0x9a183c[_0x4d59a3][_0x5c854a(0x1db)],_0xafd8d9=_0x9a183c[_0x4d59a3][_0x5c854a(0x268)],_0x3c5b01=_0x9a183c[_0x4d59a3][_0x5c854a(0x28a)],_0x366ea6=_0x9a183c[_0x4d59a3][_0x5c854a(0x26a)],_0x3b38d6=_0x9a183c[_0x4d59a3][_0x5c854a(0x267)];{var _0x4dcaa2='';{}tempemployeeList['indexOf'](_0x4d85ae)==-0x1&&(CreateListItem(_0xa3788,_0x5e0173,_0x45d364,_0x115413,_0x4d85ae,_0x537c6b,_0x4781ec,_0x2a3d00,_0x3c5f3e,_0x4dcaa2,_0xafd8d9,_0x3c5b01,_0x366ea6,_0x3b38d6),tempemployeeList[_0x5c854a(0x276)](_0x4d85ae));}}_0x504041[_0x5c854a(0x234)]!=null?(odurlGraphUserRestQuery=_0x504041[_0x5c854a(0x234)],GetUsersDtails(_NextToken)):$(_0x5c854a(0x21f))[_0x5c854a(0x25b)](),GetTempEmployeeList(0x0),CloseWaitDialog();}});}function UserProfileProperties(_0x5404d6,_0x46d229,_0x31a883,_0x11ebb0,_0x43f64b,_0x6ecb5,_0x490c70,_0x15ccd1,_0x2649cd,_0x5205f4,_0x57e1ff,_0x33e8fe,_0x185f72,_0x3b561c){var _0x7afd2f=a0_0x5289b7,_0x5f2317={};return _0x5f2317[_0x7afd2f(0x26f)]=_0x5404d6,_0x5f2317[_0x7afd2f(0x273)]=_0x46d229,_0x5f2317[_0x7afd2f(0x29e)]=_0x31a883,_0x5f2317[_0x7afd2f(0x2a6)]=_0x11ebb0,_0x5f2317[_0x7afd2f(0x1e2)]=_0x43f64b,_0x5f2317[_0x7afd2f(0x239)]=_0x6ecb5,_0x5f2317['Department']=_0x490c70,_0x5f2317[_0x7afd2f(0x289)]=_0x15ccd1,_0x5f2317[_0x7afd2f(0x24f)]=_0x2649cd,_0x5f2317['Manager']=_0x5205f4,_0x5f2317[_0x7afd2f(0x268)]=_0x57e1ff,_0x5f2317[_0x7afd2f(0x28a)]=_0x33e8fe,_0x5f2317[_0x7afd2f(0x26a)]=_0x185f72,_0x5f2317[_0x7afd2f(0x267)]=_0x3b561c,_0x5f2317;}function CreateListItem(_0x414f37,_0x2c20ad,_0x1dad54,_0x5df306,_0x16085a,_0xe54c70,_0x4c90a1,_0x3ee499,_0x505f83,_0x49aac8,_0x4e8067,_0x14ab62,_0x1d4df0,_0x43bffa){var _0x2aea6=a0_0x5289b7,_0x50bc4c=_0x2aea6(0x246);try{var _0x38b97a=_0xe54c70;(_0x38b97a==null||_0x38b97a=='')&&(_0x38b97a=_0x16085a);var _0x3d7c2d,_0x2c7dab=GetItemTypeForListName(_0x50bc4c);_0x3d7c2d={'__metadata':{'type':_0x2c7dab},'FirstName':_0x414f37,'LastName':_0x1dad54,'MiddleName':_0x2c20ad,'FullName':_0x5df306,'LogonName':_0x16085a,'Email':_0x38b97a,'Department':_0x4c90a1,'Designation':_0x3ee499,'Company':_0x505f83,'Manager':_0x49aac8,'MobileNumber':_0x4e8067,'HomePhone':_0x14ab62,'OfficeLocation':_0x1d4df0,'OtherMobileNumber':_0x43bffa},$[_0x2aea6(0x258)](AddItemToList(_0x50bc4c,_0x3d7c2d,!![]))[_0x2aea6(0x248)](function(_0x13a078){});}catch(_0x56589c){console[_0x2aea6(0x207)](_0x56589c[_0x2aea6(0x238)]);}}function onQuerySucceeded(){var _0x40c510=a0_0x5289b7;console[_0x40c510(0x207)](_0x40c510(0x297));}function onQueryFailed(_0x251e4b,_0x1a2536){var _0xaffd79=a0_0x5289b7;alert(_0xaffd79(0x285)+_0x1a2536['get_message']());}function GetUserFullName(_0x49394e){var _0x1a5579=a0_0x5289b7,_0xabe22c='',_0x550afd=_0x1a5579(0x1e1),_0xa254aa=_spPageContextInfo[_0x1a5579(0x223)],_0x133756=_0x550afd+_0x49394e;return $[_0x1a5579(0x1ef)]({'url':_0xa254aa+_0x1a5579(0x294)+encodeURIComponent(_0x133756)+'\x27','method':'GET','headers':{'Accept':_0x1a5579(0x291)},'async':![],'success':function(_0x11a3e4){var _0x16f058=_0x1a5579;_0xabe22c=_0x11a3e4['d'][_0x16f058(0x243)];},'error':function(_0x4ce758){var _0x2ba442=_0x1a5579;console['log'](JSON[_0x2ba442(0x250)](_0x4ce758));}}),_0xabe22c;}function GetAllItemsToDelete(){var _0x4db7a8=a0_0x5289b7;$[_0x4db7a8(0x1ef)]({'url':_spPageContextInfo[_0x4db7a8(0x242)]+'/_api/web/lists/getByTitle(\x27TempEmployee\x27)/items','type':_0x4db7a8(0x222),'headers':{'accept':'application/json;odata=verbose'},'success':function(_0x289928){var _0x57ea2a=_0x4db7a8,_0x246da0=_0x289928['d'][_0x57ea2a(0x1ff)];for(var _0x57f4d7=0x0;_0x57f4d7<_0x246da0[_0x57ea2a(0x227)];_0x57f4d7++){var _0x166eb2=_spPageContextInfo['webAbsoluteUrl']+'/_api/Web/Lists/getByTitle(\x27TempEmployee\x27)/getItemById('+_0x246da0[_0x57f4d7]['ID']+')';deleteItem(_0x166eb2);}},'error':function(_0x1476d7){var _0x2f840f=_0x4db7a8;console[_0x2f840f(0x207)](JSON[_0x2f840f(0x250)](_0x1476d7));}});}function deleteItem(_0x20ce69){var _0x14d1fe=a0_0x5289b7;$[_0x14d1fe(0x1ef)]({'url':_0x20ce69,'type':_0x14d1fe(0x23c),'headers':{'accept':_0x14d1fe(0x22a),'X-RequestDigest':$(_0x14d1fe(0x28e))['val'](),'If-Match':'*'},'success':function(_0x1e4351){var _0x5661d1=_0x14d1fe;console[_0x5661d1(0x207)]('deleted\x20item');},'error':function(_0x1852d2){console['log'](JSON['stringify'](_0x1852d2));}});}function GetLicencedUsersCount(){var _0x4a828c=a0_0x5289b7,_0x48ff79=0x0,_0x1246f6=_0x4a828c(0x28d),_0x5c9412=_spPageContextInfo['webAbsoluteUrl']+_0x4a828c(0x244)+_0x1246f6;return $[_0x4a828c(0x1ef)]({'url':_0x5c9412,'data':{'format':_0x4a828c(0x2a0)},'type':_0x4a828c(0x222),'dataType':_0x4a828c(0x2a0),'async':![],'success':function(_0xcb0e5b){var _0xfee15a=_0x4a828c,_0x2e6e61=_0xcb0e5b,_0x3e08d8=[];for(var _0x5ba43a=0x0;_0x5ba43a<_0x2e6e61[_0xfee15a(0x1e9)]['length'];_0x5ba43a++){if(_0x2e6e61[_0xfee15a(0x1e9)][_0x5ba43a][_0xfee15a(0x1e2)]!=undefined){var _0x3a9327=_0x2e6e61['value'][_0x5ba43a]['LogonName']['UserName'];_0x3a9327!=null&&(_0x3e08d8[_0xfee15a(0x1d6)](_0x3a9327[_0xfee15a(0x1e5)]())==-0x1&&_0x3e08d8[_0xfee15a(0x276)](_0x3a9327[_0xfee15a(0x1e5)]()));}}_0x48ff79=_0x3e08d8[_0xfee15a(0x227)];}}),_0x48ff79;}