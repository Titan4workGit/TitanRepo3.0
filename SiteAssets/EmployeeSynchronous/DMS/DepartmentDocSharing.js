(function(_0x3b6da4,_0x1d3983){var _0x313be9=a0_0x4cb6,_0x191081=_0x3b6da4();while(!![]){try{var _0x26f31c=-parseInt(_0x313be9(0x146))/0x1*(-parseInt(_0x313be9(0x171))/0x2)+-parseInt(_0x313be9(0x111))/0x3*(-parseInt(_0x313be9(0x174))/0x4)+parseInt(_0x313be9(0x11f))/0x5*(-parseInt(_0x313be9(0x15b))/0x6)+parseInt(_0x313be9(0x11e))/0x7*(-parseInt(_0x313be9(0x116))/0x8)+-parseInt(_0x313be9(0x18b))/0x9*(parseInt(_0x313be9(0xf6))/0xa)+parseInt(_0x313be9(0xf0))/0xb*(parseInt(_0x313be9(0x15a))/0xc)+-parseInt(_0x313be9(0x13c))/0xd*(-parseInt(_0x313be9(0x18c))/0xe);if(_0x26f31c===_0x1d3983)break;else _0x191081['push'](_0x191081['shift']());}catch(_0x29451c){_0x191081['push'](_0x191081['shift']());}}}(a0_0x42f8,0x3fcfc));var currentFileSiteURL='',mydeptSiteUrl='',currentDlgShare='';$(document)['ready'](function(){var _0x1cf874=a0_0x4cb6;getDeptSiteUrl(),$(_0x1cf874(0x19b))[_0x1cf874(0xed)](function(){OpenSharePopup();}),$('#Deptmutiplesharefile')[_0x1cf874(0xed)](function(){var _0x276a28=_0x1cf874,_0x422ff2=_0x276a28(0xf1),_0x143347='<br\x20/>Please\x20wait!!',_0x19fdb0=0xc8,_0x4a1fa7=0x190;SP[_0x276a28(0x103)][_0x276a28(0x110)]([_0x276a28(0x16d),_0x276a28(0x152)],function(){var _0x211052=_0x276a28;currentDlgShare=SP['UI'][_0x211052(0x17c)][_0x211052(0x179)](_0x422ff2,_0x143347,_0x19fdb0,_0x4a1fa7);}),setTimeout(function(){DeptSharemutiplefile();},0x64);}),$(_0x1cf874(0x1a2))[_0x1cf874(0x13b)](function(){var _0x268f58=_0x1cf874;clearPeoplePickerControl(_0x268f58(0x118)),$(_0x268f58(0x178))['show']();if($(this)[_0x268f58(0x123)]()=='Organization')$(_0x268f58(0x17b))[_0x268f58(0x156)](),$(_0x268f58(0x178))[_0x268f58(0x143)](),$('#ddlOrgNameDeptFolder')['val']()==null?getGuestClients(_0x268f58(0x16c)):($(_0x268f58(0x126))[_0x268f58(0x128)](_0x268f58(0x1b0),![]),$(_0x268f58(0x140))['text'](_0x268f58(0x1b2)));else{if($(this)[_0x268f58(0x123)]()=='0'||$(this)[_0x268f58(0x123)]()==_0x268f58(0x164))$(_0x268f58(0x17b))[_0x268f58(0x143)](),$(_0x268f58(0x178))['hide']();else $(this)['val']()!='Selective'&&$(this)['val']()!='0'?($('.orgDropdowndivDeptFolder')[_0x268f58(0x143)](),GetDeptSharingGpUsers($(this)[_0x268f58(0x123)](),'Folder')):$('.orgDropdowndivDeptFolder')[_0x268f58(0x143)]();}}),$(_0x1cf874(0x160))[_0x1cf874(0x13b)](function(){var _0x35b995=_0x1cf874;getOrgEmps($(_0x35b995(0x195))[_0x35b995(0xef)]());}),$(_0x1cf874(0x14c))[_0x1cf874(0xed)](function(){var _0x4ce1bb=_0x1cf874,_0x29dbb4=_0x4ce1bb(0x169),_0x63dc4e=_0x4ce1bb(0x12d),_0x20d23a=0xc8,_0x44a52c=0x190;SP['SOD']['loadMultiple']([_0x4ce1bb(0x16d),_0x4ce1bb(0x152)],function(){var _0x4a38d1=_0x4ce1bb;currentDlgShare=SP['UI']['ModalDialog'][_0x4a38d1(0x179)](_0x29dbb4,_0x63dc4e,_0x20d23a,_0x44a52c);}),setTimeout(function(){deptDocFolderSharing();},0x64);}),$(_0x1cf874(0x184))[_0x1cf874(0xed)](function(){var _0x87b355=_0x1cf874;$(_0x87b355(0x188))[_0x87b355(0x127)]('hide'),$(_0x87b355(0x178))['hide'](),$(_0x87b355(0x17b))[_0x87b355(0x143)](),$(_0x87b355(0x117))[_0x87b355(0x144)](''),$(_0x87b355(0x126))[_0x87b355(0x128)](_0x87b355(0x1b0),![]),$(_0x87b355(0x140))[_0x87b355(0xef)]('Select');});});function CreatDeptDocfromTemplateWordFile(){var _0x140263=a0_0x4cb6;CommonDeptFileCreate(_0x140263(0x10c),0x1);}function CreatDeptDocfromTemplateExcelFile(){var _0x2456d7=a0_0x4cb6;CommonDeptFileCreate(_0x2456d7(0x105),0x2);}function CreatDeptDocfromTemplatePPTFile(){CommonDeptFileCreate('pptx',0x3);}function CommonDeptFileCreate(_0x157ec3,_0x12aa62){var _0x5ecbca=a0_0x4cb6,_0x53142a='',_0x433ccc=$(_0x5ecbca(0x102))[_0x5ecbca(0x123)]();_0x433ccc=_0x433ccc[_0x5ecbca(0x149)](0x10,-0x1);if(mydeptSiteUrl==_0x5ecbca(0x12b))return alert(_0x5ecbca(0x1ac)),![];_0x433ccc==''?createNewDocumentWithRedirect2(_0x53142a,mydeptSiteUrl+_0x5ecbca(0xf7)+_0x157ec3,mydeptSiteUrl+_0x5ecbca(0x136),_0x5ecbca(0x1ab),![],mydeptSiteUrl+_0x5ecbca(0x132)+myCompanyUrl+_0x5ecbca(0x121)+_0x157ec3,!![],_0x12aa62):createNewDocumentWithRedirect2(_0x53142a,mydeptSiteUrl+_0x5ecbca(0xf7)+_0x157ec3,mydeptSiteUrl+_0x5ecbca(0x16e)+_0x433ccc,'SharePoint.OpenDocuments',![],mydeptSiteUrl+'/_layouts/CreateNewDocument.aspx?id='+myCompanyUrl+_0x5ecbca(0x121)+_0x157ec3,!![],_0x12aa62);}function getDeptSiteUrl(){var _0x2b5aeb=a0_0x4cb6,_0x545d5c=_0x2b5aeb(0x1ae)+Logged_DepartmentId+'\x27\x20';dfds=$[_0x2b5aeb(0x155)](),url=_spPageContextInfo[_0x2b5aeb(0x172)]+'/_api/web/lists/getbytitle(\x27Departments\x27)/items/'+_0x545d5c,$[_0x2b5aeb(0x151)](getItems(url,dfds))[_0x2b5aeb(0x114)](function(_0x5af6cb){var _0x13a113=_0x2b5aeb;response=[],_0x5af6cb[_0x13a113(0x14b)]>0x0?mydeptSiteUrl=_0x5af6cb[0x0][_0x13a113(0xf2)]:mydeptSiteUrl=_0x13a113(0x12b);});}function OpenSharePopup(){var _0x5488c0=a0_0x4cb6;$(_0x5488c0(0xfe))[_0x5488c0(0x143)]();if(selectedDepartmentDoc[_0x5488c0(0x14b)]>0x0)globalsharingDocumentDetails='',globalSharingDocumentDocumentType='',$(_0x5488c0(0x166))['attr'](_0x5488c0(0x1b0),!![]),$(_0x5488c0(0x1aa))[_0x5488c0(0x123)](''),$(_0x5488c0(0x163))[_0x5488c0(0x144)](''),$(_0x5488c0(0x193))[_0x5488c0(0x144)](''),$(_0x5488c0(0x17e))[_0x5488c0(0x144)](''),$('#sharedWithPermission')[_0x5488c0(0x123)]('--select--'),$(_0x5488c0(0x19d))[_0x5488c0(0x123)]('0'),$('#sharefilename')[_0x5488c0(0x143)](),$(_0x5488c0(0x115))[_0x5488c0(0x143)](),$(_0x5488c0(0x185))['hide'](),sharedUsersIdArrayListItemCollection=[],sharedUsersEmailIDsArrayListItemCollection=[],clearPeoplePickerControl(_0x5488c0(0x1b5)),$('#myModalDocumentSharing')['modal'](_0x5488c0(0x156)),$(_0x5488c0(0x134))[_0x5488c0(0x143)](),$(_0x5488c0(0x14e))['show'](),BindMySharingGroups(),$(_0x5488c0(0x19d))[_0x5488c0(0x187)](_0x5488c0(0x13b));else return alert(_0x5488c0(0x1a9)),![];}function DeptSharemutiplefile(){var _0xe38cc1=a0_0x4cb6;if(selectedDepartmentDoc[_0xe38cc1(0x14b)]>0x0){var _0x2121e0=$(_0xe38cc1(0x19d))[_0xe38cc1(0x123)](),_0x1966da=$(_0xe38cc1(0xf4))[_0xe38cc1(0x123)]();if(_0x2121e0=='0'||_0x2121e0==null||_0x2121e0=='')return currentDlgShare!=''&&currentDlgShare[_0xe38cc1(0x167)](),alert(_0xe38cc1(0x13f)),![];else{if(_0x1966da==null||_0x1966da==''||_0x1966da=='--select--')return currentDlgShare!=''&&currentDlgShare['close'](),alert('Kindly\x20select\x20permission\x20type.'),![];}if(_0x2121e0=='Private')$(_0xe38cc1(0x166))['attr'](_0xe38cc1(0x1b0),![]);else{if(_0x2121e0==_0xe38cc1(0x10a)){sharedHistoryUser=sharedUsersIdArrayListItemCollection;if($(_0xe38cc1(0x140))[_0xe38cc1(0xef)]()[_0xe38cc1(0x119)](_0xe38cc1(0x1b2))==0x0)return currentDlgShare!=''&&currentDlgShare[_0xe38cc1(0x167)](),alert(_0xe38cc1(0x1a7)),![];if(sharedUsersIdArrayListItemCollection[_0xe38cc1(0x14b)]==0x0)return currentDlgShare!=''&&currentDlgShare['close'](),alert('Guest\x20users\x20are\x20not\x20available\x20in\x20selected\x20organization(s).'),![];}else{sharedHistoryUser=[],sharedUsersIdArrayListItemCollection=[],sharedUsersEmailIDsArrayListItemCollection=[];if(getUserInfoFromPeoplePicker(_0xe38cc1(0x1b5))){if(sharedUsersIdArrayListItemCollection!=null){sharedHistoryUser=sharedUsersIdArrayListItemCollection;if(sharedUsersIdArrayListItemCollection[_0xe38cc1(0x14b)]==0x0)return currentDlgShare!=''&&currentDlgShare['close'](),alert('Kindly\x20enter\x20sharing\x20users.'),![];}else return currentDlgShare!=''&&currentDlgShare[_0xe38cc1(0x167)](),alert(_0xe38cc1(0x145)),![];}else return currentDlgShare!=''&&currentDlgShare[_0xe38cc1(0x167)](),alert(_0xe38cc1(0x145)),![];}}for(var _0x168b41=0x0;_0x168b41<selectedDepartmentDoc[_0xe38cc1(0x14b)];_0x168b41++){currentFileSiteURL=window[_0xe38cc1(0x10f)]['origin']+selectedDepartmentDocrelativeurl[_0x168b41][_0xe38cc1(0x1a0)](_0xe38cc1(0x11c))[0x0];var _0x5b9cd1=selectedDepartmentDoc[_0x168b41],_0xb4a44f=GetDeptFileServerRelativeUrl(_0x5b9cd1,_0xe38cc1(0x182));arrSharedUserIds=[];var _0x761d25=-0x1;while(++_0x761d25<sharedUsersIdArrayListItemCollection['length']){arrSharedUserIds[_0x761d25]=sharedUsersIdArrayListItemCollection[_0x761d25];}sharedUsersIdArrayListItemCollection=sharedUsersIdArrayListItemCollection[_0xe38cc1(0x10d)](sharefileuser);if(_0x2121e0==_0xe38cc1(0x164))sharedUsersIdArrayListItemCollection=[],$[_0xe38cc1(0x151)](BreakInheritePermissionOnItemSharing(myCompanyUrl,_0xb4a44f,_0x5b9cd1,_spPageContextInfo[_0xe38cc1(0x1af)],sharedUsersIdArrayListItemCollection))[_0xe38cc1(0x114)](function(_0x1644e0){DeleteSharedLink(_0x5b9cd1);});else{var _0x34a755=$(_0xe38cc1(0x19d))['val'](),_0x1fcfad=$(_0xe38cc1(0xf4))[_0xe38cc1(0x123)]();ShareFilesFolder(_0xb4a44f,_0xe38cc1(0x182));if(sharedUsersIdArrayListItemCollection[_0xe38cc1(0x14b)]>0x0){var _0x48d42d=$(_0xe38cc1(0x19d))['val']();updateDeptDocPropertiesOnItemSharing(_0x5b9cd1,_0xb4a44f,_0x48d42d,sharedUsersIdArrayListItemCollection,currentFileSiteURL,![]),GetDocumentsRevoke(sharedHistoryUser,_0x5b9cd1),_0x2121e0==_0xe38cc1(0x10a)?AddSharedLinkToListOrg(shredLinkFileName,_0xb4a44f,arrUserClientWise,_0x5b9cd1,_0xe38cc1(0x182),_0x34a755,_0x1fcfad,_0xe38cc1(0x168)):AddSharedLinkToList22(shredLinkFileName,_0xb4a44f,sharedHistoryUser,_0x5b9cd1,_0xe38cc1(0x182),_0x34a755,_0x1fcfad,_0xe38cc1(0x168));}sharedUsersIdArrayListItemCollection=sharedHistoryUser;}sharefileuser=[];}selectedDocumentserverrelativeurl=[],selectedDepartmentDoc=[];if($(_0xe38cc1(0x166))[_0xe38cc1(0x128)]('checked')==!![]){if(arrDepartmntEmail[_0xe38cc1(0x14b)]>0x0){var _0x2a9b6e='',_0x26155b=$(_0xe38cc1(0x19c))[_0xe38cc1(0xef)]();_0x26155b==_0xe38cc1(0x113)&&(_0x26155b='');_0x2a9b6e=_0xe38cc1(0x138)+_spPageContextInfo['userDisplayName']+_0xe38cc1(0x177);for(i=0x0;i<arrDepartmntEmail['length'];i++){_0x2a9b6e=_0x2a9b6e+_0xe38cc1(0x142)+arrDepartmntEmail[i][_0xe38cc1(0x182)]+'</div>'+_0xe38cc1(0xfc)+arrDepartmntEmail[i][_0xe38cc1(0x158)]+_0xe38cc1(0x13e)+_0xe38cc1(0xec)+arrDepartmntEmail[i][_0xe38cc1(0x107)]+'</div>'+'<div><strong>Type:</strong>\x20'+arrDepartmntEmail[i][_0xe38cc1(0x1b3)]+'</div>'+_0xe38cc1(0x170)+_0x26155b+_0xe38cc1(0x13e)+_0xe38cc1(0x15f)+arrDepartmntEmail[i]['serverUrl']+_0xe38cc1(0x1a5)+_0xe38cc1(0x101);}_0x2a9b6e+=_0xe38cc1(0xff);}arrDepartmntEmail=[];var _0x8c6537=[];_0x8c6537[_0xe38cc1(0x120)]($('#lblSelectedCurrentEmail')[_0xe38cc1(0x144)]());var _0x25f451=$(_0xe38cc1(0x19d))['val'](),_0x561f50=$(_0xe38cc1(0x15e))[_0xe38cc1(0x144)](),_0x1003d8;_0x1003d8={'properties':{'__metadata':{'type':'SP.Utilities.EmailProperties'},'From':_0x561f50,'To':{'results':sharedUsersEmailIDsArrayListItemCollection},'CC':{'results':_0x8c6537},'Body':_0x2a9b6e,'Subject':sharedEmailSubject}},SendEmailSharedNotification(_0x1003d8);}}else alert(_0xe38cc1(0x1a9)),currentDlgShare!=''&&currentDlgShare[_0xe38cc1(0x167)]();currentDlgShare!=''&&currentDlgShare['close']();}function a0_0x42f8(){var _0x12974b=['Kindly\x20select\x20permission\x20type.','UserName','.mulinput','modal','prop','#lblSelectedFileUrl','replace','null','parse','<br\x20/>Please\x20wait!!','Error\x20while\x20checking\x20out:\x20',')?$expand=RoleAssignments/Member/Users',')/roleassignments/getbyprincipalid(','charAt','/_layouts/CreateNewDocument.aspx?id=','POST','.MyDocsShare','\x27\x20and\x20LogonUser/ID\x20eq\x20\x27','/DepartmentalDMS','Selective','Dear\x20User,<br/><br/>','log','application/json;odata=verbose','change','3833479HnYtaX','<option></option>','</div>','Kindly\x20select\x20sharing\x20type.','.multiBox','GET','<div><strong>File\x20Name\x20:</strong>','hide','html','Kindly\x20enter\x20sharing\x20users.','5637SjxwLC','{{filename}}','join','slice','siteAbsoluteUrl','length','#btnDeptShareFolder','#lblFolderDeptTiltle','#Deptmutiplesharefile',')?$select=ServerRedirectedEmbedUri,File/Name,File/ServerRelativeUrl,Folder/Name,Folder/ServerRelativeUrl,Shared/Title,SharedId&$expand=File,Folder,SharedId','siteId','when','sp.ui.dialog.js','reject','\x20Successfully\x20removed\x20Permission\x20!','Deferred','show','/_api/web/GetFileByServerRelativeUrl(\x27','Reference','_api/web/lists/getByTitle(\x27DepartmentalDMS\x27)/getItemById(','1200zfEExD','2976myKiON','Error:\x20','{{fileype}}','#lblSelectedCurrentEmail','<div><a\x20href=','#ddlOrgNameDeptFolder','SP.Utilities.EmailProperties','Item','#lblFileName','Private','empty','#chekedSendEmail','close','Department','Sharing\x20folder...','ServerRelativeUrl','Guest\x20users\x20are\x20not\x20available\x20in\x20selected\x20organization(s).','ddlOrgNameDeptFolder','strings.js','/DepartmentalDMS/','Folder','<div><strong>Permission:</strong>\x20','30QKNHQG','webAbsoluteUrl','Folder\x27s\x20permission\x20has\x20been\x20set\x20private.','12HVTgyN','#txtPermissionLevelId','json',',\x20shared\x20the\x20following\x20document\x20with\x20you.<br/><br/>','.folderpeoplepickerdivshowhide','showWaitScreenWithNoClose','Please\x20enter\x20sharing\x20users.','.orgDropdowndivDeptFolder','ModalDialog','Read','#lblDocTiltle','value','SharingLevel','/_api/web/lists/getbytitle(\x27DocumentSharedGroups\x27)/items?$select=ID,SharingLevel,SharedUsers/Title,SharedUsers/UserName,SharedUsers/ID,LogonUser/ID,LogonUser/UserName&$expand=SharedUsers,LogonUser&$filter=SharingLevel\x20eq\x20\x27','File','_api/web/Lists/GetByTitle(\x27DepartmentalDMS\x27)/getItemById(','#btnDeptCancelShareFolder,\x20#btnCloseDeptShare','#filedocumentname','ServerRedirectedEmbedUri','trigger','#myDeptFolderSharing','ItemId','results','4693365lGSslV','28KMpDsV','Revoked','resolve','\x27)/ListItemAllFields/breakroleinheritance(true)','{{doclink}}','<option\x20value=\x220\x22>-Select\x20Sharing-</option>','{{Permission}}','#lblDocNumber','_api/web/getfilebyserverrelativeurl(\x27','#ddlOrgNameDeptFolder\x20:selected','#myModalShareHistory','#sharedWithPermission\x20\x20:selected','attr','{{sharedby}}','Restricted\x20View','#deptDocShare','#sharedWithPermission\x20:selected','#shareingTypePermissionLevel','\x27)/checkin','GetMyDocumentsWithFilesFolder','split','#__REQUESTDIGEST','#sharingTypeDeptFolderPermissionLvl','PrincipalId','MyDepartmentDocumentCurrentFolder','>Click\x20here</a>\x20to\x20open\x20the\x20document.</div>','_api/Web/Lists/getByTitle(\x27DepartmentalDMS\x27)/Items(','Kindly\x20select\x20any\x20organization.','RoleAssignments','Please\x20select\x20one\x20or\x20more\x20file','#txtSharedDocumetnOnDemandId','SharePoint.OpenDocuments','Department\x20site\x20URL\x20is\x20not\x20found!','.context-menu','?$select=ID,SiteURL&$top=5000&$filter=ID\x20eq\x20\x27','userId','checked','SharedId','Select','Type','SharedDocument','customShareingPoplePicker','Please\x20select\x20sharing\x20type.','Name','append','file\x20chekin','error:\x20','<div><strong>Title:</strong>\x20','click','promise','text','41437TEmrdB','Sharing\x20files...','SiteURL','fail','#sharedWithPermission','SP.Data.','10uALSbL','/DepartmentalDMS/Forms/template.','webServerRelativeUrl','DELETE','/Pages/MyDocuments.aspx?WebAppId=1','Sharing\x20Dept_Doc\x20Folder\x20','<div><strong>Reference\x20No\x20:</strong>\x20','/_api/web/GetFolderByServerRelativeUrl(\x27','.orgDropdowndiv','This\x20is\x20an\x20auto\x20generated\x20email.\x20Please\x20don\x27t\x20reply.','\x27)/ListItemAllFields/roleassignments/getbyprincipalid(','<br/><br/>','#currentSubFolderMyDepartment','SOD','stringify','xlsx','origin','Title','{{details}}','#chkDeptFolderSendEmail','Organization','toUpperCase','dotx','concat','filter','location','loadMultiple','255390HRZUkW','permission\x20deleted\x20sucessfully.','--select--','done','#sharefiletilte','3601168rAAtrY','#deptSharedFolderUsersLists','customSharingDeptFolderPplPickr','indexOf','#shareWithDeptFolderPermission','SharedUsers','DepartmentalDMS','ajax','7AIHBfp','740rRGlRr','push','/DocumentManagementSystem/Forms/template.','whatever','val'];a0_0x42f8=function(){return _0x12974b;};return a0_0x42f8();}function GetDeptFileServerRelativeUrl(_0x35bd26,_0x2dc7ac){var _0x2fe8bb=a0_0x4cb6,_0x55ba97='',_0x4fbe87=currentFileSiteURL+'_api/web/Lists/GetByTitle(\x27DepartmentalDMS\x27)/getItemById('+_0x35bd26+')?$select=ServerRedirectedEmbedUri,File/Name,File/ServerRelativeUrl,Folder/Name,Folder/ServerRelativeUrl,Shared/Title,SharedId&$expand=File,Folder,SharedId';return $[_0x2fe8bb(0x11d)]({'url':_0x4fbe87,'headers':{'accept':_0x2fe8bb(0x13a),'content-type':_0x2fe8bb(0x13a),'X-RequestDigest':$('#__REQUESTDIGEST')[_0x2fe8bb(0x123)]()},'async':![],'success':function(_0x357721){var _0x2c402d=_0x2fe8bb;if(_0x2dc7ac==_0x2c402d(0x182)){_0x55ba97=_0x357721['d'][_0x2c402d(0x182)][_0x2c402d(0x16a)],shredLinkFileName=_0x357721['d'][_0x2c402d(0x182)][_0x2c402d(0x1b7)],commonserverRedirectedEmbedUri=_0x357721['d'][_0x2c402d(0x186)];if(_0x357721['d'][_0x2c402d(0x1b1)]!=null)for(var _0x46cc8a=0x0;_0x46cc8a<_0x357721['d'][_0x2c402d(0x1b1)]['results'][_0x2c402d(0x14b)];_0x46cc8a++){var _0x59b899=_0x357721['d'][_0x2c402d(0x1b1)][_0x2c402d(0x18a)][_0x46cc8a];sharefileuser[_0x2c402d(0x120)](_0x59b899);}(commonserverRedirectedEmbedUri==null||commonserverRedirectedEmbedUri=='')&&(commonserverRedirectedEmbedUri='');}else _0x55ba97=_0x357721['d'][_0x2c402d(0x16f)][_0x2c402d(0x16a)],shredLinkFolderName=_0x357721['d'][_0x2c402d(0x16f)][_0x2c402d(0x1b7)],commonserverRedirectedEmbedUri='';},'eror':function(_0x37dbcb){var _0x4a42ad=_0x2fe8bb;console[_0x4a42ad(0x139)](_0x4a42ad(0xeb)+JSON[_0x4a42ad(0x104)](_0x37dbcb)),currentDlgShare!=''&&currentDlgShare[_0x4a42ad(0x167)]();}}),_0x55ba97;}function updateDeptDocPropertiesOnItemSharing(_0x1e044a,_0x14a646,_0x274d84,_0x17b510,_0x38788d,_0x326657){var _0x5907b6=a0_0x4cb6,_0x515a69=$('#sharedWithPermission')['val'](),_0x452486=$(_0x5907b6(0x175))[_0x5907b6(0x123)]();$(_0x5907b6(0x19d))[_0x5907b6(0x123)]()=='Private'&&(_0x452486='',_0x515a69='');(_0x515a69=='--select--'||_0x515a69==null||_0x515a69=='')&&(_0x452486='',_0x515a69='');var _0x287366=_0x5907b6(0x11c),_0x2de895,_0x91ffa3=GetItemTypeDeptList(_0x287366);_0x2de895={'__metadata':{'type':_0x91ffa3},'SecurityLevel':_0x274d84,'PermissionLevel':_0x515a69,'PermissionLevelId':_0x452486,'SharedId':{'results':_0x17b510}},checkoutDeptDocument(_0x14a646)['done'](function(){var _0x4e78ca=_0x5907b6;updateItemWithIDItemListDocuments(_0x287366,_0x2de895,_0x1e044a,_0x38788d,_0x326657)[_0x4e78ca(0x114)](function(){checkInDeptDocument(_0x14a646)['done'](function(){var _0x567085=a0_0x4cb6,_0x4f8ebd=readTargetUrlCookie(_0x567085(0x1a4)+_spPageContextInfo[_0x567085(0x150)]);departmentDoc[_0x567085(0x19f)](_0x4f8ebd);});});})[_0x5907b6(0xf3)](function(_0x30c2fd){var _0x2884e0=_0x5907b6;console[_0x2884e0(0x139)]('error:\x20'+JSON[_0x2884e0(0x104)](_0x30c2fd)),currentDlgShare!=''&&currentDlgShare[_0x2884e0(0x167)]();});}function GetItemTypeDeptList(_0x4d1303){var _0x24c11a=a0_0x4cb6;return _0x24c11a(0xf5)+_0x4d1303[_0x24c11a(0x131)](0x0)[_0x24c11a(0x10b)]()+_0x4d1303[_0x24c11a(0x1a0)]('\x20')[_0x24c11a(0x148)]('')[_0x24c11a(0x149)](0x1)+_0x24c11a(0x162);}function checkoutDeptDocument(_0x2ce61c){var _0x249b3c=a0_0x4cb6,_0x8f35d3=$['Deferred']();return $['ajax']({'url':currentFileSiteURL+_0x249b3c(0x194)+_0x2ce61c+'\x27)/checkout','method':_0x249b3c(0x133),'headers':{'accept':'application/json;odata=verbose','content-type':'application/json;odata=verbose','X-RequestDigest':$('#__REQUESTDIGEST')[_0x249b3c(0x123)]()},'success':function(_0x540f4b){var _0x11c6eb=_0x249b3c,_0x100b06=_0x540f4b;_0x8f35d3[_0x11c6eb(0x18e)](_0x540f4b['d']),console[_0x11c6eb(0x139)]('success:File\x20Checked\x20out\x20');},'error':function(_0x3eca7e){var _0x5f0d11=_0x249b3c;alert(_0x5f0d11(0x12e)+JSON[_0x5f0d11(0x104)](_0x3eca7e)),currentDlgShare!=''&&currentDlgShare[_0x5f0d11(0x167)]();}}),_0x8f35d3;}function checkInDeptDocument(_0x441b38){var _0x307763=a0_0x4cb6,_0x20fec6=currentFileSiteURL+_0x307763(0x194)+_0x441b38+_0x307763(0x19e),_0x34fa69=$[_0x307763(0x155)]();return $['ajax']({'url':_0x20fec6,'method':_0x307763(0x133),'data':JSON[_0x307763(0x104)]({'checkInType':0x2,'comment':_0x307763(0x122)}),'headers':{'accept':_0x307763(0x13a),'content-type':_0x307763(0x13a),'X-RequestDigest':$('#__REQUESTDIGEST')['val']()},'success':function(_0xaca5b4){var _0x417673=_0x307763,_0x3acaf1=_0xaca5b4;_0x34fa69[_0x417673(0x18e)](_0xaca5b4['d']),console[_0x417673(0x139)](_0x417673(0x1b9));},'error':function(_0x3dc03b){var _0x100bb9=_0x307763;_0x34fa69[_0x100bb9(0x153)](_0x3dc03b),currentDlgShare!=''&&currentDlgShare[_0x100bb9(0x167)]();}}),_0x34fa69;}var SelectedFolderPathURL='';function DeptShareFolderProperties(_0x63e630,_0x25a683,_0x5a2509){var _0x231854=a0_0x4cb6;SelectedFolderPathURL=window[_0x231854(0x10f)][_0x231854(0x106)]+_0x5a2509[_0x231854(0x1a0)]('DepartmentalDMS')[0x0],BindDeptSharingGroups(),commonUsedFolderSharingId=_0x63e630,$('#chkDeptFolderSendEmail')[_0x231854(0x198)](_0x231854(0x1b0),![]),sharedUsersIdArrayListItemCollection=[],sharedUsersEmailIDsArrayListItemCollection=[],clearPeoplePickerControl(_0x231854(0x118)),$(_0x231854(0x1a2))[_0x231854(0x123)]('0'),$('#shareingTypePermissionLevel')[_0x231854(0x187)](_0x231854(0x13b)),$('#myDeptFolderSharing')[_0x231854(0x127)]('show'),$(_0x231854(0x14d))['html'](_0x25a683);}function BindDeptSharingGroups(){var _0x1c1219=a0_0x4cb6;$(_0x1c1219(0x1ad))[_0x1c1219(0x143)]();var _0x253a4a=_spPageContextInfo[_0x1c1219(0xf8)]+'/_api/web/lists/getbytitle(\x27DocumentSharedGroups\x27)/items?$select=ID,SharingLevel,SharedUsers/Title,SharedUsers/UserName,SharedUsers/ID,LogonUser/ID,LogonUser/UserName&$expand=SharedUsers,LogonUser&$filter=LogonUser/ID\x20eq\x20\x27'+_spPageContextInfo[_0x1c1219(0x1af)]+'\x27';$['ajax']({'url':_0x253a4a,'headers':{'Accept':_0x1c1219(0x13a)},'async':![],'success':function(_0x5e2cee){var _0x186f96=_0x1c1219;$(_0x186f96(0x1a2))[_0x186f96(0x165)]()[_0x186f96(0x1b8)](_0x186f96(0x191)),$(_0x186f96(0x1a2))['append']($('<option></option>')[_0x186f96(0x198)](_0x186f96(0x17f),'Private')[_0x186f96(0xef)](_0x186f96(0x164))),$('#sharingTypeDeptFolderPermissionLvl')[_0x186f96(0x1b8)]($(_0x186f96(0x13d))[_0x186f96(0x198)]('value',_0x186f96(0x137))[_0x186f96(0xef)](_0x186f96(0x137))),$(_0x186f96(0x1a2))[_0x186f96(0x1b8)]($('<option></option>')['attr'](_0x186f96(0x17f),'Organization')[_0x186f96(0xef)](_0x186f96(0x10a)));for(var _0x147260=0x0;_0x147260<_0x5e2cee['d'][_0x186f96(0x18a)]['length'];_0x147260++){$(_0x186f96(0x1a2))[_0x186f96(0x1b8)]($('<option></option>')[_0x186f96(0x198)]('value',_0x5e2cee['d']['results'][_0x147260][_0x186f96(0x180)])['text'](_0x5e2cee['d'][_0x186f96(0x18a)][_0x147260]['SharingLevel']));}},'eror':function(_0xd6ff36){var _0x1d550a=_0x1c1219;console[_0x1d550a(0x139)]('error:\x20'+JSON[_0x1d550a(0x104)](_0xd6ff36)),currentDlgShare!=''&&currentDlgShare[_0x1d550a(0x167)]();}});}function GetDeptSharingGpUsers(_0x543334,_0x271d02){var _0x2beb86=a0_0x4cb6;sharedUsersIdArrayListItemCollection=[],sharedUsersEmailIDsArrayListItemCollection=[];var _0x4a47ea=_spPageContextInfo[_0x2beb86(0xf8)]+_0x2beb86(0x181)+_0x543334+_0x2beb86(0x135)+_spPageContextInfo['userId']+'\x27';$[_0x2beb86(0x11d)]({'url':_0x4a47ea,'headers':{'Accept':_0x2beb86(0x13a)},'async':![],'success':function(_0x4f0b19){var _0x395853=_0x2beb86,_0x2cb96d='';for(var _0x168289=0x0;_0x168289<_0x4f0b19['d'][_0x395853(0x18a)][_0x395853(0x14b)];_0x168289++){for(var _0xb576e7=0x0;_0xb576e7<_0x4f0b19['d']['results'][_0x168289][_0x395853(0x11b)][_0x395853(0x18a)][_0x395853(0x14b)];_0xb576e7++){sharedUsersIdArrayListItemCollection[_0x395853(0x119)](_0x4f0b19['d'][_0x395853(0x18a)][_0x168289][_0x395853(0x11b)][_0x395853(0x18a)][_0xb576e7]['ID'])==-0x1&&(sharedUsersIdArrayListItemCollection['push'](_0x4f0b19['d'][_0x395853(0x18a)][_0x168289][_0x395853(0x11b)][_0x395853(0x18a)][_0xb576e7]['ID']),SetAndResolvePeoplePicker('customSharingDeptFolderPplPickr',_0x4f0b19['d'][_0x395853(0x18a)][_0x168289][_0x395853(0x11b)][_0x395853(0x18a)][_0xb576e7][_0x395853(0x125)],![]));}}},'eror':function(_0x4a8fde){var _0xe3e79b=_0x2beb86;console[_0xe3e79b(0x139)](_0xe3e79b(0x15c)+JSON['stringify'](_0x4a8fde)),currentDlgShare!=''&&currentDlgShare[_0xe3e79b(0x167)]();}});}function a0_0x4cb6(_0x4ebaa1,_0x2a3f67){var _0x42f887=a0_0x42f8();return a0_0x4cb6=function(_0x4cb683,_0x422fca){_0x4cb683=_0x4cb683-0xeb;var _0x3936cc=_0x42f887[_0x4cb683];return _0x3936cc;},a0_0x4cb6(_0x4ebaa1,_0x2a3f67);}function deptDocFolderSharing(){var _0x2dbe02=a0_0x4cb6,_0x20959b=$('#sharingTypeDeptFolderPermissionLvl')[_0x2dbe02(0x123)](),_0x1083da=$(_0x2dbe02(0x11a))['val']();if(_0x20959b=='0'||_0x20959b==null||_0x20959b=='')return currentDlgShare!=''&&currentDlgShare[_0x2dbe02(0x167)](),alert(_0x2dbe02(0x1b6)),![];else{if(_0x1083da==null||_0x1083da==''||_0x1083da==_0x2dbe02(0x113))return currentDlgShare!=''&&currentDlgShare[_0x2dbe02(0x167)](),alert(_0x2dbe02(0x124)),![];else{if(_0x20959b==_0x2dbe02(0x10a)){sharedHistoryUser=sharedUsersIdArrayListItemCollection;if($('#ddlOrgNameDeptFolder')[_0x2dbe02(0x123)]()=='0')return currentDlgShare!=''&&currentDlgShare['close'](),alert(_0x2dbe02(0x1a7)),![];if(sharedUsersIdArrayListItemCollection[_0x2dbe02(0x14b)]==0x0)return currentDlgShare!=''&&currentDlgShare[_0x2dbe02(0x167)](),alert(_0x2dbe02(0x16b)),![];}}}if(_0x20959b==_0x2dbe02(0x164))$(_0x2dbe02(0x109))[_0x2dbe02(0x198)](_0x2dbe02(0x1b0),![]);else{if(_0x20959b!='Organization'){sharedUsersIdArrayListItemCollection=[],sharedUsersEmailIDsArrayListItemCollection=[];if(getUserInfoFromPeoplePicker(_0x2dbe02(0x118))){if(sharedUsersIdArrayListItemCollection!=null){if(sharedUsersIdArrayListItemCollection[_0x2dbe02(0x14b)]==0x0)return currentDlgShare!=''&&currentDlgShare[_0x2dbe02(0x167)](),alert('Please\x20enter\x20sharing\x20users.'),![];}else return currentDlgShare!=''&&currentDlgShare[_0x2dbe02(0x167)](),alert(_0x2dbe02(0x17a)),![];}else return currentDlgShare!=''&&currentDlgShare[_0x2dbe02(0x167)](),alert(_0x2dbe02(0x17a)),![];}}var _0x3dda76=GetDeptFileServerUrlById(commonUsedFolderSharingId,'Folder');_0x20959b==_0x2dbe02(0x164)?(updateFolderProperties(commonUsedFolderSharingId,mydeptSiteUrl,![],'DepartmentalDMS','Private'),$[_0x2dbe02(0x151)](GetAllDeptFolderUsrsSharedPrincipleId(commonUsedFolderSharingId))[_0x2dbe02(0x114)](function(_0x2231a5){var _0x344625=_0x2dbe02;DeleteSharedLink(commonUsedFolderSharingId);var _0x4e7c49=readTargetUrlCookie('MyDepartmentDocumentCurrentFolder'+_spPageContextInfo[_0x344625(0x150)]);departmentDoc['GetMyDocumentsWithFilesFolder'](_0x4e7c49),alert(_0x344625(0x173)),$('#myDeptFolderSharing')[_0x344625(0x127)](_0x344625(0x143)),currentDlgShare!=''&&currentDlgShare[_0x344625(0x167)]();})):(updateFolderProperties(commonUsedFolderSharingId,mydeptSiteUrl,![],_0x2dbe02(0x11c),_0x20959b),ShareDeptFilesFolder(_0x3dda76,_0x2dbe02(0x16f),_0x20959b));}function GetDeptFileServerUrlById(_0x3f8581,_0x1dc9dd){var _0x24505e=a0_0x4cb6,_0x50f78c='',_0x2f3534=SelectedFolderPathURL+_0x24505e(0x183)+_0x3f8581+_0x24505e(0x14f);return $[_0x24505e(0x11d)]({'url':_0x2f3534,'headers':{'accept':'application/json;odata=verbose','content-type':_0x24505e(0x13a),'X-RequestDigest':$('#__REQUESTDIGEST')['val']()},'async':![],'success':function(_0xfd2d1a){var _0x4d979a=_0x24505e;if(_0x1dc9dd==_0x4d979a(0x182)){_0x50f78c=_0xfd2d1a['d']['File'][_0x4d979a(0x16a)],shredLinkFileName=_0xfd2d1a['d'][_0x4d979a(0x182)]['Name'],commonserverRedirectedEmbedUri=_0xfd2d1a['d']['ServerRedirectedEmbedUri'];if(_0xfd2d1a['d']['SharedId']!=null)for(var _0x47137e=0x0;_0x47137e<_0xfd2d1a['d'][_0x4d979a(0x1b1)][_0x4d979a(0x18a)]['length'];_0x47137e++){var _0x5afb2c=_0xfd2d1a['d']['SharedId']['results'][_0x47137e];sharefileuser[_0x4d979a(0x120)](_0x5afb2c);}(commonserverRedirectedEmbedUri==null||commonserverRedirectedEmbedUri=='')&&(commonserverRedirectedEmbedUri='');}else _0x50f78c=_0xfd2d1a['d'][_0x4d979a(0x16f)][_0x4d979a(0x16a)],shredLinkFolderName=_0xfd2d1a['d'][_0x4d979a(0x16f)][_0x4d979a(0x1b7)],commonserverRedirectedEmbedUri='';},'eror':function(_0x174f01){var _0x2601a6=_0x24505e;console[_0x2601a6(0x139)](_0x2601a6(0x15c)+JSON[_0x2601a6(0x104)](_0x174f01));}}),_0x50f78c;}function GetAllDeptFolderUsrsSharedPrincipleId(_0x15df44){var _0x56a401=a0_0x4cb6,_0x89a9c8=$['Deferred'](),_0x4cc6f4=new Date(),_0x28cbaf=Date[_0x56a401(0x12c)](_0x4cc6f4);return $[_0x56a401(0x11d)]({'url':SelectedFolderPathURL+_0x56a401(0x1a6)+_0x15df44+_0x56a401(0x12f)+_0x28cbaf,'method':_0x56a401(0x141),'async':![],'headers':{'Accept':'application/json;\x20odata=verbose'},'success':function(_0x4e95dd){var _0x23f15c=_0x56a401;_0x89a9c8[_0x23f15c(0x18e)](_0x4e95dd['d'][_0x23f15c(0x18a)]);for(var _0x3589b7=0x0;_0x3589b7<_0x4e95dd['d']['RoleAssignments'][_0x23f15c(0x18a)][_0x23f15c(0x14b)];_0x3589b7++){if(_0x4e95dd['d'][_0x23f15c(0x1a8)][_0x23f15c(0x18a)][_0x3589b7]['PrincipalId']!=_spPageContextInfo[_0x23f15c(0x1af)]){var _0x595aa6=_0x4e95dd['d'][_0x23f15c(0x1a8)][_0x23f15c(0x18a)][_0x3589b7][_0x23f15c(0x1a3)];DeleteDeptFolderPrinciple(_0x15df44,_0x595aa6);}}},'error':function(_0x393ddf){var _0x6b616c=_0x56a401;_0x89a9c8['reject'](_0x393ddf),waitingDialog[_0x6b616c(0x143)]();}}),_0x89a9c8[_0x56a401(0xee)]();}function DeleteDeptFolderPrinciple(_0x2b2a6b,_0x27a865){var _0x3f9770=a0_0x4cb6,_0x3ec59a=$[_0x3f9770(0x155)](),_0x346af3={'X-RequestDigest':$('#__REQUESTDIGEST')[_0x3f9770(0x123)](),'X-HTTP-Method':_0x3f9770(0xf9)},_0x17afc8=SelectedFolderPathURL+_0x3f9770(0x159)+_0x2b2a6b+_0x3f9770(0x130)+_0x27a865+')';return $[_0x3f9770(0x11d)]({'url':_0x17afc8,'type':_0x3f9770(0x133),'headers':_0x346af3,'async':![],'dataType':_0x3f9770(0x176),'success':function(_0x45a03f){var _0x361073=_0x3f9770;_0x3ec59a[_0x361073(0x18e)](_0x45a03f['d']['results']),console[_0x361073(0x139)](_0x27a865+'\x20Successfully\x20removed\x20Permission\x20!');},'error':function(_0x51ba3e){var _0x7d79cf=_0x3f9770;_0x3ec59a[_0x7d79cf(0x153)](_0x51ba3e),console[_0x7d79cf(0x139)](JSON[_0x7d79cf(0x104)](_0x51ba3e));}}),_0x3ec59a[_0x3f9770(0xee)]();}function ShareDeptFilesFolder(_0x2c2b35,_0x5a0688,_0x5dbb82){var _0x19b79a=a0_0x4cb6,_0x2f26e4=[],_0x14eca5=0x1;if($(_0x19b79a(0x11a))[_0x19b79a(0x123)]()==_0x19b79a(0x17d))_0x14eca5=0x1;else $('#shareWithDeptFolderPermission')['val']()==_0x19b79a(0x19a)?_0x14eca5=0x7:_0x14eca5=0x2;var _0x35efc9=createJSONMetadata(sharedUsersEmailIDsArrayListItemCollection,_0x14eca5),_0x3e2d93=_spPageContextInfo[_0x19b79a(0x172)]+'/_api/SP.Sharing.DocumentSharingManager.UpdateDocumentSharingInfo';$['ajax']({'url':_0x3e2d93,'method':_0x19b79a(0x133),'async':![],'data':JSON[_0x19b79a(0x104)]({'resourceAddress':document['location'][_0x19b79a(0x106)]+_0x2c2b35,'userRoleAssignments':_0x35efc9,'validateExistingPermissions':![],'additiveMode':![],'sendServerManagedNotification':![],'customMessage':'Please\x20look\x20at\x20the\x20following\x20File/Folder.','includeAnonymousLinksInNotification':![]}),'headers':{'accept':_0x19b79a(0x13a),'content-type':_0x19b79a(0x13a),'X-RequestDigest':$(_0x19b79a(0x1a1))['val']()},'success':function(_0x309fc5){var _0x2bcc0d=_0x19b79a,_0x3d9d81=$(_0x2bcc0d(0x1a2))[_0x2bcc0d(0x123)](),_0x4561b9='';if(_0x5a0688==_0x2bcc0d(0x16f)){GetDocumentsRevoke(sharedUsersIdArrayListItemCollection,commonUsedFolderSharingId);_0x5dbb82=='Organization'&&_0x5a0688==_0x2bcc0d(0x16f)?AddSharedLinkToListOrg(shredLinkFolderName,_0x2c2b35,arrUserClientWise,commonUsedFolderSharingId,'Folder',_0x3d9d81,$('#shareWithDeptFolderPermission')[_0x2bcc0d(0x123)](),'Department'):AddSharedLinkToList22(shredLinkFolderName,_0x2c2b35,sharedUsersIdArrayListItemCollection,commonUsedFolderSharingId,_0x2bcc0d(0x16f),_0x3d9d81,$(_0x2bcc0d(0x11a))[_0x2bcc0d(0x123)](),_0x2bcc0d(0x168));$(_0x2bcc0d(0x109))[_0x2bcc0d(0x128)]('checked')==!![]&&EmailDeptSharedProperties(sharedUsersEmailIDsArrayListItemCollection,_0x5a0688);var _0x29104f=readTargetUrlCookie('MyDepartmentDocumentCurrentFolder'+_spPageContextInfo[_0x2bcc0d(0x150)]);departmentDoc[_0x2bcc0d(0x19f)](_0x29104f);}$(_0x2bcc0d(0x188))[_0x2bcc0d(0x127)](_0x2bcc0d(0x143)),currentDlgShare!=''&&currentDlgShare[_0x2bcc0d(0x167)](),$('.mulinput')[_0x2bcc0d(0x128)](_0x2bcc0d(0x1b0),![]),$('.multiBox')[_0x2bcc0d(0xef)]('Select'),$(_0x2bcc0d(0x17b))['hide']();},'error':function(_0x5fd3cd){var _0x3f782b=_0x19b79a;alert(_0x3f782b(0xfb)+JSON[_0x3f782b(0x104)](_0x5fd3cd)),currentDlgShare!=''&&currentDlgShare[_0x3f782b(0x167)]();}});}function EmailDeptSharedProperties(_0x3885e8,_0x3a5270){var _0xccae53=a0_0x4cb6,_0x368b78=[];_0x368b78[_0xccae53(0x120)]($(_0xccae53(0x15e))[_0xccae53(0x144)]());var _0x304252=$(_0xccae53(0x1a2))['val'](),_0x2ec04f='',_0x2528ea=emailBodyContent;if(_0x3a5270==_0xccae53(0x16f)){var _0x3e8224=$('#shareWithDeptFolderPermission\x20:selected')[_0xccae53(0xef)]();_0x3e8224=='--select--'&&(_0x3e8224=''),_0x2528ea=_0x2528ea[_0xccae53(0x12a)](_0xccae53(0x147),$(_0xccae53(0x14d))[_0xccae53(0xef)]()),_0x2528ea=_0x2528ea[_0xccae53(0x12a)]('{{fileype}}','Folder'),_0x2528ea=_0x2528ea[_0xccae53(0x12a)](_0xccae53(0x108),''),_0x2528ea=_0x2528ea[_0xccae53(0x12a)](_0xccae53(0x190),_spPageContextInfo[_0xccae53(0x14a)]+_0xccae53(0xfa)),_0x2528ea=_0x2528ea['replace'](_0xccae53(0x192),_0x3e8224);}else{globalSharingDocumentDocumentType==null&&(globalSharingDocumentDocumentType='');globalsharingDocumentDetails==null&&(globalsharingDocumentDetails='');var _0x3e8224=$(_0xccae53(0x197))['text']();_0x3e8224==_0xccae53(0x113)&&(_0x3e8224=''),_0x2528ea=_0x2528ea[_0xccae53(0x12a)](_0xccae53(0x147),$(_0xccae53(0x163))[_0xccae53(0x144)]()),_0x2528ea=_0x2528ea[_0xccae53(0x12a)](_0xccae53(0x15d),globalSharingDocumentDocumentType),_0x2528ea=_0x2528ea['replace']('{{details}}',globalsharingDocumentDetails),_0x2528ea=_0x2528ea['replace'](_0xccae53(0x190),encodeURI(document[_0xccae53(0x10f)][_0xccae53(0x106)]+'/'+$(_0xccae53(0x129))[_0xccae53(0xef)]())),_0x2528ea=_0x2528ea[_0xccae53(0x12a)](_0xccae53(0x192),_0x3e8224);}_0x2528ea=_0x2528ea[_0xccae53(0x12a)](_0xccae53(0x199),_spPageContextInfo['userDisplayName']),_0x2ec04f=_0x2528ea;var _0x4b9ce5=$(_0xccae53(0x15e))[_0xccae53(0x144)](),_0x23c6f6;_0x23c6f6={'properties':{'__metadata':{'type':_0xccae53(0x161)},'From':_0x4b9ce5,'To':{'results':_0x3885e8},'CC':{'results':_0x368b78},'Body':_0x2ec04f,'Subject':sharedEmailSubject}},SendEmailSharedNotification(_0x23c6f6);}function RevokeDepartmntPermission(_0x2b3c3a,_0x4c857c,_0x41ff33,_0x3c740e){var _0x277b26=a0_0x4cb6,_0x285d20={'Accept':'application/json;odata=verbose','content-Type':_0x277b26(0x13a),'X-RequestDigest':jQuery(_0x277b26(0x1a1))[_0x277b26(0x123)]()},_0x477768=mydeptSiteUrl+_0x277b26(0x157)+_0x4c857c+_0x277b26(0x18f);if(_0x3c740e!='')$[_0x277b26(0x11d)]({'url':_0x477768,'type':_0x277b26(0x133),'headers':_0x285d20,'dataType':_0x277b26(0x176),'success':function(_0x17b408){DeleatePermissionDeptDocs(_0x41ff33,_0x4c857c,_0x2b3c3a,_0x3c740e,'Selective',0x0,0x0);},'error':function(_0x25ae49){var _0x63ac24=_0x277b26;console[_0x63ac24(0x139)](JSON[_0x63ac24(0x104)](_0x25ae49));}});else{_0x41ff33=decodeURI(_0x41ff33);var _0x5032af=arrSharedOrgUsers[_0x277b26(0x10e)](function(_0x5de6b2){var _0x326056=_0x277b26;return _0x41ff33==_0x5de6b2[_0x326056(0x10a)];});$[_0x277b26(0x11d)]({'url':_0x477768,'type':_0x277b26(0x133),'headers':_0x285d20,'dataType':_0x277b26(0x176),'success':function(_0x151f7c){var _0x257bcc=_0x277b26;for(k=0x0;k<_0x5032af[_0x257bcc(0x14b)];k++){DeleatePermissionDeptDocs(_0x5032af[k][_0x257bcc(0x1af)],_0x4c857c,_0x2b3c3a,_0x5032af[k]['ItemId'],_0x257bcc(0x10a),k,_0x5032af[_0x257bcc(0x14b)]);}},'error':function(_0x19718b){var _0x1718cb=_0x277b26;console[_0x1718cb(0x139)](JSON[_0x1718cb(0x104)](_0x19718b));}});}}function DeleatePermissionDeptDocs(_0x6384f4,_0x3bef96,_0x38f2c9,_0x52997f,_0x1704c2,_0x435306,_0x7e0dec){var _0x2521d0=a0_0x4cb6,_0x52a8e2={'X-RequestDigest':$(_0x2521d0(0x1a1))[_0x2521d0(0x123)](),'X-HTTP-Method':'DELETE'},_0x36b9cb=mydeptSiteUrl+'/_api/web/GetFileByServerRelativeUrl(\x27'+_0x3bef96+_0x2521d0(0x100)+_0x6384f4+')';$[_0x2521d0(0x11d)]({'url':_0x36b9cb,'type':_0x2521d0(0x133),'headers':_0x52a8e2,'async':![],'success':function(_0x20174b){var _0x54e4b2=_0x2521d0,_0x1d1468=_0x54e4b2(0x1b4),_0xd8cc74,_0x277e7a=GetItemTypeForListNameDetailsGroups(_0x1d1468);_0xd8cc74={'__metadata':{'type':_0x277e7a},'PermissionStatus':_0x54e4b2(0x18d)},$['when'](updateItemWithIDItemListDocuments(_0x1d1468,_0xd8cc74,_0x52997f,myCompanyUrl))[_0x54e4b2(0x114)](function(_0x2c167b){var _0x579395=_0x54e4b2;_0x1704c2=='Organization'?_0x435306+0x1==_0x7e0dec&&alert(_0x579395(0x112)):alert(_0x579395(0x112)),$(_0x579395(0x196))[_0x579395(0x127)](_0x579395(0x143));}),console[_0x54e4b2(0x139)](_0x6384f4+_0x54e4b2(0x154));},'error':function(_0x105b93){var _0x20d32c=_0x2521d0;console[_0x20d32c(0x139)](JSON[_0x20d32c(0x104)](_0x105b93));}});}function BreakInheritePermissionFolderSharing(_0x2194f2,_0xcb2bad,_0x4f5540,_0x3f6e96){var _0x65637b=a0_0x4cb6,_0x4b427b={'Accept':_0x65637b(0x13a),'content-Type':'application/json;odata=verbose','X-RequestDigest':jQuery('#__REQUESTDIGEST')[_0x65637b(0x123)]()},_0x564d5e=myCompanyUrl+'/_api/web/GetFolderByServerRelativeUrl(\x27'+_0xcb2bad+_0x65637b(0x18f);if(_0x3f6e96!='')$['ajax']({'url':_0x564d5e,'type':'POST','headers':_0x4b427b,'dataType':_0x65637b(0x176),'success':function(_0x1aafd7){var _0x49070b=_0x65637b;DeleateUserPermissionFolder(_0x4f5540,_0xcb2bad,_0x2194f2,_0x3f6e96,_0x49070b(0x137),0x0,0x0);},'error':function(_0x458680){var _0x43e1d7=_0x65637b;console[_0x43e1d7(0x139)](JSON[_0x43e1d7(0x104)](_0x458680));}});else{_0x4f5540=decodeURI(_0x4f5540);var _0x2eb544=arrSharedOrgUsers[_0x65637b(0x10e)](function(_0x2cb192){var _0x1a2591=_0x65637b;return _0x4f5540==_0x2cb192[_0x1a2591(0x10a)];});$[_0x65637b(0x11d)]({'url':_0x564d5e,'type':'POST','headers':_0x4b427b,'dataType':'json','success':function(_0x5cb372){var _0x2f7afb=_0x65637b;for(k=0x0;k<_0x2eb544[_0x2f7afb(0x14b)];k++){DeleateUserPermissionFolder(_0x2eb544[k]['userId'],_0xcb2bad,_0x2194f2,_0x2eb544[k][_0x2f7afb(0x189)],_0x2f7afb(0x10a),k,_0x2eb544[_0x2f7afb(0x14b)]);}},'error':function(_0x1df732){var _0x3082dd=_0x65637b;console[_0x3082dd(0x139)](JSON[_0x3082dd(0x104)](_0x1df732));}});}}function BreakPermissionDeptDocFolder(_0x2d6d5a,_0x3e36c0,_0x732fc9,_0x1ad680){var _0x509d93=a0_0x4cb6,_0x84cc2={'Accept':_0x509d93(0x13a),'content-Type':_0x509d93(0x13a),'X-RequestDigest':jQuery(_0x509d93(0x1a1))[_0x509d93(0x123)]()},_0x37a411=mydeptSiteUrl+_0x509d93(0xfd)+_0x3e36c0+_0x509d93(0x18f);if(_0x1ad680!='')$['ajax']({'url':_0x37a411,'type':_0x509d93(0x133),'headers':_0x84cc2,'dataType':_0x509d93(0x176),'success':function(_0x379ec4){var _0x1fa784=_0x509d93;DeleteDeptPermissionFolder(_0x732fc9,_0x3e36c0,_0x2d6d5a,_0x1ad680,_0x1fa784(0x137),0x0,0x0);},'error':function(_0x13f712){var _0x108d25=_0x509d93;console[_0x108d25(0x139)](JSON['stringify'](_0x13f712));}});else{_0x732fc9=decodeURI(_0x732fc9);var _0x5c1483=arrSharedOrgUsers['filter'](function(_0x53baaa){var _0x6c697b=_0x509d93;return _0x732fc9==_0x53baaa[_0x6c697b(0x10a)];});$['ajax']({'url':_0x37a411,'type':_0x509d93(0x133),'headers':_0x84cc2,'dataType':_0x509d93(0x176),'success':function(_0x2e1de5){var _0x461190=_0x509d93;for(k=0x0;k<_0x5c1483[_0x461190(0x14b)];k++){DeleteDeptPermissionFolder(_0x5c1483[k][_0x461190(0x1af)],_0x3e36c0,_0x2d6d5a,_0x5c1483[k][_0x461190(0x189)],'Organization',k,_0x5c1483['length']);}},'error':function(_0x3cd16f){var _0x3f0ebd=_0x509d93;console[_0x3f0ebd(0x139)](JSON['stringify'](_0x3cd16f));}});}}function DeleteDeptPermissionFolder(_0x1cc3e2,_0x29cf86,_0x2f7a2f,_0x525a7c,_0x5843a2,_0x234ec5,_0x5c6caf){var _0xab0d39=a0_0x4cb6,_0x5908e0={'X-RequestDigest':$(_0xab0d39(0x1a1))[_0xab0d39(0x123)](),'X-HTTP-Method':'DELETE'},_0x4ca4e3=mydeptSiteUrl+'/_api/web/GetFolderByServerRelativeUrl(\x27'+_0x29cf86+_0xab0d39(0x100)+_0x1cc3e2+')';$[_0xab0d39(0x11d)]({'url':_0x4ca4e3,'type':'POST','headers':_0x5908e0,'async':![],'success':function(_0x4dd0b9){var _0x125b49=_0xab0d39,_0x449026=_0x125b49(0x1b4),_0x203bd2,_0xd49e0b=GetItemTypeForListNameDetailsGroups(_0x449026);_0x203bd2={'__metadata':{'type':_0xd49e0b},'PermissionStatus':'Revoked'},$[_0x125b49(0x151)](updateItemWithIDItemListDocuments(_0x449026,_0x203bd2,_0x525a7c,myCompanyUrl))[_0x125b49(0x114)](function(_0x11c114){var _0x1d88fa=_0x125b49;_0x5843a2=='Organization'?_0x234ec5+0x1==_0x5c6caf&&alert('permission\x20deleted\x20sucessfully.'):alert(_0x1d88fa(0x112)),$(_0x1d88fa(0x196))[_0x1d88fa(0x127)]('hide');}),console[_0x125b49(0x139)](_0x1cc3e2+_0x125b49(0x154));},'error':function(_0x18337f){var _0x1ff08f=_0xab0d39;console[_0x1ff08f(0x139)](JSON['stringify'](_0x18337f));}});}