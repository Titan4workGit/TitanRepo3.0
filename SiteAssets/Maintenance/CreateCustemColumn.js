var a0_0x815881=a0_0x460f;(function(_0x288f06,_0x2030e6){var _0x20908f=a0_0x460f,_0x192afb=_0x288f06();while(!![]){try{var _0x404b93=-parseInt(_0x20908f(0x2cf))/0x1*(parseInt(_0x20908f(0x29c))/0x2)+-parseInt(_0x20908f(0x212))/0x3*(parseInt(_0x20908f(0x1de))/0x4)+-parseInt(_0x20908f(0x2a7))/0x5*(-parseInt(_0x20908f(0x1ef))/0x6)+-parseInt(_0x20908f(0x25a))/0x7*(parseInt(_0x20908f(0x201))/0x8)+-parseInt(_0x20908f(0x1c3))/0x9*(parseInt(_0x20908f(0x1e5))/0xa)+-parseInt(_0x20908f(0x287))/0xb*(parseInt(_0x20908f(0x269))/0xc)+parseInt(_0x20908f(0x242))/0xd*(parseInt(_0x20908f(0x1e9))/0xe);if(_0x404b93===_0x2030e6)break;else _0x192afb['push'](_0x192afb['shift']());}catch(_0x2d18b8){_0x192afb['push'](_0x192afb['shift']());}}}(a0_0x1815,0xa09e2),$(document)[a0_0x815881(0x251)](function(){var _0x3cda6d=a0_0x815881,_0x496a25=$(_0x3cda6d(0x20c))[_0x3cda6d(0x27a)](_0x3cda6d(0x1c6))[_0x3cda6d(0x1ec)]();GetDepartmentUrl(),LoadAllDepartment(),departmentOnChange(),$(_0x3cda6d(0x1c7))[_0x3cda6d(0x21c)](function(){getDataFromShareDocument();}),$(_0x3cda6d(0x278))[_0x3cda6d(0x21c)](function(){createNewCustomColumn();}),$(_0x3cda6d(0x2ce))[_0x3cda6d(0x21c)](function(){addEnvironmentalSettingsEntry();}),$(_0x3cda6d(0x249))[_0x3cda6d(0x21c)](function(){getProjects();}),$(_0x3cda6d(0x270))[_0x3cda6d(0x21c)](function(){getDepartmentalItems();}),$('input[name=\x27optradio\x27]:checked'),$(_0x3cda6d(0x24a))[_0x3cda6d(0x21c)](function(){AddCustomer();}),$(_0x3cda6d(0x2b2))[_0x3cda6d(0x21c)](function(){CreateListColumns();}),$(_0x3cda6d(0x26b))[_0x3cda6d(0x21c)](function(){Addemployee();}),$(_0x3cda6d(0x2ab))['click'](function(){AddCommentInAnnouncement();}),$(_0x3cda6d(0x243))[_0x3cda6d(0x21c)](function(){addProjectkDetails();}),$('#btnChangePriority')[_0x3cda6d(0x21c)](function(){var _0x140aa1=_0x3cda6d;confirm(_0x140aa1(0x283))&&ChangePriority();}),$('#btnFillAssignedByTask')[_0x3cda6d(0x21c)](function(){var _0x4d5842=_0x3cda6d;confirm(_0x4d5842(0x283))&&getBlankAssignedBy();}),$(_0x3cda6d(0x24e))[_0x3cda6d(0x21c)](function(){var _0x3f601b=_0x3cda6d;confirm(_0x3f601b(0x283))&&(waitingDialog[_0x3f601b(0x21d)](),setTimeout(function(){getInternalEmployees();},0x1f4));}),$(_0x3cda6d(0x1f0))['click'](function(){ChangeCompanyId();}),$(_0x3cda6d(0x208))[_0x3cda6d(0x21c)](function(){var _0x428ebc=_0x3cda6d;confirm(_0x428ebc(0x283))&&(waitingDialog[_0x428ebc(0x21d)](),setTimeout(function(){fileShareDocumentColumn();},0x1f4));}),$(_0x3cda6d(0x24f))[_0x3cda6d(0x21c)](function(){var _0x109d38=_0x3cda6d;confirm(_0x109d38(0x283))&&(waitingDialog['show'](),setTimeout(function(){getTaskItemByTaskCategory();},0x1f4));});}));var TaskAssignTo=[0x74,0x14,0x20];function addEmployeeTaskDetails(){var _0x45014b=a0_0x815881,_0x3a04ad=_0x45014b(0x28b),_0x7c36a1=new Date(),_0x1555c8=_0x7c36a1[_0x45014b(0x23c)]()['substring'](0x0,0x32);for(var _0x4ce2f4=0x1;_0x4ce2f4<=0x1f4;_0x4ce2f4++){var _0x51e621=_0x45014b(0x271)+_0x4ce2f4,_0x4b4dd1;_0x4b4dd1={'__metadata':{'type':'SP.Data.EmployeeTaskDetailsListItem'},'TaskAssignToId':{'results':TaskAssignTo},'Title':_0x51e621,'CurrentPhase':_0x45014b(0x1d2),'TaskType':_0x45014b(0x247),'StartDate':_0x1555c8,'DueDate':_0x45014b(0x1d5),'TaskPriority':_0x45014b(0x1fc),'Worktype':'Fixed\x20Bugs','Distribution':_0x45014b(0x1ed),'CompanyId':Logged_CompanyId},$[_0x45014b(0x1fe)](AddItemEmp(_0x3a04ad,_0x4b4dd1))['done'](function(_0xc87e8e){_0x4ce2f4==0x1f4&&alert('Submit\x20successfully');});}}function addProjectkDetails(){var _0x10643a=a0_0x815881,_0x1caf0f=_0x10643a(0x1d3),_0x5bc87f=_0x10643a(0x260),_0x425b6d=new Date(),_0x4ad855=new Date(_0x10643a(0x2a8)),_0x358121=_0x425b6d['toISOString']()['substring'](0x0,0x32);for(var _0x16dbb2=0xbb8;_0x16dbb2<=0x1388;_0x16dbb2++){var _0x4dfb02=_0x10643a(0x235)+_0x16dbb2,_0x1b0fae;_0x1b0fae={'__metadata':{'type':'SP.Data.ProjectDetailsListItem'},'Title':_0x4dfb02,'ProjectCode':_0x10643a(0x202),'ProjectName':_0x4dfb02,'ProjectDescription':_0x5bc87f,'ProjectSiteURL':'','DepartmentId':'50','Department_IDId':Logged_DepartmentId,'ActualStartDate':_0x358121,'PlanedStartDate':_0x358121,'PlanedEndDate':_0x10643a(0x2d0),'TechnologyUsed':'','Status':_0x10643a(0x23f),'DepartmentName':'50','ManagerNameId':0x20,'OfficeLocation':_0x10643a(0x280),'Domain':_0x10643a(0x20e),'Office_Location_IdId':Logged_Location,'CompanyId':'2','ClientIDId':0x3,'ProgramIDId':0x2},$['when'](AddItemEmp(_0x1caf0f,_0x1b0fae))['done'](function(_0x400df5){var _0x2ef05a=_0x10643a;_0x16dbb2==0x1388&&alert(_0x2ef05a(0x203));});}}function AddItemEmp(_0x1b1fa3,_0x3d91c2){var _0x1df11e=a0_0x815881,_0x2464f5=$[_0x1df11e(0x279)](),_0x2d154e=_spPageContextInfo[_0x1df11e(0x218)]+_0x1df11e(0x2b5)+_0x1b1fa3+'\x27)/Items';return $[_0x1df11e(0x2a2)]({'url':_0x2d154e,'type':_0x1df11e(0x2d2),'async':![],'headers':{'accept':'application/json;odata=verbose','X-RequestDigest':$(_0x1df11e(0x245))[_0x1df11e(0x1ec)](),'content-Type':'application/json;odata=verbose'},'data':JSON['stringify'](_0x3d91c2),'success':function(_0x38d106){_0x2464f5['resolve'](_0x38d106);},'error':function(_0x4e09b1){var _0x221ae3=_0x1df11e;alert(JSON['stringify'](_0x4e09b1)),_0x2464f5[_0x221ae3(0x2c2)](_0x4e09b1);}}),_0x2464f5[_0x1df11e(0x2d1)]();}function AddCustomer(){var _0xcd1916=a0_0x815881,_0x421c35='';for(var _0x4532eb=0x1;_0x4532eb<=0x1f4;_0x4532eb++){var _0x1b093f='',_0x3cadd3='';_0x421c35=_0xcd1916(0x2a6)+_0x4532eb;var _0x46eafd=_0xcd1916(0x285)+_0x4532eb+_0xcd1916(0x1e4),_0x14e1fe=_0xcd1916(0x274)+_0x4532eb,_0x12e941=_0xcd1916(0x200),_0x1c25ab='',_0xb5f626='',_0x1869ec='',_0x1a2ef2=_0xcd1916(0x2a6),_0x30300b='',_0x5cf6e4='Gust',_0x261a0e='',_0x3e1907=_0xcd1916(0x1d4),_0xfcef4d;_0xfcef4d={'__metadata':{'type':_0xcd1916(0x2a4)},'Title':_0x421c35,'Client_Code':'205','Attn_Name':_0x14e1fe,'BillingAddress':_0x1b093f,'EmailId':_0x46eafd,'Country':_0x3cadd3,'IsActive':!![],'City':_0x12e941,'State':'Up','SalesPersonId':TaskAssignTo[0x0],'InternalMembersId':{'results':TaskAssignTo},'TemplateType':_0xcd1916(0x204),'InternalSupervisorId':TaskAssignTo[0x1],'CustType':_0xcd1916(0x214),'Contact_No':_0xcd1916(0x298),'CompanyIDId':Logged_CompanyId},$[_0xcd1916(0x1fe)](AddItemEmp(_0x3e1907,_0xfcef4d))[_0xcd1916(0x2be)](function(_0x478a50){var _0x17e3d6=_0xcd1916;_0x4532eb==0x1f4&&alert(_0x17e3d6(0x203));});}}function Create_List(){createList('Test\x20by\x20lakhan');}function a0_0x1815(){var _0x39b344=['getByTitle','each','11501esWFfW','.radioBtnClass','ID,Status,LogonName/EMail,LogonName/ID,Email','High','/_api/web/lists/getbytitle(\x27Departments\x27)/items?$select=CompanyIDId,ID,Title,SiteURL','/_api/web/lists/getbytitle(\x27EmployeeTaskDetails\x27)/GetItemById(\x27','A\x20pie\x20chart\x20(or\x20a\x20circle\x20chart)\x20is\x20a\x20circular\x20statistical\x20graphic,\x20which\x20is\x20divided\x20into\x20slices\x20to\x20illustrate\x20numerical\x20proportion.\x20In\x20a\x20pie\x20chart,\x20the\x20arc\x20length\x20of\x20each\x20slice\x20(and\x20consequently\x20its\x20central\x20angle\x20and\x20area),\x20is\x20proportional\x20to\x20the\x20quantity\x20it\x20represents.\x20While\x20it\x20is\x20named\x20for\x20its\x20resemblance\x20to\x20a\x20pie\x20which\x20has\x20been\x20sliced,\x20there\x20are\x20variations\x20on\x20the\x20way\x20it\x20can\x20be\x20presented.\x20The\x20earliest\x20known\x20pie\x20chart\x20is\x20generally\x20credited\x20to\x20William\x20Playfair\x20ie\x20charts\x20are\x20very\x20widely\x20used\x20in\x20the\x20business\x20world\x20and\x20the\x20mass\x20media.[3]\x20However,\x20they\x20have\x20been\x20criticized,[4]\x20and\x20many\x20experts\x20recommend\x20avoiding\x20them,[5][6][7][8]','forEach','EMail','_api/Web/Lists/getByTitle(\x27','membership|','guid\x27','Banner','push','SP.FieldDateTime','38628KbpJHS','N/A','#btnAddEmployee','/_api/web/lists/getByTitle(\x27EmployeeTaskDetails\x27)/items/?$top=5000','Employees','ApprovalTaskList','\x27)/fields','#btnSharingHistory','TestTask','FileValidity','ApprovedDate','Lakhan','input[name=\x27optradio\x27]:checked','SiteURL','FieldTypeKind','#btnCreateCustomColumn','Deferred','find','MM/DD/YYYY','lists','\x27)\x20and\x20(Status\x20eq\x20\x27Initiated\x27\x20or\x20Status\x20eq\x20\x27Forwarded\x27))','__metadata','email_date','Gurgaon\x20Main\x20Office','Name','\x27\x20or\x20AssignedBy/EMail\x20eq\x20\x27','The\x20related\x20MS\x20Flow\x20must\x20be\x20stopped.\x20\x0a\x20Do\x20want\x20to\x20continue\x20?','Read','Demo','No\x20Task\x20with\x20blank\x20\x27Assigned\x20By\x27\x20value\x20has\x20been\x20found.','979xXqTVg','EmployeeTaskCounter','/_api/web/Lists/GetByTitle(\x27DepartmentalDMS\x27)/Items?$select=*,ID,DocumentWrittenBy,Modified,Editor/EMail,Editor/Title,File_x0020_Type,DocumentType,Title,AccessLevel,File/Name,File/ServerRelativeUrl&$top=5000&$expand=File,Editor/Id&$orderby=Modified\x20desc&$filter=startswith(AccessLevel,\x20\x27Everyone\x27)\x20and\x20ApprovalStatus\x20eq\x20\x27Approved\x27','LogonName','EmployeeTaskDetails','/_api/web/lists/getByTitle(\x27','#HistoryURL','\x20and\x20PermissionStatus\x20ne\x20\x27Revoked\x27&$select=Id','<option\x20value=\x22','AccessLevel','slice','/_api/web/lists/getbytitle(\x27EmployeeTaskCounter\x27)/GetItemById(\x27','filter','Update\x20Successfully','LogLevel','orderBy','PATCH','02546580','SP.FieldChoice','Email','subscribe','4wPOzOP','error','GuestUser','lastIndexOf','\x27)/items','/Titan/IT/_api/web/lists/getByTitle(\x27KnowledgeBaseCategory\x27)/Items?$select=GUID','ajax','DocumentManagementSystem','SP.Data.ClientMasterListItem','/_api/Web/Lists/getByTitle(\x27SharedDocument\x27)/Items(','Adapt','423020RaccCN','26/5/2022','Successfully.','ConsoleListener','#btnaddComment','DocumentNo','\x20successfully\x20created!','No\x20record\x20found.','SP.Field','Dipankar\x20Goswami','SP.Data.EmployeesListItem','#btnCreateCustomColumns','join','/_api/Web/Lists/getByTitle(\x27SharedDocument\x27)/Items','/_api/web/Lists/GetByTitle(\x27','&$filter=AssignedBy/EMail\x20eq\x20null&$select=Id,AssignedBy/EMail,Author/EMail,Author/Id&$expand=AssignedBy,Author&$OrderBy=Modified\x20asc','trim','Draft','An\x20error\x20occurred\x20while\x20deleting\x20Application.\x20','length','Created','append','responseText','done','Parent','Updated\x20Description\x20of\x20the\x20field','LoginName','reject','Lakhan\x20sharma','?$top=5000&$select=*,ClientID/ID,ClientID/Title,Module/Title,Module/ID,AssignedBy/EMail,AssignedBy/Title,AssignedBy/Id,Author/Title,Author/EMail,DependencyTo/EMail,DependencyTo/Title,TaskAssignTo/EMail,TaskAssignTo/Title,TaskAssignTo/ID,AttachmentFiles&$Expand=ClientID,Module,Author,AssignedBy,AttachmentFiles,TaskAssignTo,DependencyTo&$OrderBy=Modified\x20asc','SP.Data.','responseJSON','email','substring','/_api/web/lists/getbytitle(\x27SharedDocument\x27)/GetItemById(','ID,Status,LoginName/EMail,LoginName/ID,email','Primary','application/json;odata=verbose','then','#btnenvironmental','418112kMzxnM','2022-10-26T12:10:10.641Z','promise','POST','1357','?$top=5000&$select=*,UserId/Id,UserId/EMail&$expand=UserId&$filter=UserId/EMail\x20eq\x20\x27','true','Inbox','/DocumentManagementSystem','ListItemAllFields','294642UfpnzY','Please\x20enter\x20DMS\x20url','log','.panel-heading-bg-txt-clr','#btnFillcompanyAndDepartmentId','SharedUsers','Company','All\x20Task\x27s\x20\x27Assigned\x20By\x27\x20column\x20have\x20been\x20set.','toUpperCase','Please\x20Enter\x20DMS\x20site\x20URl','change','Update\x20successfully','resolve','Created\x20successfully\x20!','results','Open','ProjectDetails','ClientMaster','01/01/2023','Success\x20','/DepartmentalDMS','/_api/web/lists/getbytitle(\x27Departments\x27)/items?select=*,ID,Title&$orderby=Title\x20asc&$top=5000','All\x20counters\x20have\x20been\x20updated.','Employee','split','PermissionLevelId','/_api/web/lists/getByTitle(\x27SharedDocument\x27)/items/?$select=ID,LibraryURL&$filter=LibraryName\x20eq\x20\x27DepartmentalDMS\x27\x20and\x20CompanyIDId\x20eq\x20null\x20and\x20DepartmentIDId\x20eq\x20null&$top5000','536RcXYuq','/_api/web/lists/getbytitle(\x27ApplicationLink\x27)/GetItemById(','/_api/web/lists/getbytitle(\x27','LibraryURL','expand','DueDate','@x.com','390iAQVXd','Files','Failed','Logger','27692ixytzA','DocumentType','Error!','val','Consolidated','\x27)/fields?$filter=Title\x20eq\x20\x27','84gCOKLB','#btnChangeCompanyId','?$top=5000&$select=*,Author/EMail,Author/Title,Author/Id&$Expand=Author&$OrderBy=Modified\x20asc','File','lakhan.sharma@adapt-india.com','\x27)/Items?$select=ID,*&$top=5000&$filter=SharedId\x20ne\x20null','#sharedDmsURL','AuthorEMail','Author','Approved','Shared\x20With','?$top=5000&$select=*,Approvers/EMail,Approvers/Title,Approvers/Id&$Expand=Approvers&$OrderBy=Modified\x20asc','getDate','Medium','Active','when','\x27)/Items?$select=*,Author/EMail,Author/Title,FileRef,FileLeafRef&$expand=Author/Title&$filter=ID\x20eq\x20','New\x20York','1112nuZyDo','2540D','Submit\x20successfully','Template1','Status','ApprovedVersion','Info','#btnDocumentColumn','activeLogLevel','GET','\x27)/fields/getbytitle(\x27','#btnSubmit','Titan_Permission','ABC','stringify','\x27)/fields/getbytitle(','Wrong\x20Url\x20!','10923fgNYsV','Required','Guest','CommentCount','Successfully\x20done!','FileLeafRef','webAbsoluteUrl','No\x20record\x20found','Title','CompanyID','click','show','#DepartmentDDL','Pending','Acknowledgement','SP.List','setDate','\x27)\x20and\x20(CurrentPhase\x20eq\x20\x27Open\x27))','Success','\x27)?$select=*,Author/EMail,File_x0020_Type&$top=5000&$expand=Author/EMail,Folders,Folders/ListItemAllFields,Files,Folders/ListItemAllFields/Created_x0020_By,Files/ListItemAllFields/Created_x0020_By,Files/ListItemAllFields&$orderby=ListItemAllFields/TimeLastModified\x20desc','select','&$filter=((TaskAssignTo/EMail\x20eq\x20\x27','ListItem','/sites/','hide','Guid\x20Field','uri','ApprovedByOutsider','\x27\x20and\x20DocumentID\x20eq\x20','DeptId','\x27\x20or\x20DependencyTo/EMail\x20eq\x20\x27','DepartmentalDMS','Shared','/_api/web/lists/getByTitle(\x27EmployeeTaskDetails\x27)/items/?$top=5000&$filter=TaskPriority\x20eq\x20\x27Top\x27&$select=Id,TaskPriority&$OrderBy=Modified\x20asc','getAll','TestProject','SharedDocument','SecurityLevel','ComId','SubCategory','web','An\x20error\x20occurred\x20while\x20deleting\x20task.\x20','toISOString','DocumentURL','SharedUsersId','Live','SP.FieldUser','ApprovedBy','17017fXQRfF','#btnaddProject','Updated\x20','#__REQUESTDIGEST','DELETE','General\x20task','Enter\x20valit\x20url','#btnFilProject','#btncustomer','\x27)/items/','&$filter=((Author/EMail\x20eq\x20\x27','ExternalUsers','#btnUpdateTaskCounter','#btnTaskItemByTaskCategory','/sites/Titan_2_2_1_DEV/Lists/Employees/Attachments/400/dipankar1.jpg','ready','Details','value','get','empty','PermissionLevel','SP.Data.SharedDocumentListItem'];a0_0x1815=function(){return _0x39b344;};return a0_0x1815();}function createList(_0xcb9295){var _0x219d3a=a0_0x815881,_0x19a1e2=_spPageContextInfo[_0x219d3a(0x218)]+'/_api/web/lists';$['ajax']({'url':_0x19a1e2,'type':_0x219d3a(0x2d2),'data':JSON[_0x219d3a(0x20f)]({'__metadata':{'type':_0x219d3a(0x221)},'BaseTemplate':0x65,'Title':_0xcb9295}),'headers':{'accept':_0x219d3a(0x2cc),'content-type':_0x219d3a(0x2cc),'X-RequestDigest':$('#__REQUESTDIGEST')[_0x219d3a(0x1ec)]()},'success':onQuerySucceeded,'error':onQueryFailed});}function onQuerySucceeded(_0x272083){var _0x7c545a=a0_0x815881;alert(_0x272083['d']['Title']+_0x7c545a(0x2ad));}function onQueryFailed(){var _0x2a04e0=a0_0x815881;alert(_0x2a04e0(0x1eb));}function Addemployee(){var _0x49188d=a0_0x815881,_0x2fff2d=_0x49188d(0x26d),_0x234942=new Date(),_0xca4eb7=_0x234942[_0x49188d(0x23c)]()[_0x49188d(0x2c8)](0x0,0x32),_0x3d5b18;for(var _0x23be90=0x0;_0x23be90<=0x12c;_0x23be90++){_0x3d5b18={'__metadata':{'type':_0x49188d(0x2b1)},'LogonNameId':0x74,'FullName':_0x49188d(0x2c3)+_0x23be90,'Title':_0x49188d(0x2c3)+_0x23be90,'ParentId':0x190,'Designation':'BA','Manager':_0x49188d(0x2b0),'ManagerLoginNameId':0x14,'Email':_0x49188d(0x1f3),'Gender':'Male','CompanyId':Logged_CompanyId,'DepartmentId':Logged_DepartmentId,'OfficeLocationId':Logged_Location,'Status':_0x49188d(0x1fd),'JoiningDate':_0xca4eb7,'PrimaryCompany':_0x49188d(0x2cb)},$[_0x49188d(0x1fe)](AddItemEmp(_0x2fff2d,_0x3d5b18))[_0x49188d(0x2be)](function(_0x250eb6){var _0x53492b=_0x49188d;_0x23be90==0x1324&&alert(_0x53492b(0x203));});}}function AddCommentInAnnouncement(){var _0x438169=a0_0x815881,_0x4aee5a;for(var _0x382c0e=0x1;_0x382c0e<=0x3e8;_0x382c0e++){var _0x447d59=_spPageContextInfo['userId'],_0x404fb3=_0x438169(0x250),_0xb2243a='AnnouncementsChild',_0x39a623={'__metadata':{'type':_0x438169(0x2c5)+_0xb2243a+_0x438169(0x228)},'Item_ID':_0x438169(0x2d3),'WebPartName':_0x438169(0x266),'Comment':'test'+_0x382c0e,'ReplierId':parseInt(_0x447d59),'Initials':_0x438169(0x2bf),'ReplyforId':parseInt(_0x447d59),'UserImage':_0x404fb3};$[_0x438169(0x1fe)](AddItemEmp(_0xb2243a,_0x39a623))['done'](function(_0xdd8116){var _0x5272dc=_0x438169;_0x382c0e==0x3e8&&alert(_0x5272dc(0x203));});}}var arrMeta=[{'FieldTypeKind':0x2,'Title':a0_0x815881(0x2ac)},{'FieldTypeKind':0x2,'Title':a0_0x815881(0x1ea)},{'FieldTypeKind':0x2,'Title':'DocumentWrittenBy'},{'FieldTypeKind':0x3,'Title':a0_0x815881(0x252)},{'FieldTypeKind':0x14,'Title':'Shared'},{'FieldTypeKind':0x2,'Title':a0_0x815881(0x239)},{'FieldTypeKind':0x14,'Title':a0_0x815881(0x1f9)},{'FieldTypeKind':0x2,'Title':a0_0x815881(0x290)},{'FieldTypeKind':0x2,'Title':a0_0x815881(0x237)},{'FieldTypeKind':0x2,'Title':a0_0x815881(0x256)},{'FieldTypeKind':0x2,'Title':a0_0x815881(0x1dc)},{'FieldTypeKind':0x6,'Title':a0_0x815881(0x220)},{'FieldTypeKind':0x2,'Title':'Approval'},{'FieldTypeKind':0x14,'Title':a0_0x815881(0x241)},{'FieldTypeKind':0x4,'Title':'ApprovedDate'},{'FieldTypeKind':0x4,'Title':a0_0x815881(0x272)},{'FieldTypeKind':0x4,'Title':a0_0x815881(0x27f)},{'FieldTypeKind':0x2,'Title':a0_0x815881(0x206)},{'FieldTypeKind':0x2,'Title':a0_0x815881(0x22d)},{'FieldTypeKind':0x9,'Title':a0_0x815881(0x215)},{'FieldTypeKind':0x3,'Title':a0_0x815881(0x20d)}];function CreateListColumn(){var _0x1d9a89=a0_0x815881;console['log'](arrMeta);for(var _0x302bef=0x0;_0x302bef<arrMeta[_0x1d9a89(0x2ba)];_0x302bef++){var _0x18fb15;_0x18fb15={'__metadata':{'type':_0x1d9a89(0x240),'addToDefaultView':'true'},'FieldTypeKind':arrMeta[_0x302bef][_0x1d9a89(0x277)],'Title':arrMeta[_0x302bef]['Title'],'SelectionMode':0x0,'AllowMultipleValues':!![]},$[_0x1d9a89(0x2a2)]({'url':_spPageContextInfo['webAbsoluteUrl']+'/Titan/InformationTechnology22255/_api/web/lists/getByTitle(\x27DepartmentalDMS\x27)/fields','type':'POST','async':![],'data':JSON['stringify'](_0x18fb15),'headers':{'Accept':'application/json;odata=verbose','Content-Type':_0x1d9a89(0x2cc),'X-RequestDigest':$(_0x1d9a89(0x245))['val']()},'success':function(_0x5e7a69,_0x2022aa,_0x1974f5){var _0x69c8cb=_0x1d9a89;console[_0x69c8cb(0x1c5)](_0x69c8cb(0x224)+Title),alert(_0x69c8cb(0x2bb));},'error':function(_0x3c9d2f,_0x3f0c1a,_0x503107){var _0x5328fc=_0x1d9a89;alert(_0x3c9d2f[_0x5328fc(0x2bd)]);}});}}function getGUID(){var _0x50fb4e=a0_0x815881,_0x1169fd=_spPageContextInfo['webAbsoluteUrl']+_0x50fb4e(0x2a1);$[_0x50fb4e(0x2a2)]({'url':_0x1169fd,'headers':{'Accept':_0x50fb4e(0x2cc)},'async':![],'success':function(_0x13aef0){var _0x5ca26e=_0x50fb4e,_0x472411=_0x13aef0['d']['results'][0x0][_0x5ca26e(0x27e)];return console[_0x5ca26e(0x1c5)](_0x13aef0['d'][_0x5ca26e(0x1d1)][0x0][_0x5ca26e(0x27e)][_0x5ca26e(0x22c)]),_0x472411[_0x5ca26e(0x22c)][_0x5ca26e(0x1db)](_0x5ca26e(0x265))[0x1][_0x5ca26e(0x1db)]('\x27)')[0x0],_0x472411;},'error':function(_0x547f27){var _0x2fcf56=_0x50fb4e;console[_0x2fcf56(0x1c5)](_0x2fcf56(0x22b));}});}function createNewCustomColumn(){var _0x3588f1=a0_0x815881,_0x2de6ee=$('#txtSubsiteURL')[_0x3588f1(0x1ec)]()['trim'](),_0x15db8a=_0x2de6ee[_0x3588f1(0x29f)]('/');if(_0x2de6ee[_0x3588f1(0x2ba)]==0x0)return alert(_0x3588f1(0x1cc)),![];if($(_0x3588f1(0x25b))['is'](':checked')==![])return alert('Please\x20select\x20radio\x20button'),![];var _0x21c536=_0x2de6ee[_0x3588f1(0x1db)]('/');_0x21c536=_0x21c536[_0x21c536[_0x3588f1(0x2ba)]-0x1];_0x21c536=='/'&&(_0x21c536=_0x21c536[_0x21c536[_0x3588f1(0x2ba)]-0x2]);for(var _0x14f485=0x0;_0x14f485<arrMeta[_0x3588f1(0x2ba)];_0x14f485++){var _0x6d372;GetAllFieldsFromList(_0x2de6ee[_0x3588f1(0x291)](0x0,_0x15db8a),_0x21c536,arrMeta[_0x14f485]['Title']);if(urlValidation==![])return![];if(exists==![]){var _0x2b2c1f='';_0x2b2c1f=_0x2de6ee[_0x3588f1(0x291)](0x0,_0x15db8a)+'/_api/web/lists/getByTitle(\x27'+_0x21c536+_0x3588f1(0x26f),arrMeta[_0x14f485][_0x3588f1(0x277)]==0x6?arrMeta[_0x14f485][_0x3588f1(0x21a)]==_0x3588f1(0x220)?_0x6d372={'__metadata':{'type':'SP.FieldChoice','addToDefaultView':_0x3588f1(0x1bf)},'FieldTypeKind':arrMeta[_0x14f485][_0x3588f1(0x277)],'Title':arrMeta[_0x14f485][_0x3588f1(0x21a)],'Choices':{'results':[_0x3588f1(0x213),'Not\x20Required',_0x3588f1(0x26a)]}}:_0x6d372={'__metadata':{'type':_0x3588f1(0x299),'addToDefaultView':'true'},'FieldTypeKind':arrMeta[_0x14f485]['FieldTypeKind'],'Title':arrMeta[_0x14f485][_0x3588f1(0x21a)],'Choices':{'results':[_0x3588f1(0x2b8),_0x3588f1(0x1f8),_0x3588f1(0x21f),'Rejected']}}:arrMeta[_0x14f485][_0x3588f1(0x277)]!=0x7&&(_0x6d372={'__metadata':{'type':_0x3588f1(0x2af),'addToDefaultView':'true'},'FieldTypeKind':arrMeta[_0x14f485]['FieldTypeKind'],'Title':arrMeta[_0x14f485][_0x3588f1(0x21a)]}),arrMeta[_0x14f485][_0x3588f1(0x21a)]==_0x3588f1(0x232)&&(_0x2b2c1f=_0x2de6ee[_0x3588f1(0x291)](0x0,_0x15db8a)+_0x3588f1(0x28c)+_0x21c536+_0x3588f1(0x26f),_0x6d372={'__metadata':{'type':_0x3588f1(0x240),'addToDefaultView':_0x3588f1(0x1bf)},'FieldTypeKind':arrMeta[_0x14f485]['FieldTypeKind'],'Title':arrMeta[_0x14f485]['Title'],'AllowMultipleValues':!![]}),arrMeta[_0x14f485][_0x3588f1(0x21a)]=='Shared\x20With'&&(_0x2b2c1f=_0x2de6ee[_0x3588f1(0x291)](0x0,_0x15db8a)+_0x3588f1(0x28c)+_0x21c536+_0x3588f1(0x26f),_0x6d372={'__metadata':{'type':_0x3588f1(0x240),'addToDefaultView':_0x3588f1(0x1bf)},'FieldTypeKind':arrMeta[_0x14f485]['FieldTypeKind'],'Title':arrMeta[_0x14f485][_0x3588f1(0x21a)]}),arrMeta[_0x14f485][_0x3588f1(0x21a)]==_0x3588f1(0x241)&&(_0x2b2c1f=_0x2de6ee['slice'](0x0,_0x15db8a)+'/_api/web/lists/getByTitle(\x27'+_0x21c536+'\x27)/fields',_0x6d372={'__metadata':{'type':_0x3588f1(0x240),'addToDefaultView':_0x3588f1(0x1bf)},'FieldTypeKind':arrMeta[_0x14f485][_0x3588f1(0x277)],'Title':arrMeta[_0x14f485][_0x3588f1(0x21a)],'SelectionMode':0x0}),arrMeta[_0x14f485][_0x3588f1(0x21a)]==_0x3588f1(0x272)&&(_0x2b2c1f=_0x2de6ee[_0x3588f1(0x291)](0x0,_0x15db8a)+'/_api/web/lists/getByTitle(\x27'+_0x21c536+_0x3588f1(0x26f),_0x6d372={'__metadata':{'type':'SP.FieldDateTime'},'FieldTypeKind':arrMeta[_0x14f485][_0x3588f1(0x277)],'Title':arrMeta[_0x14f485][_0x3588f1(0x21a)],'DisplayFormat':0x0}),arrMeta[_0x14f485][_0x3588f1(0x21a)]=='email_date'&&(_0x2b2c1f=_0x2de6ee[_0x3588f1(0x291)](0x0,_0x15db8a)+_0x3588f1(0x28c)+_0x21c536+_0x3588f1(0x26f),_0x6d372={'__metadata':{'type':_0x3588f1(0x268)},'FieldTypeKind':arrMeta[_0x14f485][_0x3588f1(0x277)],'Title':arrMeta[_0x14f485][_0x3588f1(0x21a)],'DisplayFormat':0x0}),arrMeta[_0x14f485][_0x3588f1(0x21a)]==_0x3588f1(0x273)&&(_0x2b2c1f=_0x2de6ee[_0x3588f1(0x291)](0x0,_0x15db8a)+_0x3588f1(0x28c)+_0x21c536+_0x3588f1(0x26f),_0x6d372={'__metadata':{'type':'SP.FieldDateTime'},'FieldTypeKind':arrMeta[_0x14f485][_0x3588f1(0x277)],'Title':arrMeta[_0x14f485][_0x3588f1(0x21a)],'DisplayFormat':0x0}),$[_0x3588f1(0x2a2)]({'url':_0x2b2c1f,'type':_0x3588f1(0x2d2),'async':![],'data':JSON[_0x3588f1(0x20f)](_0x6d372),'headers':{'Accept':_0x3588f1(0x2cc),'Content-Type':_0x3588f1(0x2cc),'X-RequestDigest':$('#__REQUESTDIGEST')[_0x3588f1(0x1ec)]()},'success':function(_0x2508ff,_0x3d36af,_0x24a46b){var _0x4e6046=_0x3588f1;console[_0x4e6046(0x1c5)](_0x4e6046(0x1d6)+arrMeta[_0x14f485][_0x4e6046(0x21a)]),arrMeta[_0x4e6046(0x2ba)]-0x1==_0x14f485&&alert(_0x4e6046(0x1d0));},'error':function(_0x4a4795,_0x302e6c,_0x424f1b){console['log']('Failed');}});}else console['log']('All\x20ready\x20Add\x20'+arrMeta[_0x14f485][_0x3588f1(0x21a)]),arrMeta['length']-0x1==_0x14f485&&alert(_0x3588f1(0x216));}}var arrColumn='test',urlValidation=!![],exists=![];function GetAllFieldsFromList(_0x3d98e4,_0x2d3d23,_0x2e04c1){var _0x2c20d8=a0_0x815881;arrColumn='',exists=![],$['ajax']({'url':_0x3d98e4+'/_api/web/lists/getByTitle(\x27'+_0x2d3d23+_0x2c20d8(0x1ee)+_0x2e04c1+'\x27','method':'GET','async':![],'headers':{'Accept':_0x2c20d8(0x2cc)},'success':function(_0x995bca,_0x1c6e20,_0x11578d){var _0x49e0a2=_0x2c20d8,_0x13a82=_0x995bca['d'][_0x49e0a2(0x1d1)];if(_0x13a82[_0x49e0a2(0x2ba)]>0x0)for(var _0x1a106=0x0;_0x1a106<_0x13a82[_0x49e0a2(0x2ba)];_0x1a106++){ColumnTitle=_0x13a82[_0x1a106][_0x49e0a2(0x21a)],exists=!![],$(_0x49e0a2(0x275))[_0x49e0a2(0x1ec)]()=='2'&&DeleteListColumn(_0x3d98e4,ColumnTitle,_0x2d3d23),console[_0x49e0a2(0x1c5)](_0x13a82[_0x1a106][_0x49e0a2(0x21a)]);}},'error':function(_0x2d1bda,_0x22a78c,_0x2c7bd9){var _0x4f2b26=_0x2c20d8;alert(_0x4f2b26(0x211)),urlValidation=![];}});}function UpdateFieldFromList(_0x563f10,_0x19f2e3,_0x2ec9b7){var _0x24e6b7=a0_0x815881;$[_0x24e6b7(0x2a2)]({'url':_0x563f10+_0x24e6b7(0x28c)+_0x19f2e3+_0x24e6b7(0x210)+_0x2ec9b7+')','method':_0x24e6b7(0x2d2),'data':JSON[_0x24e6b7(0x20f)]({'__metadata':{'type':'SP.FieldUser','addToDefaultView':'true'},'Description':_0x24e6b7(0x2c0),'FieldTypeKind':0x14,'Title':_0x2ec9b7,'AllowMultipleValues':!![]}),'headers':{'IF-MATCH':'*','X-HTTP-Method':_0x24e6b7(0x297),'Accept':_0x24e6b7(0x2cc),'Content-Type':_0x24e6b7(0x2cc),'X-RequestDigest':$('#__REQUESTDIGEST')['val']()},'success':function(_0x56468e,_0x2096bf,_0x1dfcc1){var _0x88841a=_0x24e6b7;console[_0x88841a(0x1c5)](_0x88841a(0x244)+_0x2ec9b7);},'error':function(_0x52c114,_0x478617,_0x33f3af){var _0x1c2720=_0x24e6b7;console[_0x1c2720(0x1c5)](_0x1c2720(0x1e7));}});}function DeleteListColumn(_0x213128,_0x307508,_0x2d5ae8){var _0x16d493=a0_0x815881;$[_0x16d493(0x2a2)]({'url':_0x213128+_0x16d493(0x28c)+_0x2d5ae8+_0x16d493(0x20b)+_0x307508+'\x27)','type':_0x16d493(0x2d2),'async':![],'headers':{'Accept':'application/json;odata=verbose','Content-Type':_0x16d493(0x2cc),'IF-MATCH':'*','X-HTTP-Method':_0x16d493(0x246),'X-RequestDigest':$(_0x16d493(0x245))[_0x16d493(0x1ec)]()},'success':function(_0x360606,_0x1ae2e1,_0x1c2ef9){console['log']('Delete\x20Success\x20'+_0x307508),exists=![],urlValidation=!![];},'error':function(_0xa826a9,_0x1ccd3b,_0x8d7143){var _0x3185ac=_0x16d493;console[_0x3185ac(0x1c5)](_0x3185ac(0x1e7));}});}function GetItemTypeForListName(_0x5353f1){var _0x2235ad=a0_0x815881;return'SP.Data.'+_0x5353f1['charAt'](0x0)[_0x2235ad(0x1cb)]()+_0x5353f1[_0x2235ad(0x1db)]('\x20')['join']('')[_0x2235ad(0x291)](0x1)+'ListItem';}function ChangePriority(){var _0x510aee=a0_0x815881;$['ajax']({'url':_spPageContextInfo[_0x510aee(0x218)]+_0x510aee(0x233),'method':_0x510aee(0x20a),'async':![],'headers':{'Accept':_0x510aee(0x2cc)},'success':function(_0xfddeca,_0xaf3534,_0x1a00e7){var _0x1843f9=_0x510aee,_0x5d3674=_0xfddeca['d']['results'];if(_0x5d3674[_0x1843f9(0x2ba)]>0x0)updatePriority(_0x5d3674);else return alert('No\x20Task\x20with\x20Priority\x20\x27Top\x27\x20has\x20been\x20found.'),![];},'error':function(_0x19a975,_0x50cd8,_0x5055ed){var _0x1e53ae=_0x510aee;console['log'](_0x19a975[_0x1e53ae(0x2bd)]);}});}function updatePriority(_0x1f56cf){var _0xe14104=a0_0x815881,_0x1bfdd7=GetItemTypeForListName(_0xe14104(0x28b));Metadata={'__metadata':{'type':_0x1bfdd7},'TaskPriority':_0xe14104(0x25d)},_0x1f56cf[_0xe14104(0x261)](function(_0x4f182a,_0xc0540f){var _0x38568e=_0xe14104,_0x3c74fd=$[_0x38568e(0x279)]();return $[_0x38568e(0x2a2)]({'url':_spPageContextInfo[_0x38568e(0x218)]+_0x38568e(0x25f)+_0x4f182a['Id']+'\x27)','type':_0x38568e(0x2d2),'async':![],'headers':{'accept':_0x38568e(0x2cc),'X-RequestDigest':$(_0x38568e(0x245))[_0x38568e(0x1ec)](),'content-Type':'application/json;odata=verbose','X-Http-Method':_0x38568e(0x297),'If-Match':'*'},'data':JSON[_0x38568e(0x20f)](Metadata),'success':function(_0x53fdcf){var _0x4322ab=_0x38568e;_0x3c74fd['resolve'](_0x53fdcf),_0x1f56cf[_0x4322ab(0x2ba)]==_0xc0540f+0x1&&alert('All\x20Task\x27s\x20Priority\x20has\x20been\x20changed.');},'eror':function(_0x275c11){var _0x59b0d0=_0x38568e;_0x3c74fd['reject'](error),console[_0x59b0d0(0x1c5)](_0x59b0d0(0x23b)+JSON[_0x59b0d0(0x20f)](_0x275c11));}}),_0x3c74fd[_0x38568e(0x2d1)]();});}function getBlankAssignedBy(){var _0x5581f7=a0_0x815881;$[_0x5581f7(0x2a2)]({'url':_spPageContextInfo[_0x5581f7(0x218)]+_0x5581f7(0x26c)+_0x5581f7(0x2b6),'method':_0x5581f7(0x20a),'async':![],'headers':{'Accept':'application/json;odata=verbose'},'success':function(_0x325fd9,_0x49447c,_0xdbd3a2){var _0x1e75a5=_0x5581f7,_0x4d7e80=_0x325fd9['d'][_0x1e75a5(0x1d1)];if(_0x4d7e80[_0x1e75a5(0x2ba)]>0x0)updateAssignedBy(_0x4d7e80);else return alert(_0x1e75a5(0x286)),![];},'error':function(_0x333be4,_0x58272b,_0x5c7d67){var _0x3a67ed=_0x5581f7;alert(_0x333be4[_0x3a67ed(0x2bd)]);return;}});}function updateAssignedBy(_0x386e6e){var _0xe7b7b7=a0_0x815881,_0x31da5a=GetItemTypeForListName(_0xe7b7b7(0x28b));_0x386e6e[_0xe7b7b7(0x261)](function(_0x255d30,_0x42e15d){var _0x3b0549=_0xe7b7b7;Metadata={'__metadata':{'type':_0x31da5a},'AssignedById':_0x255d30[_0x3b0549(0x1f7)]['Id']};var _0x5ef5e9=$[_0x3b0549(0x279)]();return $[_0x3b0549(0x2a2)]({'url':_spPageContextInfo['webAbsoluteUrl']+_0x3b0549(0x25f)+_0x255d30['Id']+'\x27)','type':_0x3b0549(0x2d2),'async':![],'headers':{'accept':_0x3b0549(0x2cc),'X-RequestDigest':$(_0x3b0549(0x245))[_0x3b0549(0x1ec)](),'content-Type':_0x3b0549(0x2cc),'X-Http-Method':_0x3b0549(0x297),'If-Match':'*'},'data':JSON[_0x3b0549(0x20f)](Metadata),'success':function(_0x121efd){var _0x2b32e0=_0x3b0549;_0x5ef5e9[_0x2b32e0(0x1cf)](_0x121efd),_0x386e6e['length']==_0x42e15d+0x1&&alert(_0x2b32e0(0x1ca));},'eror':function(_0x3a28ec){var _0x4ce465=_0x3b0549;_0x5ef5e9[_0x4ce465(0x2c2)](error),console[_0x4ce465(0x1c5)]('An\x20error\x20occurred\x20while\x20changing\x20task.\x20'+JSON[_0x4ce465(0x20f)](_0x3a28ec));}}),_0x5ef5e9[_0x3b0549(0x2d1)]();});}function getInternalEmployees(){var _0x58c892=a0_0x815881,_0x43a20a='';pnp[_0x58c892(0x1e8)][_0x58c892(0x29b)](new pnp[(_0x58c892(0x2aa))]()),pnp[_0x58c892(0x1e8)][_0x58c892(0x209)]=pnp[_0x58c892(0x295)][_0x58c892(0x207)],pnp['sp'][_0x58c892(0x23a)][_0x58c892(0x254)]()[_0x58c892(0x2cd)](function(_0x345e5b){var _0x25c52b=_0x58c892;console[_0x25c52b(0x1c5)](JSON['stringify'](_0x345e5b,null,0x4));});try{result=pnp['sp'][_0x58c892(0x23a)][_0x58c892(0x27c)][_0x58c892(0x258)]('Employees')['items']['select'](_0x58c892(0x25c))[_0x58c892(0x1e2)]('LogonName')[_0x58c892(0x293)]('')[_0x58c892(0x296)]('','')[_0x58c892(0x234)]()[_0x58c892(0x2cd)](function(_0x37bdb1){var _0x71a004=_0x58c892;_0x43a20a=_0x37bdb1[_0x71a004(0x293)](function(_0x2117e5){var _0x4af0cd=_0x71a004;return _0x2117e5[_0x4af0cd(0x205)]==_0x4af0cd(0x1fd);}),getExternalEmployees(_0x43a20a);});}catch(_0x1599a7){waitingDialog[_0x58c892(0x22a)](),console[_0x58c892(0x1c5)](_0x1599a7);}}function getExternalEmployees(_0x18b2ae){var _0x582072=a0_0x815881,_0x4f0326='';pnp[_0x582072(0x1e8)][_0x582072(0x29b)](new pnp[(_0x582072(0x2aa))]()),pnp[_0x582072(0x1e8)][_0x582072(0x209)]=pnp[_0x582072(0x295)][_0x582072(0x207)],pnp['sp'][_0x582072(0x23a)][_0x582072(0x254)]()['then'](function(_0x5a86be){var _0x5222dd=_0x582072;console[_0x5222dd(0x1c5)](JSON[_0x5222dd(0x20f)](_0x5a86be,null,0x4));});try{result=pnp['sp']['web']['lists'][_0x582072(0x258)](_0x582072(0x24d))['items'][_0x582072(0x226)](_0x582072(0x2ca))[_0x582072(0x1e2)](_0x582072(0x2c1))[_0x582072(0x293)]('')['orderBy']('','')[_0x582072(0x234)]()['then'](function(_0x4264af){var _0x113808=_0x582072;_0x4f0326=_0x4264af[_0x113808(0x293)](function(_0x1f01b4){var _0x2a5dd3=_0x113808;return _0x1f01b4['Status']==_0x2a5dd3(0x1fd);}),checkInCounterList(_0x18b2ae,_0x4f0326);});}catch(_0x51b951){waitingDialog[_0x582072(0x22a)](),console[_0x582072(0x1c5)](_0x51b951);}}function checkInCounterList(_0x18fd52,_0x47bc77){var _0x12508e=a0_0x815881;$[_0x12508e(0x259)](_0x18fd52,function(_0x499dc8,_0x231442){var _0x2b0fd4=_0x12508e,_0x278955=_0x2b0fd4(0x2d4)+_0x231442[_0x2b0fd4(0x29a)]+'\x27\x20';$[_0x2b0fd4(0x1fe)](getItemsWithQueryItem(_0x2b0fd4(0x288),_0x278955))[_0x2b0fd4(0x2be)](function(_0x20f20a){var _0x44f9d9=_0x2b0fd4;_0x20f20a[_0x44f9d9(0x2ba)]>0x0?(GetTaskInboxCount(_0x231442[_0x44f9d9(0x29a)],_0x20f20a[0x0]['Id']),GetTaskOutboxCount(_0x231442[_0x44f9d9(0x29a)],_0x20f20a[0x0]['Id']),GetApprovalInboxCount(_0x231442['Email'],_0x20f20a[0x0]['Id'])):AddUserInCounterList(_0x231442[_0x44f9d9(0x28a)]['ID'],_0x44f9d9(0x1da),_0x231442[_0x44f9d9(0x29a)],'Employee');});}),$[_0x12508e(0x259)](_0x47bc77,function(_0x362720,_0x12f08e){var _0x375d2f=_0x12508e,_0x353440=_0x375d2f(0x2d4)+_0x12f08e['email']+'\x27\x20';$[_0x375d2f(0x1fe)](getItemsWithQueryItem(_0x375d2f(0x288),_0x353440))[_0x375d2f(0x2be)](function(_0x381916){var _0x2131cd=_0x375d2f;_0x381916[_0x2131cd(0x2ba)]>0x0?(GetTaskInboxCount(_0x12f08e[_0x2131cd(0x2c7)],_0x381916[0x0]['Id']),GetTaskOutboxCount(_0x12f08e[_0x2131cd(0x2c7)],_0x381916[0x0]['Id'])):AddUserInCounterList(_0x12f08e[_0x2131cd(0x2c1)]['ID'],_0x2131cd(0x29e),_0x12f08e[_0x2131cd(0x2c7)],_0x2131cd(0x214));});}),alert(_0x12508e(0x1d9)),waitingDialog['hide']();}function AddUserInCounterList(_0x1d8197,_0x3858d9,_0xe57138,_0x57da6a){var _0x2216be=a0_0x815881;Metadata={'__metadata':{'type':'SP.Data.EmployeeTaskCounterListItem'},'Title':_0x3858d9,'UserIdId':_0x1d8197},AddedItemId=AddToSPList(_0x2216be(0x288),Metadata),GetTaskInboxCount(_0xe57138,AddedItemId),GetTaskOutboxCount(_0xe57138,AddedItemId),_0x57da6a==_0x2216be(0x1da)&&GetApprovalInboxCount(_0xe57138,AddedItemId);}function GetTaskInboxCount(_0x4e7418,_0x3ed0ab){var _0x3726f8=a0_0x815881;restQuery=_0x3726f8(0x227)+_0x4e7418+_0x3726f8(0x230)+_0x4e7418+_0x3726f8(0x223);var _0x5c3753=_0x3726f8(0x2c4)+restQuery;$[_0x3726f8(0x1fe)](getItemsWithQueryItem(_0x3726f8(0x28b),_0x5c3753))[_0x3726f8(0x2be)](function(_0x7925ab){var _0x404ecd=_0x3726f8,_0x40f0e5='',_0x2eca52=0x0,_0x3ae519=0x0,_0x2d4ebb=new Date();_0x2d4ebb=_0x2d4ebb['setHours'](0x0,0x0,0x0,0x0),_0x2d4ebb=new Date(_0x2d4ebb);for(var _0x16e188=0x0;_0x16e188<_0x7925ab[_0x404ecd(0x2ba)];_0x16e188++){var _0xa95179=new Date(moment(_0x7925ab[_0x16e188]['DueDate'][_0x404ecd(0x1db)]('T')[0x0])['format'](_0x404ecd(0x27b)));_0xa95179[_0x404ecd(0x222)](_0xa95179[_0x404ecd(0x1fb)]()),_0xa95179=new Date(_0xa95179),_0xa95179>=_0x2d4ebb?_0x2eca52++:_0x3ae519++;}UpdateTaskCounter(_0x3ed0ab,_0x2eca52,_0x3ae519,_0x404ecd(0x1c0));});}function GetTaskOutboxCount(_0x2db7a1,_0x5e3f5c){var _0x5c27b2=a0_0x815881;restQuery=_0x5c27b2(0x24c)+_0x2db7a1+_0x5c27b2(0x282)+_0x2db7a1+_0x5c27b2(0x223);var _0x11a6a4='?$top=5000&$select=*,ClientID/ID,ClientID/Title,Module/Title,Module/ID,AssignedBy/EMail,AssignedBy/Title,AssignedBy/Id,Author/Title,Author/EMail,DependencyTo/EMail,DependencyTo/Title,TaskAssignTo/EMail,TaskAssignTo/Title,TaskAssignTo/ID,AttachmentFiles&$Expand=ClientID,Module,Author,AssignedBy,AttachmentFiles,TaskAssignTo,DependencyTo&$OrderBy=Modified\x20asc'+restQuery;$['when'](getItemsWithQueryItem('EmployeeTaskDetails',_0x11a6a4))['done'](function(_0x3fde9d){var _0x3541d1=_0x5c27b2,_0x522f52=0x0,_0x358c79=0x0;for(var _0x1e4da3=0x0;_0x1e4da3<_0x3fde9d[_0x3541d1(0x2ba)];_0x1e4da3++){var _0x474062=new Date(_0x3fde9d[_0x1e4da3][_0x3541d1(0x1e3)]),_0x4f1a38=new Date();_0x4f1a38['setHours'](0x0,0x0,0x0,0x0),_0x4f1a38>_0x474062?_0x358c79++:_0x522f52++;}UpdateTaskCounter(_0x5e3f5c,_0x522f52,_0x358c79,'Outbox');});}function UpdateTaskCounter(_0x21301b,_0x302973,_0x3a02d5,_0x500561){var _0x2262d1=a0_0x815881,_0x2b6b35=GetItemTypeForListName(_0x2262d1(0x288));_0x500561==_0x2262d1(0x1c0)?Metadata={'__metadata':{'type':_0x2b6b35},'OpenTasksCount':parseInt(_0x302973),'OverdueCount':parseInt(_0x3a02d5)}:Metadata={'__metadata':{'type':_0x2b6b35},'OpenTasksCount_Out':parseInt(_0x302973),'OverdueCount_Out':parseInt(_0x3a02d5)};var _0x542761=$[_0x2262d1(0x279)]();return $['ajax']({'url':_spPageContextInfo[_0x2262d1(0x218)]+_0x2262d1(0x292)+_0x21301b+'\x27)','type':_0x2262d1(0x2d2),'async':![],'headers':{'accept':_0x2262d1(0x2cc),'X-RequestDigest':$(_0x2262d1(0x245))['val'](),'content-Type':_0x2262d1(0x2cc),'X-Http-Method':_0x2262d1(0x297),'If-Match':'*'},'data':JSON[_0x2262d1(0x20f)](Metadata),'success':function(_0x38f297){var _0x54d89b=_0x2262d1;_0x542761[_0x54d89b(0x1cf)](_0x38f297);},'eror':function(_0x5852f9){var _0x45d21c=_0x2262d1;_0x542761[_0x45d21c(0x2c2)](error),console[_0x45d21c(0x1c5)]('An\x20error\x20occurred\x20while\x20deleting\x20task.\x20'+JSON[_0x45d21c(0x20f)](_0x5852f9));}}),_0x542761[_0x2262d1(0x2d1)]();}function GetApprovalInboxCount(_0x4dc584,_0x3329c5){var _0x126107=a0_0x815881,_0xaa7727=0x0;restQuery='&$filter=((Approvers/EMail\x20eq\x20\x27'+_0x4dc584+_0x126107(0x27d);var _0x2f01f2=_0x126107(0x1fa)+restQuery;$['when'](getItemsWithQueryItem(_0x126107(0x26e),_0x2f01f2))['done'](function(_0x4ce83d){var _0xd61ae0=_0x126107;_0xaa7727=_0x4ce83d['length'],restQuery=_0xd61ae0(0x24c)+_0x4dc584+_0xd61ae0(0x27d);var _0x30c66c=_0xd61ae0(0x1f1)+restQuery;$['when'](getItemsWithQueryItem(_0xd61ae0(0x26e),_0x30c66c))[_0xd61ae0(0x2be)](function(_0x15b185){var _0x54215c=_0xd61ae0;UpdateApprovalCounter(_0x3329c5,_0xaa7727,_0x15b185[_0x54215c(0x2ba)]);});});}function UpdateApprovalCounter(_0x1fddad,_0x2f4dc2,_0xc0f436){var _0x1118fa=a0_0x815881,_0x16a0ff=GetItemTypeForListName(_0x1118fa(0x288));Metadata={'__metadata':{'type':_0x16a0ff},'ApprovalCount_IN':parseInt(_0x2f4dc2),'ApprovalCount_OUT':parseInt(_0xc0f436)};var _0x2f9fa1=$['Deferred']();return $[_0x1118fa(0x2a2)]({'url':_spPageContextInfo['webAbsoluteUrl']+_0x1118fa(0x292)+_0x1fddad+'\x27)','type':_0x1118fa(0x2d2),'async':![],'headers':{'accept':_0x1118fa(0x2cc),'X-RequestDigest':$('#__REQUESTDIGEST')[_0x1118fa(0x1ec)](),'content-Type':'application/json;odata=verbose','X-Http-Method':_0x1118fa(0x297),'If-Match':'*'},'data':JSON[_0x1118fa(0x20f)](Metadata),'success':function(_0x51e200){var _0x363ac3=_0x1118fa;_0x2f9fa1[_0x363ac3(0x1cf)](_0x51e200);},'eror':function(_0x1b5e93){var _0x3e81a0=_0x1118fa;_0x2f9fa1['reject'](error),console[_0x3e81a0(0x1c5)](_0x3e81a0(0x23b)+JSON[_0x3e81a0(0x20f)](_0x1b5e93));}}),_0x2f9fa1[_0x1118fa(0x2d1)]();}function AddToSPList(_0x3dade4,_0x23482b){var _0x54dcb7=a0_0x815881,_0x3ea5e1='';return $[_0x54dcb7(0x2a2)]({'url':_spPageContextInfo[_0x54dcb7(0x218)]+_0x54dcb7(0x1e0)+_0x3dade4+_0x54dcb7(0x2a0),'type':'POST','async':![],'headers':{'accept':'application/json;odata=verbose','X-RequestDigest':$(_0x54dcb7(0x245))[_0x54dcb7(0x1ec)](),'content-Type':_0x54dcb7(0x2cc)},'data':JSON[_0x54dcb7(0x20f)](_0x23482b),'success':function(_0x5e84bc){_0x3ea5e1=_0x5e84bc['d']['Id'];},'error':function(_0xae869c){var _0x9f1168=_0x54dcb7;console[_0x9f1168(0x1c5)](JSON['stringify'](_0xae869c));}}),_0x3ea5e1;}function getItemsWithQueryItem(_0x2098bb,_0x99b420){var _0x31c31b=a0_0x815881;return DeferredObj=$['Deferred'](),$[_0x31c31b(0x2a2)]({'url':_spPageContextInfo['webAbsoluteUrl']+'/_api/web/lists/getbytitle(\x27'+_0x2098bb+_0x31c31b(0x24b)+_0x99b420,'type':_0x31c31b(0x20a),'async':![],'headers':{'ACCEPT':_0x31c31b(0x2cc),'X-RequestDigest':$('#__REQUESTDIGEST')[_0x31c31b(0x1ec)]()},'success':function(_0x1f9cc7){var _0x5dcf55=_0x31c31b;DeferredObj['resolve'](_0x1f9cc7['d'][_0x5dcf55(0x1d1)]);},'error':function(_0x48e455){var _0x58f59f=_0x31c31b;DeferredObj[_0x58f59f(0x2c2)](_0x48e455);}}),DeferredObj[_0x31c31b(0x2d1)]();};function ChangeCompanyId(){var _0x77cf16=a0_0x815881;$[_0x77cf16(0x2a2)]({'url':_spPageContextInfo[_0x77cf16(0x218)]+'/_api/web/lists/getByTitle(\x27ApplicationLink\x27)/items/?$top=5000&$filter=Company/ID\x20ne\x20null&$select=*,Company/ID,Id&$expand=Company&$OrderBy=Modified\x20asc','method':'GET','async':![],'headers':{'Accept':'application/json;odata=verbose'},'success':function(_0x380073,_0x55d8b2,_0x146639){var _0x3243e5=_0x77cf16,_0x60132a=_0x380073['d'][_0x3243e5(0x1d1)];if(_0x60132a[_0x3243e5(0x2ba)]>0x0)updateCompanyId(_0x60132a);else return alert(_0x3243e5(0x2ae)),![];},'error':function(_0x11a0df,_0x22fa85,_0xae0dc9){var _0x195011=_0x77cf16;console['log'](_0x11a0df[_0x195011(0x2bd)]);}});}function updateCompanyId(_0x2b3d32){var _0x4645ea=a0_0x815881,_0x13e158=GetItemTypeForListName('ApplicationLink'),_0x5b2f02=[];_0x2b3d32[_0x4645ea(0x261)](function(_0x5e4c8b,_0x4c4029){var _0x1a3a2d=_0x4645ea;_0x5b2f02=[],_0x5b2f02['push'](_0x5e4c8b[_0x1a3a2d(0x1c9)]['ID']),Metadata={'__metadata':{'type':_0x13e158},'CompanyIdId':{'results':_0x5b2f02}};var _0x249d6f=$[_0x1a3a2d(0x279)]();return $[_0x1a3a2d(0x2a2)]({'url':_spPageContextInfo['webAbsoluteUrl']+_0x1a3a2d(0x1df)+_0x5e4c8b['Id']+')','type':_0x1a3a2d(0x2d2),'async':![],'headers':{'accept':_0x1a3a2d(0x2cc),'X-RequestDigest':$(_0x1a3a2d(0x245))[_0x1a3a2d(0x1ec)](),'content-Type':_0x1a3a2d(0x2cc),'X-Http-Method':_0x1a3a2d(0x297),'If-Match':'*'},'data':JSON['stringify'](Metadata),'success':function(_0x580f15){var _0xf7b2b=_0x1a3a2d;_0x249d6f[_0xf7b2b(0x1cf)](_0x580f15),_0x2b3d32[_0xf7b2b(0x2ba)]==_0x4c4029+0x1&&alert(_0xf7b2b(0x2a9));},'eror':function(_0x31abdf){var _0xed552e=_0x1a3a2d;_0x249d6f[_0xed552e(0x2c2)](error),console[_0xed552e(0x1c5)](_0xed552e(0x2b9)+JSON[_0xed552e(0x20f)](_0x31abdf));}}),_0x249d6f[_0x1a3a2d(0x2d1)]();});}function fileShareDocumentColumn(){var _0x334e88=a0_0x815881;$[_0x334e88(0x2a2)]({'url':_spPageContextInfo['webAbsoluteUrl']+'/_api/web/lists/getByTitle(\x27SharedDocument\x27)/items/?$top=5000&$filter=SiteURL\x20eq\x20null\x20and\x20DocumentID\x20ne\x20null&$select=*,SharedUsers/EMail&$expand=SharedUsers/EMail&$OrderBy=Modified\x20desc','method':_0x334e88(0x20a),'async':![],'headers':{'Accept':'application/json;odata=verbose'},'success':function(_0x2440c8,_0x2533a3,_0x313861){var _0x3b38e2=_0x334e88,_0x4b6303=_0x2440c8['d'][_0x3b38e2(0x1d1)];if(_0x4b6303[_0x3b38e2(0x2ba)]>0x0)for(var _0x14fc1d=0x0;_0x14fc1d<_0x4b6303[_0x3b38e2(0x2ba)];_0x14fc1d++){var _0x2d48f8=_0x4b6303[_0x14fc1d][_0x3b38e2(0x23d)],_0x2d537b=_0x4b6303[_0x14fc1d]['DocumentID'],_0x236733='';_0x4b6303[_0x14fc1d][_0x3b38e2(0x23e)]!=null&&(_0x236733=_0x4b6303[_0x14fc1d][_0x3b38e2(0x1c8)]['results'][0x0][_0x3b38e2(0x262)]);var _0x1927c7=_0x4b6303[_0x14fc1d]['Id'],_0x4148ec=_0x2d48f8['split']('/DocumentManagementSystem'),_0x582ddd=_0x3b38e2(0x2a3),_0x1426c5=_spPageContextInfo[_0x3b38e2(0x218)],_0x100789=_spPageContextInfo[_0x3b38e2(0x218)]+_0x3b38e2(0x1c1);if(_0x4148ec[_0x3b38e2(0x2ba)]>0x1){}else{var _0x27914f=_0x2d48f8[_0x3b38e2(0x1db)]('/DepartmentalDMS');_0x27914f=_0x27914f[0x0][_0x3b38e2(0x1db)](_0x3b38e2(0x229))[0x1][_0x3b38e2(0x1db)]('/'),_0x582ddd=_0x3b38e2(0x231),_0x27914f[_0x3b38e2(0x2ba)]>0x2?(_0x1426c5=_spPageContextInfo[_0x3b38e2(0x218)]+'/'+_0x27914f[0x1]+'/'+_0x27914f[0x2],_0x100789=_spPageContextInfo[_0x3b38e2(0x218)]+'/'+_0x27914f[0x1]+'/'+_0x27914f[0x2]+_0x3b38e2(0x1d7)):(_0x1426c5=_spPageContextInfo[_0x3b38e2(0x218)]+'/'+_0x27914f[0x1],_0x100789=_spPageContextInfo[_0x3b38e2(0x218)]+'/'+_0x27914f[0x1]+'/'+_0x3b38e2(0x1d7));}var _0x466f68=_0x2d48f8[_0x3b38e2(0x1db)](_0x3b38e2(0x229));_0x466f68=_0x3b38e2(0x229)+_0x466f68[0x1];var _0x4a302a=_0x466f68[_0x3b38e2(0x1db)]('/'),_0xa3bc2b=_0x4a302a[_0x4a302a[_0x3b38e2(0x2ba)]-0x1][_0x3b38e2(0x1db)]('.');_0xa3bc2b[_0x3b38e2(0x2ba)]>0x1?(_0x2d48f8=_0x466f68['split']('/'+_0x4a302a[_0x4a302a[_0x3b38e2(0x2ba)]-0x1]),_0x2d48f8=_0x466f68):_0x2d48f8=_0x466f68,_0x582ddd==_0x3b38e2(0x231)?GetFolderDetails(_0x2d48f8,_0x2d537b,_0x1927c7,_0x582ddd,_0x1426c5,_0x100789,_0x236733):GetDocumentsFiles(_0x2d48f8,_0x2d537b,_0x1927c7,_0x582ddd,_0x1426c5,_0x100789,_0x236733);}else return alert(_0x3b38e2(0x2ae)),![];waitingDialog['hide']();},'error':function(_0x104542,_0x26028a,_0x1ab087){var _0x3709ea=_0x334e88;console['log'](_0x104542[_0x3709ea(0x2bd)]);}});}function updateShareDocument(_0x3d3b07,_0x382e80,_0x2aa821,_0x1581ab,_0x365b5e,_0xbf3f9c){var _0x1d0886=a0_0x815881,_0x507420=GetItemTypeForListName(_0x1d0886(0x236)),_0x5afdbd='',_0x48441d='';_0x2aa821==_0x1d0886(0x231)?(_0x5afdbd=_0x3d3b07[0x0][_0x1d0886(0x1f7)]['EMail'],_0x48441d=_0x3d3b07[0x0][_0x1d0886(0x1ea)]):(_0x5afdbd=_0x3d3b07[0x0][_0x1d0886(0x1f6)],_0x48441d=_0x3d3b07[0x0][_0x1d0886(0x1ea)]);Metadata={'__metadata':{'type':_0x507420},'LibraryURL':_0x365b5e,'LibraryName':_0x2aa821,'SiteURL':_0x1581ab,'DocType':_0x48441d,'SharedFileTitle':_0x3d3b07[0x0][_0x1d0886(0x217)],'SharedUserEmail':_0xbf3f9c};var _0x578aa0=$[_0x1d0886(0x279)]();return $[_0x1d0886(0x2a2)]({'url':_spPageContextInfo[_0x1d0886(0x218)]+_0x1d0886(0x2c9)+_0x382e80+')','type':_0x1d0886(0x2d2),'async':![],'headers':{'accept':_0x1d0886(0x2cc),'X-RequestDigest':$(_0x1d0886(0x245))['val'](),'content-Type':_0x1d0886(0x2cc),'X-Http-Method':_0x1d0886(0x297),'If-Match':'*'},'data':JSON[_0x1d0886(0x20f)](Metadata),'success':function(_0x5db6ec){var _0x28f748=_0x1d0886;_0x578aa0[_0x28f748(0x1cf)](_0x5db6ec);},'eror':function(_0x37307a){var _0x4741c5=_0x1d0886;_0x578aa0['reject'](error),console[_0x4741c5(0x1c5)](_0x4741c5(0x2b9)+JSON[_0x4741c5(0x20f)](_0x37307a));}}),_0x578aa0[_0x1d0886(0x2d1)]();}function GetFolderDetails(_0x2f3b2a,_0x4990e2,_0x262b45,_0x3a0695,_0x50fa5e,_0x242ba5,_0x46ffdb){var _0x1034e6=a0_0x815881;debugger;var _0x373ba3=_0x2f3b2a[_0x1034e6(0x1db)](_0x1034e6(0x1d7));_0x373ba3=_0x373ba3[0x0][_0x1034e6(0x1db)](_0x1034e6(0x229))[0x1][_0x1034e6(0x1db)]('/');_0x373ba3[_0x1034e6(0x2ba)]>0x2?_0x373ba3=_0x373ba3[0x1]+'/'+_0x373ba3[0x2]:_0x373ba3=_0x373ba3[0x1];var _0x234dad=_0x50fa5e,_0x27a66c=_0x242ba5,_0x3b4e62=_spPageContextInfo[_0x1034e6(0x218)]+'/'+_0x373ba3+'/_api/Web/lists/GetByTitle(\x27'+_0x3a0695+_0x1034e6(0x1ff)+_0x4990e2+'';$[_0x1034e6(0x2a2)]({'url':_0x3b4e62,'headers':{'Accept':_0x1034e6(0x2cc)},'async':![],'success':function(_0x5ede9f){var _0x17335f=_0x1034e6,_0x4c2c30=_0x5ede9f['d'][_0x17335f(0x1d1)];_0x4c2c30[_0x17335f(0x2ba)]>0x0&&updateShareDocument(_0x4c2c30,_0x262b45,_0x3a0695,_0x234dad,_0x27a66c,_0x46ffdb),console[_0x17335f(0x1c5)](_0x4c2c30);},'eror':function(_0x34ce02){var _0x12a234=_0x1034e6;console[_0x12a234(0x1c5)](_0x34ce02);}});}function GetDocumentsFiles(_0xf61486,_0x5d095e,_0x2bb751,_0x537c63,_0x55dec1,_0x17a626,_0x246b44){var _0x2127a1=a0_0x815881,_0x1ba2e2=_0xf61486[_0x2127a1(0x1db)]('/');_0x1ba2e2=_0x1ba2e2[_0x1ba2e2[_0x2127a1(0x2ba)]-0x1],_0xf61486=_0xf61486[_0x2127a1(0x1db)]('/'+_0x1ba2e2);var _0x5b8e44=[],_0x599823=_spPageContextInfo[_0x2127a1(0x218)]+'/_api/Web/GetFolderByServerRelativeUrl(\x27'+_0xf61486[0x0]+_0x2127a1(0x225);$['ajax']({'url':_0x599823,'headers':{'Accept':_0x2127a1(0x2cc)},'async':![],'success':function(_0xb043e9){var _0x3e2bcd=_0x2127a1,_0x29876d=_0xb043e9['d'][_0x3e2bcd(0x1e6)][_0x3e2bcd(0x1d1)],_0x4492f7=_0x29876d['filter'](function(_0x380991){var _0x5d05e1=_0x3e2bcd;return _0x380991[_0x5d05e1(0x1c2)]['ID']==_0x5d095e;});if(_0x4492f7[_0x3e2bcd(0x2ba)]>0x0){var _0x275f16=_0x4492f7[0x0][_0x3e2bcd(0x1c2)]['Created_x0020_By'];_0x275f16=_0x275f16[_0x3e2bcd(0x1db)](_0x3e2bcd(0x264)),_0x5b8e44['push']({'DocumentType':_0x4492f7[0x0][_0x3e2bcd(0x1c2)][_0x3e2bcd(0x1ea)],'FileLeafRef':_0x4492f7[0x0][_0x3e2bcd(0x21a)],'AuthorEMail':_0x275f16[0x1]}),updateShareDocument(_0x5b8e44,_0x2bb751,_0x537c63,_0x55dec1,_0x17a626,_0x246b44);}},'eror':function(_0xcaa1ff){var _0x314577=_0x2127a1;console[_0x314577(0x1c5)]('error');}});}function getDepartmentalItems(){var _0x508924=a0_0x815881,_0x12b3ea=$(_0x508924(0x28d))[_0x508924(0x1ec)]()[_0x508924(0x2b7)]();_0x12b3ea[_0x508924(0x2ba)]<=0x0&&alert(_0x508924(0x1c4));var _0x5a8c2d=_0x12b3ea['split']('/');_0x5a8c2d=_0x5a8c2d[_0x5a8c2d[_0x508924(0x2ba)]-0x1];var _0x4803ff=_0x12b3ea[_0x508924(0x1db)](_0x5a8c2d),_0x36b608=_0x4803ff[0x0]+'_api/web/Lists/GetByTitle(\x27'+_0x5a8c2d+_0x508924(0x1f4);$[_0x508924(0x2a2)]({'url':_0x36b608,'headers':{'Accept':_0x508924(0x2cc)},'async':![],'success':function(_0xbdfce5){var _0x55457f=_0x508924,_0x385360=_0xbdfce5['d'][_0x55457f(0x1d1)];for(var _0x5a28ec=0x0;_0x5a28ec<_0x385360['length'];_0x5a28ec++){getShareDocumentItemsById(_0x4803ff[0x0],_0x5a8c2d,_0x385360[_0x5a28ec]['ID']),_0x385360[_0x55457f(0x2ba)]==_0x5a28ec+0x1&&alert(_0x55457f(0x1ce));}},'error':function(_0x27c3e8){var _0x49fd07=_0x508924;console[_0x49fd07(0x1c5)](_0x27c3e8);}});}function getShareDocumentItemsById(_0x4b1f26,_0x34aeb1,_0x306a39){var _0x794a0a=a0_0x815881,_0xc850be=_0x4b1f26;$[_0x794a0a(0x2a2)]({'url':_spPageContextInfo[_0x794a0a(0x218)]+'/_api/web/lists/getByTitle(\x27SharedDocument\x27)/items/?$select=*&$filter=DocumentID\x20eq\x20\x27'+_0x306a39+'\x27','method':_0x794a0a(0x20a),'async':![],'headers':{'Accept':'application/json;odata=verbose'},'success':function(_0x131287,_0x1b417a,_0x4ff846){var _0x64ea18=_0x794a0a,_0x25c9e3=_0x131287['d'][_0x64ea18(0x1d1)];if(_0x25c9e3[_0x64ea18(0x2ba)]>0x0){}else updateDocumentPropertiesOnItemSharing(_0xc850be,_0x34aeb1,_0x306a39);},'error':function(_0x361143){var _0x26bda1=_0x794a0a;console[_0x26bda1(0x1c5)](_0x361143);}});}function GetItemTypeForListNames(_0x4c442a){var _0x263a26=a0_0x815881;return _0x263a26(0x2c5)+_0x4c442a['charAt'](0x0)[_0x263a26(0x1cb)]()+_0x4c442a[_0x263a26(0x1db)]('\x20')[_0x263a26(0x2b3)]('')['slice'](0x1)+'ListItem';}function updateDocumentPropertiesOnItemSharing(_0x44464f,_0x20747b,_0x3f58a3){var _0x158e0,_0x4018e0='SP.Data.'+_0x20747b+'Item',_0x4b4c2a=[];_0x158e0={'__metadata':{'type':_0x4018e0},'SharedId':{'results':_0x4b4c2a}},updateItemWithIDItemListDocuments(_0x44464f,_0x20747b,_0x158e0,_0x3f58a3);}function updateItemWithIDItemListDocuments(_0x176465,_0x1ab73d,_0x52cff0,_0x88158e){var _0x207dff=a0_0x815881,_0x15ad23=_0x176465+_0x207dff(0x263)+_0x1ab73d+'\x27)/Items('+_0x88158e+')';$[_0x207dff(0x2a2)]({'url':_0x15ad23,'type':_0x207dff(0x2d2),'async':![],'headers':{'accept':_0x207dff(0x2cc),'X-RequestDigest':$(_0x207dff(0x245))[_0x207dff(0x1ec)](),'content-Type':_0x207dff(0x2cc),'X-Http-Method':_0x207dff(0x297),'If-Match':'*'},'data':JSON['stringify'](_0x52cff0),'success':function(_0x3d316e){var _0x361436=_0x207dff;console[_0x361436(0x1c5)](_0x3d316e);},'error':function(_0xf1d0c0){var _0x159b86=_0x207dff;alert(_0xf1d0c0[_0x159b86(0x2c6)][_0x159b86(0x29d)]['message'][_0x159b86(0x253)]);}});}function getDataFromShareDocument(){var _0x88cc40=a0_0x815881,_0x215a67=URL;$[_0x88cc40(0x2a2)]({'url':_spPageContextInfo[_0x88cc40(0x218)]+_0x88cc40(0x1dd),'method':'GET','async':![],'headers':{'Accept':_0x88cc40(0x2cc)},'success':function(_0xaf1a3b,_0x2d7008,_0x2eda78){var _0x20b896=_0x88cc40,_0x48cccb=_0xaf1a3b['d'][_0x20b896(0x1d1)];if(_0x48cccb['length']>0x0){for(let _0x3d0ea8=0x0;_0x3d0ea8<_0x48cccb[_0x20b896(0x2ba)];_0x3d0ea8++){FillCompanyCompanyAndDepartmentIdInShareDocument(_0x48cccb[_0x3d0ea8]['ID'],_0x48cccb[_0x3d0ea8][_0x20b896(0x1e1)]);}alert(_0x20b896(0x294));}else alert(_0x20b896(0x219));},'error':function(_0x5b22d2){var _0x1e4f32=_0x88cc40;console[_0x1e4f32(0x1c5)](_0x5b22d2);}});}function FillCompanyCompanyAndDepartmentIdInShareDocument(_0x15d570,_0x51428f){var _0x4c4f63=a0_0x815881,_0x34036e,_0x47f3d6='SharedDocument';if(_0x51428f!=null)var _0x51428f=_0x51428f[_0x4c4f63(0x1db)](_0x4c4f63(0x1d7))[0x0];var _0x2e4721=departmentArr[_0x4c4f63(0x293)](function(_0x51efa1){return _0x51efa1['SiteURL']==_0x51428f;});if(_0x2e4721[_0x4c4f63(0x2ba)]>0x0){var _0x45572a=_0x4c4f63(0x257);_0x34036e={'__metadata':{'type':_0x45572a},'CompanyIDId':_0x2e4721[0x0][_0x4c4f63(0x238)],'DepartmentIDId':_0x2e4721[0x0][_0x4c4f63(0x22f)]};var _0x176e84=_spPageContextInfo[_0x4c4f63(0x218)]+_0x4c4f63(0x2a5)+_0x15d570+')';$['ajax']({'url':_0x176e84,'type':_0x4c4f63(0x2d2),'async':![],'headers':{'accept':_0x4c4f63(0x2cc),'X-RequestDigest':$('#__REQUESTDIGEST')[_0x4c4f63(0x1ec)](),'content-Type':_0x4c4f63(0x2cc),'X-Http-Method':'PATCH','If-Match':'*'},'data':JSON[_0x4c4f63(0x20f)](_0x34036e),'success':function(_0x6aa3eb){var _0x20f039=_0x4c4f63;console[_0x20f039(0x1c5)](_0x6aa3eb);},'error':function(_0x1454dd){var _0x55e5cd=_0x4c4f63;alert(_0x1454dd[_0x55e5cd(0x2c6)]['message'][_0x55e5cd(0x253)]);}});}}var departmentArr=[];function GetDepartmentUrl(){var _0xe5060a=a0_0x815881,_0x3bd56a=_spPageContextInfo[_0xe5060a(0x218)]+_0xe5060a(0x25e);$[_0xe5060a(0x2a2)]({'url':_0x3bd56a,'headers':{'Accept':'application/json;odata=verbose'},'async':![],'success':function(_0x3fedf5){var _0x122319=_0xe5060a,_0x52c62e=_0x3fedf5['d']['results'];if(_0x52c62e[_0x122319(0x2ba)]>0x0)for(let _0x325e2d=0x0;_0x325e2d<_0x52c62e[_0x122319(0x2ba)];_0x325e2d++){departmentArr[_0x122319(0x267)]({'SiteURL':_0x52c62e[_0x325e2d][_0x122319(0x276)],'DeptId':_0x52c62e[_0x325e2d]['ID'],'ComId':_0x52c62e[_0x325e2d]['CompanyIDId']});}console[_0x122319(0x1c5)](departmentArr);},'eror':function(_0x5db327){var _0x54922b=_0xe5060a;console[_0x54922b(0x1c5)](_0x5db327);}});}function GetDMSDocuments(){var _0x396a9c=a0_0x815881,_0x34c668=$('#sharedDmsURL')[_0x396a9c(0x1ec)]();if(_0x34c668=='')return alert('please\x20enter\x20DMS\x20url'),![];var _0x57b774=_0x34c668+_0x396a9c(0x289);$[_0x396a9c(0x2a2)]({'url':_0x57b774,'headers':{'Accept':_0x396a9c(0x2cc)},'async':![],'success':function(_0x1bfda0){var _0x23836d=_0x396a9c,_0x1da47a=_0x1bfda0['d'][_0x23836d(0x1d1)];arrMetadata=[];if(_0x1da47a['length']>0x0){arrMetadata=_0x1da47a,console[_0x23836d(0x1c5)](arrMetadata);for(var _0x19a1c7=0x0;_0x19a1c7<_0x1da47a[_0x23836d(0x2ba)];_0x19a1c7++){getShareDocumentItemsByTitle(_0x19a1c7,_0x1da47a[_0x19a1c7]['ID'],_0x1da47a[_0x19a1c7][_0x23836d(0x1f2)]['Name']);}alert(_0x23836d(0x216));}else alert(_0x23836d(0x219));},'error':function(_0x2dd91f){var _0x246145=_0x396a9c;alert(_0x246145(0x248));}});}var arrMetadata=[];function CopyDmsToSharedocumentItems(_0x5e592c){var _0x20db5c=a0_0x815881,_0x45591c,_0x490573='SharedDocument',_0x16d706=arrMetadata[_0x5e592c][_0x20db5c(0x220)];_0x16d706==_0x20db5c(0x213)?_0x16d706=!![]:_0x16d706=![];var _0x97a091=String(arrMetadata[_0x5e592c]['Id']);if(arrMetadata['length']>0x0){var _0x2c6515=_0x20db5c(0x257);_0x45591c={'__metadata':{'type':_0x2c6515},'CompanyIDId':CompanyID,'DepartmentIDId':$(_0x20db5c(0x21e))[_0x20db5c(0x1ec)](),'DocumentID':_0x97a091,'Title':arrMetadata[_0x5e592c][_0x20db5c(0x1f2)]['Name']?arrMetadata[_0x5e592c][_0x20db5c(0x1f2)][_0x20db5c(0x281)]:'','DocumentNo':arrMetadata[_0x5e592c][_0x20db5c(0x2ac)]?arrMetadata[_0x5e592c]['DocumentNo']:'','DocType':arrMetadata[_0x5e592c][_0x20db5c(0x1ea)]?arrMetadata[_0x5e592c][_0x20db5c(0x1ea)]:'','DocumentType':_0x20db5c(0x1f2),'NeedAcknowledgement':_0x16d706,'Department':$(_0x20db5c(0x21e))['text'](),'Details':arrMetadata[_0x5e592c]['Details']?arrMetadata[_0x5e592c][_0x20db5c(0x252)]:'','SubCategory':arrMetadata[_0x5e592c]['SubCategory']?arrMetadata[_0x5e592c]['SubCategory']:'','SharedGroup':arrMetadata[_0x5e592c][_0x20db5c(0x290)]?arrMetadata[_0x5e592c][_0x20db5c(0x290)]:'','PermissionType':_0x20db5c(0x284),'DocumentURL':arrMetadata[_0x5e592c]['File']['ServerRelativeUrl'],'LibraryName':_0x20db5c(0x231),'SiteURL':$(_0x20db5c(0x1f5))[_0x20db5c(0x1ec)](),'LibraryURL':$(_0x20db5c(0x1f5))[_0x20db5c(0x1ec)]()+'/DepartmentalDMS'};var _0x59b53d=_spPageContextInfo[_0x20db5c(0x218)]+_0x20db5c(0x2b4);$[_0x20db5c(0x2a2)]({'url':_0x59b53d,'type':_0x20db5c(0x2d2),'async':![],'headers':{'accept':'application/json;odata=verbose','X-RequestDigest':$('#__REQUESTDIGEST')[_0x20db5c(0x1ec)](),'content-Type':_0x20db5c(0x2cc)},'data':JSON[_0x20db5c(0x20f)](_0x45591c),'success':function(_0x1d098f){var _0x689c18=_0x20db5c;console[_0x689c18(0x1c5)](_0x1d098f);},'error':function(_0x66410){var _0x37fb4a=_0x20db5c;alert(_0x66410[_0x37fb4a(0x2bd)]);}});}}function getShareDocumentItemsByTitle(_0x11ef4e,_0x5c8488,_0x4f267a){var _0x25f2e7=a0_0x815881,_0x282ce5=_spPageContextInfo['webAbsoluteUrl']+'/_api/web/lists/getByTitle(\x27SharedDocument\x27)/items/?$filter=SharedGroup\x20eq\x20\x27Everyone\x27\x20and\x20Title\x20eq\x20\x27'+_0x4f267a+_0x25f2e7(0x22e)+_0x5c8488+_0x25f2e7(0x28e);$[_0x25f2e7(0x2a2)]({'url':_0x282ce5,'method':'GET','async':![],'headers':{'Accept':_0x25f2e7(0x2cc)},'success':function(_0x226820,_0x22efe4,_0x2532a0){var _0x50cb31=_0x226820['d']['results'];_0x50cb31['length']==0x0&&CopyDmsToSharedocumentItems(_0x11ef4e);},'error':function(_0x27f98e,_0x4c64e8,_0x410b23){var _0x19d4da=_0x25f2e7;console[_0x19d4da(0x1c5)](_0x27f98e['responseText']);}});}function a0_0x460f(_0x16f3c6,_0x4813a4){var _0x181562=a0_0x1815();return a0_0x460f=function(_0x460f65,_0x11050b){_0x460f65=_0x460f65-0x1bf;var _0x99101d=_0x181562[_0x460f65];return _0x99101d;},a0_0x460f(_0x16f3c6,_0x4813a4);}var departmentItemsArr=[],CompanyID='';function LoadAllDepartment(){var _0x5cda7e=a0_0x815881;$(_0x5cda7e(0x21e))[_0x5cda7e(0x255)]();var _0x2fc984=_spPageContextInfo['webAbsoluteUrl']+_0x5cda7e(0x1d8);$[_0x5cda7e(0x2a2)]({'url':_0x2fc984,'headers':{'Accept':'application/json;odata=verbose'},'async':!![],'success':function(_0x13f236){var _0x172378=_0x5cda7e;for(var _0xe848ba=0x0;_0xe848ba<_0x13f236['d'][_0x172378(0x1d1)]['length'];_0xe848ba++){departmentItemsArr['push']({'SiteURL':_0x13f236['d'][_0x172378(0x1d1)][_0xe848ba][_0x172378(0x276)],'ID':_0x13f236['d'][_0x172378(0x1d1)][_0xe848ba]['ID'],'CompanyID':_0x13f236['d'][_0x172378(0x1d1)][_0xe848ba][_0x172378(0x21b)]}),$(_0x172378(0x21e))[_0x172378(0x2bc)](_0x172378(0x28f)+_0x13f236['d'][_0x172378(0x1d1)][_0xe848ba]['ID']+'\x22>'+_0x13f236['d'][_0x172378(0x1d1)][_0xe848ba][_0x172378(0x21a)]+'</option>'),$('#sharedDmsURL')['val'](_0x13f236['d']['results'][0x0]['SiteURL']);}console[_0x172378(0x1c5)](departmentItemsArr);},'myError':function(_0x5aa30e){}});}function departmentOnChange(){var _0xfa0c20=a0_0x815881;$(_0xfa0c20(0x21e))[_0xfa0c20(0x1cd)](function(){departmentItemsArr['filter'](function(_0xda81ae){var _0x4f9a82=a0_0x460f;_0xda81ae['ID']==$('#DepartmentDDL')[_0x4f9a82(0x1ec)]()&&($(_0x4f9a82(0x1f5))[_0x4f9a82(0x1ec)](_0xda81ae['SiteURL']),CompanyID=_0xda81ae['CompanyID']);});});}