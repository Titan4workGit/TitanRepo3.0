var a0_0x176401=a0_0x2225;(function(_0x23e548,_0x1b4af1){var _0x3796bc=a0_0x2225,_0x22d6c6=_0x23e548();while(!![]){try{var _0x351b15=-parseInt(_0x3796bc(0x110))/0x1+-parseInt(_0x3796bc(0x183))/0x2*(-parseInt(_0x3796bc(0x1af))/0x3)+parseInt(_0x3796bc(0x140))/0x4*(parseInt(_0x3796bc(0x1ad))/0x5)+parseInt(_0x3796bc(0x18b))/0x6*(parseInt(_0x3796bc(0x171))/0x7)+parseInt(_0x3796bc(0xf4))/0x8+parseInt(_0x3796bc(0x139))/0x9*(parseInt(_0x3796bc(0x18d))/0xa)+-parseInt(_0x3796bc(0x18a))/0xb*(parseInt(_0x3796bc(0x103))/0xc);if(_0x351b15===_0x1b4af1)break;else _0x22d6c6['push'](_0x22d6c6['shift']());}catch(_0x346226){_0x22d6c6['push'](_0x22d6c6['shift']());}}}(a0_0x4037,0x93222),$(document)[a0_0x176401(0x146)](function(){var _0x5bbf14=a0_0x176401,_0x111dcd=$('#btnSubmit')[_0x5bbf14(0x147)](_0x5bbf14(0x153))['val']();GetDepartmentUrl(),LoadAllDepartment(),departmentOnChange(),$(_0x5bbf14(0x15c))['click'](function(){getDataFromShareDocument();}),$('#btnCreateCustomColumn')[_0x5bbf14(0xd6)](function(){createNewCustomColumn();}),$(_0x5bbf14(0x14f))[_0x5bbf14(0xd6)](function(){addEnvironmentalSettingsEntry();}),$('#btnFilProject')['click'](function(){getProjects();}),$(_0x5bbf14(0xc0))[_0x5bbf14(0xd6)](function(){getDepartmentalItems();}),$(_0x5bbf14(0x14e)),$(_0x5bbf14(0x18e))[_0x5bbf14(0xd6)](function(){AddCustomer();}),$(_0x5bbf14(0x17b))[_0x5bbf14(0xd6)](function(){CreateListColumns();}),$(_0x5bbf14(0x134))[_0x5bbf14(0xd6)](function(){Addemployee();}),$(_0x5bbf14(0x1b2))[_0x5bbf14(0xd6)](function(){AddCommentInAnnouncement();}),$(_0x5bbf14(0x176))[_0x5bbf14(0xd6)](function(){addProjectkDetails();}),$('#btnChangePriority')['click'](function(){var _0x3200de=_0x5bbf14;confirm(_0x3200de(0x19d))&&ChangePriority();}),$('#btnFillAssignedByTask')['click'](function(){var _0x4eb784=_0x5bbf14;confirm(_0x4eb784(0x19d))&&getBlankAssignedBy();}),$('#btnUpdateTaskCounter')['click'](function(){var _0x5780ca=_0x5bbf14;confirm(_0x5780ca(0x19d))&&(waitingDialog[_0x5780ca(0xe7)](),setTimeout(function(){getInternalEmployees();},0x1f4));}),$(_0x5bbf14(0x15e))['click'](function(){ChangeCompanyId();}),$(_0x5bbf14(0x127))['click'](function(){var _0x326428=_0x5bbf14;confirm(_0x326428(0x19d))&&(waitingDialog[_0x326428(0xe7)](),setTimeout(function(){fileShareDocumentColumn();},0x1f4));}),$('#btnTaskItemByTaskCategory')[_0x5bbf14(0xd6)](function(){var _0x5f1cd3=_0x5bbf14;confirm('The\x20related\x20MS\x20Flow\x20must\x20be\x20stopped.\x20\x0a\x20Do\x20want\x20to\x20continue\x20?')&&(waitingDialog[_0x5f1cd3(0xe7)](),setTimeout(function(){getTaskItemByTaskCategory();},0x1f4));});}));var TaskAssignTo=[0x74,0x14,0x20];function addEmployeeTaskDetails(){var _0x348ee2=a0_0x176401,_0x8321f4=_0x348ee2(0xb0),_0x2b9277=new Date(),_0x5cd78d=_0x2b9277[_0x348ee2(0x1a9)]()[_0x348ee2(0xd9)](0x0,0x32);for(var _0x31a1d0=0x1;_0x31a1d0<=0x1f4;_0x31a1d0++){var _0x3782d1=_0x348ee2(0xef)+_0x31a1d0,_0x46332a;_0x46332a={'__metadata':{'type':_0x348ee2(0x16e)},'TaskAssignToId':{'results':TaskAssignTo},'Title':_0x3782d1,'CurrentPhase':'Open','TaskType':_0x348ee2(0x149),'StartDate':_0x5cd78d,'DueDate':_0x348ee2(0xc1),'TaskPriority':_0x348ee2(0x11b),'Worktype':_0x348ee2(0x194),'Distribution':_0x348ee2(0x10a),'CompanyId':Logged_CompanyId},$[_0x348ee2(0x17c)](AddItemEmp(_0x8321f4,_0x46332a))[_0x348ee2(0xea)](function(_0x3caa07){_0x31a1d0==0x1f4&&alert('Submit\x20successfully');});}}function addProjectkDetails(){var _0xab83b5=a0_0x176401,_0x1c39d5='ProjectDetails',_0x119532=_0xab83b5(0x164),_0x468dfc=new Date(),_0x397186=new Date('26/5/2022'),_0x1ffbad=_0x468dfc[_0xab83b5(0x1a9)]()[_0xab83b5(0xd9)](0x0,0x32);for(var _0x208557=0xbb8;_0x208557<=0x1388;_0x208557++){var _0x2d20a0='TestProject'+_0x208557,_0x4137f1;_0x4137f1={'__metadata':{'type':'SP.Data.ProjectDetailsListItem'},'Title':_0x2d20a0,'ProjectCode':_0xab83b5(0xc4),'ProjectName':_0x2d20a0,'ProjectDescription':_0x119532,'ProjectSiteURL':'','DepartmentId':'50','Department_IDId':Logged_DepartmentId,'ActualStartDate':_0x1ffbad,'PlanedStartDate':_0x1ffbad,'PlanedEndDate':_0xab83b5(0x13e),'TechnologyUsed':'','Status':'Live','DepartmentName':'50','ManagerNameId':0x20,'OfficeLocation':_0xab83b5(0x10e),'Domain':_0xab83b5(0x160),'Office_Location_IdId':Logged_Location,'CompanyId':'2','ClientIDId':0x3,'ProgramIDId':0x2},$[_0xab83b5(0x17c)](AddItemEmp(_0x1c39d5,_0x4137f1))[_0xab83b5(0xea)](function(_0x5530aa){_0x208557==0x1388&&alert('Submit\x20successfully');});}}function AddItemEmp(_0x16ba52,_0x305045){var _0x31f1cf=a0_0x176401,_0x22c32e=$[_0x31f1cf(0x131)](),_0x21931f=_spPageContextInfo[_0x31f1cf(0xab)]+_0x31f1cf(0xd2)+_0x16ba52+'\x27)/Items';return $['ajax']({'url':_0x21931f,'type':_0x31f1cf(0xf6),'async':![],'headers':{'accept':_0x31f1cf(0x138),'X-RequestDigest':$(_0x31f1cf(0xc5))['val'](),'content-Type':'application/json;odata=verbose'},'data':JSON[_0x31f1cf(0x193)](_0x305045),'success':function(_0x5272fa){var _0x5dd8c=_0x31f1cf;_0x22c32e[_0x5dd8c(0x123)](_0x5272fa);},'error':function(_0x2237d3){var _0x21975d=_0x31f1cf;alert(JSON[_0x21975d(0x193)](_0x2237d3)),_0x22c32e['reject'](_0x2237d3);}}),_0x22c32e['promise']();}function AddCustomer(){var _0x127a2d=a0_0x176401,_0x2cfcae='';for(var _0x2b9e1d=0x1;_0x2b9e1d<=0x1f4;_0x2b9e1d++){var _0x568703='',_0x39dab2='';_0x2cfcae=_0x127a2d(0x1b0)+_0x2b9e1d;var _0x4ce6db='Demo'+_0x2b9e1d+'@x.com',_0x1f1c1d=_0x127a2d(0xcc)+_0x2b9e1d,_0x2d878b=_0x127a2d(0x161),_0x4f6009='',_0x4b0f88='',_0x359b7c='',_0xfdb8ce=_0x127a2d(0x1b0),_0x66223c='',_0x5a6c75='Gust',_0x316ca4='',_0xc06577=_0x127a2d(0x180),_0x283cfc;_0x283cfc={'__metadata':{'type':_0x127a2d(0x13c)},'Title':_0x2cfcae,'Client_Code':_0x127a2d(0x1a3),'Attn_Name':_0x1f1c1d,'BillingAddress':_0x568703,'EmailId':_0x4ce6db,'Country':_0x39dab2,'IsActive':!![],'City':_0x2d878b,'State':'Up','SalesPersonId':TaskAssignTo[0x0],'InternalMembersId':{'results':TaskAssignTo},'TemplateType':'Template1','InternalSupervisorId':TaskAssignTo[0x1],'CustType':_0x127a2d(0x132),'Contact_No':_0x127a2d(0x11d),'CompanyIDId':Logged_CompanyId},$[_0x127a2d(0x17c)](AddItemEmp(_0xc06577,_0x283cfc))['done'](function(_0x2613de){var _0x3764c7=_0x127a2d;_0x2b9e1d==0x1f4&&alert(_0x3764c7(0x196));});}}function Create_List(){var _0x4b2686=a0_0x176401;createList(_0x4b2686(0x15f));}function createList(_0x314112){var _0x4dc950=a0_0x176401,_0x27def6=_spPageContextInfo[_0x4dc950(0xab)]+'/_api/web/lists';$[_0x4dc950(0x19a)]({'url':_0x27def6,'type':_0x4dc950(0xf6),'data':JSON[_0x4dc950(0x193)]({'__metadata':{'type':_0x4dc950(0x186)},'BaseTemplate':0x65,'Title':_0x314112}),'headers':{'accept':'application/json;odata=verbose','content-type':_0x4dc950(0x138),'X-RequestDigest':$('#__REQUESTDIGEST')[_0x4dc950(0xbb)]()},'success':onQuerySucceeded,'error':onQueryFailed});}function onQuerySucceeded(_0x3b336f){var _0x52edfa=a0_0x176401;alert(_0x3b336f['d'][_0x52edfa(0xcb)]+_0x52edfa(0x129));}function onQueryFailed(){alert('Error!');}function a0_0x4037(){var _0x558a46=['ServerRelativeUrl','ApprovedByOutsider','application/json;odata=verbose','1901619SxYPRm','FieldTypeKind','value','SP.Data.ClientMasterListItem','All\x20Task\x27s\x20\x27Assigned\x20By\x27\x20column\x20have\x20been\x20set.','2022-10-26T12:10:10.641Z','CommentCount','2343512bfZrhz','Read','items','responseText','membership|','Logger','ready','find','SP.Field','General\x20task','/_api/web/lists/getbytitle(\x27','/_api/web/lists/getbytitle(\x27ApplicationLink\x27)/GetItemById(','DELETE','Status','input[name=\x27optradio\x27]:checked','#btnenvironmental','Primary','?$top=5000&$select=*,Author/EMail,Author/Title,Author/Id&$Expand=Author&$OrderBy=Modified\x20asc','setHours','.panel-heading-bg-txt-clr','/_api/web/lists/getbytitle(\x27EmployeeTaskDetails\x27)/GetItemById(\x27','CompanyIDId','\x27)/fields/getbytitle(','/Titan/InformationTechnology22255/_api/web/lists/getByTitle(\x27DepartmentalDMS\x27)/fields','SharedUsersId','SP.Data.EmployeeTaskCounterListItem','#DepartmentDDL','.radioBtnClass','#btnFillcompanyAndDepartmentId','append','#btnChangeCompanyId','Test\x20by\x20lakhan','ABC','New\x20York','orderBy','lakhan.sharma@adapt-india.com','A\x20pie\x20chart\x20(or\x20a\x20circle\x20chart)\x20is\x20a\x20circular\x20statistical\x20graphic,\x20which\x20is\x20divided\x20into\x20slices\x20to\x20illustrate\x20numerical\x20proportion.\x20In\x20a\x20pie\x20chart,\x20the\x20arc\x20length\x20of\x20each\x20slice\x20(and\x20consequently\x20its\x20central\x20angle\x20and\x20area),\x20is\x20proportional\x20to\x20the\x20quantity\x20it\x20represents.\x20While\x20it\x20is\x20named\x20for\x20its\x20resemblance\x20to\x20a\x20pie\x20which\x20has\x20been\x20sliced,\x20there\x20are\x20variations\x20on\x20the\x20way\x20it\x20can\x20be\x20presented.\x20The\x20earliest\x20known\x20pie\x20chart\x20is\x20generally\x20credited\x20to\x20William\x20Playfair\x20ie\x20charts\x20are\x20very\x20widely\x20used\x20in\x20the\x20business\x20world\x20and\x20the\x20mass\x20media.[3]\x20However,\x20they\x20have\x20been\x20criticized,[4]\x20and\x20many\x20experts\x20recommend\x20avoiding\x20them,[5][6][7][8]','/_api/web/lists/getbytitle(\x27Departments\x27)/items?select=*,ID,Title&$orderby=Title\x20asc&$top=5000','text','/_api/web/lists/getbytitle(\x27Departments\x27)/items?$select=CompanyIDId,ID,Title,SiteURL','No\x20record\x20found','FileValidity','</option>','/sites/','/_api/web/Lists/GetByTitle(\x27DepartmentalDMS\x27)/Items?$select=*,ID,DocumentWrittenBy,Modified,Editor/EMail,Editor/Title,File_x0020_Type,DocumentType,Title,AccessLevel,File/Name,File/ServerRelativeUrl&$top=5000&$expand=File,Editor/Id&$orderby=Modified\x20desc&$filter=startswith(AccessLevel,\x20\x27Everyone\x27)\x20and\x20ApprovalStatus\x20eq\x20\x27Approved\x27','message','SP.Data.EmployeeTaskDetailsListItem','then','PATCH','802151ZzPfoD','\x27)\x20and\x20(Status\x20eq\x20\x27Initiated\x27\x20or\x20Status\x20eq\x20\x27Forwarded\x27))','SP.Data.','Details','SiteURL','#btnaddProject','LibraryURL','ListItemAllFields','results','_api/web/Lists/GetByTitle(\x27','#btnCreateCustomColumns','when','No\x20Task\x20with\x20Priority\x20\x27Top\x27\x20has\x20been\x20found.','true','\x27\x20or\x20DependencyTo/EMail\x20eq\x20\x27','ClientMaster','getAll','DocumentID','231468BwBDLj','Lakhan\x20sharma','Successfully.','SP.List','\x27\x20and\x20DocumentID\x20eq\x20','userId','Not\x20Required','11IEChhb','36Qybxly','#HistoryURL','10YwnWIF','#btncustomer','Outbox','Titan_Permission','/_api/Web/lists/GetByTitle(\x27','Acknowledgement','stringify','Fixed\x20Bugs','#sharedDmsURL','Submit\x20successfully','/_api/web/lists/getByTitle(\x27','lists','Parent','ajax','MM/DD/YYYY','join','The\x20related\x20MS\x20Flow\x20must\x20be\x20stopped.\x20\x0a\x20Do\x20want\x20to\x20continue\x20?','AccessLevel','ApprovalTaskList','Employees','/_api/web/lists/getByTitle(\x27ApplicationLink\x27)/items/?$top=5000&$filter=Company/ID\x20ne\x20null&$select=*,Company/ID,Id&$expand=Company&$OrderBy=Modified\x20asc','responseJSON','205','/_api/web/lists/getByTitle(\x27SharedDocument\x27)/items/?$select=*&$filter=DocumentID\x20eq\x20\x27','ComId','SP.FieldDateTime','\x27)/items','getDate','toISOString','SubCategory','Please\x20enter\x20DMS\x20url','EmployeeTaskCounter','10eKXnyv','/_api/web/lists/getByTitle(\x27SharedDocument\x27)/items/?$select=ID,LibraryURL&$filter=LibraryName\x20eq\x20\x27DepartmentalDMS\x27\x20and\x20CompanyIDId\x20eq\x20null\x20and\x20DepartmentIDId\x20eq\x20null&$top5000','21AEKzPE','Adapt','\x27)/fields/getbytitle(\x27','#btnaddComment','File','hide','DepartmentalDMS','expand','All\x20counters\x20have\x20been\x20updated.','webAbsoluteUrl','/sites/Titan_2_2_1_DEV/Lists/Employees/Attachments/400/dipankar1.jpg','Update\x20successfully','Created_x0020_By','?$top=5000&$select=*,UserId/Id,UserId/EMail&$expand=UserId&$filter=UserId/EMail\x20eq\x20\x27','EmployeeTaskDetails','LoginName','#txtSubsiteURL','Shared\x20With','Info','GuestUser','ApplicationLink','__metadata','slice','Employee','email','val','All\x20ready\x20Add\x20','Shared','\x27)/Items?$select=ID,*&$top=5000&$filter=SharedId\x20ne\x20null','promise','#btnSharingHistory','01/01/2023','DocumentNo','ApprovedBy','2540D','#__REQUESTDIGEST','setDate','DeptId','/DepartmentalDMS','Created\x20successfully\x20!','SP.Data.SharedDocumentListItem','Title','Lakhan','Updated\x20Description\x20of\x20the\x20field','/_api/Web/GetFolderByServerRelativeUrl(\x27','web','LogonName','SP.Data.EmployeesListItem','/_api/web/Lists/GetByTitle(\x27','Item','each','N/A','click','Author','email_date','substring','Inbox','Approval','Banner','ConsoleListener','split','\x27)/Items(','AnnouncementsChild','subscribe','ApprovedDate','/Titan/IT/_api/web/lists/getByTitle(\x27KnowledgeBaseCategory\x27)/Items?$select=GUID','\x27)/items/','/_api/web/lists/getByTitle(\x27SharedDocument\x27)/items/?$filter=SharedGroup\x20eq\x20\x27Everyone\x27\x20and\x20Title\x20eq\x20\x27','&$filter=((Author/EMail\x20eq\x20\x27','show','SP.FieldUser','CompanyID','done','DocumentType','SharedDocument','empty','Please\x20select\x20radio\x20button','TestTask','/_api/web/lists/getbytitle(\x27SharedDocument\x27)/GetItemById(','error','&$filter=((TaskAssignTo/EMail\x20eq\x20\x27','/_api/Web/Lists/getByTitle(\x27SharedDocument\x27)/Items(','7359056bLdhCo','Active','POST','format','\x27)/fields','AuthorEMail','Approved','ID,Status,LogonName/EMail,LogonName/ID,Email','Please\x20Enter\x20DMS\x20site\x20URl','getByTitle','SharedUsers','Failed','Updated\x20','GET','Required','34823172OjviYP','\x27)/Items?$select=*,Author/EMail,Author/Title,FileRef,FileLeafRef&$expand=Author/Title&$filter=ID\x20eq\x20','toUpperCase','An\x20error\x20occurred\x20while\x20deleting\x20task.\x20','/_api/web/lists/getbytitle(\x27EmployeeTaskCounter\x27)/GetItemById(\x27','_api/Web/Lists/getByTitle(\x27','No\x20Task\x20with\x20blank\x20\x27Assigned\x20By\x27\x20value\x20has\x20been\x20found.','Consolidated',':checked','select','DocumentManagementSystem','Gurgaon\x20Main\x20Office','DocumentURL','296036ptrupj','\x27\x20or\x20AssignedBy/EMail\x20eq\x20\x27','Male','log','Delete\x20Success\x20','ListItem','length','\x27)?$select=*,Author/EMail,File_x0020_Type&$top=5000&$expand=Author/EMail,Folders,Folders/ListItemAllFields,Files,Folders/ListItemAllFields/Created_x0020_By,Files/ListItemAllFields/Created_x0020_By,Files/ListItemAllFields&$orderby=ListItemAllFields/TimeLastModified\x20desc','/DocumentManagementSystem','Draft','DueDate','Medium','reject','02546580','ID,Status,LoginName/EMail,LoginName/ID,email','?$top=5000&$select=*,ClientID/ID,ClientID/Title,Module/Title,Module/ID,AssignedBy/EMail,AssignedBy/Title,AssignedBy/Id,Author/Title,Author/EMail,DependencyTo/EMail,DependencyTo/Title,TaskAssignTo/EMail,TaskAssignTo/Title,TaskAssignTo/ID,AttachmentFiles&$Expand=ClientID,Module,Author,AssignedBy,AttachmentFiles,TaskAssignTo,DependencyTo&$OrderBy=Modified\x20asc','PermissionLevelId','push','SP.FieldChoice','resolve','get','please\x20enter\x20DMS\x20url','Successfully\x20done!','#btnDocumentColumn','trim','\x20successfully\x20created!','filter','/_api/web/lists/getByTitle(\x27EmployeeTaskDetails\x27)/items/?$top=5000&$filter=TaskPriority\x20eq\x20\x27Top\x27&$select=Id,TaskPriority&$OrderBy=Modified\x20asc','lastIndexOf','LogLevel','forEach','Email','EMail','Deferred','Guest','charAt','#btnAddEmployee','&$filter=((Approvers/EMail\x20eq\x20\x27'];a0_0x4037=function(){return _0x558a46;};return a0_0x4037();}function Addemployee(){var _0x465fb7=a0_0x176401,_0x1f2c1c=_0x465fb7(0x1a0),_0x379b08=new Date(),_0x46307f=_0x379b08[_0x465fb7(0x1a9)]()[_0x465fb7(0xd9)](0x0,0x32),_0x5eb1c7;for(var _0x86ae9e=0x0;_0x86ae9e<=0x12c;_0x86ae9e++){_0x5eb1c7={'__metadata':{'type':_0x465fb7(0xd1)},'LogonNameId':0x74,'FullName':_0x465fb7(0x184)+_0x86ae9e,'Title':_0x465fb7(0x184)+_0x86ae9e,'ParentId':0x190,'Designation':'BA','Manager':'Dipankar\x20Goswami','ManagerLoginNameId':0x14,'Email':_0x465fb7(0x163),'Gender':_0x465fb7(0x112),'CompanyId':Logged_CompanyId,'DepartmentId':Logged_DepartmentId,'OfficeLocationId':Logged_Location,'Status':_0x465fb7(0xf5),'JoiningDate':_0x46307f,'PrimaryCompany':_0x465fb7(0x150)},$[_0x465fb7(0x17c)](AddItemEmp(_0x1f2c1c,_0x5eb1c7))[_0x465fb7(0xea)](function(_0x4ab49c){var _0x55f7c=_0x465fb7;_0x86ae9e==0x1324&&alert(_0x55f7c(0x196));});}}function AddCommentInAnnouncement(){var _0x441ec8=a0_0x176401,_0xa5899f;for(var _0x43643d=0x1;_0x43643d<=0x3e8;_0x43643d++){var _0x568cdb=_spPageContextInfo[_0x441ec8(0x188)],_0x48fbc5=_0x441ec8(0xac),_0x23dffd=_0x441ec8(0xe0),_0x2040c0={'__metadata':{'type':_0x441ec8(0x173)+_0x23dffd+_0x441ec8(0x115)},'Item_ID':'1357','WebPartName':_0x441ec8(0xdc),'Comment':'test'+_0x43643d,'ReplierId':parseInt(_0x568cdb),'Initials':_0x441ec8(0x199),'ReplyforId':parseInt(_0x568cdb),'UserImage':_0x48fbc5};$[_0x441ec8(0x17c)](AddItemEmp(_0x23dffd,_0x2040c0))[_0x441ec8(0xea)](function(_0x35ed81){var _0x2f1ad4=_0x441ec8;_0x43643d==0x3e8&&alert(_0x2f1ad4(0x196));});}}var arrMeta=[{'FieldTypeKind':0x2,'Title':a0_0x176401(0xc2)},{'FieldTypeKind':0x2,'Title':a0_0x176401(0xeb)},{'FieldTypeKind':0x2,'Title':'DocumentWrittenBy'},{'FieldTypeKind':0x3,'Title':a0_0x176401(0x174)},{'FieldTypeKind':0x14,'Title':'Shared'},{'FieldTypeKind':0x2,'Title':'SubCategory'},{'FieldTypeKind':0x14,'Title':'Shared\x20With'},{'FieldTypeKind':0x2,'Title':a0_0x176401(0x19e)},{'FieldTypeKind':0x2,'Title':'SecurityLevel'},{'FieldTypeKind':0x2,'Title':'PermissionLevel'},{'FieldTypeKind':0x2,'Title':a0_0x176401(0x120)},{'FieldTypeKind':0x6,'Title':a0_0x176401(0x192)},{'FieldTypeKind':0x2,'Title':a0_0x176401(0xdb)},{'FieldTypeKind':0x14,'Title':a0_0x176401(0xc3)},{'FieldTypeKind':0x4,'Title':a0_0x176401(0xe2)},{'FieldTypeKind':0x4,'Title':a0_0x176401(0x169)},{'FieldTypeKind':0x4,'Title':a0_0x176401(0xd8)},{'FieldTypeKind':0x2,'Title':'ApprovedVersion'},{'FieldTypeKind':0x2,'Title':a0_0x176401(0x137)},{'FieldTypeKind':0x9,'Title':a0_0x176401(0x13f)},{'FieldTypeKind':0x3,'Title':a0_0x176401(0x190)}];function CreateListColumn(){var _0x24a555=a0_0x176401;console[_0x24a555(0x113)](arrMeta);for(var _0x55e76a=0x0;_0x55e76a<arrMeta[_0x24a555(0x116)];_0x55e76a++){var _0x237528;_0x237528={'__metadata':{'type':_0x24a555(0xe8),'addToDefaultView':_0x24a555(0x17e)},'FieldTypeKind':arrMeta[_0x55e76a][_0x24a555(0x13a)],'Title':arrMeta[_0x55e76a][_0x24a555(0xcb)],'SelectionMode':0x0,'AllowMultipleValues':!![]},$[_0x24a555(0x19a)]({'url':_spPageContextInfo[_0x24a555(0xab)]+_0x24a555(0x157),'type':_0x24a555(0xf6),'async':![],'data':JSON[_0x24a555(0x193)](_0x237528),'headers':{'Accept':_0x24a555(0x138),'Content-Type':_0x24a555(0x138),'X-RequestDigest':$(_0x24a555(0xc5))[_0x24a555(0xbb)]()},'success':function(_0x1dcea6,_0xe2b5c6,_0x34f029){console['log']('Success'+Title),alert('Created');},'error':function(_0x3a9fb0,_0x515242,_0x158ab3){alert(_0x3a9fb0['responseText']);}});}}function getGUID(){var _0xd19f15=a0_0x176401,_0x1e8da8=_spPageContextInfo['webAbsoluteUrl']+_0xd19f15(0xe3);$[_0xd19f15(0x19a)]({'url':_0x1e8da8,'headers':{'Accept':_0xd19f15(0x138)},'async':![],'success':function(_0x333451){var _0x31b559=_0xd19f15,_0x218911=_0x333451['d']['results'][0x0][_0x31b559(0xb7)];return console[_0x31b559(0x113)](_0x333451['d'][_0x31b559(0x179)][0x0]['__metadata']['uri']),_0x218911['uri'][_0x31b559(0xde)]('guid\x27')[0x1]['split']('\x27)')[0x0],_0x218911;},'error':function(_0x420655){console['log']('Guid\x20Field');}});}function createNewCustomColumn(){var _0x7d5451=a0_0x176401,_0x43aca2=$(_0x7d5451(0xb2))[_0x7d5451(0xbb)]()[_0x7d5451(0x128)](),_0x3c9938=_0x43aca2[_0x7d5451(0x12c)]('/');if(_0x43aca2['length']==0x0)return alert(_0x7d5451(0xfc)),![];if($(_0x7d5451(0x15b))['is'](_0x7d5451(0x10b))==![])return alert(_0x7d5451(0xee)),![];var _0x268804=_0x43aca2[_0x7d5451(0xde)]('/');_0x268804=_0x268804[_0x268804[_0x7d5451(0x116)]-0x1];_0x268804=='/'&&(_0x268804=_0x268804[_0x268804[_0x7d5451(0x116)]-0x2]);for(var _0x4a1a1b=0x0;_0x4a1a1b<arrMeta[_0x7d5451(0x116)];_0x4a1a1b++){var _0x4c1501;GetAllFieldsFromList(_0x43aca2[_0x7d5451(0xb8)](0x0,_0x3c9938),_0x268804,arrMeta[_0x4a1a1b][_0x7d5451(0xcb)]);if(urlValidation==![])return![];if(exists==![]){var _0x1410ed='';_0x1410ed=_0x43aca2[_0x7d5451(0xb8)](0x0,_0x3c9938)+_0x7d5451(0x197)+_0x268804+_0x7d5451(0xf8),arrMeta[_0x4a1a1b][_0x7d5451(0x13a)]==0x6?arrMeta[_0x4a1a1b][_0x7d5451(0xcb)]==_0x7d5451(0x192)?_0x4c1501={'__metadata':{'type':_0x7d5451(0x122),'addToDefaultView':_0x7d5451(0x17e)},'FieldTypeKind':arrMeta[_0x4a1a1b][_0x7d5451(0x13a)],'Title':arrMeta[_0x4a1a1b][_0x7d5451(0xcb)],'Choices':{'results':[_0x7d5451(0x102),_0x7d5451(0x189),_0x7d5451(0xd5)]}}:_0x4c1501={'__metadata':{'type':_0x7d5451(0x122),'addToDefaultView':'true'},'FieldTypeKind':arrMeta[_0x4a1a1b]['FieldTypeKind'],'Title':arrMeta[_0x4a1a1b][_0x7d5451(0xcb)],'Choices':{'results':[_0x7d5451(0x119),_0x7d5451(0xfa),'Pending','Rejected']}}:arrMeta[_0x4a1a1b]['FieldTypeKind']!=0x7&&(_0x4c1501={'__metadata':{'type':_0x7d5451(0x148),'addToDefaultView':_0x7d5451(0x17e)},'FieldTypeKind':arrMeta[_0x4a1a1b][_0x7d5451(0x13a)],'Title':arrMeta[_0x4a1a1b]['Title']}),arrMeta[_0x4a1a1b][_0x7d5451(0xcb)]==_0x7d5451(0xbd)&&(_0x1410ed=_0x43aca2['slice'](0x0,_0x3c9938)+_0x7d5451(0x197)+_0x268804+_0x7d5451(0xf8),_0x4c1501={'__metadata':{'type':_0x7d5451(0xe8),'addToDefaultView':_0x7d5451(0x17e)},'FieldTypeKind':arrMeta[_0x4a1a1b][_0x7d5451(0x13a)],'Title':arrMeta[_0x4a1a1b][_0x7d5451(0xcb)],'AllowMultipleValues':!![]}),arrMeta[_0x4a1a1b][_0x7d5451(0xcb)]==_0x7d5451(0xb3)&&(_0x1410ed=_0x43aca2[_0x7d5451(0xb8)](0x0,_0x3c9938)+'/_api/web/lists/getByTitle(\x27'+_0x268804+_0x7d5451(0xf8),_0x4c1501={'__metadata':{'type':_0x7d5451(0xe8),'addToDefaultView':_0x7d5451(0x17e)},'FieldTypeKind':arrMeta[_0x4a1a1b][_0x7d5451(0x13a)],'Title':arrMeta[_0x4a1a1b]['Title']}),arrMeta[_0x4a1a1b]['Title']==_0x7d5451(0xc3)&&(_0x1410ed=_0x43aca2[_0x7d5451(0xb8)](0x0,_0x3c9938)+'/_api/web/lists/getByTitle(\x27'+_0x268804+_0x7d5451(0xf8),_0x4c1501={'__metadata':{'type':_0x7d5451(0xe8),'addToDefaultView':_0x7d5451(0x17e)},'FieldTypeKind':arrMeta[_0x4a1a1b][_0x7d5451(0x13a)],'Title':arrMeta[_0x4a1a1b]['Title'],'SelectionMode':0x0}),arrMeta[_0x4a1a1b][_0x7d5451(0xcb)]==_0x7d5451(0x169)&&(_0x1410ed=_0x43aca2[_0x7d5451(0xb8)](0x0,_0x3c9938)+_0x7d5451(0x197)+_0x268804+_0x7d5451(0xf8),_0x4c1501={'__metadata':{'type':_0x7d5451(0x1a6)},'FieldTypeKind':arrMeta[_0x4a1a1b][_0x7d5451(0x13a)],'Title':arrMeta[_0x4a1a1b][_0x7d5451(0xcb)],'DisplayFormat':0x0}),arrMeta[_0x4a1a1b]['Title']==_0x7d5451(0xd8)&&(_0x1410ed=_0x43aca2[_0x7d5451(0xb8)](0x0,_0x3c9938)+_0x7d5451(0x197)+_0x268804+_0x7d5451(0xf8),_0x4c1501={'__metadata':{'type':_0x7d5451(0x1a6)},'FieldTypeKind':arrMeta[_0x4a1a1b]['FieldTypeKind'],'Title':arrMeta[_0x4a1a1b]['Title'],'DisplayFormat':0x0}),arrMeta[_0x4a1a1b][_0x7d5451(0xcb)]==_0x7d5451(0xe2)&&(_0x1410ed=_0x43aca2['slice'](0x0,_0x3c9938)+'/_api/web/lists/getByTitle(\x27'+_0x268804+'\x27)/fields',_0x4c1501={'__metadata':{'type':_0x7d5451(0x1a6)},'FieldTypeKind':arrMeta[_0x4a1a1b][_0x7d5451(0x13a)],'Title':arrMeta[_0x4a1a1b][_0x7d5451(0xcb)],'DisplayFormat':0x0}),$[_0x7d5451(0x19a)]({'url':_0x1410ed,'type':_0x7d5451(0xf6),'async':![],'data':JSON[_0x7d5451(0x193)](_0x4c1501),'headers':{'Accept':_0x7d5451(0x138),'Content-Type':_0x7d5451(0x138),'X-RequestDigest':$(_0x7d5451(0xc5))[_0x7d5451(0xbb)]()},'success':function(_0x1309d1,_0x3c57be,_0x2bdbe2){var _0x50e0c7=_0x7d5451;console[_0x50e0c7(0x113)]('Success\x20'+arrMeta[_0x4a1a1b][_0x50e0c7(0xcb)]),arrMeta[_0x50e0c7(0x116)]-0x1==_0x4a1a1b&&alert(_0x50e0c7(0xc9));},'error':function(_0x320f84,_0x5d60e6,_0x4a8f59){var _0x2a3231=_0x7d5451;console[_0x2a3231(0x113)](_0x2a3231(0xff));}});}else console['log'](_0x7d5451(0xbc)+arrMeta[_0x4a1a1b]['Title']),arrMeta[_0x7d5451(0x116)]-0x1==_0x4a1a1b&&alert(_0x7d5451(0x126));}}var arrColumn='test',urlValidation=!![],exists=![];function GetAllFieldsFromList(_0x5e1b26,_0xcc19a5,_0x4d7f05){var _0xfa23c8=a0_0x176401;arrColumn='',exists=![],$['ajax']({'url':_0x5e1b26+'/_api/web/lists/getByTitle(\x27'+_0xcc19a5+'\x27)/fields?$filter=Title\x20eq\x20\x27'+_0x4d7f05+'\x27','method':_0xfa23c8(0x101),'async':![],'headers':{'Accept':_0xfa23c8(0x138)},'success':function(_0x1e3ec9,_0x28cd25,_0x4cb536){var _0xce4a1b=_0xfa23c8,_0x3d3bfb=_0x1e3ec9['d'][_0xce4a1b(0x179)];if(_0x3d3bfb[_0xce4a1b(0x116)]>0x0)for(var _0x4a1745=0x0;_0x4a1745<_0x3d3bfb[_0xce4a1b(0x116)];_0x4a1745++){ColumnTitle=_0x3d3bfb[_0x4a1745][_0xce4a1b(0xcb)],exists=!![],$(_0xce4a1b(0x14e))[_0xce4a1b(0xbb)]()=='2'&&DeleteListColumn(_0x5e1b26,ColumnTitle,_0xcc19a5),console[_0xce4a1b(0x113)](_0x3d3bfb[_0x4a1745]['Title']);}},'error':function(_0x28b0ac,_0x28838a,_0x41ea1d){alert('Wrong\x20Url\x20!'),urlValidation=![];}});}function UpdateFieldFromList(_0x35c631,_0x1a7cae,_0x34f7f5){var _0x5d1d77=a0_0x176401;$[_0x5d1d77(0x19a)]({'url':_0x35c631+'/_api/web/lists/getByTitle(\x27'+_0x1a7cae+_0x5d1d77(0x156)+_0x34f7f5+')','method':_0x5d1d77(0xf6),'data':JSON[_0x5d1d77(0x193)]({'__metadata':{'type':_0x5d1d77(0xe8),'addToDefaultView':_0x5d1d77(0x17e)},'Description':_0x5d1d77(0xcd),'FieldTypeKind':0x14,'Title':_0x34f7f5,'AllowMultipleValues':!![]}),'headers':{'IF-MATCH':'*','X-HTTP-Method':'PATCH','Accept':_0x5d1d77(0x138),'Content-Type':_0x5d1d77(0x138),'X-RequestDigest':$(_0x5d1d77(0xc5))['val']()},'success':function(_0x253fb4,_0x304db0,_0x5c59cd){var _0x444f56=_0x5d1d77;console[_0x444f56(0x113)](_0x444f56(0x100)+_0x34f7f5);},'error':function(_0xebd278,_0x24ca69,_0x533929){var _0x10643a=_0x5d1d77;console['log'](_0x10643a(0xff));}});}function DeleteListColumn(_0x2d7e7b,_0x2d64ca,_0x2487d7){var _0x17494d=a0_0x176401;$[_0x17494d(0x19a)]({'url':_0x2d7e7b+_0x17494d(0x197)+_0x2487d7+_0x17494d(0x1b1)+_0x2d64ca+'\x27)','type':'POST','async':![],'headers':{'Accept':_0x17494d(0x138),'Content-Type':_0x17494d(0x138),'IF-MATCH':'*','X-HTTP-Method':_0x17494d(0x14c),'X-RequestDigest':$(_0x17494d(0xc5))[_0x17494d(0xbb)]()},'success':function(_0x506146,_0x4a1dbc,_0x2883a4){var _0x47f7de=_0x17494d;console[_0x47f7de(0x113)](_0x47f7de(0x114)+_0x2d64ca),exists=![],urlValidation=!![];},'error':function(_0xf8c1a7,_0x307a5e,_0x4f8ed3){var _0x1859e3=_0x17494d;console[_0x1859e3(0x113)]('Failed');}});}function GetItemTypeForListName(_0xb81e3){var _0x2a106c=a0_0x176401;return _0x2a106c(0x173)+_0xb81e3[_0x2a106c(0x133)](0x0)['toUpperCase']()+_0xb81e3[_0x2a106c(0xde)]('\x20')[_0x2a106c(0x19c)]('')[_0x2a106c(0xb8)](0x1)+_0x2a106c(0x115);}function ChangePriority(){var _0x1df22a=a0_0x176401;$[_0x1df22a(0x19a)]({'url':_spPageContextInfo[_0x1df22a(0xab)]+_0x1df22a(0x12b),'method':_0x1df22a(0x101),'async':![],'headers':{'Accept':_0x1df22a(0x138)},'success':function(_0x4e1431,_0x257ba9,_0x1374b6){var _0x1f9b27=_0x1df22a,_0x222022=_0x4e1431['d'][_0x1f9b27(0x179)];if(_0x222022[_0x1f9b27(0x116)]>0x0)updatePriority(_0x222022);else return alert(_0x1f9b27(0x17d)),![];},'error':function(_0x155efb,_0x1f4e2e,_0x1952ed){var _0xb12337=_0x1df22a;console[_0xb12337(0x113)](_0x155efb[_0xb12337(0x143)]);}});}function updatePriority(_0x34448f){var _0x32c3e7=a0_0x176401,_0x2f13e6=GetItemTypeForListName(_0x32c3e7(0xb0));Metadata={'__metadata':{'type':_0x2f13e6},'TaskPriority':'High'},_0x34448f[_0x32c3e7(0x12e)](function(_0x3e8f0d,_0xf8bb82){var _0x4bbd5f=_0x32c3e7,_0x13ba6d=$[_0x4bbd5f(0x131)]();return $[_0x4bbd5f(0x19a)]({'url':_spPageContextInfo[_0x4bbd5f(0xab)]+_0x4bbd5f(0x154)+_0x3e8f0d['Id']+'\x27)','type':'POST','async':![],'headers':{'accept':_0x4bbd5f(0x138),'X-RequestDigest':$('#__REQUESTDIGEST')[_0x4bbd5f(0xbb)](),'content-Type':_0x4bbd5f(0x138),'X-Http-Method':_0x4bbd5f(0x170),'If-Match':'*'},'data':JSON['stringify'](Metadata),'success':function(_0x57710b){_0x13ba6d['resolve'](_0x57710b),_0x34448f['length']==_0xf8bb82+0x1&&alert('All\x20Task\x27s\x20Priority\x20has\x20been\x20changed.');},'eror':function(_0x8299c5){var _0x2639c0=_0x4bbd5f;_0x13ba6d['reject'](error),console[_0x2639c0(0x113)]('An\x20error\x20occurred\x20while\x20deleting\x20task.\x20'+JSON['stringify'](_0x8299c5));}}),_0x13ba6d[_0x4bbd5f(0xbf)]();});}function getBlankAssignedBy(){var _0x4de7a8=a0_0x176401;$['ajax']({'url':_spPageContextInfo[_0x4de7a8(0xab)]+'/_api/web/lists/getByTitle(\x27EmployeeTaskDetails\x27)/items/?$top=5000'+'&$filter=AssignedBy/EMail\x20eq\x20null&$select=Id,AssignedBy/EMail,Author/EMail,Author/Id&$expand=AssignedBy,Author&$OrderBy=Modified\x20asc','method':_0x4de7a8(0x101),'async':![],'headers':{'Accept':'application/json;odata=verbose'},'success':function(_0x259e1b,_0x1dba64,_0x5676cf){var _0x4cc7d1=_0x4de7a8,_0x1f6db3=_0x259e1b['d'][_0x4cc7d1(0x179)];if(_0x1f6db3[_0x4cc7d1(0x116)]>0x0)updateAssignedBy(_0x1f6db3);else return alert(_0x4cc7d1(0x109)),![];},'error':function(_0x171dad,_0x523fe4,_0x38ae0f){var _0x1f747d=_0x4de7a8;alert(_0x171dad[_0x1f747d(0x143)]);return;}});}function updateAssignedBy(_0x4751d5){var _0x3938e2=a0_0x176401,_0x574144=GetItemTypeForListName('EmployeeTaskDetails');_0x4751d5[_0x3938e2(0x12e)](function(_0x31e43b,_0xe8f012){var _0x2374a6=_0x3938e2;Metadata={'__metadata':{'type':_0x574144},'AssignedById':_0x31e43b[_0x2374a6(0xd7)]['Id']};var _0x246d86=$[_0x2374a6(0x131)]();return $[_0x2374a6(0x19a)]({'url':_spPageContextInfo[_0x2374a6(0xab)]+_0x2374a6(0x154)+_0x31e43b['Id']+'\x27)','type':_0x2374a6(0xf6),'async':![],'headers':{'accept':_0x2374a6(0x138),'X-RequestDigest':$(_0x2374a6(0xc5))[_0x2374a6(0xbb)](),'content-Type':_0x2374a6(0x138),'X-Http-Method':_0x2374a6(0x170),'If-Match':'*'},'data':JSON[_0x2374a6(0x193)](Metadata),'success':function(_0x48e82a){var _0x34af83=_0x2374a6;_0x246d86[_0x34af83(0x123)](_0x48e82a),_0x4751d5[_0x34af83(0x116)]==_0xe8f012+0x1&&alert(_0x34af83(0x13d));},'eror':function(_0x6359b8){var _0x2169ce=_0x2374a6;_0x246d86[_0x2169ce(0x11c)](error),console['log']('An\x20error\x20occurred\x20while\x20changing\x20task.\x20'+JSON[_0x2169ce(0x193)](_0x6359b8));}}),_0x246d86[_0x2374a6(0xbf)]();});}function getInternalEmployees(){var _0x29622d=a0_0x176401,_0x14b3c4='';pnp['Logger'][_0x29622d(0xe1)](new pnp[(_0x29622d(0xdd))]()),pnp['Logger']['activeLogLevel']=pnp['LogLevel'][_0x29622d(0xb4)],pnp['sp']['web']['get']()['then'](function(_0x5e2478){var _0x2a52d4=_0x29622d;console[_0x2a52d4(0x113)](JSON['stringify'](_0x5e2478,null,0x4));});try{result=pnp['sp'][_0x29622d(0xcf)]['lists'][_0x29622d(0xfd)](_0x29622d(0x1a0))[_0x29622d(0x142)][_0x29622d(0x10c)](_0x29622d(0xfb))[_0x29622d(0x1b6)](_0x29622d(0xd0))[_0x29622d(0x12a)]('')[_0x29622d(0x162)]('','')['getAll']()['then'](function(_0xd8aa64){_0x14b3c4=_0xd8aa64['filter'](function(_0x18efef){var _0x5e04ef=a0_0x2225;return _0x18efef[_0x5e04ef(0x14d)]==_0x5e04ef(0xf5);}),getExternalEmployees(_0x14b3c4);});}catch(_0x193bac){waitingDialog[_0x29622d(0x1b4)](),console['log'](_0x193bac);}}function getExternalEmployees(_0x16871c){var _0x5058c2=a0_0x176401,_0x5dadaf='';pnp['Logger']['subscribe'](new pnp[(_0x5058c2(0xdd))]()),pnp[_0x5058c2(0x145)]['activeLogLevel']=pnp[_0x5058c2(0x12d)][_0x5058c2(0xb4)],pnp['sp']['web'][_0x5058c2(0x124)]()[_0x5058c2(0x16f)](function(_0x420d72){var _0x4325a0=_0x5058c2;console[_0x4325a0(0x113)](JSON['stringify'](_0x420d72,null,0x4));});try{result=pnp['sp'][_0x5058c2(0xcf)][_0x5058c2(0x198)]['getByTitle']('ExternalUsers')[_0x5058c2(0x142)][_0x5058c2(0x10c)](_0x5058c2(0x11e))[_0x5058c2(0x1b6)](_0x5058c2(0xb1))[_0x5058c2(0x12a)]('')[_0x5058c2(0x162)]('','')[_0x5058c2(0x181)]()[_0x5058c2(0x16f)](function(_0x2d4d28){_0x5dadaf=_0x2d4d28['filter'](function(_0x2d4bae){return _0x2d4bae['Status']=='Active';}),checkInCounterList(_0x16871c,_0x5dadaf);});}catch(_0x3b5e2b){waitingDialog[_0x5058c2(0x1b4)](),console[_0x5058c2(0x113)](_0x3b5e2b);}}function checkInCounterList(_0x43798e,_0x5c12c1){var _0x1ab0e7=a0_0x176401;$[_0x1ab0e7(0xd4)](_0x43798e,function(_0x31d7f8,_0x52618e){var _0x5e3590=_0x1ab0e7,_0x4f7702=_0x5e3590(0xaf)+_0x52618e['Email']+'\x27\x20';$[_0x5e3590(0x17c)](getItemsWithQueryItem('EmployeeTaskCounter',_0x4f7702))[_0x5e3590(0xea)](function(_0x1d293a){var _0x42bdb8=_0x5e3590;_0x1d293a['length']>0x0?(GetTaskInboxCount(_0x52618e[_0x42bdb8(0x12f)],_0x1d293a[0x0]['Id']),GetTaskOutboxCount(_0x52618e[_0x42bdb8(0x12f)],_0x1d293a[0x0]['Id']),GetApprovalInboxCount(_0x52618e[_0x42bdb8(0x12f)],_0x1d293a[0x0]['Id'])):AddUserInCounterList(_0x52618e[_0x42bdb8(0xd0)]['ID'],_0x42bdb8(0xb9),_0x52618e['Email'],_0x42bdb8(0xb9));});}),$['each'](_0x5c12c1,function(_0x439776,_0x4c01cd){var _0x5427dd=_0x1ab0e7,_0x47171a=_0x5427dd(0xaf)+_0x4c01cd['email']+'\x27\x20';$[_0x5427dd(0x17c)](getItemsWithQueryItem(_0x5427dd(0x1ac),_0x47171a))[_0x5427dd(0xea)](function(_0x220aa6){var _0x74648a=_0x5427dd;_0x220aa6[_0x74648a(0x116)]>0x0?(GetTaskInboxCount(_0x4c01cd[_0x74648a(0xba)],_0x220aa6[0x0]['Id']),GetTaskOutboxCount(_0x4c01cd['email'],_0x220aa6[0x0]['Id'])):AddUserInCounterList(_0x4c01cd[_0x74648a(0xb1)]['ID'],_0x74648a(0xb5),_0x4c01cd['email'],_0x74648a(0x132));});}),alert(_0x1ab0e7(0x1b7)),waitingDialog[_0x1ab0e7(0x1b4)]();}function AddUserInCounterList(_0x18438e,_0x372b19,_0x227cd8,_0x177334){var _0x1e0d09=a0_0x176401;Metadata={'__metadata':{'type':_0x1e0d09(0x159)},'Title':_0x372b19,'UserIdId':_0x18438e},AddedItemId=AddToSPList(_0x1e0d09(0x1ac),Metadata),GetTaskInboxCount(_0x227cd8,AddedItemId),GetTaskOutboxCount(_0x227cd8,AddedItemId),_0x177334=='Employee'&&GetApprovalInboxCount(_0x227cd8,AddedItemId);}function GetTaskInboxCount(_0x47b5ad,_0x3b4ef3){var _0x4ef64a=a0_0x176401;restQuery=_0x4ef64a(0xf2)+_0x47b5ad+_0x4ef64a(0x17f)+_0x47b5ad+'\x27)\x20and\x20(CurrentPhase\x20eq\x20\x27Open\x27))';var _0x230d9d=_0x4ef64a(0x11f)+restQuery;$[_0x4ef64a(0x17c)](getItemsWithQueryItem(_0x4ef64a(0xb0),_0x230d9d))[_0x4ef64a(0xea)](function(_0x31a811){var _0x232760=_0x4ef64a,_0x552c04='',_0x5b2a0e=0x0,_0x2126a2=0x0,_0x562c03=new Date();_0x562c03=_0x562c03[_0x232760(0x152)](0x0,0x0,0x0,0x0),_0x562c03=new Date(_0x562c03);for(var _0x4ad0d0=0x0;_0x4ad0d0<_0x31a811['length'];_0x4ad0d0++){var _0x243f57=new Date(moment(_0x31a811[_0x4ad0d0]['DueDate'][_0x232760(0xde)]('T')[0x0])[_0x232760(0xf7)](_0x232760(0x19b)));_0x243f57[_0x232760(0xc6)](_0x243f57[_0x232760(0x1a8)]()),_0x243f57=new Date(_0x243f57),_0x243f57>=_0x562c03?_0x5b2a0e++:_0x2126a2++;}UpdateTaskCounter(_0x3b4ef3,_0x5b2a0e,_0x2126a2,_0x232760(0xda));});}function GetTaskOutboxCount(_0x4731a2,_0x330330){var _0x33d168=a0_0x176401;restQuery='&$filter=((Author/EMail\x20eq\x20\x27'+_0x4731a2+_0x33d168(0x111)+_0x4731a2+'\x27)\x20and\x20(CurrentPhase\x20eq\x20\x27Open\x27))';var _0x4625ee=_0x33d168(0x11f)+restQuery;$['when'](getItemsWithQueryItem('EmployeeTaskDetails',_0x4625ee))[_0x33d168(0xea)](function(_0x5c998e){var _0x276435=_0x33d168,_0x49d445=0x0,_0x5d1449=0x0;for(var _0x427eea=0x0;_0x427eea<_0x5c998e[_0x276435(0x116)];_0x427eea++){var _0x21457e=new Date(_0x5c998e[_0x427eea][_0x276435(0x11a)]),_0x2a39ab=new Date();_0x2a39ab[_0x276435(0x152)](0x0,0x0,0x0,0x0),_0x2a39ab>_0x21457e?_0x5d1449++:_0x49d445++;}UpdateTaskCounter(_0x330330,_0x49d445,_0x5d1449,_0x276435(0x18f));});}function UpdateTaskCounter(_0x4a9a85,_0x4ea76f,_0x5d9848,_0x2ec096){var _0x5281bc=a0_0x176401,_0x4c45f2=GetItemTypeForListName('EmployeeTaskCounter');_0x2ec096==_0x5281bc(0xda)?Metadata={'__metadata':{'type':_0x4c45f2},'OpenTasksCount':parseInt(_0x4ea76f),'OverdueCount':parseInt(_0x5d9848)}:Metadata={'__metadata':{'type':_0x4c45f2},'OpenTasksCount_Out':parseInt(_0x4ea76f),'OverdueCount_Out':parseInt(_0x5d9848)};var _0x5520f0=$[_0x5281bc(0x131)]();return $['ajax']({'url':_spPageContextInfo[_0x5281bc(0xab)]+_0x5281bc(0x107)+_0x4a9a85+'\x27)','type':_0x5281bc(0xf6),'async':![],'headers':{'accept':_0x5281bc(0x138),'X-RequestDigest':$(_0x5281bc(0xc5))['val'](),'content-Type':_0x5281bc(0x138),'X-Http-Method':_0x5281bc(0x170),'If-Match':'*'},'data':JSON[_0x5281bc(0x193)](Metadata),'success':function(_0x239ee8){var _0x5cdea2=_0x5281bc;_0x5520f0[_0x5cdea2(0x123)](_0x239ee8);},'eror':function(_0x436a68){var _0x12a9d2=_0x5281bc;_0x5520f0[_0x12a9d2(0x11c)](error),console['log'](_0x12a9d2(0x106)+JSON[_0x12a9d2(0x193)](_0x436a68));}}),_0x5520f0[_0x5281bc(0xbf)]();}function GetApprovalInboxCount(_0x4c65b4,_0x3144d2){var _0x18de17=a0_0x176401,_0x3af33f=0x0;restQuery=_0x18de17(0x135)+_0x4c65b4+_0x18de17(0x172);var _0x2c9c74='?$top=5000&$select=*,Approvers/EMail,Approvers/Title,Approvers/Id&$Expand=Approvers&$OrderBy=Modified\x20asc'+restQuery;$[_0x18de17(0x17c)](getItemsWithQueryItem(_0x18de17(0x19f),_0x2c9c74))['done'](function(_0x2832a3){var _0x389914=_0x18de17;_0x3af33f=_0x2832a3[_0x389914(0x116)],restQuery=_0x389914(0xe6)+_0x4c65b4+'\x27)\x20and\x20(Status\x20eq\x20\x27Initiated\x27\x20or\x20Status\x20eq\x20\x27Forwarded\x27))';var _0x543e91=_0x389914(0x151)+restQuery;$[_0x389914(0x17c)](getItemsWithQueryItem(_0x389914(0x19f),_0x543e91))[_0x389914(0xea)](function(_0x4ccef8){var _0x87e7eb=_0x389914;UpdateApprovalCounter(_0x3144d2,_0x3af33f,_0x4ccef8[_0x87e7eb(0x116)]);});});}function UpdateApprovalCounter(_0x10ee64,_0x5630a1,_0x23be6d){var _0x2ed2e9=a0_0x176401,_0x42b994=GetItemTypeForListName(_0x2ed2e9(0x1ac));Metadata={'__metadata':{'type':_0x42b994},'ApprovalCount_IN':parseInt(_0x5630a1),'ApprovalCount_OUT':parseInt(_0x23be6d)};var _0x4c5c94=$[_0x2ed2e9(0x131)]();return $['ajax']({'url':_spPageContextInfo['webAbsoluteUrl']+_0x2ed2e9(0x107)+_0x10ee64+'\x27)','type':_0x2ed2e9(0xf6),'async':![],'headers':{'accept':_0x2ed2e9(0x138),'X-RequestDigest':$(_0x2ed2e9(0xc5))[_0x2ed2e9(0xbb)](),'content-Type':_0x2ed2e9(0x138),'X-Http-Method':_0x2ed2e9(0x170),'If-Match':'*'},'data':JSON[_0x2ed2e9(0x193)](Metadata),'success':function(_0x4db927){var _0x306a07=_0x2ed2e9;_0x4c5c94[_0x306a07(0x123)](_0x4db927);},'eror':function(_0x3d645d){var _0x4fb72f=_0x2ed2e9;_0x4c5c94[_0x4fb72f(0x11c)](error),console['log'](_0x4fb72f(0x106)+JSON[_0x4fb72f(0x193)](_0x3d645d));}}),_0x4c5c94[_0x2ed2e9(0xbf)]();}function AddToSPList(_0x2ae35f,_0xdf35a2){var _0xc0cd15=a0_0x176401,_0x2b8f18='';return $[_0xc0cd15(0x19a)]({'url':_spPageContextInfo[_0xc0cd15(0xab)]+'/_api/web/lists/getbytitle(\x27'+_0x2ae35f+_0xc0cd15(0x1a7),'type':'POST','async':![],'headers':{'accept':_0xc0cd15(0x138),'X-RequestDigest':$('#__REQUESTDIGEST')[_0xc0cd15(0xbb)](),'content-Type':_0xc0cd15(0x138)},'data':JSON[_0xc0cd15(0x193)](_0xdf35a2),'success':function(_0x219bdb){_0x2b8f18=_0x219bdb['d']['Id'];},'error':function(_0x3f456e){var _0x130614=_0xc0cd15;console[_0x130614(0x113)](JSON[_0x130614(0x193)](_0x3f456e));}}),_0x2b8f18;}function getItemsWithQueryItem(_0xf39e15,_0x3faaee){var _0x3cce81=a0_0x176401;return DeferredObj=$[_0x3cce81(0x131)](),$[_0x3cce81(0x19a)]({'url':_spPageContextInfo[_0x3cce81(0xab)]+_0x3cce81(0x14a)+_0xf39e15+_0x3cce81(0xe4)+_0x3faaee,'type':_0x3cce81(0x101),'async':![],'headers':{'ACCEPT':_0x3cce81(0x138),'X-RequestDigest':$(_0x3cce81(0xc5))[_0x3cce81(0xbb)]()},'success':function(_0x143d59){DeferredObj['resolve'](_0x143d59['d']['results']);},'error':function(_0x235002){var _0x61948a=_0x3cce81;DeferredObj[_0x61948a(0x11c)](_0x235002);}}),DeferredObj['promise']();};function ChangeCompanyId(){var _0x1b4c40=a0_0x176401;$[_0x1b4c40(0x19a)]({'url':_spPageContextInfo[_0x1b4c40(0xab)]+_0x1b4c40(0x1a1),'method':'GET','async':![],'headers':{'Accept':'application/json;odata=verbose'},'success':function(_0x4b0561,_0x427e01,_0x22d6fb){var _0x5e1465=_0x1b4c40,_0x45dce1=_0x4b0561['d'][_0x5e1465(0x179)];if(_0x45dce1[_0x5e1465(0x116)]>0x0)updateCompanyId(_0x45dce1);else return alert('No\x20record\x20found.'),![];},'error':function(_0x2619ae,_0x2e6f15,_0x13637e){var _0x5cf8d2=_0x1b4c40;console[_0x5cf8d2(0x113)](_0x2619ae[_0x5cf8d2(0x143)]);}});}function updateCompanyId(_0x3786a9){var _0x37c6cd=a0_0x176401,_0x41c62f=GetItemTypeForListName(_0x37c6cd(0xb6)),_0x1810ed=[];_0x3786a9[_0x37c6cd(0x12e)](function(_0x47b84d,_0x14fa43){var _0x503fd8=_0x37c6cd;_0x1810ed=[],_0x1810ed[_0x503fd8(0x121)](_0x47b84d['Company']['ID']),Metadata={'__metadata':{'type':_0x41c62f},'CompanyIdId':{'results':_0x1810ed}};var _0x5eab48=$['Deferred']();return $[_0x503fd8(0x19a)]({'url':_spPageContextInfo[_0x503fd8(0xab)]+_0x503fd8(0x14b)+_0x47b84d['Id']+')','type':'POST','async':![],'headers':{'accept':_0x503fd8(0x138),'X-RequestDigest':$(_0x503fd8(0xc5))[_0x503fd8(0xbb)](),'content-Type':_0x503fd8(0x138),'X-Http-Method':'PATCH','If-Match':'*'},'data':JSON[_0x503fd8(0x193)](Metadata),'success':function(_0x2426d1){var _0x6beb17=_0x503fd8;_0x5eab48['resolve'](_0x2426d1),_0x3786a9[_0x6beb17(0x116)]==_0x14fa43+0x1&&alert(_0x6beb17(0x185));},'eror':function(_0x3eb8c5){var _0x5e9835=_0x503fd8;_0x5eab48['reject'](error),console[_0x5e9835(0x113)]('An\x20error\x20occurred\x20while\x20deleting\x20Application.\x20'+JSON[_0x5e9835(0x193)](_0x3eb8c5));}}),_0x5eab48[_0x503fd8(0xbf)]();});}function fileShareDocumentColumn(){var _0xe03bb7=a0_0x176401;$[_0xe03bb7(0x19a)]({'url':_spPageContextInfo[_0xe03bb7(0xab)]+'/_api/web/lists/getByTitle(\x27SharedDocument\x27)/items/?$top=5000&$filter=SiteURL\x20eq\x20null\x20and\x20DocumentID\x20ne\x20null&$select=*,SharedUsers/EMail&$expand=SharedUsers/EMail&$OrderBy=Modified\x20desc','method':_0xe03bb7(0x101),'async':![],'headers':{'Accept':_0xe03bb7(0x138)},'success':function(_0x279529,_0xfb9d70,_0x19de6f){var _0x5e890c=_0xe03bb7,_0x1fff4b=_0x279529['d'][_0x5e890c(0x179)];if(_0x1fff4b[_0x5e890c(0x116)]>0x0)for(var _0x32fe71=0x0;_0x32fe71<_0x1fff4b[_0x5e890c(0x116)];_0x32fe71++){var _0x2e361b=_0x1fff4b[_0x32fe71][_0x5e890c(0x10f)],_0x1ec607=_0x1fff4b[_0x32fe71][_0x5e890c(0x182)],_0x4e49eb='';_0x1fff4b[_0x32fe71][_0x5e890c(0x158)]!=null&&(_0x4e49eb=_0x1fff4b[_0x32fe71][_0x5e890c(0xfe)][_0x5e890c(0x179)][0x0][_0x5e890c(0x130)]);var _0x13c70e=_0x1fff4b[_0x32fe71]['Id'],_0x9555dd=_0x2e361b[_0x5e890c(0xde)](_0x5e890c(0x118)),_0x2885b6=_0x5e890c(0x10d),_0x143508=_spPageContextInfo[_0x5e890c(0xab)],_0x2cdf0e=_spPageContextInfo[_0x5e890c(0xab)]+_0x5e890c(0x118);if(_0x9555dd[_0x5e890c(0x116)]>0x1){}else{var _0x4589cf=_0x2e361b[_0x5e890c(0xde)](_0x5e890c(0xc8));_0x4589cf=_0x4589cf[0x0][_0x5e890c(0xde)](_0x5e890c(0x16b))[0x1][_0x5e890c(0xde)]('/'),_0x2885b6=_0x5e890c(0x1b5),_0x4589cf[_0x5e890c(0x116)]>0x2?(_0x143508=_spPageContextInfo[_0x5e890c(0xab)]+'/'+_0x4589cf[0x1]+'/'+_0x4589cf[0x2],_0x2cdf0e=_spPageContextInfo['webAbsoluteUrl']+'/'+_0x4589cf[0x1]+'/'+_0x4589cf[0x2]+_0x5e890c(0xc8)):(_0x143508=_spPageContextInfo[_0x5e890c(0xab)]+'/'+_0x4589cf[0x1],_0x2cdf0e=_spPageContextInfo[_0x5e890c(0xab)]+'/'+_0x4589cf[0x1]+'/'+_0x5e890c(0xc8));}var _0xdcd7c5=_0x2e361b[_0x5e890c(0xde)](_0x5e890c(0x16b));_0xdcd7c5='/sites/'+_0xdcd7c5[0x1];var _0x2f928d=_0xdcd7c5[_0x5e890c(0xde)]('/'),_0x1bcc34=_0x2f928d[_0x2f928d[_0x5e890c(0x116)]-0x1]['split']('.');_0x1bcc34['length']>0x1?(_0x2e361b=_0xdcd7c5[_0x5e890c(0xde)]('/'+_0x2f928d[_0x2f928d['length']-0x1]),_0x2e361b=_0xdcd7c5):_0x2e361b=_0xdcd7c5,_0x2885b6==_0x5e890c(0x1b5)?GetFolderDetails(_0x2e361b,_0x1ec607,_0x13c70e,_0x2885b6,_0x143508,_0x2cdf0e,_0x4e49eb):GetDocumentsFiles(_0x2e361b,_0x1ec607,_0x13c70e,_0x2885b6,_0x143508,_0x2cdf0e,_0x4e49eb);}else return alert('No\x20record\x20found.'),![];waitingDialog['hide']();},'error':function(_0x55841e,_0x610df3,_0xe8a40e){var _0x5102b4=_0xe03bb7;console[_0x5102b4(0x113)](_0x55841e[_0x5102b4(0x143)]);}});}function updateShareDocument(_0x5ae005,_0x36acf6,_0x26bc44,_0x332462,_0x404754,_0x5ddda0){var _0x563559=a0_0x176401,_0x35e3ac=GetItemTypeForListName(_0x563559(0xec)),_0xd45be3='',_0x48a036='';_0x26bc44==_0x563559(0x1b5)?(_0xd45be3=_0x5ae005[0x0][_0x563559(0xd7)]['EMail'],_0x48a036=_0x5ae005[0x0][_0x563559(0xeb)]):(_0xd45be3=_0x5ae005[0x0][_0x563559(0xf9)],_0x48a036=_0x5ae005[0x0][_0x563559(0xeb)]);Metadata={'__metadata':{'type':_0x35e3ac},'LibraryURL':_0x404754,'LibraryName':_0x26bc44,'SiteURL':_0x332462,'DocType':_0x48a036,'SharedFileTitle':_0x5ae005[0x0]['FileLeafRef'],'SharedUserEmail':_0x5ddda0};var _0x37945c=$[_0x563559(0x131)]();return $[_0x563559(0x19a)]({'url':_spPageContextInfo['webAbsoluteUrl']+_0x563559(0xf0)+_0x36acf6+')','type':_0x563559(0xf6),'async':![],'headers':{'accept':_0x563559(0x138),'X-RequestDigest':$(_0x563559(0xc5))['val'](),'content-Type':_0x563559(0x138),'X-Http-Method':_0x563559(0x170),'If-Match':'*'},'data':JSON[_0x563559(0x193)](Metadata),'success':function(_0x4e8305){var _0xdeddef=_0x563559;_0x37945c[_0xdeddef(0x123)](_0x4e8305);},'eror':function(_0x304a1c){var _0xce3764=_0x563559;_0x37945c[_0xce3764(0x11c)](error),console[_0xce3764(0x113)]('An\x20error\x20occurred\x20while\x20deleting\x20Application.\x20'+JSON[_0xce3764(0x193)](_0x304a1c));}}),_0x37945c[_0x563559(0xbf)]();}function GetFolderDetails(_0x4f1106,_0x58c95e,_0x5305f7,_0x1a9aef,_0x14817c,_0x2b45cd,_0x480f8d){var _0x565cf0=a0_0x176401;debugger;var _0x3f50f0=_0x4f1106['split']('/DepartmentalDMS');_0x3f50f0=_0x3f50f0[0x0][_0x565cf0(0xde)](_0x565cf0(0x16b))[0x1]['split']('/');_0x3f50f0['length']>0x2?_0x3f50f0=_0x3f50f0[0x1]+'/'+_0x3f50f0[0x2]:_0x3f50f0=_0x3f50f0[0x1];var _0xbbe048=_0x14817c,_0x3d1d2c=_0x2b45cd,_0x133e70=_spPageContextInfo['webAbsoluteUrl']+'/'+_0x3f50f0+_0x565cf0(0x191)+_0x1a9aef+_0x565cf0(0x104)+_0x58c95e+'';$[_0x565cf0(0x19a)]({'url':_0x133e70,'headers':{'Accept':_0x565cf0(0x138)},'async':![],'success':function(_0x4a73b3){var _0x13b029=_0x565cf0,_0x4cc903=_0x4a73b3['d'][_0x13b029(0x179)];_0x4cc903[_0x13b029(0x116)]>0x0&&updateShareDocument(_0x4cc903,_0x5305f7,_0x1a9aef,_0xbbe048,_0x3d1d2c,_0x480f8d),console[_0x13b029(0x113)](_0x4cc903);},'eror':function(_0x554a9b){var _0x102bc9=_0x565cf0;console[_0x102bc9(0x113)](_0x554a9b);}});}function GetDocumentsFiles(_0x2b42bd,_0x49cfdc,_0x48ba57,_0x4cca32,_0x3093fd,_0x15f549,_0x485ea7){var _0x473c8f=a0_0x176401,_0x208387=_0x2b42bd[_0x473c8f(0xde)]('/');_0x208387=_0x208387[_0x208387['length']-0x1],_0x2b42bd=_0x2b42bd['split']('/'+_0x208387);var _0x152ca3=[],_0x46041c=_spPageContextInfo[_0x473c8f(0xab)]+_0x473c8f(0xce)+_0x2b42bd[0x0]+_0x473c8f(0x117);$[_0x473c8f(0x19a)]({'url':_0x46041c,'headers':{'Accept':'application/json;odata=verbose'},'async':![],'success':function(_0x20b661){var _0x581d32=_0x473c8f,_0x6e160e=_0x20b661['d']['Files'][_0x581d32(0x179)],_0x51ffe9=_0x6e160e[_0x581d32(0x12a)](function(_0x3d476b){var _0x1b4728=_0x581d32;return _0x3d476b[_0x1b4728(0x178)]['ID']==_0x49cfdc;});if(_0x51ffe9[_0x581d32(0x116)]>0x0){var _0x5210d8=_0x51ffe9[0x0]['ListItemAllFields'][_0x581d32(0xae)];_0x5210d8=_0x5210d8['split'](_0x581d32(0x144)),_0x152ca3[_0x581d32(0x121)]({'DocumentType':_0x51ffe9[0x0][_0x581d32(0x178)][_0x581d32(0xeb)],'FileLeafRef':_0x51ffe9[0x0][_0x581d32(0xcb)],'AuthorEMail':_0x5210d8[0x1]}),updateShareDocument(_0x152ca3,_0x48ba57,_0x4cca32,_0x3093fd,_0x15f549,_0x485ea7);}},'eror':function(_0x5bc202){console['log']('error');}});}function getDepartmentalItems(){var _0x19250c=a0_0x176401,_0x407cda=$(_0x19250c(0x18c))[_0x19250c(0xbb)]()[_0x19250c(0x128)]();_0x407cda['length']<=0x0&&alert(_0x19250c(0x1ab));var _0x4705f6=_0x407cda[_0x19250c(0xde)]('/');_0x4705f6=_0x4705f6[_0x4705f6[_0x19250c(0x116)]-0x1];var _0x17026a=_0x407cda[_0x19250c(0xde)](_0x4705f6),_0x169bba=_0x17026a[0x0]+_0x19250c(0x17a)+_0x4705f6+_0x19250c(0xbe);$[_0x19250c(0x19a)]({'url':_0x169bba,'headers':{'Accept':_0x19250c(0x138)},'async':![],'success':function(_0x210d8d){var _0x47dd83=_0x19250c,_0x551ab4=_0x210d8d['d'][_0x47dd83(0x179)];for(var _0x2dd0f2=0x0;_0x2dd0f2<_0x551ab4['length'];_0x2dd0f2++){getShareDocumentItemsById(_0x17026a[0x0],_0x4705f6,_0x551ab4[_0x2dd0f2]['ID']),_0x551ab4[_0x47dd83(0x116)]==_0x2dd0f2+0x1&&alert(_0x47dd83(0xad));}},'error':function(_0x2eb98a){var _0x1f16ad=_0x19250c;console[_0x1f16ad(0x113)](_0x2eb98a);}});}function getShareDocumentItemsById(_0x574530,_0x3a0996,_0x51a8aa){var _0x142602=a0_0x176401,_0x335161=_0x574530;$[_0x142602(0x19a)]({'url':_spPageContextInfo['webAbsoluteUrl']+_0x142602(0x1a4)+_0x51a8aa+'\x27','method':_0x142602(0x101),'async':![],'headers':{'Accept':_0x142602(0x138)},'success':function(_0x913ba2,_0x3cecc1,_0x5e6381){var _0x154938=_0x142602,_0x49a4ce=_0x913ba2['d'][_0x154938(0x179)];if(_0x49a4ce[_0x154938(0x116)]>0x0){}else updateDocumentPropertiesOnItemSharing(_0x335161,_0x3a0996,_0x51a8aa);},'error':function(_0x43ca3e){var _0x48e66f=_0x142602;console[_0x48e66f(0x113)](_0x43ca3e);}});}function GetItemTypeForListNames(_0x5b413f){var _0x55d7de=a0_0x176401;return _0x55d7de(0x173)+_0x5b413f[_0x55d7de(0x133)](0x0)[_0x55d7de(0x105)]()+_0x5b413f[_0x55d7de(0xde)]('\x20')[_0x55d7de(0x19c)]('')['slice'](0x1)+_0x55d7de(0x115);}function updateDocumentPropertiesOnItemSharing(_0x53dcd7,_0x156299,_0x7da1bc){var _0x4519ed=a0_0x176401,_0x1b2663,_0x1faf10='SP.Data.'+_0x156299+_0x4519ed(0xd3),_0x4ef948=[];_0x1b2663={'__metadata':{'type':_0x1faf10},'SharedId':{'results':_0x4ef948}},updateItemWithIDItemListDocuments(_0x53dcd7,_0x156299,_0x1b2663,_0x7da1bc);}function updateItemWithIDItemListDocuments(_0x21bfb8,_0x2f99f4,_0xfac6fd,_0x125d64){var _0x366223=a0_0x176401,_0x410577=_0x21bfb8+_0x366223(0x108)+_0x2f99f4+_0x366223(0xdf)+_0x125d64+')';$[_0x366223(0x19a)]({'url':_0x410577,'type':'POST','async':![],'headers':{'accept':_0x366223(0x138),'X-RequestDigest':$(_0x366223(0xc5))['val'](),'content-Type':_0x366223(0x138),'X-Http-Method':'PATCH','If-Match':'*'},'data':JSON['stringify'](_0xfac6fd),'success':function(_0x3f904f){console['log'](_0x3f904f);},'error':function(_0x591d61){var _0x14899a=_0x366223;alert(_0x591d61[_0x14899a(0x1a2)][_0x14899a(0xf1)][_0x14899a(0x16d)][_0x14899a(0x13b)]);}});}function getDataFromShareDocument(){var _0x8ba7c9=a0_0x176401,_0x565719=URL;$[_0x8ba7c9(0x19a)]({'url':_spPageContextInfo[_0x8ba7c9(0xab)]+_0x8ba7c9(0x1ae),'method':'GET','async':![],'headers':{'Accept':'application/json;odata=verbose'},'success':function(_0x11594e,_0x32a773,_0x4191dd){var _0x598a9a=_0x8ba7c9,_0x1eca9e=_0x11594e['d'][_0x598a9a(0x179)];if(_0x1eca9e[_0x598a9a(0x116)]>0x0){for(let _0x89ade7=0x0;_0x89ade7<_0x1eca9e['length'];_0x89ade7++){FillCompanyCompanyAndDepartmentIdInShareDocument(_0x1eca9e[_0x89ade7]['ID'],_0x1eca9e[_0x89ade7][_0x598a9a(0x177)]);}alert('Update\x20Successfully');}else alert(_0x598a9a(0x168));},'error':function(_0x3e204f){console['log'](_0x3e204f);}});}function FillCompanyCompanyAndDepartmentIdInShareDocument(_0x52304c,_0x1f89a4){var _0x5b95e6=a0_0x176401,_0x24b9b7,_0x50d9a4='SharedDocument';if(_0x1f89a4!=null)var _0x1f89a4=_0x1f89a4[_0x5b95e6(0xde)](_0x5b95e6(0xc8))[0x0];var _0x1d4594=departmentArr[_0x5b95e6(0x12a)](function(_0x37a1aa){var _0x50704d=_0x5b95e6;return _0x37a1aa[_0x50704d(0x175)]==_0x1f89a4;});if(_0x1d4594['length']>0x0){var _0x5ebf63='SP.Data.SharedDocumentListItem';_0x24b9b7={'__metadata':{'type':_0x5ebf63},'CompanyIDId':_0x1d4594[0x0][_0x5b95e6(0x1a5)],'DepartmentIDId':_0x1d4594[0x0][_0x5b95e6(0xc7)]};var _0x3f59ba=_spPageContextInfo[_0x5b95e6(0xab)]+_0x5b95e6(0xf3)+_0x52304c+')';$[_0x5b95e6(0x19a)]({'url':_0x3f59ba,'type':'POST','async':![],'headers':{'accept':_0x5b95e6(0x138),'X-RequestDigest':$(_0x5b95e6(0xc5))[_0x5b95e6(0xbb)](),'content-Type':_0x5b95e6(0x138),'X-Http-Method':_0x5b95e6(0x170),'If-Match':'*'},'data':JSON['stringify'](_0x24b9b7),'success':function(_0xfaab3){console['log'](_0xfaab3);},'error':function(_0xef6abe){var _0xee87ab=_0x5b95e6;alert(_0xef6abe[_0xee87ab(0x1a2)]['message'][_0xee87ab(0x13b)]);}});}}var departmentArr=[];function GetDepartmentUrl(){var _0xc022e=a0_0x176401,_0x415b01=_spPageContextInfo[_0xc022e(0xab)]+_0xc022e(0x167);$[_0xc022e(0x19a)]({'url':_0x415b01,'headers':{'Accept':'application/json;odata=verbose'},'async':![],'success':function(_0x5f23b0){var _0x3b3964=_0xc022e,_0x1c20e3=_0x5f23b0['d'][_0x3b3964(0x179)];if(_0x1c20e3[_0x3b3964(0x116)]>0x0)for(let _0x230a42=0x0;_0x230a42<_0x1c20e3[_0x3b3964(0x116)];_0x230a42++){departmentArr['push']({'SiteURL':_0x1c20e3[_0x230a42][_0x3b3964(0x175)],'DeptId':_0x1c20e3[_0x230a42]['ID'],'ComId':_0x1c20e3[_0x230a42][_0x3b3964(0x155)]});}console[_0x3b3964(0x113)](departmentArr);},'eror':function(_0x150f53){console['log'](_0x150f53);}});}function GetDMSDocuments(){var _0x3007a3=a0_0x176401,_0x356c11=$(_0x3007a3(0x195))[_0x3007a3(0xbb)]();if(_0x356c11=='')return alert(_0x3007a3(0x125)),![];var _0x27067e=_0x356c11+_0x3007a3(0x16c);$[_0x3007a3(0x19a)]({'url':_0x27067e,'headers':{'Accept':_0x3007a3(0x138)},'async':![],'success':function(_0x2fb94f){var _0x401088=_0x3007a3,_0x1b8ed9=_0x2fb94f['d']['results'];arrMetadata=[];if(_0x1b8ed9[_0x401088(0x116)]>0x0){arrMetadata=_0x1b8ed9,console[_0x401088(0x113)](arrMetadata);for(var _0x3fcce2=0x0;_0x3fcce2<_0x1b8ed9[_0x401088(0x116)];_0x3fcce2++){getShareDocumentItemsByTitle(_0x3fcce2,_0x1b8ed9[_0x3fcce2]['ID'],_0x1b8ed9[_0x3fcce2][_0x401088(0x1b3)]['Name']);}alert(_0x401088(0x126));}else alert('No\x20record\x20found');},'error':function(_0x9b0f7f){alert('Enter\x20valit\x20url');}});}function a0_0x2225(_0x1db7b6,_0x2cfc80){var _0x40372e=a0_0x4037();return a0_0x2225=function(_0x22257e,_0x82c2b3){_0x22257e=_0x22257e-0xab;var _0x44181c=_0x40372e[_0x22257e];return _0x44181c;},a0_0x2225(_0x1db7b6,_0x2cfc80);}var arrMetadata=[];function CopyDmsToSharedocumentItems(_0x4aa114){var _0x1c237b=a0_0x176401,_0x480bcc,_0x1e74b1='SharedDocument',_0x53dc6d=arrMetadata[_0x4aa114]['Acknowledgement'];_0x53dc6d==_0x1c237b(0x102)?_0x53dc6d=!![]:_0x53dc6d=![];var _0x5715cc=String(arrMetadata[_0x4aa114]['Id']);if(arrMetadata[_0x1c237b(0x116)]>0x0){var _0x58de63=_0x1c237b(0xca);_0x480bcc={'__metadata':{'type':_0x58de63},'CompanyIDId':CompanyID,'DepartmentIDId':$(_0x1c237b(0x15a))[_0x1c237b(0xbb)](),'DocumentID':_0x5715cc,'Title':arrMetadata[_0x4aa114][_0x1c237b(0x1b3)]['Name']?arrMetadata[_0x4aa114][_0x1c237b(0x1b3)]['Name']:'','DocumentNo':arrMetadata[_0x4aa114][_0x1c237b(0xc2)]?arrMetadata[_0x4aa114][_0x1c237b(0xc2)]:'','DocType':arrMetadata[_0x4aa114][_0x1c237b(0xeb)]?arrMetadata[_0x4aa114][_0x1c237b(0xeb)]:'','DocumentType':_0x1c237b(0x1b3),'NeedAcknowledgement':_0x53dc6d,'Department':$(_0x1c237b(0x15a))[_0x1c237b(0x166)](),'Details':arrMetadata[_0x4aa114][_0x1c237b(0x174)]?arrMetadata[_0x4aa114][_0x1c237b(0x174)]:'','SubCategory':arrMetadata[_0x4aa114][_0x1c237b(0x1aa)]?arrMetadata[_0x4aa114][_0x1c237b(0x1aa)]:'','SharedGroup':arrMetadata[_0x4aa114][_0x1c237b(0x19e)]?arrMetadata[_0x4aa114][_0x1c237b(0x19e)]:'','PermissionType':_0x1c237b(0x141),'DocumentURL':arrMetadata[_0x4aa114][_0x1c237b(0x1b3)][_0x1c237b(0x136)],'LibraryName':'DepartmentalDMS','SiteURL':$(_0x1c237b(0x195))[_0x1c237b(0xbb)](),'LibraryURL':$(_0x1c237b(0x195))['val']()+_0x1c237b(0xc8)};var _0x3e6b9a=_spPageContextInfo[_0x1c237b(0xab)]+'/_api/Web/Lists/getByTitle(\x27SharedDocument\x27)/Items';$[_0x1c237b(0x19a)]({'url':_0x3e6b9a,'type':_0x1c237b(0xf6),'async':![],'headers':{'accept':_0x1c237b(0x138),'X-RequestDigest':$(_0x1c237b(0xc5))[_0x1c237b(0xbb)](),'content-Type':_0x1c237b(0x138)},'data':JSON[_0x1c237b(0x193)](_0x480bcc),'success':function(_0x31b540){console['log'](_0x31b540);},'error':function(_0x45e627){var _0x5abbfb=_0x1c237b;alert(_0x45e627[_0x5abbfb(0x143)]);}});}}function getShareDocumentItemsByTitle(_0x4e4e26,_0x2a952f,_0x19d09b){var _0x20884e=a0_0x176401,_0x4bc2a0=_spPageContextInfo[_0x20884e(0xab)]+_0x20884e(0xe5)+_0x19d09b+_0x20884e(0x187)+_0x2a952f+'\x20and\x20PermissionStatus\x20ne\x20\x27Revoked\x27&$select=Id';$['ajax']({'url':_0x4bc2a0,'method':_0x20884e(0x101),'async':![],'headers':{'Accept':_0x20884e(0x138)},'success':function(_0xa3f972,_0x55fbec,_0x158bef){var _0x10e6fb=_0x20884e,_0x504c78=_0xa3f972['d'][_0x10e6fb(0x179)];_0x504c78[_0x10e6fb(0x116)]==0x0&&CopyDmsToSharedocumentItems(_0x4e4e26);},'error':function(_0x15e3ca,_0x483ef0,_0x29fd80){var _0x2da510=_0x20884e;console[_0x2da510(0x113)](_0x15e3ca[_0x2da510(0x143)]);}});}var departmentItemsArr=[],CompanyID='';function LoadAllDepartment(){var _0x18fd14=a0_0x176401;$(_0x18fd14(0x15a))[_0x18fd14(0xed)]();var _0x3e7b08=_spPageContextInfo[_0x18fd14(0xab)]+_0x18fd14(0x165);$['ajax']({'url':_0x3e7b08,'headers':{'Accept':'application/json;odata=verbose'},'async':!![],'success':function(_0x333936){var _0x46a148=_0x18fd14;for(var _0x5dc709=0x0;_0x5dc709<_0x333936['d'][_0x46a148(0x179)][_0x46a148(0x116)];_0x5dc709++){departmentItemsArr['push']({'SiteURL':_0x333936['d']['results'][_0x5dc709][_0x46a148(0x175)],'ID':_0x333936['d'][_0x46a148(0x179)][_0x5dc709]['ID'],'CompanyID':_0x333936['d'][_0x46a148(0x179)][_0x5dc709][_0x46a148(0xe9)]}),$(_0x46a148(0x15a))[_0x46a148(0x15d)]('<option\x20value=\x22'+_0x333936['d'][_0x46a148(0x179)][_0x5dc709]['ID']+'\x22>'+_0x333936['d'][_0x46a148(0x179)][_0x5dc709][_0x46a148(0xcb)]+_0x46a148(0x16a)),$(_0x46a148(0x195))[_0x46a148(0xbb)](_0x333936['d']['results'][0x0][_0x46a148(0x175)]);}console[_0x46a148(0x113)](departmentItemsArr);},'myError':function(_0x11bc8e){}});}function departmentOnChange(){$('#DepartmentDDL')['change'](function(){var _0x37ff2d=a0_0x2225;departmentItemsArr[_0x37ff2d(0x12a)](function(_0x34c11b){var _0xb4445a=_0x37ff2d;_0x34c11b['ID']==$(_0xb4445a(0x15a))['val']()&&($('#sharedDmsURL')[_0xb4445a(0xbb)](_0x34c11b['SiteURL']),CompanyID=_0x34c11b[_0xb4445a(0xe9)]);});});}