(function(_0x53b3a1,_0x271082){var _0x6dab92=a0_0x4036,_0x5ddf45=_0x53b3a1();while(!![]){try{var _0x544ce7=parseInt(_0x6dab92(0xc0))/0x1+parseInt(_0x6dab92(0xb7))/0x2+parseInt(_0x6dab92(0x8e))/0x3*(-parseInt(_0x6dab92(0x99))/0x4)+-parseInt(_0x6dab92(0xd6))/0x5+parseInt(_0x6dab92(0xb4))/0x6+parseInt(_0x6dab92(0x7f))/0x7+-parseInt(_0x6dab92(0x97))/0x8;if(_0x544ce7===_0x271082)break;else _0x5ddf45['push'](_0x5ddf45['shift']());}catch(_0xcc4f){_0x5ddf45['push'](_0x5ddf45['shift']());}}}(a0_0x5f1f,0xc7e21));const selectedFolders=[];var zip,listName='DemoLibrary';const myTimeout='';function a0_0x5f1f(){var _0x30bfe5=['catch','promise','2106860vcOZnW','html','<table>','resolve','stringify','download','webAbsoluteUrl','lastIndexOf','__next','fail','Error\x20checking\x20file\x20permissions:\x20','.chkShareToMe','Folders','length','BasePermissions','177789POuluJ','fileserverrelativeurl','ajax','slice','concat','has','substring','forEach','then','19701296CWFpxc','FileRef','24eKxRUa','/_api/web/lists/getbytitle(\x27','<input\x20type=\x27checkbox\x27\x20name=\x27files\x27\x20value=\x27','application/json;\x20odata=verbose','reject','/_api/web/GetFolderByServerRelativeUrl(\x27','ServerRelativeUrl','all','\x20Files/folders\x20with\x20restricted\x20view\x20permission\x20can\x27t\x20be\x20downloaded.','hide','</td><td>','SiteURL','blob','SelectedLibrary','checkbox','Restricted\x20file(s)\x20are\x20skipped\x20to\x20download','</td></tr>','indexOf','.chkFileFolder','\x27)/GetFolderByServerRelativeUrl(\x27','Network\x20response\x20was\x20not\x20ok','application/json;odata=verbose','generateAsync','/_api/web/lists/getByTitle(\x27DemoLibrary\x27)/items?$select=FileRef&$orderby=FileLeafRef&$filter=FSObjType\x20eq\x201','There\x20was\x20a\x20problem\x20with\x20the\x20fetch\x20operation:','\x27)/folders','results','8297742yGleLw','toJSON','createObjectURL','2578316aseRmM','href','IsBlock','file','EffectiveBasePermissions','fadeIn','&$skiptoken=','&$filter=FileDirRef\x20eq\x20\x27','LibraryName','1100354bfAObs','name','This\x20is\x20an\x20empty\x20folder\x20&\x20can\x27t\x20be\x20downloaded.','checked','map','#overlaysearch','openItems','\x27)?$expand=Folders,Files,\x20ListItemAllFields/EffectiveBasePermissions,\x20Files/ListItemAllFields/EffectiveBasePermissions','log','apply','done','ListItemAllFields','createElement','error','push','when','ServerURL','.zip','<tr><td>','PermissionKind','GET','\x27)/items?$top=5000','2182440ABqSno','files_'];a0_0x5f1f=function(){return _0x30bfe5;};return a0_0x5f1f();}function a0_0x4036(_0xc1890e,_0x4fc5df){var _0x5f1f8f=a0_0x5f1f();return a0_0x4036=function(_0x4036f7,_0x1b065f){_0x4036f7=_0x4036f7-0x7f;var _0x31b5b4=_0x5f1f8f[_0x4036f7];return _0x31b5b4;},a0_0x4036(_0xc1890e,_0x4fc5df);}var messagetext='',Ismessage=![],IsleftRestritcfile=![];async function downloadSelectedFilesAsZip(_0x1935de){$['getScript']('https://cdnjs.cloudflare.com/ajax/libs/jszip/3.7.1/jszip.min.js',function(){var _0x383e98=a0_0x4036;_0x1935de[0x0][_0x383e98(0xa6)]==undefined?(listName=_0x1935de[0x0][_0x383e98(0xbf)],SiteUrl=_0x1935de[0x0][_0x383e98(0xa4)]):listName=_0x1935de[0x0][_0x383e98(0xa6)];var _0x42a6f5=[];Ismessage=![],messagetext='';var _0x3605e2=_0x1935de[_0x383e98(0xc4)](function(_0x187d99){var _0x247c92=_0x383e98;_0x187d99[_0x247c92(0xb9)]!='Yes'?_0x187d99[_0x247c92(0x8f)]==undefined?$['when'](getFolderFilesAndSubFolders(_0x187d99[_0x247c92(0xd0)],_0x42a6f5))[_0x247c92(0xca)](function(_0xaf212b){return _0x3605e2=_0xaf212b;}):$[_0x247c92(0xcf)](getFolderFilesAndSubFolders(_0x187d99['fileserverrelativeurl'],_0x42a6f5))[_0x247c92(0xca)](function(_0x276f8b){return _0x3605e2=_0x276f8b;}):(Ismessage=!![],messagetext=_0x247c92(0xa1));}),_0x360e67='';_0x42a6f5[_0x383e98(0x8c)]>0x0?Promise[_0x383e98(0xa0)](_0x3605e2)['then'](function(){zip=new JSZip();var _0x158c2e=_0x42a6f5['map'](function(_0x36d192){var _0x23aa8c=a0_0x4036,_0x5d0cb2=_spPageContextInfo['portalUrl']+_0x36d192;return fetch(_0x5d0cb2)[_0x23aa8c(0x96)](function(_0x4590fd){var _0x5b3852=_0x23aa8c;if(!_0x4590fd['ok'])throw new Error(_0x5b3852(0xad));return _0x4590fd[_0x5b3852(0xa5)]();})[_0x23aa8c(0x96)](function(_0x2baee6){var _0x5ccae0=_0x23aa8c,_0x158697=_0x36d192[_0x5ccae0(0x94)](_0x36d192[_0x5ccae0(0xaa)](listName)+listName[_0x5ccae0(0x8c)]+0x1);zip[_0x5ccae0(0xba)](_0x158697,_0x2baee6);})[_0x23aa8c(0xd8)](_0x389a1d=>{var _0x9198bd=_0x23aa8c;console[_0x9198bd(0xcd)](_0x9198bd(0xb1),_0x389a1d);});});Promise['all'](_0x158c2e)['then'](function(){dowloadZip();});}):(Ismessage?alert(messagetext):alert(_0x383e98(0xc2)),IsleftRestritcfile=![],waitingDialog[_0x383e98(0xa2)]());});}function dowloadZip(){var _0x29f919=a0_0x4036;zip[_0x29f919(0xaf)]({'type':_0x29f919(0xa5)})[_0x29f919(0x96)](function(_0x1ff5ca){var _0x21a04e=_0x29f919,_0x27ff3c=document[_0x21a04e(0xcc)]('a');_0x27ff3c[_0x21a04e(0xb8)]=URL[_0x21a04e(0xb6)](_0x1ff5ca),_0x27ff3c[_0x21a04e(0x84)]=_0x21a04e(0xd7)+new Date()[_0x21a04e(0xb5)]()[_0x21a04e(0x91)](0x0,0x14)+_0x21a04e(0xd1),_0x27ff3c['click'](),waitingDialog[_0x21a04e(0xa2)](),IsleftRestritcfile&&(alert(_0x21a04e(0xa8)),IsleftRestritcfile=![]),$(_0x21a04e(0xab))['prop'](_0x21a04e(0xc3),![]),$(_0x21a04e(0x8a))['prop'](_0x21a04e(0xc3),![]),arrFileFolder=[];});}function getFilesFromLibrary(_0x469d94){var _0x59b244=a0_0x4036,_0x58fc20=_0x469d94+_0x59b244(0xb0);$['ajax']({'url':_0x58fc20,'type':_0x59b244(0xd4),'headers':{'Accept':_0x59b244(0xae)},'beforeSend':function(){var _0x237ee2=_0x59b244;$(_0x237ee2(0xc5))[_0x237ee2(0xbc)]();},'success':function(_0x5d3121){var _0x3d6f4f=_0x59b244,_0x5ce1e3=_0x5d3121['d'][_0x3d6f4f(0xb3)],_0x18ca87=[];_0x5ce1e3['forEach'](function(_0x89b6){var _0x2468a5=_0x3d6f4f,_0x2dd21b=_0x89b6[_0x2468a5(0x98)][_0x2468a5(0x94)](_0x89b6['FileRef'][_0x2468a5(0x86)]('/')+0x1),_0x48ca20={'name':_0x2dd21b,'url':_0x89b6[_0x2468a5(0x98)],'checkbox':_0x2468a5(0x9b)+_0x89b6[_0x2468a5(0x98)]+'\x27>'};_0x18ca87['push'](_0x48ca20);});var _0x578320=_0x3d6f4f(0x81);_0x578320+='<tr><th>Select</th><th>Name</th></tr>',_0x18ca87[_0x3d6f4f(0x95)](function(_0x32fd50){var _0x4a5eb3=_0x3d6f4f;_0x578320+=_0x4a5eb3(0xd2)+_0x32fd50[_0x4a5eb3(0xa7)]+_0x4a5eb3(0xa3)+_0x32fd50[_0x4a5eb3(0xc1)]+_0x4a5eb3(0xa9);}),_0x578320+='</table>',$('#fileList')[_0x3d6f4f(0x80)](_0x578320);},'error':function(_0x20044c){var _0x73bf96=_0x59b244;console[_0x73bf96(0xc8)](_0x20044c);}});}function getFolderFilesAndSubFolders(_0x592e08,_0x447716){var _0x4eb30c=a0_0x4036,_0x106743=SiteUrl+_0x4eb30c(0x9e)+_0x592e08+_0x4eb30c(0xc7);return jQuery[_0x4eb30c(0x90)]({'url':_0x106743,'type':_0x4eb30c(0xd4),'async':![],'headers':{'accept':_0x4eb30c(0xae)},'beforeSend':function(){},'success':function(_0x15349d){var _0x8bb2c5=_0x4eb30c,_0x235fd8=parseBasePermissionss(_0x15349d['d'][_0x8bb2c5(0xcb)][_0x8bb2c5(0xbb)]);if(_0x235fd8!=![]){var _0x4efd43=_0x15349d['d']['Files'][_0x8bb2c5(0xb3)];_0x4efd43[_0x8bb2c5(0x95)](function(_0x4dcd5a){var _0x41cf0f=_0x8bb2c5;parseBasePermissionss(_0x4dcd5a['ListItemAllFields'][_0x41cf0f(0xbb)])!=![]?_0x447716[_0x41cf0f(0xce)](_0x4dcd5a['ServerRelativeUrl']):IsleftRestritcfile=!![];});var _0x421410=_0x15349d['d'][_0x8bb2c5(0x8b)][_0x8bb2c5(0xb3)],_0x118261=_0x421410[_0x8bb2c5(0xc4)](function(_0x383515){var _0x96d148=_0x8bb2c5;getFolderFilesAndSubFolders(_0x383515[_0x96d148(0x9f)],_0x447716);});}else IsleftRestritcfile=!![];},'error':function(_0xa3ef1c){console['log'](_0xa3ef1c);}}),_0x447716;}function parseBasePermissionss(_0xc7d015){var _0x26a5ae=a0_0x4036,_0x157d13=new SP[(_0x26a5ae(0x8d))]();return _0x157d13['initPropertiesFromJson'](_0xc7d015),_0x157d13[_0x26a5ae(0x93)](SP[_0x26a5ae(0xd3)][_0x26a5ae(0xc6)]);}var Isnotpermission=![];function checkFilePermission(_0x10f5a0){var _0x40a4b5=a0_0x4036;Isnotpermission=![];var _0x4875f3=SiteUrl+'/_api/web/GetFolderByServerRelativePath(\x27'+_0x10f5a0+'\x27)?$select=ID,EncodedAbsUrl,File_x0020_Type&$expand=Folders,Folders/ListItemAllFields/HasUniqueRoleAssignments,Files/ModifiedBy/Title,Files/ListItemAllFields/HasUniqueRoleAssignments,Folders/ListItemAllFields,Files,Files/ListItemAllFields,Files/ListItemAllFields/FileSizeDisplay&$orderby=Modified\x20desc';return $[_0x40a4b5(0x90)]({'url':_0x4875f3,'type':_0x40a4b5(0xd4),'async':![],'headers':{'accept':_0x40a4b5(0xae)},'success':function(_0x4f41fb){debugger;},'error':function(_0x70cfce){var _0xce90a2=_0x40a4b5;console[_0xce90a2(0xc8)](_0xce90a2(0x89)+JSON[_0xce90a2(0x83)](_0x70cfce));}}),Isnotpermission;}function retrieveAllItemsFromFolder(_0x4ac62d,_0x29fe1a){var _0x50ab0e=a0_0x4036,_0x3661cf=$['Deferred'](),_0x5515f5=[];_0x3ecd63(_0x4ac62d,_0x29fe1a,null,_0x5515f5);function _0x3ecd63(_0x5dd45e,_0x5c162c,_0x3fdc57,_0x1609cc){var _0x6305cc=a0_0x4036,_0x270512=_spPageContextInfo[_0x6305cc(0x85)]+_0x6305cc(0x9a)+_0x5dd45e+_0x6305cc(0xd5);_0x5c162c&&(_0x270512+=_0x6305cc(0xbe)+_0x5c162c+'\x27'),_0x3fdc57&&(_0x270512+=_0x6305cc(0xbd)+encodeURIComponent(_0x3fdc57)),$[_0x6305cc(0x90)]({'url':_0x270512,'method':_0x6305cc(0xd4),'headers':{'Accept':_0x6305cc(0x9c)},'success':function(_0x3faf46){var _0x35b8b0=_0x6305cc;_0x1609cc=_0x1609cc['concat'](_0x3faf46['d']['results']);if(_0x3faf46['d']['__next']){var _0x34cc8f=_0x3faf46['d'][_0x35b8b0(0x87)],_0x519ac7=_0x34cc8f[_0x35b8b0(0x94)](_0x34cc8f[_0x35b8b0(0xaa)]('skiptoken=')+0xa);_0x3ecd63(_0x5dd45e,_0x5c162c,_0x519ac7,_0x1609cc);}else _0x372b1d(_0x5dd45e,_0x5c162c,_0x1609cc)[_0x35b8b0(0x96)](function(_0x3fa93f){var _0x22792b=_0x35b8b0;_0x3661cf[_0x22792b(0x82)](_0x3fa93f);})[_0x35b8b0(0x88)](function(_0x74b09f){_0x3661cf['reject'](_0x74b09f);});},'error':function(_0x13d4f2){var _0x43874a=_0x6305cc;_0x3661cf[_0x43874a(0x9d)](_0x13d4f2);}});}function _0x372b1d(_0x50e616,_0x355be5,_0x1abd50){var _0x1c5a3e=a0_0x4036,_0x16a2b8=$['Deferred'](),_0x4e369c=_spPageContextInfo[_0x1c5a3e(0x85)]+_0x1c5a3e(0x9a)+_0x50e616+_0x1c5a3e(0xac)+_0x355be5+_0x1c5a3e(0xb2);return $[_0x1c5a3e(0x90)]({'url':_0x4e369c,'method':_0x1c5a3e(0xd4),'headers':{'Accept':_0x1c5a3e(0x9c)},'success':function(_0x3e5c21){var _0x55dfbe=_0x1c5a3e,_0x2010d0=_0x3e5c21['d'][_0x55dfbe(0xb3)],_0x37d353=$[_0x55dfbe(0xc4)](_0x2010d0,function(_0x423882){var _0x4175ff=_0x55dfbe,_0x1bd983=_0x423882[_0x4175ff(0x9f)];return _0x3ecd63(_0x50e616,_0x1bd983,null,_0x1abd50);});$[_0x55dfbe(0xcf)][_0x55dfbe(0xc9)]($,_0x37d353)[_0x55dfbe(0xca)](function(){var _0x5c642e=_0x55dfbe,_0x4b83a6=[];for(var _0x1e5181=0x0;_0x1e5181<arguments['length'];_0x1e5181++){_0x4b83a6=_0x4b83a6[_0x5c642e(0x92)](arguments[_0x1e5181]);}var _0x595a44=_0x1abd50['concat'](_0x4b83a6);_0x16a2b8[_0x5c642e(0x82)](_0x595a44);})[_0x55dfbe(0x88)](function(_0x2a341f){var _0xce48b6=_0x55dfbe;_0x16a2b8[_0xce48b6(0x9d)](_0x2a341f);});},'error':function(_0x449ae3){var _0x16bbb1=_0x1c5a3e;_0x16a2b8[_0x16bbb1(0x9d)](_0x449ae3);}}),_0x16a2b8[_0x1c5a3e(0xd9)]();}return _0x3661cf[_0x50ab0e(0xd9)]();}