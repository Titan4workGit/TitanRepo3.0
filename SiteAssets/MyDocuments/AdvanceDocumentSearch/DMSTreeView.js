var a0_0x2b038c=a0_0x2356;(function(_0xdfe27a,_0x3e340c){var _0x20bcfb=a0_0x2356,_0x24d9e8=_0xdfe27a();while(!![]){try{var _0x3411a5=-parseInt(_0x20bcfb(0x15b))/0x1+-parseInt(_0x20bcfb(0x1a9))/0x2*(parseInt(_0x20bcfb(0x17f))/0x3)+-parseInt(_0x20bcfb(0x2b7))/0x4+parseInt(_0x20bcfb(0x22c))/0x5+parseInt(_0x20bcfb(0x174))/0x6*(parseInt(_0x20bcfb(0x1b0))/0x7)+parseInt(_0x20bcfb(0x2a3))/0x8*(-parseInt(_0x20bcfb(0x218))/0x9)+-parseInt(_0x20bcfb(0x1da))/0xa*(-parseInt(_0x20bcfb(0x1ce))/0xb);if(_0x3411a5===_0x3e340c)break;else _0x24d9e8['push'](_0x24d9e8['shift']());}catch(_0x49ac83){_0x24d9e8['push'](_0x24d9e8['shift']());}}}(a0_0x37fb,0x202f5));var SharingUserEmail=[],SharingUserId=[],SharingUserName=[];$(document)[a0_0x2b038c(0x219)](function(){var _0x51707b=a0_0x2b038c;InitializePeoplePicker(_0x51707b(0x2bf),!![]),onChangeSharing(_0x51707b(0x1b9),'SharingPplPicker',_0x51707b(0x271)),$(_0x51707b(0x2e3))[_0x51707b(0x2cc)](function(){var _0x281244=_0x51707b,_0x39887e=this[_0x281244(0x1aa)];SharingUserEmail=[],SharingUserId=[],SharingUserName=[],$(_0x281244(0x1a7))[_0x281244(0x184)]();if(_0x39887e==_0x281244(0x163))$(_0x281244(0x222))[_0x281244(0x2b6)](),$(_0x281244(0x28c))[_0x281244(0x22d)](),$(_0x281244(0x209))['hide'](),$(_0x281244(0x188))[_0x281244(0x22d)](),$(_0x281244(0x198))[_0x281244(0x2b6)](),$('#AddUserPplPicker')['show'](),$('#userDiv')[_0x281244(0x2b6)](),$(_0x281244(0x206))[_0x281244(0x29b)]()==''&&getMyGroups();else{if(_0x39887e==_0x281244(0x217))$(_0x281244(0x222))[_0x281244(0x22d)](),$(_0x281244(0x28c))[_0x281244(0x2b6)](),$(_0x281244(0x209))[_0x281244(0x22d)](),$(_0x281244(0x188))['hide'](),$('#userDiv')[_0x281244(0x2b6)](),$(_0x281244(0x26a))[_0x281244(0x22d)](),$('#userDiv')['hide'](),$(_0x281244(0x220))['html']()==''&&getGuestClientShare();else{if(_0x39887e=='Project-Team')$('.My-Groups')[_0x281244(0x22d)](),$('.Organization')[_0x281244(0x22d)](),$(_0x281244(0x209))[_0x281244(0x2b6)](),$(_0x281244(0x188))['hide'](),$(_0x281244(0x198))[_0x281244(0x2b6)](),$(_0x281244(0x26a))[_0x281244(0x2b6)](),$(_0x281244(0x198))[_0x281244(0x2b6)](),$(_0x281244(0x18f))['html']()==''&&loadProjects();else _0x39887e==_0x281244(0x1e5)?($('.My-Groups')[_0x281244(0x22d)](),$(_0x281244(0x28c))['hide'](),$(_0x281244(0x209))[_0x281244(0x22d)](),$('.Selective')[_0x281244(0x2b6)](),$(_0x281244(0x26a))['show'](),$(_0x281244(0x198))[_0x281244(0x2b6)](),$(_0x281244(0x198))['show']()):($(_0x281244(0x222))['hide'](),$(_0x281244(0x28c))[_0x281244(0x22d)](),$(_0x281244(0x209))[_0x281244(0x22d)](),$(_0x281244(0x188))['hide'](),$(_0x281244(0x26a))[_0x281244(0x2b6)](),$(_0x281244(0x198))['hide']());}}}),$(_0x51707b(0x239))[_0x51707b(0x2b4)](function(){ShareFileValidation()==!![]&&shareFile();}),$(_0x51707b(0x1bf))['click'](function(){var _0x16a7a2=_0x51707b;GetSharedHistory(DocumentId,$(_0x16a7a2(0x283))['text'](),$(_0x16a7a2(0x152))[_0x16a7a2(0x19f)](),$('#FileDocType')[_0x16a7a2(0x19f)](),$('#FileName')['text'](),_0x16a7a2(0x27b));}),$(_0x51707b(0x167))[_0x51707b(0x2b4)](function(){var _0x2a49ce=_0x51707b;$(_0x2a49ce(0x18d))['prop']('checked',$(this)[_0x2a49ce(0x229)](_0x2a49ce(0x16d))),selectedHistoryDoc=[],selectedHistoryDocrelativeurl=[],$(_0x2a49ce(0x18d))['each'](function(){var _0x591e61=_0x2a49ce;$(this)[_0x591e61(0x229)](_0x591e61(0x16d))==!![]?(selectedHistoryDoc[_0x591e61(0x244)]($(this)[_0x591e61(0x254)]()),$(_0x591e61(0x14d))[_0x591e61(0x2b6)]()):$(_0x591e61(0x14d))[_0x591e61(0x22d)]();});}),$('#expiredats')[_0x51707b(0x2cc)](function(){var _0x5dcd5d=_0x51707b;if(new Date()>new Date($(_0x5dcd5d(0x26c))[_0x5dcd5d(0x254)]()))return alert(_0x5dcd5d(0x25e)),![];}),$(_0x51707b(0x1d4))[_0x51707b(0x2b4)](function(){var _0x34fb92=_0x51707b;$(_0x34fb92(0x2d3))[_0x34fb92(0x254)](''),$(_0x34fb92(0x2b1))['val']('Contribute'),$(_0x34fb92(0x2b1))['trigger'](_0x34fb92(0x2cc)),$(_0x34fb92(0x24d))[_0x34fb92(0x229)]('checked','checked'),$('#expiredon')['prop'](_0x34fb92(0x16d),''),$(_0x34fb92(0x26c))[_0x34fb92(0x21e)]('activating'),$(_0x34fb92(0x270))[_0x34fb92(0x229)](_0x34fb92(0x16d),''),$(_0x34fb92(0x288))[_0x34fb92(0x229)](_0x34fb92(0x16d),''),$(_0x34fb92(0x1ae))[_0x34fb92(0x229)](_0x34fb92(0x16d),''),$(_0x34fb92(0x26f))[_0x34fb92(0x229)]('checked',''),$(_0x34fb92(0x14e))[_0x34fb92(0x229)](_0x34fb92(0x16d),''),$(_0x34fb92(0x1a5))[_0x34fb92(0x19f)](_0x34fb92(0x27c)),$(_0x34fb92(0x2e3))[_0x34fb92(0x254)]('--Select--'),$(_0x34fb92(0x2e3))[_0x34fb92(0x299)]('change');});});function shareFile(){var _0x1b5b3f=a0_0x2b038c,_0x5c5ca5=[],_0x1aee3f=[],_0x2bce01=!![];sharedUsersIdArrayListItemCollection=[],sharedUsersIdArrayListItemCollection=SharingUserId[_0x1b5b3f(0x1af)](function(_0x14d061){return _0x14d061;});var _0x41fd2c=$('#sharewith')[_0x1b5b3f(0x254)](),_0x56f7c9=$(_0x1b5b3f(0x2b1))['val'](),_0x43a352=DocumentId[_0x1b5b3f(0x2cb)](),_0x287850=$('#FilePath')['text']();_0x5c5ca5=getSharedUsersId(_0x43a352);if(sharedUsersIdArrayListItemCollection['length']==0x0){for(var _0x5ae4dd=0x0;_0x5ae4dd<SharingUserEmail[_0x1b5b3f(0x1e6)];_0x5ae4dd++){SharingUserId[_0x1b5b3f(0x244)](parseInt(SharingUserEmail[_0x5ae4dd][_0x1b5b3f(0x224)]));}sharedUsersIdArrayListItemCollection=SharingUserId['filter'](function(_0x159195){return _0x159195;});}_0x1aee3f=$[_0x1b5b3f(0x1b5)](_0x5c5ca5,function(_0x4ab0c3){var _0x4fae94=_0x1b5b3f;return $[_0x4fae94(0x214)](_0x4ab0c3,sharedUsersIdArrayListItemCollection)!==-0x1;}),sharedUsersIdArrayListItemCollection=sharedUsersIdArrayListItemCollection[_0x1b5b3f(0x2a5)](_0x5c5ca5);_0x41fd2c==_0x1b5b3f(0x217)?_0x2bce01=getTargetRoleDefinitionId():_0x2bce01=ShareFilesFolder(_0x287850,_0x1b5b3f(0x27b),'',_0x41fd2c);_0x2bce01!=![]&&(_0x2bce01=!![]);if(sharedUsersIdArrayListItemCollection[_0x1b5b3f(0x1e6)]>0x0&&_0x2bce01==!![]){var _0x4ea37b=$(_0x1b5b3f(0x2e3))[_0x1b5b3f(0x254)]();updateDocumentPropertiesOnItemSharing(_0x43a352,_0x287850,_0x41fd2c,sharedUsersIdArrayListItemCollection,CopySourceURL,![]),GetDocumentsRevoke(_0x1aee3f,_0x43a352);var _0x13900e=[];_0x13900e=getSharedType();_0x41fd2c==_0x1b5b3f(0x217)?AddSharedLinkToListOrg(_0x287850,_0x43a352,_0x1b5b3f(0x27b),$(_0x1b5b3f(0x2e3))['val'](),$(_0x1b5b3f(0x2b1))[_0x1b5b3f(0x254)](),_0x13900e[0x0],$(_0x1b5b3f(0x17a))[_0x1b5b3f(0x19f)](),_0x13900e[0x1]):AddSharedLinkToList(_0x287850,SharingUserId,_0x43a352,_0x1b5b3f(0x27b),$(_0x1b5b3f(0x2e3))[_0x1b5b3f(0x254)](),$(_0x1b5b3f(0x2b1))['val'](),_0x13900e[0x0],$(_0x1b5b3f(0x17a))[_0x1b5b3f(0x19f)](),_0x13900e[0x1]);if($('#notifymail')[_0x1b5b3f(0x229)]('checked')==!![]){var _0x54f5ee=[],_0x48899a=$(_0x1b5b3f(0x16e))[_0x1b5b3f(0x19f)]();if(SharingUserEmail[_0x1b5b3f(0x1e6)]>0x0){var _0x4092b3='';_0x4092b3='Dear\x20User,<br/><br/>'+_spPageContextInfo['userDisplayName']+_0x1b5b3f(0x266),_0x4092b3=_0x4092b3+_0x1b5b3f(0x26b)+$(_0x1b5b3f(0x199))['text']()+_0x1b5b3f(0x2c7)+_0x1b5b3f(0x2c3)+$('#FileReference')[_0x1b5b3f(0x19f)]()+_0x1b5b3f(0x2c7)+_0x1b5b3f(0x1d3)+$(_0x1b5b3f(0x152))[_0x1b5b3f(0x19f)]()+'</div>'+_0x1b5b3f(0x20b)+$(_0x1b5b3f(0x17a))[_0x1b5b3f(0x19f)]()+_0x1b5b3f(0x2c7)+_0x1b5b3f(0x172)+_0x48899a+_0x1b5b3f(0x2c7)+_0x1b5b3f(0x20e)+$(_0x1b5b3f(0x2d3))['val']()+_0x1b5b3f(0x2c7)+_0x1b5b3f(0x260)+$(_0x1b5b3f(0x2e1))[_0x1b5b3f(0x254)]()+_0x1b5b3f(0x232)+_0x1b5b3f(0x2ca),_0x4092b3+='This\x20is\x20an\x20auto\x20generated\x20email.\x20Please\x20don\x27t\x20reply.';}var _0x5746fb=$(_0x1b5b3f(0x1d9))[_0x1b5b3f(0x19f)](),_0x1aaab4;$(_0x1b5b3f(0x2e3))['val']()=='Organization'?SharingUserEmail[_0x1b5b3f(0x25b)](function(_0x2f2fec,_0x15a43d){var _0x55165d=_0x1b5b3f;_0x54f5ee['push'](_0x2f2fec[_0x55165d(0x1ab)]);}):_0x54f5ee=SharingUserEmail['filter'](function(_0x20390c){return _0x20390c;}),_0x1aaab4={'properties':{'__metadata':{'type':_0x1b5b3f(0x151)},'From':_spPageContextInfo[_0x1b5b3f(0x192)],'To':{'results':_0x54f5ee},'Body':_0x4092b3,'Subject':_0x1b5b3f(0x252)}},SendEmailSharedNotification(_0x1aaab4);}else alert('File\x20has\x20been\x20shared.'),$(_0x1b5b3f(0x2bd))[_0x1b5b3f(0x19f)](_0x1b5b3f(0x1f0)+$('#sharewith')['val']()),$(_0x1b5b3f(0x1bf))[_0x1b5b3f(0x2b6)](),$(_0x1b5b3f(0x1d4))[_0x1b5b3f(0x299)](_0x1b5b3f(0x2b4));}}function getSharedType(){var _0x56f2ee=a0_0x2b038c,_0x52e9a5=[];if($('#LibProject')[_0x56f2ee(0x19f)]()==_0x56f2ee(0x1d7))_0x52e9a5['push']('My-DMS'),_0x52e9a5[_0x56f2ee(0x244)](_spPageContextInfo[_0x56f2ee(0x2e5)]);else{if($('#LibProject')[_0x56f2ee(0x19f)]()[_0x56f2ee(0x221)](_0x56f2ee(0x1c7))!=-0x1)_0x52e9a5[_0x56f2ee(0x244)](_0x56f2ee(0x1c7)),_0x52e9a5[_0x56f2ee(0x244)]($(_0x56f2ee(0x1f3))['text']()[_0x56f2ee(0x29c)](':\x20')[0x1]);else{if($(_0x56f2ee(0x1f3))[_0x56f2ee(0x19f)]()[_0x56f2ee(0x221)](_0x56f2ee(0x1e9))!=-0x1)_0x52e9a5[_0x56f2ee(0x244)]('Group'),_0x52e9a5[_0x56f2ee(0x244)]($(_0x56f2ee(0x1f3))[_0x56f2ee(0x19f)]()['split'](':\x20')[0x1]);else{if($(_0x56f2ee(0x1f3))[_0x56f2ee(0x19f)]()['indexOf'](_0x56f2ee(0x2b5))!=-0x1)_0x52e9a5[_0x56f2ee(0x244)](_0x56f2ee(0x2b5)),_0x52e9a5['push']($('#LibProject')[_0x56f2ee(0x19f)]()[_0x56f2ee(0x29c)](':\x20')[0x1]);else $(_0x56f2ee(0x1f3))[_0x56f2ee(0x19f)]()['indexOf'](_0x56f2ee(0x1c9))!=-0x1&&(_0x52e9a5[_0x56f2ee(0x244)]('Guest'),_0x52e9a5[_0x56f2ee(0x244)]($('#LibProject')[_0x56f2ee(0x19f)]()[_0x56f2ee(0x29c)](':\x20')[0x1]));}}}return _0x52e9a5;}function SendEmailSharedNotification(_0x4a986f){var _0x29cbc1=a0_0x2b038c,_0x27ccf6=_spPageContextInfo[_0x29cbc1(0x1b4)]+_0x29cbc1(0x1f6);$[_0x29cbc1(0x1e3)]({'contentType':'application/json','url':_0x27ccf6,'type':_0x29cbc1(0x204),'data':JSON['stringify'](_0x4a986f),'headers':{'Accept':_0x29cbc1(0x1f1),'content-type':_0x29cbc1(0x1f1),'X-RequestDigest':$(_0x29cbc1(0x22f))[_0x29cbc1(0x254)]()},'success':function(_0x320f84){var _0x55925e=_0x29cbc1;alert('File\x20has\x20been\x20shared.'),$('#FileSharing')[_0x55925e(0x19f)](_0x55925e(0x1f0)+$(_0x55925e(0x2e3))['val']()),$(_0x55925e(0x1bf))[_0x55925e(0x2b6)](),$(_0x55925e(0x1d4))[_0x55925e(0x299)](_0x55925e(0x2b4));},'error':function(_0x371c98){var _0x1f560f=_0x29cbc1;waitingDialog['hide'](),alert(_0x1f560f(0x171)+JSON[_0x1f560f(0x28f)](_0x371c98));}});}function AddSharedLinkToListOrg(_0x4ea646,_0x3657b3,_0x401426,_0x691355,_0x4fa72c,_0x2126f4,_0x4861e2,_0x5402c3){var _0x1d0811=a0_0x2b038c;IsBlock='No';var _0x4a2553='SharedDocument',_0x59e5c1=GetItemTypeForListName(_0x4a2553);for(k=0x0;k<SharingUserEmail[_0x1d0811(0x1e6)];k++){if(SharingUserEmail[k][_0x1d0811(0x224)]!=null&&SharingUserEmail[k]['GroupId']!=''&&SharingUserEmail[k][_0x1d0811(0x224)]!=_0x1d0811(0x2d4)&&SharingUserEmail[k]['GroupId']!=_0x1d0811(0x1ca)){var _0x2ebf31=[];_0x2ebf31[_0x1d0811(0x244)](SharingUserEmail[k]['GroupId']);var _0x5a1abf;_0x4fa72c==_0x1d0811(0x263)&&(IsBlock='Yes');var _0x198db3=null;$(_0x1d0811(0x26c))[_0x1d0811(0x254)]()!=''&&(_0x198db3=GetDateStandardFormat(moment($(_0x1d0811(0x26c))[_0x1d0811(0x254)]())[_0x1d0811(0x1e8)](_0x1d0811(0x1bd)))),_0x5a1abf={'__metadata':{'type':_0x59e5c1},'Title':$(_0x1d0811(0x199))[_0x1d0811(0x19f)](),'DocumentURL':_0x4ea646,'SharedUsersId':{'results':_0x2ebf31},'DocumentID':_0x3657b3,'DOC_IDId':_0x3657b3,'SharedClientId':parseInt(SharingUserEmail[k]['ClientId']),'DocumentType':_0x401426,'SharedGroup':_0x691355,'PermissionType':_0x4fa72c,'ServerRedirectedEmbedURL':'','IsBlock':IsBlock,'SharedType':_0x2126f4,'SharedFrom':_0x5402c3,'SharedMessage':$(_0x1d0811(0x2d3))[_0x1d0811(0x254)](),'SharingValidity':_0x198db3,'NeedAcknowledgement':$(_0x1d0811(0x14e))[_0x1d0811(0x229)]('checked'),'LibraryURL':'','LibraryName':CopyLibrary,'SiteURL':CopySourceURL,'DocType':_0x4861e2},$['when'](AddItemToListGroups(_0x4a2553,_0x5a1abf))[_0x1d0811(0x1b2)](function(_0x4ddc1d){});}}}function AddSharedLinkToList(_0x58f493,_0x747a1b,_0xab61b1,_0x45cd3a,_0x5b997b,_0x5d06b9,_0x116ee6,_0xff115a,_0x3e1783){var _0x50b8c6=a0_0x2b038c;IsBlock='No';var _0x503763='SharedDocument',_0x3db08e=GetItemTypeForListName(_0x503763);for(k=0x0;k<_0x747a1b['length'];k++){var _0xbb613e=[];_0xbb613e['push'](_0x747a1b[k]);var _0x1c921c;_0x5d06b9=='Restricted\x20View'&&(IsBlock=_0x50b8c6(0x201));var _0x47c6b0=null;$(_0x50b8c6(0x26c))[_0x50b8c6(0x254)]()!=''&&(_0x47c6b0=GetDateStandardFormat(moment($('#expiredats')[_0x50b8c6(0x254)]())['format'](_0x50b8c6(0x1bd)))),_0x1c921c={'__metadata':{'type':_0x3db08e},'Title':$(_0x50b8c6(0x199))[_0x50b8c6(0x19f)](),'DocumentURL':_0x58f493,'SharedUsersId':{'results':_0xbb613e},'SharedUserEmail':SharingUserEmail[k],'DocumentID':_0xab61b1,'DOC_IDId':_0xab61b1,'DocumentType':_0x45cd3a,'SharedGroup':_0x5b997b,'PermissionType':_0x5d06b9,'ServerRedirectedEmbedURL':'','IsBlock':IsBlock,'SharedType':_0x116ee6,'SharedFrom':_0x3e1783,'SharedMessage':$(_0x50b8c6(0x2d3))[_0x50b8c6(0x254)](),'SharingValidity':_0x47c6b0,'NeedAcknowledgement':$(_0x50b8c6(0x14e))[_0x50b8c6(0x229)](_0x50b8c6(0x16d)),'LibraryURL':'','LibraryName':CopyLibrary,'SiteURL':CopySourceURL,'DocType':_0xff115a},$[_0x50b8c6(0x1cc)](AddItemToListGroups(_0x503763,_0x1c921c))[_0x50b8c6(0x1b2)](function(_0xa5d067){});}}function AddItemToListGroups(_0x1e3a4a,_0x51c6c0){var _0x1b83cd=a0_0x2b038c,_0x3e816d=$[_0x1b83cd(0x284)]();return $[_0x1b83cd(0x1e3)]({'url':_spPageContextInfo[_0x1b83cd(0x238)]+_0x1b83cd(0x1d5)+_0x1e3a4a+_0x1b83cd(0x1eb),'type':'POST','async':![],'headers':{'accept':_0x1b83cd(0x1f1),'X-RequestDigest':$(_0x1b83cd(0x22f))[_0x1b83cd(0x254)](),'content-Type':_0x1b83cd(0x1f1)},'data':JSON['stringify'](_0x51c6c0),'success':function(_0x477fb9){var _0x1aed2a=_0x1b83cd;_0x3e816d[_0x1aed2a(0x289)](_0x477fb9);},'error':function(_0x3d419f){var _0x22777e=_0x1b83cd;alert(JSON[_0x22777e(0x28f)](_0x3d419f)),_0x3e816d[_0x22777e(0x179)](_0x3d419f);}}),_0x3e816d[_0x1b83cd(0x189)]();}function updateItemWithIDItemListDocuments(_0x967755,_0x41ddd6,_0x533c40,_0x48d4c3,_0x4bee08){var _0x144067=a0_0x2b038c,_0x3db6e5=$['Deferred']();_0x967755=='Shared%20Documents'&&(_0x967755=_0x144067(0x259));_0x48d4c3!=_spPageContextInfo['webAbsoluteUrl']&&$['when'](GetFormDigestValue(_0x48d4c3))[_0x144067(0x1b2)](function(_0x332636){RequestDigest=_0x332636;});var _0x21fca3=_0x48d4c3+_0x144067(0x2e0)+_0x967755+_0x144067(0x2be)+_0x533c40+')';return $[_0x144067(0x1e3)]({'url':_0x21fca3,'type':_0x144067(0x204),'async':_0x4bee08,'headers':{'accept':_0x144067(0x1f1),'X-RequestDigest':RequestDigest,'content-Type':'application/json;odata=verbose','X-Http-Method':'PATCH','If-Match':'*'},'data':JSON[_0x144067(0x28f)](_0x41ddd6),'success':function(_0x55ce14){var _0x58da93=_0x144067;RequestDigest=$(_0x58da93(0x22f))[_0x58da93(0x254)](),console[_0x58da93(0x24e)](_0x533c40+_0x58da93(0x21f)),_0x3db6e5[_0x58da93(0x289)](!![]);},'error':function(_0x4ee0d2){var _0x2b2765=_0x144067;RequestDigest=$('#__REQUESTDIGEST')[_0x2b2765(0x254)](),_0x4ee0d2[_0x2b2765(0x2cf)][_0x2b2765(0x221)](_0x2b2765(0x1e7))!=-0x1&&alert(_0x2b2765(0x2de)),_0x3db6e5['reject'](_0x4ee0d2),waitingDialog[_0x2b2765(0x22d)]();}}),_0x3db6e5[_0x144067(0x189)]();}function GetDocumentsRevoke(_0x2f6d1a,_0x416d8d){var _0x1dcd73=a0_0x2b038c;arrSharedUser=[];$(_0x1dcd73(0x2e3))['val']()=='Organization'?SharingUserEmail['forEach'](function(_0x5b4457,_0x2bc44b){var _0xa8087c=_0x1dcd73;arrSharedUser['push'](_0x5b4457[_0xa8087c(0x224)]);}):arrSharedUser=_0x2f6d1a[_0x1dcd73(0x1af)](function(_0x4ddb84){return _0x4ddb84;});for(k=0x0;k<arrSharedUser['length'];k++){var _0x420d6d=_0x1dcd73(0x29e)+arrSharedUser[k]+_0x1dcd73(0x2bb)+_0x416d8d+_0x1dcd73(0x1f4),_0x13e905=_0x1dcd73(0x1ff)+_0x420d6d;$[_0x1dcd73(0x1cc)](getItemsWithQuery(_0x1dcd73(0x237),_0x13e905))[_0x1dcd73(0x1b2)](function(_0x4a7f84){var _0x19e4a7=_0x1dcd73;for(var _0x514f8d=0x0;_0x514f8d<_0x4a7f84[_0x19e4a7(0x1e6)];_0x514f8d++){currentItemId=_0x4a7f84[_0x514f8d]['ID'];var _0x376d4a=_0x19e4a7(0x237),_0x2f892f,_0x4b41d8=GetItemTypeForListName(_0x376d4a);_0x2f892f={'__metadata':{'type':_0x4b41d8},'PermissionStatus':'Revoked','share_remarks':'Revoked\x20due\x20to\x20re-share','SharedEnd':new Date()[_0x19e4a7(0x2a7)]()},$[_0x19e4a7(0x1cc)](updateItemWithIDItemListDocuments(_0x376d4a,_0x2f892f,currentItemId,_spPageContextInfo[_0x19e4a7(0x238)]))[_0x19e4a7(0x1b2)](function(_0x4969b5){var _0x21473b=_0x19e4a7;console[_0x21473b(0x24e)](_0x21473b(0x19e));});}});}}function updateDocumentPropertiesOnItemSharing(_0x279964,_0x58220c,_0x9c5e4b,_0xe76a85,_0x1308ae,_0x5bf6c5){var _0x1c1020=a0_0x2b038c,_0x3c8e96=$(_0x1c1020(0x2b1))[_0x1c1020(0x254)](),_0x2c3be4='';if($('#sharedWithPermission')[_0x1c1020(0x254)]()==_0x1c1020(0x1d0))_0x2c3be4=_0x1c1020(0x157);else $(_0x1c1020(0x2b1))['val']()==_0x1c1020(0x159)?_0x2c3be4='1073741826':_0x2c3be4=_0x1c1020(0x173);var _0xcc15c0=CopyLibrary,_0x6d267f;if(_0xcc15c0['includes']('Documents')==!![])var _0x8e1277=GetItemTypeForLibraryName(_0x1c1020(0x226));else var _0x8e1277=GetItemTypeForLibraryName(_0xcc15c0);_0x6d267f={'__metadata':{'type':_0x8e1277},'SecurityLevel':_0x9c5e4b,'PermissionLevel':_0x3c8e96,'PermissionLevelId':_0x2c3be4,'SharedId':{'results':_0xe76a85}},updateItemWithIDItemListDocuments(_0xcc15c0,_0x6d267f,_0x279964,_0x1308ae,_0x5bf6c5)[_0x1c1020(0x1b2)](function(){})[_0x1c1020(0x205)](function(_0x3166ac){var _0x1f84cb=_0x1c1020;console[_0x1f84cb(0x24e)](_0x3166ac);});}function ShareFilesFolder(_0x397a54,_0x1a4399,_0x5d772a){var _0xf8738d=a0_0x2b038c,_0x1c40c8=[],_0x43df06=0x2;if($(_0xf8738d(0x2b1))[_0xf8738d(0x254)]()==_0xf8738d(0x159))_0x43df06=0x1;else $(_0xf8738d(0x2b1))[_0xf8738d(0x254)]()==_0xf8738d(0x263)&&(_0x43df06=0x4);_0x397a54[_0xf8738d(0x1b7)](_0xf8738d(0x259))==!![]&&_0x397a54[_0xf8738d(0x1b7)](_0xf8738d(0x2c4))==![]&&(_0x397a54=_0x397a54['replace'](_0xf8738d(0x259),'Shared%20Documents'));var _0x3b9951=createJSONMetadata(SharingUserEmail,_0x43df06),_0x2b1151=_spPageContextInfo[_0xf8738d(0x238)]+'/_api/SP.Sharing.DocumentSharingManager.UpdateDocumentSharingInfo';return $[_0xf8738d(0x1e3)]({'url':_0x2b1151,'method':_0xf8738d(0x204),'async':![],'data':JSON[_0xf8738d(0x28f)]({'resourceAddress':document['location'][_0xf8738d(0x1e4)]+_0x397a54,'userRoleAssignments':_0x3b9951,'validateExistingPermissions':![],'additiveMode':![],'sendServerManagedNotification':![],'customMessage':'Please\x20look\x20at\x20the\x20following\x20File/Folder.','includeAnonymousLinksInNotification':![]}),'headers':{'accept':_0xf8738d(0x1f1),'content-type':_0xf8738d(0x1f1),'X-RequestDigest':$(_0xf8738d(0x22f))[_0xf8738d(0x254)]()},'success':function(_0x14c750){var _0x319b44=_0xf8738d;console[_0x319b44(0x24e)](_0x319b44(0x1a3)),SharingRespose=!![];},'error':function(_0x1fb58c){var _0x9d615c=_0xf8738d;return SharingRespose=![],_0x1fb58c['responseText'][_0x9d615c(0x1b7)]('The\x20caller\x20has\x20no\x20permissions\x20to\x20grant\x20permission')==!![]?(alert(_0x9d615c(0x2ce)+$('#FileName')['text']()+'\x20to\x20perform\x20this\x20operation.'),![]):(alert(_0x1fb58c[_0x9d615c(0x2cf)]),![]);}}),SharingRespose;}function createJSONMetadata(_0x301e98,_0x512c40){var _0x13f0b5=a0_0x2b038c,_0x4f82cf=[],_0x1b3a27={};_0x1b3a27[_0x13f0b5(0x1bc)]=_0x13f0b5(0x20d);for(var _0x360f75=0x0;_0x360f75<_0x301e98['length'];_0x360f75++){var _0x57064e={};_0x57064e['__metadata']=_0x1b3a27,_0x57064e['Role']=parseInt(_0x512c40),_0x57064e[_0x13f0b5(0x1c4)]=_0x301e98[_0x360f75],_0x4f82cf['push'](_0x57064e);}return _0x4f82cf;}function getSharedUsersId(_0x41a183){var _0x446076=a0_0x2b038c,_0xd005b2=[];CopyLibrary==_0x446076(0x2c4)&&(CopyLibrary=_0x446076(0x259));CopySourceURL!=_spPageContextInfo[_0x446076(0x238)]&&$[_0x446076(0x1cc)](GetFormDigestValue(CopySourceURL))[_0x446076(0x1b2)](function(_0x53ce22){RequestDigest=_0x53ce22;});var _0x2690c9=CopySourceURL+'/_api/web/Lists/GetByTitle(\x27'+CopyLibrary+_0x446076(0x264)+_0x41a183+')?$select=ServerRedirectedEmbedUri,File/Name,File/ServerRelativeUrl,Folder/Name,Folder/ServerRelativeUrl,Shared/Title,SharedId&$expand=File,Folder,SharedId';return $[_0x446076(0x1e3)]({'url':_0x2690c9,'headers':{'accept':_0x446076(0x1f1),'content-type':_0x446076(0x1f1),'X-RequestDigest':RequestDigest},'async':![],'success':function(_0x58bac1){var _0x5035f8=_0x446076;RequestDigest=$(_0x5035f8(0x22f))[_0x5035f8(0x254)]();if(_0x58bac1['d'][_0x5035f8(0x2e2)]!=null)for(var _0x2234a7=0x0;_0x2234a7<_0x58bac1['d']['SharedId'][_0x5035f8(0x1ea)]['length'];_0x2234a7++){var _0x28b967=_0x58bac1['d'][_0x5035f8(0x2e2)][_0x5035f8(0x1ea)][_0x2234a7];_0xd005b2[_0x5035f8(0x244)](_0x28b967);}},'eror':function(_0x336df7){var _0x3309ac=_0x446076;RequestDigest=$(_0x3309ac(0x22f))[_0x3309ac(0x254)](),console[_0x3309ac(0x24e)](_0x336df7);}}),_0xd005b2;}function ShareFileValidation(){var _0x1c2cee=a0_0x2b038c;if(SharingUserEmail[_0x1c2cee(0x1e6)]==0x0){alert(_0x1c2cee(0x19a));return;}else{if($('#expiredon')[_0x1c2cee(0x229)](_0x1c2cee(0x16d))&&$(_0x1c2cee(0x26c))[_0x1c2cee(0x254)]()==''){alert(_0x1c2cee(0x17d));return;}else return new Date()>new Date($('#expiredats')[_0x1c2cee(0x254)]())?(alert('Expiry\x20date\x20should\x20me\x20greater\x20than\x20today.'),![]):!![];}}function loadProjects(){var _0x129b05=a0_0x2b038c,_0x3a84c9='',_0x5263c5=_0x129b05(0x186)+_spPageContextInfo['userEmail']+'\x27\x20';$['when'](getItemsWithQuery(_0x129b05(0x16c),_0x5263c5))[_0x129b05(0x1b2)](function(_0x1dbf64){var _0x1c8700=_0x129b05;if(_0x1dbf64['length']>0x0){for(var _0xae8d5f=0x0;_0xae8d5f<_0x1dbf64[_0x1c8700(0x1e6)];_0xae8d5f++){_0x3a84c9+=_0x1c8700(0x1dc)+_0x1dbf64[_0xae8d5f]['Id']+_0x1c8700(0x2dc)+_0x1dbf64[_0xae8d5f][_0x1c8700(0x150)]+'\x22\x20class=\x22chkProjectName\x22><div\x20class=\x22teamprojectcontent\x22><p>'+_0x1dbf64[_0xae8d5f][_0x1c8700(0x150)]+_0x1c8700(0x24b),_0x3a84c9+=_0x1c8700(0x1b1)+_0x1dbf64[_0xae8d5f][_0x1c8700(0x21b)]+'</span>\x20|\x20<span>'+_0x1dbf64[_0xae8d5f]['DepartmentName']+_0x1c8700(0x2df);}$(_0x1c8700(0x18f))[_0x1c8700(0x2af)](_0x3a84c9);}}),$('.chkProjectName')[_0x129b05(0x2b4)](function(){var _0x1c592e=_0x129b05;getProjectUsers(this[_0x1c592e(0x1f5)],this['id'][_0x1c592e(0x1c0)](_0x1c592e(0x1fc),''),this[_0x1c592e(0x16d)]);var _0xfadcfb=[],_0x2f37ff=this[_0x1c592e(0x1f5)];$(_0x1c592e(0x1a6))[_0x1c592e(0x19f)]()!=_0x1c592e(0x27c)&&$(_0x1c592e(0x1a6))[_0x1c592e(0x19f)]()!=''&&(_0xfadcfb=$(_0x1c592e(0x1a6))['text']()[_0x1c592e(0x29c)](',')),this[_0x1c592e(0x16d)]?($(_0x1c592e(0x1a6))[_0x1c592e(0x19f)](''),_0xfadcfb[_0x1c592e(0x244)](this[_0x1c592e(0x1f5)])):_0xfadcfb=_0xfadcfb[_0x1c592e(0x1af)](function(_0x94c7d5){return _0x94c7d5!==_0x2f37ff;}),_0xfadcfb['length']==0x0?$('#selectProjectNames')[_0x1c592e(0x19f)](_0x1c592e(0x27c)):$(_0x1c592e(0x1a6))[_0x1c592e(0x19f)](_0xfadcfb['toString']());});}function getProjectUsers(_0x20d073,_0x5ea221,_0x170cfa){var _0x25c6f4=a0_0x2b038c,_0x36f2e8='',_0x578071=_0x25c6f4(0x170)+_0x5ea221+'\x27\x20';$[_0x25c6f4(0x1cc)](getItemsWithQuery(_0x25c6f4(0x29f),_0x578071))[_0x25c6f4(0x1b2)](function(_0x58a4fe){var _0x31efaf=_0x25c6f4;if(_0x58a4fe[_0x31efaf(0x1e6)]>0x0)for(var _0x23cd7c=0x0;_0x23cd7c<_0x58a4fe[_0x31efaf(0x1e6)];_0x23cd7c++){if(_0x170cfa==!![]){_0x36f2e8='';var _0x247149=_0x58a4fe[_0x23cd7c]['TeamMember'][_0x31efaf(0x295)];_0x247149[_0x31efaf(0x1b7)]('#')==!![]&&(_0x247149=_0x247149[_0x31efaf(0x1c0)]('#ext#@adaptindia.onmicrosoft.com',''),_0x247149=_0x247149[_0x31efaf(0x1c0)]('_','@')),SharingUserEmail[_0x31efaf(0x244)](_0x247149),SharingUserId['push'](_0x58a4fe[_0x23cd7c][_0x31efaf(0x16a)]['Id']),SharingUserName[_0x31efaf(0x244)](_0x58a4fe[_0x23cd7c][_0x31efaf(0x16a)]['Title']),attachment=_spPageContextInfo[_0x31efaf(0x238)]+_0x31efaf(0x15e)+escapeProperly(_0x247149),_0x36f2e8+=_0x31efaf(0x16f)+_0x58a4fe[_0x23cd7c]['Id']+'\x22><div\x20class=\x22employeesection\x22>',_0x36f2e8+=_0x31efaf(0x193)+_0x247149+'\x27,\x20\x27'+_0x58a4fe[_0x23cd7c]['TeamMember'][_0x31efaf(0x1b8)]+_0x31efaf(0x242)+_0x58a4fe[_0x23cd7c][_0x31efaf(0x16a)]['Id']+');\x22\x20class=\x22crosebox\x22><i\x20class=\x22fa\x20fa-times\x22></i></span>',_0x36f2e8+=_0x31efaf(0x1db)+attachment+_0x31efaf(0x202),_0x36f2e8+=_0x31efaf(0x291)+_0x58a4fe[_0x23cd7c][_0x31efaf(0x16a)][_0x31efaf(0x1b8)]+_0x31efaf(0x211),_0x36f2e8+=_0x31efaf(0x169)+_0x58a4fe[_0x23cd7c][_0x31efaf(0x16a)]['Title']+'\x27)\x22>'+_0x58a4fe[_0x23cd7c][_0x31efaf(0x16a)][_0x31efaf(0x1b8)]+_0x31efaf(0x298),_0x36f2e8+=_0x31efaf(0x17b),$(_0x31efaf(0x26a))[_0x31efaf(0x20a)](_0x36f2e8);}else $(_0x31efaf(0x276)+_0x58a4fe[_0x23cd7c]['Id'])[_0x31efaf(0x184)](),SharingUserEmail=SharingUserEmail[_0x31efaf(0x1af)](function(_0x4c7f7a){var _0x465199=_0x31efaf;return _0x4c7f7a['toLowerCase']()!==_0x247149[_0x465199(0x1e1)]();}),SharingUserId=SharingUserId[_0x31efaf(0x1af)](function(_0x1fbfc3){var _0x19d5da=_0x31efaf;return _0x1fbfc3!==_0x58a4fe[_0x23cd7c][_0x19d5da(0x16a)]['Id'];}),SharingUserName=SharingUserName[_0x31efaf(0x1af)](function(_0x1b4845){var _0x1cd532=_0x31efaf;return _0x1b4845[_0x1cd532(0x1e1)]()!==_0x58a4fe[_0x23cd7c][_0x1cd532(0x16a)][_0x1cd532(0x1b8)]['toLowerCase']();});}});}function getGuestClientShare(){var _0x321d36=a0_0x2b038c,_0x2ed814='',_0x31b4e9=_0x321d36(0x2d9)+_spPageContextInfo['userEmail']+_0x321d36(0x1d1)+_spPageContextInfo[_0x321d36(0x192)]+'\x27\x20';$[_0x321d36(0x1cc)](getItemsWithQuery('ClientMaster',_0x31b4e9))[_0x321d36(0x1b2)](function(_0x2075ea){var _0x47e2b3=_0x321d36;if(_0x2075ea[_0x47e2b3(0x1e6)]>0x0){for(var _0x3e244c=0x0;_0x3e244c<_0x2075ea['length'];_0x3e244c++){var _0x234e88=_0x2075ea[_0x3e244c];_0x234e88[_0x47e2b3(0x1b3)]!=null&&(_0x2ed814+='<li><input\x20type=\x22checkbox\x22\x20class=\x22chkClientName\x20chk'+_0x234e88[_0x47e2b3(0x1c1)]['Id']+_0x47e2b3(0x2dc)+_0x234e88[_0x47e2b3(0x1b8)]+'\x22\x20onclick=\x22ShowGetClient(\x27'+_0x234e88[_0x47e2b3(0x1b8)]+_0x47e2b3(0x191)+_0x234e88[_0x47e2b3(0x1c1)]['Id']+'\x27,\x20\x27'+_0x234e88[_0x47e2b3(0x1c1)]['Title']+_0x47e2b3(0x191)+_0x234e88['Id']+_0x47e2b3(0x200)+_0x234e88['Title']+_0x47e2b3(0x1a4));}$(_0x47e2b3(0x220))[_0x47e2b3(0x2af)](_0x2ed814);}});}function ShowGetClient(_0x232e53,_0x501a34,_0x1feaaa,_0x54eba7,_0x3f7c27){var _0x3b360f=a0_0x2b038c;getClientUsers(_0x232e53,_0x501a34,_0x1feaaa,_0x3f7c27[_0x3b360f(0x16d)]);var _0x5eeb10=[];_0x3f7c27[_0x3b360f(0x16d)]?SharingUserEmail[_0x3b360f(0x244)]({'GroupId':_0x501a34,'ClientName':_0x232e53,'ClientId':_0x54eba7,'GroupTitle':_0x1feaaa}):SharingUserEmail=SharingUserEmail['filter'](function(_0x131c2a){var _0x1b260e=_0x3b360f;return _0x131c2a[_0x1b260e(0x224)]!=_0x501a34;}),$(_0x3b360f(0x250))[_0x3b360f(0x1e6)]!=0x0?($(_0x3b360f(0x198))['show'](),$(_0x3b360f(0x250))[_0x3b360f(0x1be)](function(){var _0x2a635a=_0x3b360f;_0x5eeb10[_0x2a635a(0x244)](this['title']);}),_0x5eeb10[_0x3b360f(0x282)](',\x20')['length']>0x3e?(selectedClientNameTemp=_0x5eeb10['join'](','),selectedClientNameTemp=selectedClientNameTemp['substring'](0x0,0x3e),$(_0x3b360f(0x1fe))[_0x3b360f(0x19f)](selectedClientNameTemp+_0x3b360f(0x277))):$(_0x3b360f(0x1fe))['text'](_0x5eeb10[_0x3b360f(0x282)](','))):($(_0x3b360f(0x1fe))[_0x3b360f(0x19f)](_0x3b360f(0x27c)),$(_0x3b360f(0x198))[_0x3b360f(0x22d)]());}function getClientUsers(_0x299b0d,_0xacdd8d,_0x2bd1b2,_0x5ae645){var _0x39b51b=a0_0x2b038c,_0x3fab3b='',_0x500207='';_0x5ae645==!![]?(_0x3fab3b='',_0x500207=_spPageContextInfo[_0x39b51b(0x238)]+_0x39b51b(0x15e)+escapeProperly(_0x2bd1b2),_0x3fab3b+=_0x39b51b(0x165)+_0xacdd8d+_0x39b51b(0x14c),_0x3fab3b+=_0x39b51b(0x29d)+_0xacdd8d+_0x39b51b(0x177),_0x3fab3b+='<div\x20class=\x22empoyeeimg\x22><img\x20src=\x22'+_0x500207+_0x39b51b(0x202),_0x3fab3b+=_0x39b51b(0x291)+_0x299b0d+_0x39b51b(0x211),_0x3fab3b+=_0x39b51b(0x286)+_0x2bd1b2+'</span>',_0x3fab3b+='</div></div></div>',$('#AddUserPplPicker')[_0x39b51b(0x20a)](_0x3fab3b)):$(_0x39b51b(0x255)+_0xacdd8d)['remove']();}function RemoveGroup(_0x34e64c){var _0x135b81=a0_0x2b038c;SharingUserEmail=SharingUserEmail['filter'](function(_0x151ec5){var _0x5d4d38=a0_0x2356;return _0x151ec5[_0x5d4d38(0x224)]!=_0x34e64c;}),$(_0x135b81(0x255)+_0x34e64c)['remove'](),$(_0x135b81(0x296)+_0x34e64c)[_0x135b81(0x229)](_0x135b81(0x2d2),_0x135b81(0x2d2)),SharingUserEmail[_0x135b81(0x1e6)]==0x0&&$(_0x135b81(0x198))['hide']();}function onChangeSharing(_0x239883,_0x4f8839,_0x29bd26){var _0x11d144=a0_0x2b038c,_0x505804=SPClientPeoplePicker[_0x11d144(0x212)][_0x239883],_0x1e0bfe='';_0x505804[_0x11d144(0x19c)]=function(_0x3deae9,_0x24972f){var _0x5159b7=_0x11d144;if(_0x24972f[_0x5159b7(0x1e6)]>0x0){_0x1e0bfe='',tempUserId=parseInt(getUserInformation(_0x4f8839)),SharingUserId[_0x5159b7(0x244)](tempUserId);var _0x12f69c=_0x24972f[0x0][_0x5159b7(0x21d)][_0x5159b7(0x29c)]('|')[0x2];_0x12f69c['includes']('#')==!![]&&(_0x12f69c=_0x12f69c[_0x5159b7(0x1c0)](_0x5159b7(0x1cb),''),_0x12f69c=_0x12f69c[_0x5159b7(0x1c0)]('_','@')),SharingUserEmail[_0x5159b7(0x244)](_0x12f69c),SharingUserName['push'](_0x24972f[0x0][_0x5159b7(0x158)]),attachment=_spPageContextInfo[_0x5159b7(0x238)]+_0x5159b7(0x15e)+escapeProperly(_0x12f69c),_0x1e0bfe+=_0x5159b7(0x230)+tempUserId+_0x5159b7(0x14c),_0x1e0bfe+=_0x5159b7(0x193)+_0x12f69c+_0x5159b7(0x191)+_0x24972f[0x0][_0x5159b7(0x158)]+_0x5159b7(0x242)+tempUserId+');\x22\x20class=\x22crosebox\x22><i\x20class=\x22fa\x20fa-times\x22></i></span>',_0x1e0bfe+=_0x5159b7(0x1db)+attachment+_0x5159b7(0x202),_0x1e0bfe+=_0x5159b7(0x291)+_0x24972f[0x0][_0x5159b7(0x158)]+_0x5159b7(0x211),_0x1e0bfe+=_0x5159b7(0x169)+_0x12f69c+_0x5159b7(0x285)+_0x12f69c+_0x5159b7(0x298),_0x1e0bfe+=_0x5159b7(0x17b),$('#'+_0x29bd26)[_0x5159b7(0x20a)](_0x1e0bfe),EmptyPeoplePicker(_0x4f8839);}else{}};}function getMyGroups(){var _0x5b92c3=a0_0x2b038c,_0x2fd861='',_0x31c1a7='',_0x4f3442=_0x5b92c3(0x176)+_spPageContextInfo[_0x5b92c3(0x192)]+'\x27\x20';$[_0x5b92c3(0x1cc)](getItemsWithQuery('DocumentSharedGroups',_0x4f3442))[_0x5b92c3(0x1b2)](function(_0x17a094){var _0x1e5b19=_0x5b92c3;if(_0x17a094[_0x1e5b19(0x1e6)]>0x0){for(var _0x225362=0x0;_0x225362<_0x17a094[_0x1e5b19(0x1e6)];_0x225362++){_0x2fd861+=_0x1e5b19(0x268)+_0x17a094[_0x225362]['Id']+'\x22\x20title=\x22'+_0x17a094[_0x225362][_0x1e5b19(0x1cf)]+'\x22><div\x20class=\x22insidemygroup\x22><h3>'+_0x17a094[_0x225362][_0x1e5b19(0x1cf)]+_0x1e5b19(0x164);if(_0x17a094[_0x225362][_0x1e5b19(0x29a)][_0x1e5b19(0x1ea)]!=null)for(var _0x530ce1=0x0;_0x530ce1<_0x17a094[_0x225362][_0x1e5b19(0x29a)][_0x1e5b19(0x1ea)]['length'];_0x530ce1++){_0x31c1a7=_spPageContextInfo['webAbsoluteUrl']+_0x1e5b19(0x15e)+escapeProperly(_0x17a094[_0x225362][_0x1e5b19(0x29a)][_0x1e5b19(0x1ea)][_0x530ce1][_0x1e5b19(0x295)]),_0x2fd861+=_0x1e5b19(0x249)+_0x31c1a7+'\x22\x20title=\x22'+_0x17a094[_0x225362][_0x1e5b19(0x29a)][_0x1e5b19(0x1ea)][_0x530ce1][_0x1e5b19(0x1b8)]+'\x22></li>';}_0x2fd861+=_0x1e5b19(0x2a9);}$('#GroupNameList')[_0x1e5b19(0x2af)](_0x2fd861);}}),$('.chkGpName')['click'](function(){var _0x22a5db=_0x5b92c3;getMyGroupsUsers(parseInt(this['id'][_0x22a5db(0x1c0)](_0x22a5db(0x224),'')),this[_0x22a5db(0x16d)]);var _0x1ad6e9=[],_0x432eec=this[_0x22a5db(0x1f5)];$(_0x22a5db(0x16b))[_0x22a5db(0x19f)]()!=_0x22a5db(0x27c)&&$(_0x22a5db(0x16b))[_0x22a5db(0x19f)]()!=''&&(_0x1ad6e9=$(_0x22a5db(0x16b))['text']()[_0x22a5db(0x29c)](',')),this[_0x22a5db(0x16d)]?($(_0x22a5db(0x16b))['text'](''),_0x1ad6e9[_0x22a5db(0x244)](this['title'])):_0x1ad6e9=_0x1ad6e9[_0x22a5db(0x1af)](function(_0x5583d4){return _0x5583d4!==_0x432eec;}),_0x1ad6e9[_0x22a5db(0x1e6)]==0x0?$(_0x22a5db(0x16b))[_0x22a5db(0x19f)](_0x22a5db(0x27c)):$('#selectedGroupNames')[_0x22a5db(0x19f)](_0x1ad6e9[_0x22a5db(0x2cb)]());});}function getMyGroupsUsers(_0x1aba06,_0x5c1529){var _0x4441f0=a0_0x2b038c,_0x3c98ba='',_0x418211='',_0x1088e2='?$select=ID,SharedUsers/ID,SharedUsers/Title,SharedUsers/EMail,LogonUser/ID,LogonUser/EMail,LogonUser/Title,LogonUser/UserName,SharingLevel&$expand=SharedUsers,LogonUser&$orderby=ID\x20asc&$filter=LogonUser/EMail\x20eq\x20\x27'+_spPageContextInfo[_0x4441f0(0x192)]+'\x27\x20and\x20ID\x20eq\x20\x27'+_0x1aba06+'\x27\x20';$[_0x4441f0(0x1cc)](getItemsWithQuery('DocumentSharedGroups',_0x1088e2))[_0x4441f0(0x1b2)](function(_0x12217f){var _0x527daf=_0x4441f0;if(_0x12217f[_0x527daf(0x1e6)]>0x0)for(var _0x175b69=0x0;_0x175b69<_0x12217f[_0x527daf(0x1e6)];_0x175b69++){if(_0x12217f[_0x175b69][_0x527daf(0x29a)]['results']!=null)for(var _0x101edf=0x0;_0x101edf<_0x12217f[_0x175b69][_0x527daf(0x29a)]['results'][_0x527daf(0x1e6)];_0x101edf++){_0x5c1529==!![]?(_0x3c98ba='',SharingUserEmail[_0x527daf(0x244)](_0x12217f[_0x175b69][_0x527daf(0x29a)][_0x527daf(0x1ea)][_0x101edf][_0x527daf(0x295)]),SharingUserId['push'](_0x12217f[_0x175b69]['SharedUsers']['results'][_0x101edf]['ID']),SharingUserName[_0x527daf(0x244)](_0x12217f[_0x175b69][_0x527daf(0x29a)][_0x527daf(0x1ea)][_0x101edf][_0x527daf(0x1b8)]),_0x418211=_spPageContextInfo['webAbsoluteUrl']+_0x527daf(0x15e)+escapeProperly(_0x12217f[_0x175b69][_0x527daf(0x29a)][_0x527daf(0x1ea)][_0x101edf][_0x527daf(0x295)]),_0x3c98ba+=_0x527daf(0x230)+_0x12217f[_0x175b69]['Id']+_0x527daf(0x14c),_0x3c98ba+=_0x527daf(0x193)+_0x12217f[_0x175b69][_0x527daf(0x29a)][_0x527daf(0x1ea)][_0x101edf][_0x527daf(0x295)]+_0x527daf(0x191)+_0x12217f[_0x175b69][_0x527daf(0x29a)][_0x527daf(0x1ea)][_0x101edf]['Title']+_0x527daf(0x242)+_0x12217f[_0x175b69][_0x527daf(0x29a)][_0x527daf(0x1ea)][_0x101edf]['ID']+_0x527daf(0x215),_0x3c98ba+=_0x527daf(0x1db)+_0x418211+'\x22\x20alt=\x22\x22>',_0x3c98ba+=_0x527daf(0x291)+_0x12217f[_0x175b69][_0x527daf(0x29a)][_0x527daf(0x1ea)][_0x101edf][_0x527daf(0x1b8)]+_0x527daf(0x211),_0x3c98ba+=_0x527daf(0x169)+_0x12217f[_0x175b69][_0x527daf(0x29a)][_0x527daf(0x1ea)][_0x101edf]['EMail']+_0x527daf(0x285)+_0x12217f[_0x175b69][_0x527daf(0x29a)][_0x527daf(0x1ea)][_0x101edf]['EMail']+_0x527daf(0x298),_0x3c98ba+='</div></div></div>',$(_0x527daf(0x26a))['before'](_0x3c98ba)):($(_0x527daf(0x187)+_0x12217f[_0x175b69]['Id'])['remove'](),SharingUserEmail=SharingUserEmail['filter'](function(_0x5b4e0e){var _0x4c9fd7=_0x527daf;return _0x5b4e0e[_0x4c9fd7(0x1e1)]()!==_0x12217f[_0x175b69][_0x4c9fd7(0x29a)][_0x4c9fd7(0x1ea)][_0x101edf][_0x4c9fd7(0x295)][_0x4c9fd7(0x1e1)]();}),SharingUserId=SharingUserId[_0x527daf(0x1af)](function(_0x3672dd){var _0x4f18a8=_0x527daf;return _0x3672dd!==_0x12217f[_0x175b69][_0x4f18a8(0x29a)][_0x4f18a8(0x1ea)][_0x101edf]['ID'];}),SharingUserName=SharingUserName['filter'](function(_0x11641c){var _0x5bb114=_0x527daf;return _0x11641c['toLowerCase']()!==_0x12217f[_0x175b69][_0x5bb114(0x29a)]['results'][_0x101edf][_0x5bb114(0x1b8)]['toLowerCase']();}));}}});}function removeShareUser(_0x27045c,_0x50ec9f,_0x3b780a,_0x7a50ac,_0x3ecb69){var _0x197435=a0_0x2b038c;$(_0x27045c)[_0x197435(0x23e)](_0x197435(0x1a7))[_0x197435(0x184)](),SharingUserEmail=SharingUserEmail[_0x197435(0x1af)](function(_0x112f07){return _0x112f07['toLowerCase']()!==_0x50ec9f['toLowerCase']();}),SharingUserName=SharingUserName[_0x197435(0x1af)](function(_0x22a471){var _0x539724=_0x197435;return _0x22a471[_0x539724(0x1e1)]()!==_0x3b780a[_0x539724(0x1e1)]();}),SharingUserId=SharingUserId[_0x197435(0x1af)](function(_0x43a417){return _0x43a417!=_0x7a50ac;});}function GetSharedHistory(_0x350edf,_0x54851e,_0xa8e61f,_0x55aa78,_0x2ed231,_0x4afeb3){var _0x554801=a0_0x2b038c;selectedHistoryDoc=[];var _0x66e12d='',_0x3f6964=[],_0x182b38=[],_0x4ae661=[],_0x568af6=[],_0x341ad7=[];SharedTo='';var _0x3729de=_0x554801(0x223);$(_0x554801(0x196))[_0x554801(0x229)](_0x554801(0x16d),![]),$(_0x554801(0x14d))[_0x554801(0x22d)](),$(_0x554801(0x22b))[_0x554801(0x22d)](),$(_0x554801(0x294))['html'](''),$(_0x554801(0x261))[_0x554801(0x29b)](''),$(_0x554801(0x2b0))[_0x554801(0x17c)]('show');var _0x30f9de=_0x554801(0x1fa)+_0x350edf+_0x554801(0x2d8);$['when'](getItemsWithQuery(_0x554801(0x237),_0x30f9de))[_0x554801(0x1b2)](function(_0x3d9db0){var _0xadf905=_0x554801;$(_0xadf905(0x1b6))[_0xadf905(0x29b)](_0x2ed231);_0xa8e61f==_0xadf905(0x1ca)?$(_0xadf905(0x246))['html'](''):$(_0xadf905(0x246))[_0xadf905(0x29b)](_0xa8e61f);_0x55aa78=='null'?$('#referNo')[_0xadf905(0x29b)](''):$(_0xadf905(0x292))[_0xadf905(0x29b)](_0x55aa78);if(_0x3d9db0['length']>0x0){var _0x336d6a='';$(_0xadf905(0x261))[_0xadf905(0x2af)](_0xadf905(0x185));for(var _0x590371=0x0;_0x590371<_0x3d9db0[_0xadf905(0x1e6)];_0x590371++){var _0x183aae=_0x3d9db0[_0x590371]['Title'],_0x24d2f0=_0x3d9db0[_0x590371][_0xadf905(0x14f)],_0x2db727=_0x3d9db0[_0x590371]['ID'],_0x2a30c3=_0x3d9db0[_0x590371][_0xadf905(0x1fb)],_0x42796c='',_0x315a7f='',_0x301d3d='',_0x5abc55=_0x3d9db0[_0x590371][_0xadf905(0x2a1)];_0x5abc55==!![]?_0x5abc55=_0xadf905(0x1e0):_0x5abc55=_0xadf905(0x245);var _0x730e5c='';_0x3d9db0[_0x590371]['SharingValidity']!=null&&(_0x730e5c=titanForWork[_0xadf905(0x1c8)](_0x3d9db0[_0x590371]['SharingValidity']));for(var _0x601781=0x0;_0x601781<_0x3d9db0[_0x590371][_0xadf905(0x29a)]['results']['length'];_0x601781++){_0x3f6964[_0xadf905(0x221)](_0x3d9db0[_0x590371][_0xadf905(0x29a)][_0xadf905(0x1ea)][_0x601781][_0xadf905(0x1b8)])==-0x1&&(_0x3f6964[_0xadf905(0x244)](_0x3d9db0[_0x590371][_0xadf905(0x29a)][_0xadf905(0x1ea)][_0x601781][_0xadf905(0x1b8)]),_0x3d9db0[_0x590371]['SharedGroup']!=_0xadf905(0x217)?_0x66e12d+='<option\x20value=\x27'+_0x3d9db0[_0x590371][_0xadf905(0x29a)][_0xadf905(0x1ea)][_0x601781]['Title']+_0xadf905(0x236)+_0x3d9db0[_0x590371][_0xadf905(0x29a)][_0xadf905(0x1ea)][_0x601781][_0xadf905(0x1b8)]+'\x27>'+_0x3d9db0[_0x590371]['SharedUsers'][_0xadf905(0x1ea)][_0x601781]['Title']+_0xadf905(0x1f7):jQuery[_0xadf905(0x214)](_0x3d9db0[_0x590371][_0xadf905(0x18b)][_0xadf905(0x1b8)],_0x341ad7)=='-1'&&(_0x66e12d+=_0xadf905(0x162)+_0x3d9db0[_0x590371][_0xadf905(0x18b)][_0xadf905(0x1b8)]+_0xadf905(0x236)+_0x3d9db0[_0x590371][_0xadf905(0x18b)][_0xadf905(0x1b8)]+'\x27>'+_0x3d9db0[_0x590371][_0xadf905(0x18b)][_0xadf905(0x1b8)]+_0xadf905(0x1f7),_0x341ad7['push'](_0x3d9db0[_0x590371][_0xadf905(0x18b)][_0xadf905(0x1b8)]))),_0x42796c=_0x3d9db0[_0x590371][_0xadf905(0x29a)][_0xadf905(0x1ea)][_0x601781]['Title'],_0x315a7f=_0x3d9db0[_0x590371][_0xadf905(0x287)],_0x315a7f=_0x315a7f?_0x315a7f:'',_0x301d3d=_0x3d9db0[_0x590371][_0xadf905(0x29a)]['results'][_0x601781]['Id'];}if(_0x3d9db0[_0x590371][_0xadf905(0x20f)]!='Organization'){var _0x310a41=_spPageContextInfo[_0xadf905(0x238)]+_0xadf905(0x15e)+escapeProperly(_0x315a7f);_0x2a30c3==_0xadf905(0x23a)?(_0x336d6a+=_0xadf905(0x182),_0x3d9db0[_0x590371][_0xadf905(0x20f)]==_0xadf905(0x258)?_0x336d6a+=_0xadf905(0x279)+_0x42796c['charAt'](0x0)+_0xadf905(0x253):_0x336d6a+=_0xadf905(0x161)+_0x310a41+'\x27\x20data-themekey=\x27#\x27><div\x20class=\x27designationtype\x27>',_0x336d6a+='<h3\x20class=\x27namesection\x27>'+_0x42796c+_0xadf905(0x211),_0x336d6a+=_0xadf905(0x195)+_0x315a7f+_0xadf905(0x2c8)+_0x315a7f+_0xadf905(0x24a),_0x336d6a+=_0xadf905(0x273)+_0x24d2f0+_0xadf905(0x216),_0x336d6a+=_0xadf905(0x273)+titanForWork[_0xadf905(0x1c8)](_0x3d9db0[_0x590371][_0xadf905(0x15a)])+_0xadf905(0x216),_0x336d6a+=_0xadf905(0x273)+_0x3d9db0[_0x590371][_0xadf905(0x251)]['Title']+_0xadf905(0x216),_0x336d6a+=_0xadf905(0x273)+_0x730e5c+_0xadf905(0x216),_0x336d6a+='<td>'+_0x5abc55+_0xadf905(0x216),_0x336d6a+=_0xadf905(0x2ac)+titanForWork[_0xadf905(0x1c8)](_0x3d9db0[_0x590371]['Modified'])+_0xadf905(0x1ec),_0x336d6a+=_0xadf905(0x2ad)):(SharedTo=_0xadf905(0x278),_0x336d6a+=_0xadf905(0x1e2),_0x336d6a+='<td><input\x20type=\x27checkbox\x27\x20class=\x27historydocid\x27\x20value='+_0x350edf+','+encodeURI(_0x54851e)+','+_0x301d3d+','+_0x2db727+','+_0x3729de+','+_0x4afeb3+','+SharedTo+_0xadf905(0x2db)+_0x301d3d+'\x27\x27></td>',_0x3d9db0[_0x590371][_0xadf905(0x20f)]==_0xadf905(0x258)?_0x336d6a+=_0xadf905(0x279)+_0x42796c[_0xadf905(0x281)](0x0)+_0xadf905(0x253):_0x336d6a+=_0xadf905(0x161)+_0x310a41+_0xadf905(0x19d),_0x336d6a+=_0xadf905(0x168)+_0x42796c+_0xadf905(0x211),_0x336d6a+='<a\x20href=\x27javascript:void(0);\x27\x20class=\x27emailsec\x27\x20onclick=\x27OpenEmail(\x22'+_0x315a7f+_0xadf905(0x2c8)+_0x315a7f+_0xadf905(0x24a),_0x336d6a+=_0xadf905(0x273)+_0x24d2f0+_0xadf905(0x216),_0x336d6a+=_0xadf905(0x273)+titanForWork[_0xadf905(0x1c8)](_0x3d9db0[_0x590371][_0xadf905(0x15a)])+_0xadf905(0x216),_0x336d6a+='<td>'+_0x3d9db0[_0x590371]['Author'][_0xadf905(0x1b8)]+'</td>',_0x336d6a+=_0xadf905(0x273)+_0x730e5c+_0xadf905(0x216),_0x336d6a+=_0xadf905(0x273)+_0x5abc55+_0xadf905(0x216),_0x336d6a+='<td><a\x20style=\x27cursor:\x20pointer;\x27\x20onclick=RevokePermission(\x27'+_0x350edf+_0xadf905(0x2cd)+encodeURI(_0x54851e)+'\x27,\x27'+_0x301d3d+_0xadf905(0x2cd)+_0x2db727+'\x27)>Revoke</a></td>',_0x336d6a+=_0xadf905(0x2ad));}else _0x2a30c3==_0xadf905(0x23a)?(_0x336d6a+='<tr><td></td>',_0x336d6a+=_0xadf905(0x2a8)+_0x3d9db0[_0x590371][_0xadf905(0x18b)][_0xadf905(0x1b8)][_0xadf905(0x281)](0x0)+_0xadf905(0x24c),_0x336d6a+=_0xadf905(0x27d)+_0x3d9db0[_0x590371][_0xadf905(0x18b)][_0xadf905(0x1b8)]+_0xadf905(0x1c3),_0x336d6a+='</div></div><td>'+_0x24d2f0+'</td>',_0x336d6a+=_0xadf905(0x273)+titanForWork[_0xadf905(0x1c8)](_0x3d9db0[_0x590371][_0xadf905(0x15a)])+_0xadf905(0x216),_0x336d6a+=_0xadf905(0x273)+_0x3d9db0[_0x590371][_0xadf905(0x251)]['Title']+_0xadf905(0x216),_0x336d6a+='<td>'+_0x730e5c+_0xadf905(0x216),_0x336d6a+='<td>'+_0x5abc55+_0xadf905(0x216),_0x336d6a+=_0xadf905(0x2ac)+titanForWork[_0xadf905(0x1c8)](_0x3d9db0[_0x590371][_0xadf905(0x1ed)])+_0xadf905(0x1ec)):(SharedTo='Organization',_0x336d6a+=_0xadf905(0x1e2),_0x336d6a+=_0xadf905(0x1f8)+_0x350edf+','+encodeURI(_0x54851e)+','+_0x301d3d+','+_0x2db727+','+_0x3729de+','+_0x4afeb3+','+SharedTo+_0xadf905(0x2db)+_0x301d3d+_0xadf905(0x18e),_0x336d6a+='<td><div\x20class=\x27flexingtwo\x27><div\x20id=\x27profileImage\x27>'+_0x3d9db0[_0x590371][_0xadf905(0x18b)][_0xadf905(0x1b8)]['charAt'](0x0)+_0xadf905(0x253),_0x336d6a+=_0xadf905(0x168)+_0x3d9db0[_0x590371][_0xadf905(0x18b)][_0xadf905(0x1b8)]+_0xadf905(0x211),_0x336d6a+=_0xadf905(0x22e),_0x336d6a+=_0xadf905(0x273)+_0x24d2f0+'</td>',_0x336d6a+=_0xadf905(0x273)+titanForWork[_0xadf905(0x1c8)](_0x3d9db0[_0x590371][_0xadf905(0x15a)])+_0xadf905(0x216),_0x336d6a+=_0xadf905(0x273)+_0x3d9db0[_0x590371][_0xadf905(0x251)][_0xadf905(0x1b8)]+_0xadf905(0x216),_0x336d6a+=_0xadf905(0x273)+_0x730e5c+_0xadf905(0x216),_0x336d6a+=_0xadf905(0x273)+_0x5abc55+_0xadf905(0x216),_0x336d6a+=_0xadf905(0x153)+_0x301d3d+_0xadf905(0x2cd)+_0x2db727+_0xadf905(0x2a6),_0x336d6a+='</tr>');}_0x3d9db0[_0xadf905(0x1e6)]==0x0?$(_0xadf905(0x1ee))[_0xadf905(0x2b6)]():$(_0xadf905(0x1ee))['hide'](),$(_0xadf905(0x294))[_0xadf905(0x2af)](_0x336d6a),$(_0xadf905(0x175))[_0xadf905(0x19f)](_0x3d9db0['length']),_0x3d9db0[_0xadf905(0x1e6)]>0x0&&($(_0xadf905(0x261))[_0xadf905(0x2af)](_0x66e12d),TableConfiguration(),selectedHistoryDocEvent());}else $(_0xadf905(0x1ee))['show'](),$(_0xadf905(0x175))[_0xadf905(0x19f)]('0');});}function RevokeGpPermission(_0x3b49ea,_0x159d4e,_0x459a31){var _0x4c203d=a0_0x2b038c;$(_0x4c203d(0x283))[_0x4c203d(0x19f)]()[_0x4c203d(0x1b7)](_0x4c203d(0x259))==!![]&&$(_0x4c203d(0x283))[_0x4c203d(0x19f)]()[_0x4c203d(0x1b7)](_0x4c203d(0x2c4))==![]&&$(_0x4c203d(0x283))['text']($(_0x4c203d(0x283))[_0x4c203d(0x19f)]()[_0x4c203d(0x1c0)](_0x4c203d(0x259),_0x4c203d(0x2c4)));CopySourceURL!=_spPageContextInfo['webAbsoluteUrl']&&$[_0x4c203d(0x1cc)](GetFormDigestValue(CopySourceURL))[_0x4c203d(0x1b2)](function(_0x4564c4){RequestDigest=_0x4564c4;});var _0x11de8b=CopySourceURL+_0x4c203d(0x1ad)+$(_0x4c203d(0x283))[_0x4c203d(0x19f)]()+_0x4c203d(0x23b)+_0x3b49ea+')';$[_0x4c203d(0x1e3)]({'url':_0x11de8b,'type':_0x4c203d(0x204),'async':![],'headers':{'X-RequestDigest':RequestDigest,'Accept':_0x4c203d(0x1f1),'content-Type':'application/json;odata=verbose','X-HTTP-Method':_0x4c203d(0x2bc)},'async':![],'success':function(_0x2d0b65){var _0x4ffb00=_0x4c203d;RequestDigest=$('#__REQUESTDIGEST')['val']();var _0x240d1b=GetItemTypeForListName('SharedDocument');Metadata={'__metadata':{'type':_0x240d1b},'PermissionStatus':_0x4ffb00(0x23a),'SharedEnd':new Date()['toISOString']()},$[_0x4ffb00(0x1cc)](updateItemWithIDItemListDocuments(_0x4ffb00(0x237),Metadata,_0x159d4e,_spPageContextInfo[_0x4ffb00(0x238)],![]))['done'](function(_0x5eea6c){var _0x5cbf0c=_0x4ffb00;return _0x459a31!=![]&&(alert(_0x5cbf0c(0x272)),$('#myModalShareHistory')[_0x5cbf0c(0x17c)](_0x5cbf0c(0x22d))),![];});},'error':function(_0x4190e8){var _0x4d3678=_0x4c203d;RequestDigest=$(_0x4d3678(0x22f))[_0x4d3678(0x254)](),_0x4190e8[_0x4d3678(0x2cf)][_0x4d3678(0x1b7)](_0x4d3678(0x247))==!![]?alert(_0x4d3678(0x2ce)+$(_0x4d3678(0x199))[_0x4d3678(0x19f)]()+_0x4d3678(0x1c2)):alert(_0x4190e8[_0x4d3678(0x28d)]['error'][_0x4d3678(0x194)][_0x4d3678(0x1aa)]);}});}function a0_0x2356(_0x33250f,_0x30d475){var _0x37fb57=a0_0x37fb();return a0_0x2356=function(_0x235643,_0x28ab7e){_0x235643=_0x235643-0x14b;var _0x2c5177=_0x37fb57[_0x235643];return _0x2c5177;},a0_0x2356(_0x33250f,_0x30d475);}var selectedHistoryDoc=[];function TableConfiguration(){var _0x20c272=a0_0x2b038c;sorter=new TINY[(_0x20c272(0x2c5))][(_0x20c272(0x2e4))]('sorter',_0x20c272(0x2a4),{'headclass':_0x20c272(0x2b8),'ascclass':_0x20c272(0x178),'descclass':_0x20c272(0x23c),'evenclass':_0x20c272(0x2c6),'oddclass':_0x20c272(0x2ba),'evenselclass':_0x20c272(0x1fd),'oddselclass':_0x20c272(0x275),'paginate':!![],'size':0xa,'colddid':'columns','currentid':_0x20c272(0x2da),'totalid':'totalpages','startingrecid':_0x20c272(0x25a),'endingrecid':_0x20c272(0x2dd),'totalrecid':_0x20c272(0x1a8),'hoverid':'selectedrow','pageddid':'pagedropdown','navid':_0x20c272(0x262),'sortdir':0x1,'init':!![]});}function selectedHistoryDocEvent(){var _0x1b37bb=a0_0x2b038c;$(_0x1b37bb(0x18d))[_0x1b37bb(0x2cc)](function(){var _0x454f08=_0x1b37bb;selectedHistoryDoc=[],selectedHistoryDocrelativeurl=[],$(_0x454f08(0x18d))[_0x454f08(0x1be)](function(){var _0x3580f3=_0x454f08;$(this)[_0x3580f3(0x229)]('checked')==!![]&&selectedHistoryDoc[_0x3580f3(0x244)]($(this)[_0x3580f3(0x254)]());}),selectedHistoryDoc[_0x454f08(0x1e6)]==0x0?$(_0x454f08(0x14d))[_0x454f08(0x22d)]():$(_0x454f08(0x14d))[_0x454f08(0x2b6)](),$(_0x454f08(0x256))[_0x454f08(0x1e6)]==$(_0x454f08(0x18d))[_0x454f08(0x1e6)]?$('.select_all')[_0x454f08(0x229)](_0x454f08(0x16d),!![]):$(_0x454f08(0x196))[_0x454f08(0x229)](_0x454f08(0x16d),![]);});}function RevokePermission(_0x117ac5,_0x3ccb4d,_0x469373,_0x32d79d,_0x4057db){var _0x954519=a0_0x2b038c;CopySourceURL!=_spPageContextInfo[_0x954519(0x238)]&&$[_0x954519(0x1cc)](GetFormDigestValue(CopySourceURL))[_0x954519(0x1b2)](function(_0x481d34){RequestDigest=_0x481d34;});var _0x1af3be={'Accept':_0x954519(0x1f1),'content-Type':'application/json;odata=verbose','X-RequestDigest':RequestDigest},_0x214940=CopySourceURL+_0x954519(0x1ad)+_0x3ccb4d+'\x27)/ListItemAllFields/breakroleinheritance(true)';$[_0x954519(0x1e3)]({'url':_0x214940,'type':_0x954519(0x204),'headers':_0x1af3be,'dataType':_0x954519(0x2d0),'success':function(_0x3d80d8){var _0x1985ae=_0x954519;RequestDigest=$(_0x1985ae(0x22f))[_0x1985ae(0x254)](),DeleateUserPermission(_0x469373,_0x3ccb4d,_0x117ac5,_0x32d79d,_0x1985ae(0x1e5),0x0,0x0,_0x4057db);},'error':function(_0x23b4c0){var _0x5b1a1c=_0x954519;RequestDigest=$(_0x5b1a1c(0x22f))[_0x5b1a1c(0x254)](),console['log'](JSON[_0x5b1a1c(0x28f)](_0x23b4c0));}});}function DeleateUserPermission(_0x12b882,_0x20babf,_0xf70905,_0x4cd5f2,_0x3fc735,_0x38e726,_0xe29257,_0x1607f9){var _0x3c0445=a0_0x2b038c;CopySourceURL!=_spPageContextInfo['webAbsoluteUrl']&&$['when'](GetFormDigestValue(CopySourceURL))[_0x3c0445(0x1b2)](function(_0x2c8784){RequestDigest=_0x2c8784;});var _0x40c448={'X-RequestDigest':RequestDigest,'X-HTTP-Method':_0x3c0445(0x2bc)},_0x2a7994=CopySourceURL+_0x3c0445(0x1ad)+_0x20babf+_0x3c0445(0x23b)+_0x12b882+')';$['ajax']({'url':_0x2a7994,'type':_0x3c0445(0x204),'headers':_0x40c448,'async':![],'success':function(_0x4ff9ff){var _0x1d65c2=_0x3c0445;RequestDigest=$(_0x1d65c2(0x22f))[_0x1d65c2(0x254)]();var _0x4fce5f=_0x1d65c2(0x237),_0x5c8199,_0x4aef8b=GetItemTypeForListName(_0x4fce5f);_0x5c8199={'__metadata':{'type':_0x4aef8b},'PermissionStatus':_0x1d65c2(0x23a),'SharedEnd':new Date()[_0x1d65c2(0x2a7)]()},$['when'](updateItemWithIDItemListDocuments(_0x4fce5f,_0x5c8199,_0x4cd5f2,_spPageContextInfo[_0x1d65c2(0x238)]))[_0x1d65c2(0x1b2)](function(_0x27854f){var _0x5218ef=_0x1d65c2;_0x1607f9!=![]&&alert(_0x5218ef(0x2b9)),$(_0x5218ef(0x2b0))[_0x5218ef(0x17c)](_0x5218ef(0x22d));}),console['log'](_0x12b882+_0x1d65c2(0x2d1));},'error':function(_0x23ceb0){var _0x5e983f=_0x3c0445;RequestDigest=$(_0x5e983f(0x22f))['val'](),_0x23ceb0[_0x5e983f(0x2cf)][_0x5e983f(0x1b7)](_0x5e983f(0x247))==!![]?alert('You\x20don\x27t\x20have\x20the\x20required\x20permission\x20on\x20'+$(_0x5e983f(0x199))[_0x5e983f(0x19f)]()+'\x20to\x20perform\x20this\x20operation.'):alert(_0x23ceb0['responseText']);}});}function RevokeOnCheckBox(){var _0x2c43aa=a0_0x2b038c;if(selectedHistoryDoc['length']>0x0){var _0x1efc4b=0x1;for(var _0xdb2c47=0x0;_0xdb2c47<selectedHistoryDoc['length'];_0xdb2c47++){var _0x3ad31c=selectedHistoryDoc[_0xdb2c47],_0x51da71=[];_0x51da71=_0x3ad31c[_0x2c43aa(0x29c)](','),_0x51da71[0x6]=='User'?RevokePermission(_0x51da71[0x0],_0x51da71[0x1],_0x51da71[0x2],_0x51da71[0x3],![]):RevokeGpPermission(_0x51da71[0x2],_0x51da71[0x3],![]);}return alert(_0x2c43aa(0x21a)),![];}else alert('Please\x20select\x20one\x20or\x20more\x20history\x20for\x20revoke.');}function getTargetRoleDefinitionId(){var _0x1e657=a0_0x2b038c,_0x59c2f8=!![];return $[_0x1e657(0x1e3)]({'url':_spPageContextInfo[_0x1e657(0x238)]+_0x1e657(0x20c)+$(_0x1e657(0x2b1))['val']()+_0x1e657(0x1d6),'type':_0x1e657(0x183),'async':![],'headers':{'accept':_0x1e657(0x1f1)},'success':function(_0x4edb18){targetRoleDefinitionId=_0x4edb18['d']['Id'],_0x59c2f8=breakRoleInheritanceOfList(targetRoleDefinitionId);},'error':errorHandler}),_0x59c2f8;}function breakRoleInheritanceOfList(_0x2ff21e){var _0x5b45f9=a0_0x2b038c,_0x590a0f=!![];CopySourceURL!=_spPageContextInfo['webAbsoluteUrl']&&$[_0x5b45f9(0x1cc)](GetFormDigestValue(CopySourceURL))['done'](function(_0x35f1c5){RequestDigest=_0x35f1c5;});var _0x8a5ce9={'Accept':_0x5b45f9(0x1f1),'content-Type':_0x5b45f9(0x1f1),'X-RequestDigest':RequestDigest};$('#FilePath')[_0x5b45f9(0x19f)]()['includes'](_0x5b45f9(0x259))==!![]&&$(_0x5b45f9(0x283))[_0x5b45f9(0x19f)]()['includes'](_0x5b45f9(0x2c4))==![]&&$(_0x5b45f9(0x283))[_0x5b45f9(0x19f)]($(_0x5b45f9(0x283))[_0x5b45f9(0x19f)]()[_0x5b45f9(0x1c0)](_0x5b45f9(0x259),'Shared%20Documents'));var _0x56e5d8=CopySourceURL+_0x5b45f9(0x1ad)+$('#FilePath')[_0x5b45f9(0x19f)]()+'\x27)/ListItemAllFields/breakroleinheritance(true)';return $[_0x5b45f9(0x1e3)]({'url':_0x56e5d8,'type':_0x5b45f9(0x204),'headers':_0x8a5ce9,'async':![],'dataType':'json','success':function(_0x37c920){var _0x58321b=_0x5b45f9;RequestDigest=$(_0x58321b(0x22f))[_0x58321b(0x254)](),_0x590a0f=deleteCurrentRoleForGroup(_0x2ff21e);},'error':function(_0x36075e){var _0x47370b=_0x5b45f9;RequestDigest=$(_0x47370b(0x22f))[_0x47370b(0x254)](),console['log'](JSON[_0x47370b(0x28f)](_0x36075e));}}),_0x590a0f;}function deleteCurrentRoleForGroup(_0x59f9d9){var _0xd36fb8=a0_0x2b038c,_0x16aea4=!![];CopySourceURL!=_spPageContextInfo[_0xd36fb8(0x238)]&&$[_0xd36fb8(0x1cc)](GetFormDigestValue(CopySourceURL))['done'](function(_0x2e4274){RequestDigest=_0x2e4274;});for(var _0xf6b01e=0x0;_0xf6b01e<SharingUserEmail[_0xd36fb8(0x1e6)];_0xf6b01e++){if(SharingUserEmail[_0xf6b01e][_0xd36fb8(0x224)]!=null&&SharingUserEmail[_0xf6b01e][_0xd36fb8(0x224)]!=''&&SharingUserEmail[_0xf6b01e][_0xd36fb8(0x224)]!=_0xd36fb8(0x2d4)&&SharingUserEmail[_0xf6b01e][_0xd36fb8(0x224)]!=_0xd36fb8(0x1ca)){var _0x22cc53=CopySourceURL+'/_api/web/GetFileByServerRelativeUrl(\x27'+$('#FilePath')[_0xd36fb8(0x19f)]()+_0xd36fb8(0x23b)+SharingUserEmail[_0xf6b01e][_0xd36fb8(0x224)]+')';$['ajax']({'url':_0x22cc53,'type':'POST','async':![],'headers':{'X-RequestDigest':RequestDigest,'Accept':_0xd36fb8(0x1f1),'content-Type':_0xd36fb8(0x1f1),'X-HTTP-Method':_0xd36fb8(0x2bc)},'async':![],'success':function(_0x4d6551){var _0x4ef7ff=_0xd36fb8;_0x16aea4=!![],RequestDigest=$(_0x4ef7ff(0x22f))['val'](),setNewPermissionsForGroup(_0x59f9d9,parseInt(SharingUserEmail[_0xf6b01e][_0x4ef7ff(0x224)]));},'error':function(_0x5e4721){var _0x46df29=_0xd36fb8;RequestDigest=$('#__REQUESTDIGEST')[_0x46df29(0x254)]();if(_0x5e4721[_0x46df29(0x2cf)][_0x46df29(0x1b7)](_0x46df29(0x247))==!![])return alert(_0x46df29(0x2ce)+$(_0x46df29(0x199))['text']()+'\x20to\x20perform\x20this\x20operation.'),![];else console[_0x46df29(0x24e)](_0x5e4721[_0x46df29(0x2cf)]),setNewPermissionsForGroup(_0x59f9d9,parseInt(SharingUserEmail[_0xf6b01e][_0x46df29(0x224)]));}});}}return _0x16aea4;}function setNewPermissionsForGroup(_0x5c0aaf,_0x1ed471){var _0x2c1382=a0_0x2b038c;CopySourceURL!=_spPageContextInfo[_0x2c1382(0x238)]&&$['when'](GetFormDigestValue(CopySourceURL))[_0x2c1382(0x1b2)](function(_0x49f55a){RequestDigest=_0x49f55a;});var _0x35c10a=CopySourceURL+_0x2c1382(0x1ad)+$(_0x2c1382(0x283))[_0x2c1382(0x19f)]()+'\x27)/ListItemAllFields/roleassignments/addroleassignment(principalid='+_0x1ed471+',roledefid='+_0x5c0aaf+')';$['ajax']({'url':_0x35c10a,'type':'POST','async':![],'headers':{'X-RequestDigest':RequestDigest},'success':successHandler,'error':errorHandler});}function successHandler(){var _0x575706=a0_0x2b038c;RequestDigest=$(_0x575706(0x22f))['val']();}function errorHandler(_0xace95b,_0x7e3a0b,_0x13b1d6){var _0x3d5d88=a0_0x2b038c;return RequestDigest=$(_0x3d5d88(0x22f))[_0x3d5d88(0x254)](),_0xace95b[_0x3d5d88(0x2cf)]['includes'](_0x3d5d88(0x247))==!![]?(alert(_0x3d5d88(0x2ce)+$('#FileName')['text']()+'\x20to\x20perform\x20this\x20operation.'),![]):(alert(_0xace95b['responseText']),![]);}function myShareDepartmentCopy(){var _0x538b4e=a0_0x2b038c,_0x446592='',_0x316c9e=_0x538b4e(0x225)+Logged_CompanyId+_0x538b4e(0x15f)+_spPageContextInfo[_0x538b4e(0x228)]+'\x27\x20and\x20WebPartName\x20eq\x20\x27DepartmentDocument_Access\x27)\x20or\x20(CompanyId\x20eq\x20\x27'+Logged_CompanyId+_0x538b4e(0x290)+_spPageContextInfo[_0x538b4e(0x228)]+_0x538b4e(0x280);$['when'](getItemsWithQuery('ProcessApprovers',_0x316c9e))['done'](function(_0x19c8c8){var _0x4f50d3=_0x538b4e;_0x446592+='<tr><td><div\x20class=\x22checkbox\x20m-0\x22><label><input\x20class=\x22DocLib\x22\x20name=\x22Library\x22\x20type=\x22radio\x22\x20value=\x22\x22></label></div></td>',_0x446592+=_0x4f50d3(0x267);var _0x136b5b=getDepartmentURL(Logged_DepartmentId);_0x136b5b=_0x136b5b+_0x4f50d3(0x1d8),_0x446592+='<tr><td><div\x20class=\x22checkbox\x20m-0\x22><label><input\x20class=\x22DocLib\x22\x20name=\x22Library\x22\x20type=\x22radio\x22\x20id=\x22chkDepartments\x22\x20value=\x22\x22></label></div></td>',_0x446592+=_0x4f50d3(0x23f),_0x446592+=_0x4f50d3(0x235)+_0x136b5b+'>'+Logged_DepartmentName+_0x4f50d3(0x2c2),$[_0x4f50d3(0x1be)](_0x19c8c8,function(_0x2314ed,_0x15ac1b){var _0x345dc4=_0x4f50d3,_0x40b4f9=getDepartmentURL(_0x15ac1b['Department']['ID']);_0x40b4f9=_0x40b4f9+_0x345dc4(0x1d8),_0x446592+=_0x345dc4(0x154)+_0x2314ed+_0x345dc4(0x23d),_0x446592+='<td\x20class=\x22text-left\x22>Department</td>',_0x446592+=_0x345dc4(0x235)+_0x40b4f9+'>'+_0x15ac1b[_0x345dc4(0x1c7)]['DepartmentName']+_0x345dc4(0x2c2);}),$(_0x4f50d3(0x160))[_0x4f50d3(0x2af)](_0x446592),BindProjectsCopy();});}function BindProjectsCopy(){var _0x18c28c=a0_0x2b038c,_0x5b420d='',_0xf555e5=[],_0x1f6bdb=_0x18c28c(0x27e)+Logged_CompanyId+_0x18c28c(0x293)+_spPageContextInfo['userId']+_0x18c28c(0x26e);$[_0x18c28c(0x1cc)](getItemsWithQuery(_0x18c28c(0x29f),_0x1f6bdb))['done'](function(_0x1b9bd1){var _0x473893=_0x18c28c;$[_0x473893(0x1be)](_0x1b9bd1,function(_0x279f0d,_0x5e3179){var _0x4a24db=_0x473893;if(_0xf555e5[_0x4a24db(0x221)](_0x5e3179[_0x4a24db(0x2b5)]['Id'])==-0x1){var _0x246787=getProjectDMS(_0x5e3179[_0x4a24db(0x2b5)]['Id']);_0xf555e5[_0x4a24db(0x244)](_0x5e3179[_0x4a24db(0x2b5)]['Id']),_0x5b420d+=_0x4a24db(0x234)+_0x279f0d+_0x4a24db(0x23d),_0x5b420d+='<td\x20class=\x22text-left\x22>Project</td>',_0x5b420d+=_0x4a24db(0x1ef)+_0x246787+'>'+_0x5e3179[_0x4a24db(0x2b5)]['ProjectName']+'</a></td></tr>';}}),$(_0x473893(0x160))['append'](_0x5b420d);}),getGuestClientsCopy();}function getGuestClientsCopy(){var _0x58a101=a0_0x2b038c,_0x47cb3e='',_0x532484=_0x58a101(0x2a2)+_spPageContextInfo[_0x58a101(0x192)]+_0x58a101(0x1d1)+_spPageContextInfo[_0x58a101(0x192)]+'\x27\x20';$['when'](getItemsWithQuery(_0x58a101(0x2ae),_0x532484))[_0x58a101(0x1b2)](function(_0x1ef037){var _0x356354=_0x58a101;if(_0x1ef037[_0x356354(0x1e6)]>0x0)for(var _0x15c51e=0x0;_0x15c51e<_0x1ef037[_0x356354(0x1e6)];_0x15c51e++){var _0xca5558=_0x1ef037[_0x15c51e];_0xca5558[_0x356354(0x1b3)]!=null&&(_0x47cb3e+=_0x356354(0x28a)+_0x15c51e+_0x356354(0x23d),_0x47cb3e+=_0x356354(0x2aa),_0x47cb3e+='<td><a\x20href=javascript:void(0)\x20style=\x22cursor:text;color:black;\x22\x20name\x20=\x20'+_0xca5558['DocumentLibrary']+'>'+_0xca5558[_0x356354(0x1b8)]+'</a></td></tr>');}$(_0x356354(0x160))[_0x356354(0x2af)](_0x47cb3e);}),getCustomDMSCopy();}function getCustomDMSCopy(){var _0x4c34dc=a0_0x2b038c,_0x14f4ca='',_0x1e2e99=_0x4c34dc(0x15d)+_spPageContextInfo[_0x4c34dc(0x228)]+_0x4c34dc(0x26e);$[_0x4c34dc(0x1cc)](getItemsWithQuery(_0x4c34dc(0x2a0),_0x1e2e99))['done'](function(_0x4c50eb){var _0x96304f=_0x4c34dc;if(_0x4c50eb[_0x96304f(0x1e6)]>0x0){for(var _0x158cb8=0x0;_0x158cb8<_0x4c50eb[_0x96304f(0x1e6)];_0x158cb8++){_0x4c50eb[_0x158cb8][_0x96304f(0x21b)]==_0x96304f(0x2c1)&&(_0x14f4ca+=_0x96304f(0x248)+_0x158cb8+_0x96304f(0x23d),_0x14f4ca+='<td\x20class=\x22text-left\x22>Custom</td>',_0x14f4ca+=_0x96304f(0x1ef)+_0x4c50eb[_0x158cb8][_0x96304f(0x243)]+'>'+_0x4c50eb[_0x158cb8][_0x96304f(0x1b8)]+_0x96304f(0x2c2));}$(_0x96304f(0x160))['append'](_0x14f4ca);}});}function getTreeView(_0x1554e8){var _0x13002d=a0_0x2b038c,_0x27fcc8='',_0x4785fd='',_0x1a800c='',_0x47ae04='';if(_0x1554e8[_0x13002d(0x2b3)][0x1][_0x13002d(0x27a)]==_0x13002d(0x1d7))_0x27fcc8=_spPageContextInfo[_0x13002d(0x238)],_0x1a800c='DocumentManagementSystem/'+_spPageContextInfo['userEmail']+'/',_0x4785fd=_0x13002d(0x213),_0x47ae04=_0x13002d(0x1d7);else{var _0xcf7935=_0x1554e8[_0x13002d(0x2b3)][0x2]['innerHTML']['split']('name=\x22')[0x1]['split']('\x22>')[0x0];const _0x56431f=_0xcf7935[_0x13002d(0x29c)](_0x13002d(0x25c))[0x0];_0x27fcc8=_0x56431f[_0x13002d(0x166)](0x0,_0x56431f['lastIndexOf']('/'));;_0x1a800c=_0x56431f[_0x13002d(0x29c)]('/')[_0x56431f['split']('/')[_0x13002d(0x1e6)]-0x1]+'/',_0x1a800c=='Documents/'&&(_0x1a800c=_0x13002d(0x265)),_0x4785fd=_0x1a800c[_0x13002d(0x190)](0x0,_0x1a800c[_0x13002d(0x1e6)]-0x1),_0x47ae04=_0x1554e8[_0x13002d(0x2b3)][0x1][_0x13002d(0x27a)]+_0x13002d(0x156)+_0x1554e8[_0x13002d(0x2b3)][0x2]['innerHTML'][_0x13002d(0x29c)](_0x13002d(0x181))[0x1][_0x13002d(0x29c)]('\x22>')[0x1][_0x13002d(0x29c)]('</a>')[0x0];}bindTreeView(_0x27fcc8,_0x1a800c,_0x4785fd,_0x47ae04);}function bindTreeView(_0x45ed18,_0x2d4902,_0x23ae0d,_0x2432ef){var _0x3de9fa=a0_0x2b038c;$(_0x3de9fa(0x2ab))[_0x3de9fa(0x2d6)](),$(_0x3de9fa(0x203))[_0x3de9fa(0x19f)](_0x2432ef);var _0x4958b9='',_0x334805=_0x45ed18+_0x3de9fa(0x1d2)+_0x2d4902+_0x3de9fa(0x1a0);$[_0x3de9fa(0x1e3)]({'url':_0x334805,'type':_0x3de9fa(0x183),'headers':{'accept':_0x3de9fa(0x1f1)},'async':![],'success':function(_0x516547){var _0x1f8949=_0x3de9fa,_0x11aa1f=_0x516547['d'][_0x1f8949(0x1df)][_0x1f8949(0x1ea)];if(_0x11aa1f[_0x1f8949(0x1e6)]>0x0){_0x4958b9+=_0x1f8949(0x297),_0x4958b9+=_0x1f8949(0x241)+_0x45ed18+_0x1f8949(0x191)+_0x2d4902+'\x27,\x20\x27'+_0x23ae0d+_0x1f8949(0x227),_0x4958b9+=_0x1f8949(0x297);for(var _0x2adae8=0x0;_0x2adae8<_0x11aa1f['length'];_0x2adae8++){_0x11aa1f[_0x2adae8][_0x1f8949(0x22a)]!='Forms'&&(_0x4958b9+=_0x1f8949(0x208)+_0x11aa1f[_0x2adae8][_0x1f8949(0x25f)]['Id']+_0x1f8949(0x26d)+_0x45ed18+_0x1f8949(0x191)+_0x2d4902+_0x11aa1f[_0x2adae8][_0x1f8949(0x22a)]+_0x1f8949(0x191)+_0x23ae0d+_0x1f8949(0x1cd)+_0x11aa1f[_0x2adae8]['Name']+'</a>',_0x4958b9+=_0x1f8949(0x297),_0x4958b9+=BindSubFolders(_0x45ed18,_0x2d4902+_0x11aa1f[_0x2adae8][_0x1f8949(0x22a)]+'/',_0x23ae0d),_0x4958b9+=_0x1f8949(0x2b2),_0x4958b9+=_0x1f8949(0x1a4));}_0x4958b9+='</ul>',_0x4958b9+=_0x1f8949(0x2b2),$(_0x1f8949(0x2ab))[_0x1f8949(0x2af)](_0x4958b9);}else _0x4958b9+=_0x1f8949(0x297),_0x4958b9+=_0x1f8949(0x241)+_0x45ed18+_0x1f8949(0x191)+_0x2d4902+_0x1f8949(0x191)+_0x23ae0d+_0x1f8949(0x227),_0x4958b9+=_0x1f8949(0x1f2),$('.treesec')[_0x1f8949(0x2af)](_0x4958b9);}})['fail'](function(_0x313403){var _0x313571=_0x3de9fa;_0x4958b9+=_0x313571(0x180),$('.treesec')[_0x313571(0x2af)](_0x4958b9),$(_0x313571(0x1ba))[_0x313571(0x22d)]();}),$(_0x3de9fa(0x1ba))[_0x3de9fa(0x22d)]();}function BindSubFolders(_0x32e71f,_0x1f5fe8,_0x4d7fa3){var _0x5356b0=a0_0x2b038c;try{var _0x58fd31='',_0x1d51fc=_0x32e71f+_0x5356b0(0x1d2)+_0x1f5fe8+_0x5356b0(0x1a0);return $[_0x5356b0(0x1e3)]({'url':_0x1d51fc,'type':'GET','headers':{'accept':_0x5356b0(0x1f1)},'async':![],'success':function(_0x4e0b60){var _0x469993=_0x5356b0,_0x15d4e2=_0x4e0b60['d'][_0x469993(0x1df)]['results'];if(_0x15d4e2[_0x469993(0x1e6)]>0x0){_0x58fd31+=_0x469993(0x297);for(var _0x4c8543=0x0;_0x4c8543<_0x15d4e2[_0x469993(0x1e6)];_0x4c8543++){_0x15d4e2[_0x4c8543][_0x469993(0x22a)]!=_0x469993(0x240)&&(_0x58fd31+=_0x469993(0x208)+_0x15d4e2[_0x4c8543][_0x469993(0x25f)]['Id']+_0x469993(0x26d)+_0x32e71f+'\x27,\x20\x27'+_0x1f5fe8+_0x15d4e2[_0x4c8543][_0x469993(0x22a)]+_0x469993(0x191)+_0x4d7fa3+_0x469993(0x1cd)+_0x15d4e2[_0x4c8543][_0x469993(0x22a)]+'</a>',_0x58fd31+=_0x469993(0x297),_0x58fd31+=BindSubFolders(_0x32e71f,_0x1f5fe8+_0x15d4e2[_0x4c8543][_0x469993(0x22a)]+'/',_0x4d7fa3),_0x58fd31+=_0x469993(0x2b2),_0x58fd31+=_0x469993(0x1a4));}_0x58fd31+=_0x469993(0x2b2);}}}),_0x58fd31;}catch(_0x59a23b){alert(_0x59a23b[_0x5356b0(0x194)]),$(_0x5356b0(0x1ba))[_0x5356b0(0x22d)]();}}var CopyLibrary='';function ClickFolder(_0x2b963e,_0x32c4f8,_0x5e4cac,_0x4053da){var _0x4f8cf7=a0_0x2b038c;CopyDestURL=_0x32c4f8,CopyFolderName=_0x5e4cac;if(CopyFolderName[_0x4f8cf7(0x221)]('Shared%20Documents')!=-0x1)CopyFolderName=CopyFolderName[_0x4f8cf7(0x1c0)](_0x4f8cf7(0x2c4),'Documents');else CopyFolderName[_0x4f8cf7(0x221)](_0x4f8cf7(0x252))!=-0x1&&(CopyFolderName=CopyFolderName[_0x4f8cf7(0x1c0)](_0x4f8cf7(0x252),_0x4f8cf7(0x259)));$(_0x4f8cf7(0x19b))[_0x4f8cf7(0x24f)]({'text-shadow':''}),$(_0x2b963e)[_0x4f8cf7(0x24f)](_0x4f8cf7(0x207),_0x4f8cf7(0x2c9));}function copyFile(){var _0x1869e4=a0_0x2b038c,_0x4de1c0=CopySourceURL,_0x5478cc=CopyDestURL,_0x4e6f82=new SP['RequestExecutor'](_0x4de1c0),_0x480eb8=new SP[(_0x1869e4(0x18a))](_0x5478cc),_0x46f244=$(_0x1869e4(0x283))[_0x1869e4(0x19f)](),_0x2a6831=_0x4de1c0+_0x1869e4(0x1ad)+_0x46f244+_0x1869e4(0x1ac),_0x350c62=_0x5478cc,_0x40634f=$('#FileName')['text'](),_0xc41c0d=_0x350c62+_0x1869e4(0x1a1)+encodeURIComponent(CopyFolderName)+_0x1869e4(0x155)+_0x40634f+_0x1869e4(0x17e);$['ajax']({'url':_0x350c62+_0x1869e4(0x269),'type':'POST','headers':{'Accept':_0x1869e4(0x1f1)},'success':function(_0x369f2c){var _0x5b5d6c=_0x1869e4,_0x2eb668=_0x369f2c['d'][_0x5b5d6c(0x2d7)][_0x5b5d6c(0x14b)];_0x2a6831['indexOf'](_0x5b5d6c(0x259))!=-0x1&&(_0x2a6831=_0x2a6831[_0x5b5d6c(0x1c0)](_0x5b5d6c(0x259),_0x5b5d6c(0x252)));var _0x342d65={'url':_0x2a6831,'method':_0x5b5d6c(0x183),'binaryStringResponseBody':!![],'success':function(_0x2c866b){var _0x4ad0a7=_0x5b5d6c,_0x41c252=_0x369f2c['body'];_0xc41c0d[_0x4ad0a7(0x221)]('Documents')!=-0x1&&(_0xc41c0d=_0xc41c0d[_0x4ad0a7(0x1c0)](_0x4ad0a7(0x259),_0x4ad0a7(0x252)));$[_0x4ad0a7(0x1cc)](GetFormDigestValue(_0x350c62))[_0x4ad0a7(0x1b2)](function(_0x4fbd84){RequestDigest=_0x4fbd84;});var _0x40d8dc={'url':_0xc41c0d,'method':_0x4ad0a7(0x204),'headers':{'Accept':'application/json;\x20odata=verbose','X-RequestDigest':RequestDigest},'contentType':_0x4ad0a7(0x1f1),'binaryStringRequestBody':!![],'body':_0x2c866b[_0x4ad0a7(0x1c5)],'success':function(_0x115a74){var _0x21b743=_0x4ad0a7;RequestDigest=$(_0x21b743(0x22f))[_0x21b743(0x254)](),$(_0x21b743(0x1dd))[_0x21b743(0x299)]('click'),$(_0x21b743(0x197))[_0x21b743(0x1a2)](_0x21b743(0x16d),![]),$(_0x21b743(0x1c6))[_0x21b743(0x17c)]('hide'),IsMoving==!![]?DeleteFileFromSource(''):(alert(_0x21b743(0x274)),CopyDestURL='',CopyFolderName='');},'error':function(_0x2acafd){var _0x2b2c78=_0x4ad0a7;return RequestDigest=$(_0x2b2c78(0x22f))[_0x2b2c78(0x254)](),_0x2acafd[_0x2b2c78(0x1c5)][_0x2b2c78(0x1b7)](_0x2b2c78(0x28b))==!![]?(alert('You\x20don\x27t\x20have\x20the\x20required\x20permission\x20to\x20perform\x20this\x20operation.'),![]):(alert(_0x2acafd[_0x2b2c78(0x1c5)]),![]);}};_0x480eb8[_0x4ad0a7(0x15c)](_0x40d8dc);},'error':function(_0x1c33a0){var _0x4c76f2=_0x5b5d6c;return RequestDigest=$(_0x4c76f2(0x22f))['val'](),_0x1c33a0['body'][_0x4c76f2(0x1b7)]('Access\x20is\x20denied')==!![]?(alert(_0x4c76f2(0x231)),![]):(alert(_0x1c33a0['body']),![]);}};_0x4e6f82[_0x5b5d6c(0x15c)](_0x342d65);},'error':function(_0x1f81ec){var _0x1622dc=_0x1869e4;return _0x1f81ec[_0x1622dc(0x1c5)][_0x1622dc(0x1b7)]('Access\x20is\x20denied')==!![]?(alert('You\x20don\x27t\x20have\x20the\x20required\x20permission\x20to\x20perform\x20this\x20operation.'),![]):(alert(_0x1f81ec[_0x1622dc(0x1c5)]),![]);}});}function DeleteFileFromSource(_0x3d5acd){var _0x440e5b=a0_0x2b038c;$[_0x440e5b(0x1cc)](GetFormDigestValue(CopySourceURL))[_0x440e5b(0x1b2)](function(_0x3e907e){RequestDigest=_0x3e907e;}),$[_0x440e5b(0x1e3)]({'url':CopySourceURL+_0x440e5b(0x27f)+CopyLibrary+'\x27)/items(\x27'+DocumentId+'\x27)','type':'POST','async':![],'headers':{'X-RequestDigest':RequestDigest,'IF-MATCH':'*','X-HTTP-Method':_0x440e5b(0x2bc)},'success':function(_0x5d6e26,_0x56c195,_0x5638c3){var _0x388806=_0x440e5b;RequestDigest=$('#__REQUESTDIGEST')['val'](),$('#ModalDisplayProperty')[_0x388806(0x17c)]('hide'),CopyLibrary='',CopyDestURL='',CopyFolderName='',_0x3d5acd==_0x388806(0x1f9)?alert(_0x388806(0x25d)):alert(_0x388806(0x21c));},'error':function(_0x5f2bc9,_0x528253,_0x31e225){var _0x5732e0=_0x440e5b;return RequestDigest=$(_0x5732e0(0x22f))[_0x5732e0(0x254)](),_0x5f2bc9[_0x5732e0(0x2cf)]['includes'](_0x5732e0(0x28b))==!![]?(alert('You\x20don\x27t\x20have\x20the\x20required\x20permission\x20to\x20perform\x20this\x20operation.'),![]):(alert(_0x5f2bc9[_0x5732e0(0x2cf)]),![]);}});}function a0_0x37fb(){var _0xc22f09=['.historydocid','\x27\x27></td>','#projectList','substring','\x27,\x20\x27','userEmail','<span\x20onclick=\x22removeShareUser(this,\x20\x27','message','<a\x20href=\x27javascript:void(0);\x27\x20class=\x27emailsec\x27\x20onclick=\x27OpenEmail(\x22','.select_all','input[name=\x22Library\x22]','#userDiv','#FileName','Kindly\x20select\x20any\x20users\x20first.','.DmsTree','OnValueChangedClientScript','\x27\x20data-themekey=\x27#\x27><div\x20class=\x27designationtype\x27>','sucessfully\x20revoke','text','\x27)?$select=ID,File_x0020_Type,FSObjType,FileLeafRef,EncodedAbsUrl,FileRef&$top=5000&$expand=Folders,Folders/ListItemAllFields,Files,Files/ListItemAllFields','/_api/web/GetFolderByServerRelativeUrl(\x27','attr','Assigned','</li>','.txtselect','#selectProjectNames','.parentremove','totalrecords','2qxbWqE','value','GroupTitle','\x27)/$value','/_api/web/GetFileByServerRelativeUrl(\x27','.chkClientName','filter','7CTgbnb','<span>','done','DocumentLibrary','webServerRelativeUrl','grep','#filenamee','includes','Title','SharingPplPicker_TopSpan','#txtPleaseWait','error','type','DD/MM/YYYY','each','#txtSharingHistoy','replace','GroupName','\x20to\x20perform\x20this\x20operation.','</h3><p>Guest\x20Client</p></td>','UserId','body','#copymove','Department','convertJSONDateAMPMWithDate','Guest\x20Client','null','#ext#@adaptindia.onmicrosoft.com','when','\x27);\x22\x20href=\x22javascript:void(0);\x22>','99sJCbbL','SharingLevel','Contribute','\x27\x20or\x20InternalSupervisor/EMail\x20eq\x20\x27','/_api/Web/GetFolderByServerRelativeUrl(\x27','<div><strong>Title:</strong>\x20','.btnClosePopup','/_api/web/lists/getbytitle(\x27','\x27)/id','My\x20Documents','/DepartmentalDMS/Forms/AllItems.aspx','#lblSelectedCurrentEmail','796890OQOerp','<div\x20class=\x22empoyeeimg\x22><img\x20src=\x22','<li><input\x20type=\x22checkbox\x22\x20id=\x22ProjectId','#Backbtn','\x20does\x20not\x20exist\x20in\x20the\x20file\x20exploerer\x20plugin','Folders','Required','toLowerCase','<tr>','ajax','origin','Selective','length','does\x20not\x20exist\x20on\x20type','format','Custom','results','\x27)/items','</span></td>','Modified','.NoRecordFound','<td><a\x20href=javascript:void(0)\x20style=\x22cursor:text;color:black;\x22\x20name\x20=\x20','Shared\x20with\x20','application/json;odata=verbose','<ul></ul></ul>','#LibProject','\x27\x20and\x20PermissionStatus\x20ne\x20\x27Revoked\x27','title','/_api/SP.Utilities.Utility.SendEmail','</option>','<td><input\x20type=\x27checkbox\x27\x20class=\x27historydocid\x27\x20value=','DeleteFile','?$select=*,SharedUsers/Id,SharedUsers/Title,SharedClient/Title,Author/Title&$expand=Author,SharedUsers,SharedClient&$Filter=DocumentID\x20eq\x20\x27','PermissionStatus','ProjectId','evenselected','#selectClientName','?$select=ID,DocumentNo,Details,ServerRedirectedEmbedURL,Title,DocumentURL,DocumentID,DocumentType,SharedGroup,PermissionStatus,PermissionType,SharedUsers/Title,SharedUsers/ID,Author/Title,Author/ID&$expand=SharedUsers,Author','\x27,\x20this)\x22>','Yes','\x22\x20alt=\x22\x22>','#FolderNameCopy','POST','fail','#GroupNameList','text-shadow','<li\x20class=\x22parent\x22\x20id=\x22treeNode_','.Project-Team','before','<div><strong>Type:</strong>\x20','/_api/web/roledefinitions/getbyname(\x27','SP.Sharing.UserRoleAssignment','<div><strong>Message:</strong>\x20','SharedGroup','preventDefault','</h3>','SPClientPeoplePickerDict','DocumentManagementSystem','inArray',');\x22\x20class=\x22crosebox\x22><i\x20class=\x22fa\x20fa-times\x22></i></span>','</td>','Organization','9nTVGCh','ready','Permissions\x20has\x20been\x20revoked.','Status','File\x20has\x20been\x20successfully\x20moved.','Key','removeClass',':\x20Item\x20is\x20set\x20permission','#ClientList','indexOf','.My-Groups','My_Doc','GroupId','?$select=*,Department/DepartmentName,Department/ID&$top=5000&$expand=Department&$filter=(CompanyId\x20eq\x20\x27','Shared_x0020_Documents','\x27);\x22\x20href=\x22javascript:void(0);\x22>Root</a>','userId','prop','Name','.context-menu','468010KLyhvk','hide','</div></div></td>','#__REQUESTDIGEST','<div\x20class=\x22col-sm-6\x20parentremove\x20User','You\x20don\x27t\x20have\x20the\x20required\x20permission\x20to\x20perform\x20this\x20operation.','>Click\x20here</a>\x20to\x20open\x20the\x20document.</div>','filetree','<tr><td><div\x20class=\x22checkbox\x20m-0\x22><label><input\x20class=\x22DocLib\x22\x20name=\x22Library\x22\x20type=\x22radio\x22\x20id=\x22chkProjectTeamDetails','<td\x20class=\x22text-left\x22><a\x20href=javascript:void(0)\x20style=\x22cursor:text;color:black;\x22\x20name\x20=\x20','\x27title=\x27','SharedDocument','webAbsoluteUrl','#btnShare','Revoked','\x27)/ListItemAllFields/roleassignments/getbyprincipalid(','desc','\x22\x20value=\x22\x22></label></div></td>','parents','<td\x20class=\x22text-left\x22>Department</td>','Forms','<li\x20class=\x22parent\x22><a\x20class=\x22DmsTree\x20RootFolder\x22\x20onclick=\x22ClickFolder(this,\x20\x27','\x27,\x20','DMS_Link','push','Not\x20Required','#filetitle','Attempted\x20to\x20perform\x20an\x20unauthorized\x20operation','<tr><td><div\x20class=\x22checkbox\x20m-0\x22><label><input\x20class=\x22DocLib\x22\x20name=\x22Library\x22\x20type=\x22radio\x22\x20id=\x22chkPersonalDMS','<li><img\x20src=\x22','</a></div></div></td>','</p>','</div></span>','#forever','log','css','.chkClientName:checked','Author','Shared\x20Documents','</div><div\x20class=\x27designationtype\x27>','val','.GpUser','.historydocid:checked','find','Everyone','Documents','startrecord','forEach','/Forms','File\x20has\x20been\x20successfully\x20deleted.','Expiry\x20date\x20should\x20me\x20greater\x20than\x20today.','ListItemAllFields','<div><a\x20href=','#shreduser','tablenav','Restricted\x20View','\x27)/getItemById(','Shared\x20Documents/',',\x20shared\x20the\x20following\x20document\x20with\x20you.<br/><br/>','<td\x20class=\x22text-left\x22>My\x20Documents</td><td\x20class=\x22text-left\x22></td></tr>','<li><input\x20type=\x22checkbox\x22\x20class=\x22chkGpName\x22\x20id=\x22GroupId','/_api/contextinfo','#AddUserPplPicker','<div><strong>File\x20Name\x20:</strong>','#expiredats','\x22><a\x20class=\x22DmsTree\x22\x20onclick=\x22ClickFolder(this,\x20\x27','\x27\x20and\x20Status\x20eq\x20\x27Active\x27','.chkProjectName','#notifymail','AddUserPplPicker','Permission\x20has\x20been\x20revoked.','<td>','File\x20has\x20been\x20successfully\x20copied.','oddselected','.ProjectUser','...','User','<td><div\x20class=\x27flexingtwo\x27><div\x20id=\x27profileImage\x27>','innerHTML','File','Select','</div><div\x20class=\x27designationtype\x27><h3\x20class=\x27namesection\x27>','?$select=DocumentPermission,TeamMember/Id,Project/Id,Project/ProjectName&$top=5000&$orderby=Project/ProjectName\x20asc&$expand=TeamMember,Project&$filter=CompanyId\x20eq\x20\x27','/_api/web/lists/GetByTitle(\x27','\x27\x20and\x20WebPartName\x20eq\x20\x27Documents\x27)\x20','charAt','join','#FilePath','Deferred','\x27)\x22>','<span\x20class=\x22employeeemail\x22>','SharedUserEmail','.chkGpName','resolve','<tr><td><div\x20class=\x22checkbox\x20m-0\x22><label><input\x20class=\x22DocLib\x22\x20name=\x22Library\x22\x20type=\x22radio\x22\x20id=\x22chkClientMaster','Access\x20is\x20denied','.Organization','responseJSON','a[href=\x22#\x22]','stringify','\x27\x20and\x20Owner\x20eq\x20\x27','</div><div\x20class=\x22employeeinfo\x22><h3>','#referNo','\x27\x20and\x20TeamMemberId\x20eq\x20\x27','#sharedHistoryList','EMail','.chk','<ul>','</span>','trigger','SharedUsers','html','split','<span\x20onclick=\x22RemoveGroup(\x27','&$filter=SharedUsers/ID\x20eq\x20\x27','ProjectTeamDetails','PersonalDMS_Setting','NeedAcknowledgement','?$select=Id,Title,IsActive,CompanyID/Id,DocumentLibrary,InternalMembers/EMail,InternalSupervisor/EMail&$orderby=Title\x20asc&$expand=CompanyID,InternalMembers,InternalSupervisor&$top=5000&$filter=DocumentLibrary\x20ne\x20null\x20and\x20IsActive\x20eq\x20\x271\x27\x20and\x20InternalMembers/EMail\x20eq\x20\x27','1942048tyLnYL','sharedHistoryTable','concat','\x27)>Revoke</a></td>','toISOString','<td><div\x20class=\x27flexingtwo\x27><div\x20class=\x27empoyeeimg\x20clientnameshow\x27><span\x20class=\x27clienttext\x27><div\x20id=\x27profileImage\x27>','</ul></li>','<td\x20class=\x22text-left\x22>Guest\x20Client</td>','.treesec','<td><div\x20class=\x27RevokedDetails\x27><span\x20style=\x27cursor:\x20not-allowed;color:\x20Red;\x27>Revoked</span><span>','</tr>','ClientMaster','append','#myModalShareHistory','#sharedWithPermission','</ul>','cells','click','Project','show','644896nImqOS','head','permission\x20deleted\x20sucessfully.','oddrow','\x27\x20and\x20DocumentID\x20eq\x20\x27','DELETE','#FileSharing','\x27)/Items(','SharingPplPicker','addClass','Active','</a></td></tr>','<div><strong>Reference\x20No\x20:</strong>\x20','Shared%20Documents','table','evenrow','</div>','\x22);\x27>','2px\x200px\x205px\x20#1e90ff','<br/><br/>','toString','change','\x27,\x27','You\x20don\x27t\x20have\x20the\x20required\x20permission\x20on\x20','responseText','json','\x20Successfully\x20removed\x20Permission\x20!','disabled','#txtShareMessage','undefined','object','empty','GetContextWebInformation','\x27&$orderby=Created\x20desc','?$select=Id,Title,IsActive,GroupName/Id,GroupName/Title,DocumentLibrary,CompanyID/Id,DocumentLibrary,InternalMembers/EMail,InternalSupervisor/EMail&$orderby=Title\x20asc&$expand=GroupName,CompanyID,InternalMembers,InternalSupervisor&$top=5000&$filter=IsActive\x20eq\x20\x271\x27\x20and\x20InternalMembers/EMail\x20eq\x20\x27','currentpage','\x20title=\x27','\x22\x20title=\x22','endrecord','Required\x20columns\x20does\x20not\x20exists.\x20Kindly\x20contact\x20administrator.','</span></div></li>','/_api/Web/Lists/getByTitle(\x27','.txtCopyLink','SharedId','#sharewith','sorter','userDisplayName','FormDigestValue','\x22><div\x20class=\x22employeesection\x22>','#revokebtn','#Acknowledgment','PermissionType','ProjectName','SP.Utilities.EmailProperties','#FileTitle','<td><a\x20style=\x27cursor:\x20pointer;\x27\x20onclick=RevokeGpPermission(\x27','<tr><td><div\x20class=\x22checkbox\x20m-0\x22><label><input\x20class=\x22DocLib\x22\x20name=\x22Library\x22\x20type=\x22radio\x22\x20id=\x22chkProcessApprovers','\x27)/Files/Add(url=\x27','\x20:\x20','1073741827','DisplayText','Read','Created','66970jAFldR','executeAsync','?$top=5000&$select=*,Author/Id,CompanyID/Id&$expand=Author,CompanyID&$orderby=Title\x20asc&$filter=EmployeeName/Id\x20eq\x20\x27','/_layouts/15/userphoto.aspx?accountname=','\x27\x20and\x20ContributorsId\x20eq\x20\x27','#tbdyCopyFileLib','<td><div\x20class=\x27flexingtwo\x27><img\x20src=\x27','<option\x20value=\x27','My-Groups','</h3><ul\x20class=\x22listingroups\x22>','<div\x20class=\x22col-sm-6\x20parentremove\x20GpUser','slice','#selectAllHist','<h3\x20class=\x27namesection\x27>','<span\x20class=\x22employeeemail\x22\x20style=\x22cursor:pointer;color:blue\x22\x20onclick=\x22OpenEmail(\x27','TeamMember','#selectedGroupNames','ProjectDetails','checked','#sharedWithPermission\x20:selected','<div\x20class=\x22col-sm-6\x20parentremove\x20ProjectUser','?$select=Id,Project/Id,TeamMember/EMail,TeamMember/Title,TeamMember/Id,Status&$top=5000&$expand=Project,TeamMember&$filter=Project/Id\x20eq\x20\x27','SendEmailSharedNotification\x20\x20','<div><strong>Permission:</strong>\x20','1073741937','151614uNbxkE','#TotalItemscount','?$select=ID,SharedUsers/ID,SharedUsers/Title,SharedUsers/EMail,LogonUser/ID,LogonUser/EMail,LogonUser/Title,LogonUser/UserName,SharingLevel&$expand=SharedUsers,LogonUser&$orderby=ID\x20asc&$filter=LogonUser/EMail\x20eq\x20\x27','\x27);\x22\x20class=\x22crosebox\x22><i\x20class=\x22fa\x20fa-times\x22></i></span>','asc','reject','#FileDocType','</div></div></div>','modal','Kindly\x20enter\x20expiry\x20date.','\x27,overwrite=true)','699879RvRBpN','<div\x20class=\x22\x22>Document\x20library\x20cannot\x20be\x20found.</div>','name=\x22','<tr><td></td>','GET','remove','<option\x20value=\x22\x22>All</option>','?$select=Id,ProjectName,DepartmentName,ClientID/Title,ManagerName/EMail,Status&$top=5000&$expand=ClientID,ManagerName&$filter=ManagerName/EMail\x20eq\x20\x27','.User','.Selective','promise','RequestExecutor','SharedClient','toggleClass'];a0_0x37fb=function(){return _0xc22f09;};return a0_0x37fb();}function TreeStructure(){var _0x1d885d=a0_0x2b038c;$['fn'][_0x1d885d(0x233)]=function(_0x530881){var _0xd3f4ea=_0x1d885d,_0x35d235={'collapsed':!![],'console':![]},_0x56dd3e={'init':function(_0x48894e){var _0x48894e=$['extend'](_0x35d235,_0x48894e);return this['each'](function(){var _0x5bf100=a0_0x2356,_0xf97731=$(this);_0xf97731['addClass']('file-list')[_0x5bf100(0x257)]('li')[_0x5bf100(0x2c0)]('folder-root\x20closed')['on'](_0x5bf100(0x2b4),_0x5bf100(0x28e),function(_0x239aa9){var _0x164ec5=_0x5bf100;return _0x239aa9[_0x164ec5(0x210)](),$(this)['parent']()[_0x164ec5(0x18c)]('closed')[_0x164ec5(0x18c)]('open'),![];});});}};if(typeof _0x530881===_0xd3f4ea(0x2d5)||!_0x530881)return _0x56dd3e['init']['apply'](this,arguments);else $['on'](_0xd3f4ea(0x1bb),function(){var _0x3f4b19=_0xd3f4ea;console[_0x3f4b19(0x24e)](_0x530881+_0x3f4b19(0x1de));});},waitingDialog[_0x1d885d(0x22d)]();}