var a0_0x22105c=a0_0x2ef5;(function(_0x4e32b4,_0x33cb1d){var _0x3c8073=a0_0x2ef5,_0x254566=_0x4e32b4();while(!![]){try{var _0x45a772=parseInt(_0x3c8073(0x264))/0x1*(-parseInt(_0x3c8073(0x1ed))/0x2)+-parseInt(_0x3c8073(0x2b5))/0x3+-parseInt(_0x3c8073(0x234))/0x4+-parseInt(_0x3c8073(0x25a))/0x5*(parseInt(_0x3c8073(0x1e8))/0x6)+-parseInt(_0x3c8073(0x238))/0x7+parseInt(_0x3c8073(0x26b))/0x8*(-parseInt(_0x3c8073(0x2a6))/0x9)+parseInt(_0x3c8073(0x223))/0xa;if(_0x45a772===_0x33cb1d)break;else _0x254566['push'](_0x254566['shift']());}catch(_0x2a51ea){_0x254566['push'](_0x254566['shift']());}}}(a0_0x4261,0xa9a53));var clientContext='',oNewWebsite='',departmentID='',companyID='',siteURLProjects='',siteUrl='',siteclientContext='',projectInternalName='';stackToUsers='',sponsorToUsers='',alluser='',projecttouser='';var IsProjectAdmin=![],IsdeptAdmin=![];$(document)[a0_0x22105c(0x1db)](function(){var _0x57492b=a0_0x22105c;$[_0x57492b(0x255)](getProjectRights())[_0x57492b(0x22a)](function(_0x2423bb){var _0x49dd46=_0x57492b;if(_0x2423bb)SP[_0x49dd46(0x27e)][_0x49dd46(0x22b)](Initialization_ProjectSite,'sp.js');else IsDepartmentAdmin()==!![]?SP[_0x49dd46(0x27e)][_0x49dd46(0x22b)](Initialization_ProjectSite,_0x49dd46(0x27c)):(alert(_0x49dd46(0x203)),window[_0x49dd46(0x23a)][_0x49dd46(0x2d2)]=_0x49dd46(0x2d6)+titanForWork[_0x49dd46(0x21e)]('CompanyId')+'');});}),$(document)[a0_0x22105c(0x1db)](function(){var _0x3e2f21=a0_0x22105c;companyID=titanForWork[_0x3e2f21(0x21e)](_0x3e2f21(0x2c3)),$('.dropdown\x20dt\x20a')['on']('click',function(){var _0xb9fd91=_0x3e2f21;$(_0xb9fd91(0x2d0))[_0xb9fd91(0x211)](_0xb9fd91(0x265));}),$(_0x3e2f21(0x1ce))['on'](_0x3e2f21(0x260),function(){$('.dropdown\x20dd\x20ul')['hide']();});function _0xa16d9b(_0x37a944){var _0x301a19=_0x3e2f21;return $('#'+_0x37a944)[_0x301a19(0x2ac)](_0x301a19(0x258))[_0x301a19(0x2bd)]();}$(document)[_0x3e2f21(0x253)](_0x3e2f21(0x260),function(_0x5becbf){var _0x598043=_0x3e2f21,_0x274329=$(_0x5becbf[_0x598043(0x214)]);if(!_0x274329[_0x598043(0x1d0)]()[_0x598043(0x254)]('dropdown'))$(_0x598043(0x2d0))[_0x598043(0x273)]();}),$(_0x3e2f21(0x24a))[_0x3e2f21(0x2b9)](_0x3e2f21(0x298),!![]),$(_0x3e2f21(0x274))[_0x3e2f21(0x273)](),$(_0x3e2f21(0x276))[_0x3e2f21(0x2ab)]({'changeMonth':!![],'changeYear':!![],'yearRange':_0x3e2f21(0x24d)}),$('.txtPlannedStartDate')[_0x3e2f21(0x2ab)](_0x3e2f21(0x29a),_0x3e2f21(0x1e1),_0x3e2f21(0x28c)),$(_0x3e2f21(0x1f1))[_0x3e2f21(0x2ab)]({'changeMonth':!![],'changeYear':!![],'yearRange':_0x3e2f21(0x24d)}),$(_0x3e2f21(0x1f1))[_0x3e2f21(0x2ab)]('option',_0x3e2f21(0x1e1),_0x3e2f21(0x28c)),$('.txtActualStartDate')[_0x3e2f21(0x2ab)]({'changeMonth':!![],'changeYear':!![],'yearRange':_0x3e2f21(0x24d)}),$('.txtActualStartDate')[_0x3e2f21(0x2ab)](_0x3e2f21(0x29a),_0x3e2f21(0x1e1),_0x3e2f21(0x28c)),$(_0x3e2f21(0x1f6))[_0x3e2f21(0x2ab)]({'changeMonth':!![],'changeYear':!![],'yearRange':_0x3e2f21(0x24d)}),$(_0x3e2f21(0x1f6))[_0x3e2f21(0x2ab)](_0x3e2f21(0x29a),_0x3e2f21(0x1e1),_0x3e2f21(0x28c)),$(_0x3e2f21(0x28f))[_0x3e2f21(0x262)](function(){var _0x5995c7=_0x3e2f21,_0xbd9381=$(_0x5995c7(0x28f))[_0x5995c7(0x1d7)]();$[_0x5995c7(0x280)]($(_0x5995c7(0x28f))[_0x5995c7(0x1d7)]())!=''&&CheckProjectCodeExistOrNot(_0x5995c7(0x283),_0xbd9381);}),$(_0x3e2f21(0x272))[_0x3e2f21(0x262)](function(){var _0x2853d1=_0x3e2f21,_0x22d216=$(_0x2853d1(0x272))[_0x2853d1(0x1d7)]();$[_0x2853d1(0x280)]($(_0x2853d1(0x272))[_0x2853d1(0x1d7)]())!=''&&CheckProjectCodeExistOrNot(_0x2853d1(0x22d),_0x22d216);});var _0x597900=new Array();_0x597900[_0x3e2f21(0x219)](0x8),_0x597900[_0x3e2f21(0x219)](0x9),_0x597900['push'](0x2e),_0x597900[_0x3e2f21(0x219)](0x24),_0x597900[_0x3e2f21(0x219)](0x23),_0x597900['push'](0x25),_0x597900[_0x3e2f21(0x219)](0x27),_0x597900[_0x3e2f21(0x219)](0x20),$(_0x3e2f21(0x28f))[_0x3e2f21(0x1e4)](function(_0x2855a4){var _0x3879fb=_0x3e2f21,_0x7898c1=_0x2855a4[_0x3879fb(0x231)]==0x0?_0x2855a4[_0x3879fb(0x2ce)]:_0x2855a4['keyCode'],_0x16de66=_0x7898c1==0x2d||_0x7898c1==0x26||_0x7898c1==0x5f||_0x7898c1>=0x30&&_0x7898c1<=0x39||_0x7898c1>=0x41&&_0x7898c1<=0x5a||_0x7898c1>=0x61&&_0x7898c1<=0x7a||_0x597900['indexOf'](_0x2855a4[_0x3879fb(0x231)])!=-0x1&&_0x2855a4[_0x3879fb(0x2ce)]!=_0x2855a4[_0x3879fb(0x231)]||_0x2855a4[_0x3879fb(0x231)]==0x20;return _0x16de66;});});function getmultiselctValue(){var _0x4fb358=a0_0x22105c;$(_0x4fb358(0x249))['on'](_0x4fb358(0x260),function(){var _0x30ee55=_0x4fb358,_0x29e9aa=$(this)[_0x30ee55(0x21f)](_0x30ee55(0x1d6))[_0x30ee55(0x2ac)]('input[type=\x22checkbox\x22]')[_0x30ee55(0x1d7)](),_0x29e9aa=$(this)[_0x30ee55(0x1d7)]()+',';if($(this)['is'](_0x30ee55(0x1cd))){var _0x3d6266=_0x30ee55(0x2a3)+_0x29e9aa+'\x22>'+_0x29e9aa+_0x30ee55(0x269);$(_0x30ee55(0x252))['append'](_0x3d6266),$(_0x30ee55(0x2ad))[_0x30ee55(0x273)]();}else{$(_0x30ee55(0x2d1)+_0x29e9aa+'\x22]')[_0x30ee55(0x29e)]();var _0x5a1ad4=$(_0x30ee55(0x2ad));$(_0x30ee55(0x24e))[_0x30ee55(0x1ee)](_0x5a1ad4);}});}function Initialization_ProjectSite(){var _0x434acd=a0_0x22105c;InitializePeoplePicker('ProjectManagerEmployeePicker',![]),InitializePeoplePicker(_0x434acd(0x202),!![]),InitializePeoplePicker(_0x434acd(0x1f3),!![]),departmentID=titanForWork[_0x434acd(0x21e)]('DepartmentId'),companyID=titanForWork[_0x434acd(0x21e)](_0x434acd(0x2c3)),companyID>0x0&&getCurrentURL_EventCreateProjectSite(_0x434acd(0x29c),companyID),$('#cancelNewProject')['click'](function(){RedirectToListViewPage();});}function getCurrentURL_EventCreateProjectSite(_0x379e6c,_0x1b2122){var _0x32dc3c=a0_0x22105c;siteURLProjects=_spPageContextInfo[_0x32dc3c(0x2b2)]+_0x32dc3c(0x242)+_0x379e6c+_0x32dc3c(0x1f8)+_0x1b2122+'\x27',$[_0x32dc3c(0x227)]({'url':siteURLProjects,'headers':{'Accept':_0x32dc3c(0x277)},'async':![],'success':function(_0x1bf6b5){var _0x41a080=_0x32dc3c,_0x5ce94f=_0x1bf6b5['d'][_0x41a080(0x2a2)];_0x5ce94f[_0x41a080(0x2af)]>0x0&&(siteURL=_0x5ce94f[0x0]['SiteURL'],siteclientContext=new SP[(_0x41a080(0x27b))](siteURL),siteURLProjects=_0x5ce94f[0x0]['SiteURL'],siteURLProjects=siteURLProjects+_0x41a080(0x1e6),clientContext=new SP[(_0x41a080(0x27b))](siteURLProjects),getConsultantDetails(siteclientContext),officeLocation(),getClientMaster(),getDepartment(),bindProjectType());},'eror':function(_0x48d301){var _0x42991f=_0x32dc3c;console[_0x42991f(0x27d)]($(_0x42991f(0x2c6))['val']());}});}function getDepartment(){var _0x1eee6f=a0_0x22105c,_0x8d090a=titanForWork['getQueryStringParameter'](_0x1eee6f(0x2c3)),_0x37debd=new SP[(_0x1eee6f(0x27b))](),_0x1cb491=_0x37debd[_0x1eee6f(0x1f4)]()[_0x1eee6f(0x221)]()[_0x1eee6f(0x21b)](_0x1eee6f(0x2b4)),_0x130bfa=new SP[(_0x1eee6f(0x1d3))](),_0x42e23d=_0x1eee6f(0x1ec)+_0x8d090a+_0x1eee6f(0x243);_0x130bfa[_0x1eee6f(0x284)](_0x42e23d);var _0x3e9107=_0x1cb491[_0x1eee6f(0x244)](_0x130bfa);_0x37debd[_0x1eee6f(0x29b)](_0x3e9107),_0x37debd[_0x1eee6f(0x257)](function(){var _0x47922c=_0x1eee6f,_0xab09d=_0x3e9107[_0x47922c(0x23f)](),_0x33dba9=0x1,_0x58db63='<select\x20name=\x22officeLocation\x22\x20id=\x22departmentDetails\x22\x20class=\x22form-control\x22>';_0x58db63+=_0x47922c(0x2a8);while(_0xab09d[_0x47922c(0x1ea)]()){var _0x496223=_0xab09d[_0x47922c(0x24b)](),_0x4e4536=_0x496223[_0x47922c(0x22f)]('ID'),_0x3cc5c9=_0x496223[_0x47922c(0x22f)](_0x47922c(0x282));_0x58db63+=_0x47922c(0x237)+_0x4e4536+'\x22>'+_0x3cc5c9+_0x47922c(0x20e),_0x33dba9++;}_0x58db63+=_0x47922c(0x213),$('#departmentDiv')['append'](_0x58db63),IsdeptAdmin==!![]&&($(_0x47922c(0x1e9))[_0x47922c(0x1d7)](Logged_DepartmentId),$(_0x47922c(0x1e9))[_0x47922c(0x2b7)](_0x47922c(0x298),!![]));},function(){var _0x1076d7=_0x1eee6f;console[_0x1076d7(0x27d)](_0x1076d7(0x212));});}function officeLocation(){var _0x2389e9=a0_0x22105c,_0x5df1cb=titanForWork['getQueryStringParameter'](_0x2389e9(0x2c3)),_0x3bc6c0=new SP[(_0x2389e9(0x27b))](),_0x5d706c=_0x3bc6c0[_0x2389e9(0x1f4)]()[_0x2389e9(0x221)]()[_0x2389e9(0x21b)](_0x2389e9(0x1fc)),_0x4d3ece=new SP[(_0x2389e9(0x1d3))](),_0x1a62cd=_0x2389e9(0x2a0)+_0x5df1cb+_0x2389e9(0x2cc);_0x4d3ece['set_viewXml'](_0x1a62cd);var _0x3b73e5=_0x5d706c[_0x2389e9(0x244)](_0x4d3ece);_0x3bc6c0['load'](_0x3b73e5),_0x3bc6c0['executeQueryAsync'](function(){var _0x56b531=_0x2389e9,_0x1889bd=_0x3b73e5[_0x56b531(0x23f)](),_0xddbcf7=0x1,_0x4d9eee=_0x56b531(0x246);_0x4d9eee+='<option\x20value=\x220\x22>-Select-</option>';while(_0x1889bd[_0x56b531(0x1ea)]()){var _0x6e55ef=_0x1889bd['get_current'](),_0x29286b=_0x6e55ef[_0x56b531(0x22f)]('ID'),_0x5e7a66=_0x6e55ef['get_item'](_0x56b531(0x1da));_0x4d9eee+=_0x56b531(0x237)+_0x29286b+'\x22>'+_0x5e7a66+_0x56b531(0x20e),_0xddbcf7++;}_0x4d9eee+=_0x56b531(0x213),$(_0x56b531(0x201))[_0x56b531(0x1ee)](_0x4d9eee);},function(){var _0x38264f=_0x2389e9;console[_0x38264f(0x27d)](_0x38264f(0x212));});}function getClientMaster(){var _0x42e7af=a0_0x22105c,_0x3f2276=titanForWork[_0x42e7af(0x21e)]('CompanyId'),_0x4f77f1=new SP['ClientContext'](),_0xb68c4f=_0x4f77f1[_0x42e7af(0x1f4)]()[_0x42e7af(0x221)]()[_0x42e7af(0x21b)](_0x42e7af(0x2ae)),_0xb6606=new SP['CamlQuery'](),_0x263e18=_0x42e7af(0x2a0)+_0x3f2276+_0x42e7af(0x2aa);_0xb6606[_0x42e7af(0x284)](_0x263e18);var _0x4a637e=_0xb68c4f[_0x42e7af(0x244)](_0xb6606);_0x4f77f1[_0x42e7af(0x29b)](_0x4a637e),_0x4f77f1[_0x42e7af(0x257)](function(){var _0x5ba00f=_0x42e7af;debugger;var _0x2990f5=_0x4a637e['getEnumerator'](),_0x31e83a=0x1,_0x1d6883='<select\x20name=\x22ClientName\x22\x20id=\x22clientName\x22\x20class=\x22form-control\x22>';_0x1d6883+=_0x5ba00f(0x2c8);while(_0x2990f5[_0x5ba00f(0x1ea)]()){var _0x1811a5=_0x2990f5[_0x5ba00f(0x24b)](),_0x3ac2eb=_0x1811a5['get_item']('ID'),_0x169d0b=_0x1811a5[_0x5ba00f(0x22f)](_0x5ba00f(0x282));_0x1d6883+='<option\x20value=\x22'+_0x3ac2eb+'\x22>'+_0x169d0b+_0x5ba00f(0x20e),_0x31e83a++;}_0x1d6883+=_0x5ba00f(0x213),$(_0x5ba00f(0x2c2))[_0x5ba00f(0x1ee)](_0x1d6883),$('#clientName')['select2']({'placeholder':_0x5ba00f(0x1e7),'allowClear':![]});},function(){var _0x308d17=_0x42e7af;console[_0x308d17(0x27d)](_0x308d17(0x212));});}function getConsultantDetails(_0x1ce133){var _0x51f1c4=a0_0x22105c,_0x29d7a7=_0x1ce133[_0x51f1c4(0x1f4)]()[_0x51f1c4(0x221)]()[_0x51f1c4(0x21b)]('Consultant_List'),_0x555aac=new SP[(_0x51f1c4(0x1d3))]();_0x555aac[_0x51f1c4(0x284)](_0x51f1c4(0x222));var _0x27f708=_0x29d7a7['getItems'](_0x555aac);_0x1ce133[_0x51f1c4(0x29b)](_0x27f708),_0x1ce133[_0x51f1c4(0x257)](function(){var _0x171b86=_0x51f1c4,_0x3d3426=_0x171b86(0x224),_0x3997b4=_0x27f708[_0x171b86(0x23f)](),_0x5e6d45=_0x27f708['get_count'](),_0xbdefa2=0x1;if(_0x5e6d45>0x0){while(_0x3997b4[_0x171b86(0x1ea)]()){var _0x4d8dc5=_0x3997b4[_0x171b86(0x24b)](),_0x35516c=_0x4d8dc5['get_item'](_0x171b86(0x1fd));_0x3d3426+=_0x171b86(0x232)+_0x35516c+_0x171b86(0x22c)+_0x35516c+_0x171b86(0x275),_0xbdefa2++;}_0x3d3426+=_0x171b86(0x26d),$(_0x171b86(0x1d6))[_0x171b86(0x1ee)](_0x3d3426),getmultiselctValue();}},function(){});}function getConsultantValue(){var _0x47f2a2=a0_0x22105c,_0x1e2a76='';return $('.multiSel\x20span')[_0x47f2a2(0x26e)](function(){var _0x69dd39=_0x47f2a2;_0x1e2a76+=$(this)[_0x69dd39(0x2bd)]();}),_0x1e2a76;}$(function(){bindButtonClick();});function bindButtonClick(){var _0x56c433=a0_0x22105c;$(_0x56c433(0x1f2))['on'](_0x56c433(0x260),function(){var _0x33a08d=_0x56c433;debugger;var _0x3f3604=$('#txtProjectName')[_0x33a08d(0x1d7)](),_0x46255e=$(_0x33a08d(0x272))[_0x33a08d(0x1d7)](),_0x416832=$(_0x33a08d(0x1e0))['find'](_0x33a08d(0x1e9))[_0x33a08d(0x1d7)](),_0x75dbdb=$(_0x33a08d(0x201))[_0x33a08d(0x2ac)](_0x33a08d(0x1de))[_0x33a08d(0x1d7)](),_0x370a18=$(_0x33a08d(0x276))[_0x33a08d(0x1d7)](),_0x11f399=$(_0x33a08d(0x1f1))[_0x33a08d(0x1d7)](),_0x471f54=getPeopleUserInfoGroups('ProjectManagerEmployeePicker');if(_0x471f54[_0x33a08d(0x2af)]==0x0)return alert(_0x33a08d(0x25e)),![];if(_0x471f54[_0x33a08d(0x2af)]==0x1){var _0x48da48=IsMangerActive(_0x471f54);if(!_0x48da48)return alert(_0x33a08d(0x2d8)),_0x48da48='',![];else var _0x40d7c5=_0x471f54[0x0];}if(_0x471f54[_0x33a08d(0x2af)]>0x1)return alert('please\x20insert\x20only\x201\x20Manager'),![];var _0x367abb=$(_0x33a08d(0x2b6))[_0x33a08d(0x1d7)](),_0x16d3c7=$(_0x33a08d(0x2c7))[_0x33a08d(0x21c)](),_0x328926='';projectInternalName=GenerateGUID();_0x370a18!=null&&_0x370a18!=''&&(_0x328926=GetDateStandardFormat(_0x370a18));var _0xf32126='';_0x11f399!=null&&_0x11f399!=''&&(_0xf32126=GetDateStandardFormat(_0x11f399));if(_0x3f3604[_0x33a08d(0x280)]()==''||_0x370a18==''||_0x11f399==''||$(_0x33a08d(0x1e9))[_0x33a08d(0x1d7)]()=='0'||_0x16d3c7=='Select\x20Customer')alert('Please\x20fill\x20all\x20required\x20fields.');else _0xf32126>_0x328926?(waitingDialog[_0x33a08d(0x228)](),createSite()):alert('Planned\x20End\x20Date\x20can\x20not\x20less\x20than\x20Planned\x20Start\x20Date.');});}function createSite(){var _0x46a579=a0_0x22105c,_0x4aaa2a=$('#txtProjectName')[_0x46a579(0x1d7)](),_0x1d4b7f=$(_0x46a579(0x2b6))[_0x46a579(0x1d7)]();siteUrl=projectInternalName;var _0x5ca596=clientContext[_0x46a579(0x1f4)]()[_0x46a579(0x1fe)](),_0x43fae5=new SP['WebCreationInformation']();_0x43fae5[_0x46a579(0x23b)](_0x4aaa2a),_0x43fae5['set_description'](_0x1d4b7f),_0x43fae5[_0x46a579(0x296)](0x409),_0x43fae5[_0x46a579(0x1fb)](siteUrl),_0x43fae5[_0x46a579(0x205)](!![]),_0x43fae5[_0x46a579(0x233)](_0x46a579(0x2b0)),_0x5ca596['add'](_0x43fae5),clientContext['executeQueryAsync'](Function[_0x46a579(0x1d2)](this,this[_0x46a579(0x1dd)]),Function[_0x46a579(0x1d2)](this,this[_0x46a579(0x20f)]));}function createSite2(){var _0x5a9031=a0_0x22105c,_0xa56515=$(_0x5a9031(0x28f))['val'](),_0xc6beee=$(_0x5a9031(0x2b6))['val']();siteUrl=_0xa56515['replace'](/\s/g,'');var _0x1d9117=clientContext['get_web']()['get_webs'](),_0x21122e=new SP[(_0x5a9031(0x1d5))]();_0x21122e[_0x5a9031(0x23b)](_0xa56515),_0x21122e[_0x5a9031(0x216)](_0xc6beee),_0x21122e[_0x5a9031(0x296)](0x409),_0x21122e[_0x5a9031(0x1fb)](siteUrl),_0x21122e[_0x5a9031(0x205)](!![]),_0x21122e[_0x5a9031(0x233)]('STS#0'),oNewWebsite=_0x1d9117[_0x5a9031(0x29f)](_0x21122e),clientContext[_0x5a9031(0x257)](Function[_0x5a9031(0x1d2)](this,onQuerySucceeded_CreateProjectSite),Function['createDelegate'](this,this[_0x5a9031(0x20f)]));}function onQuerySucceeded_CreateProjectSite(){createListItem();}function onQueryFailed_CreateProjectSite(_0x6830dd,_0x5b3fd7){var _0x1d9e5c=a0_0x22105c;alert('Request\x20failed.\x20'+_0x5b3fd7[_0x1d9e5c(0x2ca)]()+'\x0a'+_0x5b3fd7[_0x1d9e5c(0x206)]());}function GenerateGUID(){var _0x1afcab=a0_0x22105c;return _0x1afcab(0x23d)[_0x1afcab(0x27a)](/[xy]/g,function(_0x4edab6){var _0x53904d=_0x1afcab,_0x18c27a=parseFloat('0.'+Math['random']()[_0x53904d(0x1ef)]()['replace']('0.','')+new Date()[_0x53904d(0x239)]())*0x10|0x0,_0x4f1e66=_0x4edab6=='x'?_0x18c27a:_0x18c27a&0x3|0x8;return _0x4f1e66[_0x53904d(0x1ef)](0x10);});}function CheckProjectCodeExistOrNot(_0x12f9d0,_0x1d9531){var _0x510318=a0_0x22105c,_0x537952=titanForWork['getQueryStringParameter']('CompanyId'),_0x3ffe9a=_0x510318(0x218),_0x353909={},_0x42606f=![],_0x4cdf40='';if(_0x12f9d0==_0x510318(0x283))_0x4cdf40=_spPageContextInfo[_0x510318(0x2b2)]+'/_api/Web/Lists/GetByTitle(\x27ProjectDetails\x27)/Items?$select=Title&$filter=CompanyId\x20eq\x20\x27'+_0x537952+_0x510318(0x215)+_0x1d9531+'\x27';else _0x12f9d0==_0x510318(0x22d)&&(_0x4cdf40=_spPageContextInfo[_0x510318(0x2b2)]+'/_api/Web/Lists/GetByTitle(\x27ProjectDetails\x27)/Items?$select=Title&$filter=ProjectCode\x20eq\x20\x27'+_0x1d9531+_0x510318(0x268)+_0x537952+'\x27');return $[_0x510318(0x227)]({'url':_0x4cdf40,'type':_0x3ffe9a,'data':_0x353909,'async':![],'headers':{'Accept':_0x510318(0x277),'Content-Type':_0x510318(0x277),'X-RequestDigest':$(_0x510318(0x25d))[_0x510318(0x1d7)](),'IF-MATCH':'*','X-HTTP-Method':null},'cache':![],'success':function(_0x91cd81){var _0x204b4c=_0x510318,_0x341da9,_0x44f04d=_0x91cd81['d'][_0x204b4c(0x2a2)],_0x36d8d6=_0x91cd81['d']['results'][_0x204b4c(0x2af)];_0x36d8d6>0x0&&(alert(_0x204b4c(0x20d)),$(_0x204b4c(0x272))['val'](''),$(_0x204b4c(0x272))[_0x204b4c(0x245)](),$(_0x204b4c(0x28f))[_0x204b4c(0x1d7)](''),$(_0x204b4c(0x28f))[_0x204b4c(0x245)]());},'error':function(_0x47fa75){Helper['CloseWaitDialog']();}}),_0x42606f;}function getPeopleUserInfoGroups(_0x4bf6fd){var _0x10681f=a0_0x22105c,_0x30f6a1=new Array(),_0x394298=$(_0x10681f(0x259)+_0x4bf6fd+'\x27]'),_0xb09e28=SPClientPeoplePicker[_0x10681f(0x1e3)][_0x394298[0x1]['id']],_0x22a5e6=_0xb09e28[_0x10681f(0x2cd)]();if(_0x22a5e6[_0x10681f(0x2af)]>0x0)for(var _0x314273=0x0;_0x314273<_0x22a5e6[_0x10681f(0x2af)];_0x314273++){_0x30f6a1['push'](GetUserIdGroups(_0x22a5e6[_0x314273][_0x10681f(0x2d3)]));}return _0x30f6a1;}function GetUserIdGroups(_0x13974f){var _0x3f884f=a0_0x22105c,_0x1a102c='',_0x541e09=_0x3f884f(0x290),_0x484c1d=_spPageContextInfo[_0x3f884f(0x240)],_0x5d2905=_0x13974f;return $[_0x3f884f(0x227)]({'url':_0x484c1d+'/_api/web/siteusers(@v)?@v=\x27'+encodeURIComponent(_0x5d2905)+'\x27','method':_0x3f884f(0x218),'headers':{'Accept':'application/json;\x20odata=verbose'},'async':![],'success':function(_0x502ff6){_0x1a102c=_0x502ff6['d']['Id'];},'error':function(_0x444a92){var _0x16ce88=_0x3f884f;console['log'](JSON[_0x16ce88(0x20a)](_0x444a92));}}),_0x1a102c;}function createListItem(){var _0x4b5942=a0_0x22105c,_0x1c770d=new Array();_0x1c770d=getPeopleUserInfoGroups(_0x4b5942(0x1f3));if(_0x1c770d[_0x4b5942(0x2af)]==0x0){}var _0x5a820f=new Array();_0x5a820f=getPeopleUserInfoGroups(_0x4b5942(0x202));if(_0x5a820f[_0x4b5942(0x2af)]==0x0){}var _0x4e326a=$(_0x4b5942(0x272))['val'](),_0x2f0bb6=$(_0x4b5942(0x28f))[_0x4b5942(0x1d7)](),_0x1408b9=$(_0x4b5942(0x28b))[_0x4b5942(0x1d7)](),_0x3f2f04=$(_0x4b5942(0x276))[_0x4b5942(0x1d7)](),_0xd7ab4e='';_0x3f2f04!=null&&_0x3f2f04!=''&&(_0xd7ab4e=GetDateStandardFormat(_0x3f2f04));var _0xa07c22=$(_0x4b5942(0x1f1))[_0x4b5942(0x1d7)](),_0x37a1c7='';_0xa07c22!=null&&_0xa07c22!=''&&(_0x37a1c7=GetDateStandardFormat(_0xa07c22));var _0x51e8a1=$(_0x4b5942(0x22e))[_0x4b5942(0x1d7)](),_0x5cfece='';_0x51e8a1!=null&&_0x51e8a1!=''&&(_0x5cfece=GetDateStandardFormat(_0x51e8a1));txtDepartmentID=$(_0x4b5942(0x1e0))[_0x4b5942(0x2ac)](_0x4b5942(0x1e9))[_0x4b5942(0x1d7)](),DepartmentFullName=$(_0x4b5942(0x1e0))[_0x4b5942(0x2ac)]('select#departmentDetails\x20option:selected')[_0x4b5942(0x21c)](),txtofficeLocationID=$(_0x4b5942(0x201))[_0x4b5942(0x2ac)](_0x4b5942(0x1de))[_0x4b5942(0x1d7)](),OfficeFullName=$(_0x4b5942(0x201))[_0x4b5942(0x2ac)](_0x4b5942(0x1f7))['text']();var _0x61e821=getPeopleUserInfoGroups(_0x4b5942(0x247));if(_0x61e821[_0x4b5942(0x2af)]==0x0)return alert(_0x4b5942(0x25e)),![];_0x61e821[_0x4b5942(0x2af)]==0x1&&(txtManagerTeam=_0x61e821[0x0]);txtStackeholderTeam=$(_0x4b5942(0x2cb))[_0x4b5942(0x2ac)](_0x4b5942(0x286))['val'](),txtSponsorTeam=$(_0x4b5942(0x29d))[_0x4b5942(0x2ac)]('#TaskTeamDetails')[_0x4b5942(0x1d7)](),txtProjectStatus=$(_0x4b5942(0x24a))[_0x4b5942(0x1d7)](),txtDomain=$(_0x4b5942(0x299))['val']();var _0x2dd95c=$(_0x4b5942(0x210))['val'](),_0x5b8dde=$(_0x4b5942(0x2b6))[_0x4b5942(0x1d7)](),_0x3a18d4=siteURLProjects+'/'+siteUrl,_0x3cb904=getConsultantValue();AddNewTak(_0x4b5942(0x20b),_0x4e326a,_0x2f0bb6,_0x1408b9,_0xd7ab4e,_0x37a1c7,_0x5cfece,txtDepartmentID,DepartmentFullName,txtofficeLocationID,OfficeFullName,txtManagerTeam,txtStackeholderTeam,txtSponsorTeam,txtProjectStatus,_0x2dd95c,_0x5b8dde,txtDomain,_0x3cb904,_0x3a18d4,_0x1c770d,_0x5a820f);}function a0_0x2ef5(_0x5c7ff5,_0x19e75c){var _0x4261aa=a0_0x4261();return a0_0x2ef5=function(_0x2ef5bc,_0x5eda90){_0x2ef5bc=_0x2ef5bc-0x1cc;var _0x357f3=_0x4261aa[_0x2ef5bc];return _0x357f3;},a0_0x2ef5(_0x5c7ff5,_0x19e75c);}function AddNewTak(_0x2135ef,_0x19be12,_0x422a99,_0x3ebb70,_0x27cdac,_0x313315,_0x37fb18,_0x2d8d22,_0x3f7251,_0x4e9388,_0x2ae394,_0xb4e589,_0x4c7957,_0x22926d,_0x145182,_0x18b8ed,_0x2b0490,_0x5348a2,_0x542fc8,_0x34229e,_0x4c9855,_0x3e2ba5){var _0x56b7c1=a0_0x22105c;try{var _0x3e71b5=titanForWork[_0x56b7c1(0x21e)](_0x56b7c1(0x2c3)),_0x2f8b71,_0x40a0e7=GetItemTypeForListName(_0x2135ef);_0x2f8b71={'__metadata':{'type':_0x40a0e7},'Title':_0x422a99,'ProjectCode':_0x19be12,'ProjectName':_0x422a99,'ProjectDescription':_0x2b0490,'ProjectSiteURL':_0x34229e,'DepartmentId':_0x2d8d22,'Department_IDId':_0x2d8d22,'ActualStartDate':_0x37fb18,'PlanedStartDate':_0x27cdac,'PlanedEndDate':_0x313315,'TechnologyUsed':_0x18b8ed,'Status':_0x145182,'DepartmentName':_0x3f7251,'ConsultantName':_0x542fc8,'ManagerNameId':_0xb4e589,'OfficeLocation':_0x2ae394,'Domain':_0x5348a2,'OfficeLocationID':_0x4e9388,'Office_Location_IdId':_0x4e9388,'CompanyId':_0x3e71b5,'MultipleStackeholderId':{'results':_0x4c9855},'MultipleSponsorId':{'results':_0x3e2ba5},'ProjectInternalName':projectInternalName,'ClientIDId':_0x3ebb70},(_0x37fb18==null||_0x37fb18=='')&&delete _0x2f8b71[_0x56b7c1(0x236)],(_0x313315==null||_0x313315=='')&&delete _0x2f8b71[_0x56b7c1(0x28e)],(_0x27cdac==null||_0x27cdac=='')&&delete _0x2f8b71[_0x56b7c1(0x2bf)],AddItemToList(_0x2135ef,_0x2f8b71,_0xb4e589,_0x34229e,_0x27cdac,_0x313315);}catch(_0x29a774){console[_0x56b7c1(0x27d)](_0x29a774[_0x56b7c1(0x287)]);}}function AddItemToList(_0x522ff8,_0x5186bb,_0x4fc7d8,_0xb5de7c,_0x4d4200,_0x200ca1){var _0x5dbbb6=a0_0x22105c,_0x1e1529=$[_0x5dbbb6(0x2a7)]();return $[_0x5dbbb6(0x227)]({'url':_spPageContextInfo[_0x5dbbb6(0x2b2)]+'/_api/web/lists/getbytitle(\x27'+_0x522ff8+_0x5dbbb6(0x25f),'type':_0x5dbbb6(0x26a),'async':![],'headers':{'accept':'application/json;odata=verbose','X-RequestDigest':$(_0x5dbbb6(0x25d))['val'](),'content-Type':_0x5dbbb6(0x277)},'data':JSON[_0x5dbbb6(0x20a)](_0x5186bb),'success':function(_0x56a452){var _0x38f720=_0x5dbbb6,_0x26a8b6=_0x56a452['d']['ID'],_0x58815b='';_0x56a452['d'][_0x38f720(0x2c4)]==null||_0x56a452['d'][_0x38f720(0x2c4)]==''?_0x58815b=items[0x0][_0x38f720(0x2b1)]:_0x58815b=_0x56a452['d']['ProjectInternalName'],_0x1e1529[_0x38f720(0x261)](_0x56a452),console[_0x38f720(0x27d)](_0x38f720(0x1fa)),alert(_0x38f720(0x230)),waitingDialog[_0x38f720(0x273)](),$[_0x38f720(0x255)](BreakInheritePermissionDMSLibrary(_0x4fc7d8,_0x38f720(0x2a5),_0x58815b))['done'](function(_0x244241){AddProjectManagerAsADefaultMemeber(_0x4fc7d8,_0x4d4200,_0x200ca1,parseInt(_0x26a8b6)),GetTaskEmailTemplate(0x6),GetProjectDetails(_0x26a8b6),SendTaskEmail(),RedirectToListViewPage();});},'error':function(_0x4c7a5b){var _0x43af71=_0x5dbbb6;console[_0x43af71(0x27d)](JSON['stringify'](_0x4c7a5b)),_0x1e1529['reject'](_0x4c7a5b);}}),_0x1e1529[_0x5dbbb6(0x2c1)]();}function AddProjectManagerAsADefaultMemeber(_0x2933b0,_0x5eebfc,_0x227fb0,_0x2d95fc){var _0x4e5ccb=a0_0x22105c,_0x55d0de=$['Deferred'](),_0x4f85c1=_0x4e5ccb(0x248),_0x2fc1bd=CreateMetadataForAddingProjectManager(_0x4f85c1,_0x2933b0,_0x5eebfc,_0x227fb0,_0x2d95fc),_0x3d2d5f=_spPageContextInfo[_0x4e5ccb(0x2b2)]+'/_api/web/lists/getbytitle(\x27'+_0x4f85c1+_0x4e5ccb(0x25f),_0x286735={'accept':_0x4e5ccb(0x277),'X-RequestDigest':$(_0x4e5ccb(0x25d))[_0x4e5ccb(0x1d7)](),'content-Type':_0x4e5ccb(0x277)};return $[_0x4e5ccb(0x227)]({'url':_0x3d2d5f,'type':_0x4e5ccb(0x26a),'async':![],'headers':_0x286735,'data':JSON['stringify'](_0x2fc1bd),'success':function(_0x46b688){var _0x8d4f56=_0x4e5ccb;console[_0x8d4f56(0x27d)]('Project\x20Manager\x20Added\x20As\x20A\x20Default\x20Team\x20Member.');},'error':function(_0x34b26c){var _0x2fdc2d=_0x4e5ccb;console[_0x2fdc2d(0x27d)](data),_0x55d0de[_0x2fdc2d(0x2b3)](_0x34b26c);}}),_0x55d0de['promise']();}function CreateMetadataForAddingProjectManager(_0x563d46,_0x11d79d,_0x3af298,_0x309120,_0x18daad,_0x2a4932){var _0x54f892=a0_0x22105c,_0x51d285=GetItemTypeForListName(_0x563d46),_0x2d2d79;return _0x2d2d79={'__metadata':{'type':_0x51d285}},_0x2d2d79['ProjectId']=_0x18daad,_0x2d2d79[_0x54f892(0x1df)]=_0x11d79d,_0x2d2d79['Role']='Project\x20Manager',_0x2d2d79[_0x54f892(0x20c)]=_0x3af298,_0x2d2d79['ExpectedReleseDate']=_0x309120,_0x2d2d79[_0x54f892(0x2a4)]=!![],_0x2d2d79[_0x54f892(0x256)]=!![],_0x2d2d79['TaskPermission']=!![],_0x2d2d79[_0x54f892(0x2c3)]=titanForWork[_0x54f892(0x21e)](_0x54f892(0x2c3)),_0x2d2d79;}function addManagerToSiteAdmin(_0x421f4b,_0x9624d,_0xe1fe4b){var _0x219aae=a0_0x22105c,_0x5ee276={'Accept':_0x219aae(0x277),'content-Type':_0x219aae(0x277),'X-RequestDigest':jQuery(_0x219aae(0x25d))['val']()},_0x3da7d0=_0x9624d+'/_api/web/roleassignments/addroleassignment(principalid='+_0x421f4b+_0x219aae(0x1f0)+_0xe1fe4b+')';$['ajax']({'url':_0x3da7d0,'type':'POST','headers':_0x5ee276,'dataType':_0x219aae(0x288),'async':![],'success':function(_0x4e4d83){var _0x53124a=_0x219aae;console[_0x53124a(0x27d)]('User\x20has\x20been\x20assigned\x20permission\x20.'),alert('Project\x20site\x20created\x20Successfully'),waitingDialog[_0x53124a(0x273)](),RedirectToListViewPage();},'error':function(_0x2a3a56){var _0x2948a2=_0x219aae;console[_0x2948a2(0x27d)](JSON[_0x2948a2(0x20a)](_0x2a3a56));}});}function GetItemTypeForListName(_0xdce3e){var _0xfdbeb=a0_0x22105c;return _0xfdbeb(0x2c5)+_0xdce3e['charAt'](0x0)['toUpperCase']()+_0xdce3e[_0xfdbeb(0x289)]('\x20')['join']('')[_0xfdbeb(0x251)](0x1)+_0xfdbeb(0x2d7);}function GetDateStandardFormat(_0x72e22e){var _0x503290=a0_0x22105c,_0x1f848a=ConvertDateFormatToddMMyyyy(_0x72e22e),_0x111d1a=new Date(_0x1f848a),_0x17c45c=0x3c*0x3c*0x18*0x3e8,_0x5b7717=new Date(_0x111d1a[_0x503290(0x239)]()),_0xa99b29=_0x5b7717['toISOString']();return _0xa99b29;}function ConvertDateFormatToddMMyyyy(_0x18479a){var _0x57fd63=a0_0x22105c,_0x187ce2=stringToDate(_0x18479a,_0x57fd63(0x21d),'/');return _0x187ce2;}function stringToDate(_0x5c4a77,_0x2418d3,_0x88be7a){var _0x529a53=a0_0x22105c,_0x5bf447=_0x2418d3[_0x529a53(0x1f9)](),_0x313cd0=_0x5bf447['split'](_0x88be7a),_0x5379be=_0x5c4a77[_0x529a53(0x289)](_0x88be7a),_0x453e27=_0x313cd0['indexOf']('mm'),_0x348021=_0x313cd0[_0x529a53(0x225)]('dd'),_0x19ea54=_0x313cd0['indexOf'](_0x529a53(0x2bb)),_0x2fdd2c=parseInt(_0x5379be[_0x453e27]);_0x2fdd2c-=0x1;var _0x457c7f=new Date(_0x5379be[_0x19ea54],_0x2fdd2c,_0x5379be[_0x348021]);return _0x457c7f;}function RedirectToListViewPage(){var _0x550c22=a0_0x22105c;companyID=titanForWork[_0x550c22(0x21e)](_0x550c22(0x2c3)),location[_0x550c22(0x2d2)]=_spPageContextInfo[_0x550c22(0x2b2)]+_0x550c22(0x291)+companyID;}function InitializePeoplePicker(_0x2b5990,_0x4582a0){var _0x3d3b88=a0_0x22105c;_0x4582a0==null&&(_0x4582a0=![]);var _0x4b7261={};_0x4b7261['PrincipalAccountType']='User',_0x4b7261[_0x3d3b88(0x28a)]=0xf,_0x4b7261[_0x3d3b88(0x24c)]=0xf,_0x4b7261['AllowMultipleValues']=_0x4582a0,_0x4b7261['MaximumEntitySuggestions']=0x32,_0x4b7261['Width']=_0x3d3b88(0x2d5),SPClientPeoplePicker_InitStandaloneControlWrapper(_0x2b5990,null,_0x4b7261);}function GetProjectDetails(_0x1d6786){var _0x580e8f=a0_0x22105c;projectManage=[],StakeHolders=[],ProjectSponsors=[],projectItemDetails=[];var _0x1544ce=_spPageContextInfo[_0x580e8f(0x2b2)]+'/_api/lists/getbytitle(\x27ProjectDetails\x27)/items?$select=*,ManagerName/Title,ManagerName/UserName,MultipleStackeholder/Title,MultipleStackeholder/UserName,MultipleSponsor/Title,MultipleSponsor/UserName&$Expand=ManagerName,MultipleStackeholder,MultipleSponsor&$Filter=ID\x20eq\x20\x27'+_0x1d6786+'\x27';$['ajax']({'url':_0x1544ce,'method':_0x580e8f(0x218),'headers':{'Accept':_0x580e8f(0x2c0)},'async':![],'success':function(_0x16e769){var _0x19dd39=_0x580e8f,_0x41cef6=_0x16e769,_0x475174='';for(var _0x3d67f2=0x0;_0x3d67f2<_0x41cef6['d'][_0x19dd39(0x2a2)][_0x19dd39(0x2af)];_0x3d67f2++){_0x41cef6['d'][_0x19dd39(0x2a2)][_0x3d67f2][_0x19dd39(0x217)]!=null&&(projectManage[_0x19dd39(0x219)](_0x41cef6['d'][_0x19dd39(0x2a2)][_0x3d67f2][_0x19dd39(0x217)][_0x19dd39(0x1d8)]),projecttouser+=_0x41cef6['d']['results'][_0x3d67f2][_0x19dd39(0x217)][_0x19dd39(0x282)]+',',projecttouser=projecttouser[_0x19dd39(0x27a)](/,(\s+)?$/,''));if(_0x41cef6['d'][_0x19dd39(0x2a2)][_0x3d67f2][_0x19dd39(0x25b)]['results']!=null){for(var _0x5420dc=0x0;_0x5420dc<_0x41cef6['d']['results'][_0x3d67f2]['MultipleStackeholder']['results']['length'];_0x5420dc++){StakeHolders[_0x19dd39(0x219)](_0x41cef6['d'][_0x19dd39(0x2a2)][_0x3d67f2][_0x19dd39(0x25b)][_0x19dd39(0x2a2)][_0x5420dc][_0x19dd39(0x1d8)]),stackToUsers+=_0x41cef6['d'][_0x19dd39(0x2a2)][_0x3d67f2][_0x19dd39(0x25b)][_0x19dd39(0x2a2)][_0x5420dc][_0x19dd39(0x282)]+',';}stackToUsers=stackToUsers['replace'](/,(\s+)?$/,'');}if(_0x41cef6['d'][_0x19dd39(0x2a2)][_0x3d67f2][_0x19dd39(0x208)][_0x19dd39(0x2a2)]!=null){for(var _0x5420dc=0x0;_0x5420dc<_0x41cef6['d'][_0x19dd39(0x2a2)][_0x3d67f2][_0x19dd39(0x208)][_0x19dd39(0x2a2)][_0x19dd39(0x2af)];_0x5420dc++){ProjectSponsors[_0x19dd39(0x219)](_0x41cef6['d']['results'][_0x3d67f2][_0x19dd39(0x208)]['results'][_0x5420dc][_0x19dd39(0x1d8)]),sponsorToUsers+=_0x41cef6['d']['results'][_0x3d67f2][_0x19dd39(0x208)][_0x19dd39(0x2a2)][_0x5420dc][_0x19dd39(0x282)]+',';}sponsorToUsers=sponsorToUsers[_0x19dd39(0x27a)](/,(\s+)?$/,'');}alluser=StakeHolders[_0x19dd39(0x295)](ProjectSponsors,projectManage),projectItemDetails[_0x19dd39(0x219)](TaskMetadata(_0x41cef6['d']['results'][_0x3d67f2],projecttouser,stackToUsers,sponsorToUsers));}},'error':function(_0x404b0f){var _0x128b05=_0x580e8f;console[_0x128b05(0x27d)](JSON[_0x128b05(0x20a)](_0x404b0f));}});}function GetTaskEmailTemplate(_0x260131){var _0x3f5f62=a0_0x22105c,_0x1eb96c=_spPageContextInfo[_0x3f5f62(0x240)]+_0x3f5f62(0x278)+_0x260131+'\x27';$[_0x3f5f62(0x227)]({'url':_0x1eb96c,'headers':{'accept':'application/json;odata=verbose','content-type':_0x3f5f62(0x277),'X-RequestDigest':$(_0x3f5f62(0x25d))['val']()},'async':![],'success':function(_0x1a38eb){var _0xbd11d4=_0x3f5f62,_0x4bd8d6=_0x1a38eb['d'][_0xbd11d4(0x2a2)];for(var _0x2ddfc5=0x0;_0x2ddfc5<_0x4bd8d6[_0xbd11d4(0x2af)];_0x2ddfc5++){_0x4bd8d6[_0x2ddfc5][_0xbd11d4(0x2cf)]!=null&&(emailBodyContent=_0x4bd8d6[_0x2ddfc5]['Body']),_0x4bd8d6[_0x2ddfc5]['Subject']!=null&&(taskEmailSubject=_0x4bd8d6[_0x2ddfc5][_0xbd11d4(0x241)]);}},'eror':function(_0x1b9e82){var _0x389241=_0x3f5f62;console[_0x389241(0x27d)]('error');}});}function SendTaskEmail(){var _0x5f463c=a0_0x22105c,_0x562e3f=emailBodyContent,_0x5a5a28=taskEmailSubject;projectItemDetails[_0x5f463c(0x26c)](function(_0x1e6a26){var _0x7d4722=_0x5f463c;_0x562e3f=_0x562e3f[_0x7d4722(0x27a)](_0x7d4722(0x294),_0x1e6a26[_0x7d4722(0x1f5)]),_0x562e3f=_0x562e3f[_0x7d4722(0x27a)](_0x7d4722(0x220),_0x1e6a26[_0x7d4722(0x267)]),_0x562e3f=_0x562e3f[_0x7d4722(0x27a)](_0x7d4722(0x26f),_0x1e6a26['ProjectName']),_0x562e3f=_0x562e3f[_0x7d4722(0x27a)](_0x7d4722(0x209),_0x1e6a26[_0x7d4722(0x1cc)]),_0x1e6a26['DepartmentName']==_0x7d4722(0x1d1)?_0x562e3f=_0x562e3f[_0x7d4722(0x27a)](_0x7d4722(0x285),''):_0x562e3f=_0x562e3f['replace'](_0x7d4722(0x285),_0x1e6a26[_0x7d4722(0x271)]),_0x1e6a26['OfficeLocation']==_0x7d4722(0x1d1)?_0x562e3f=_0x562e3f['replace'](_0x7d4722(0x293),''):_0x562e3f=_0x562e3f[_0x7d4722(0x27a)](_0x7d4722(0x293),_0x1e6a26[_0x7d4722(0x1fc)]),_0x562e3f=_0x562e3f[_0x7d4722(0x27a)](_0x7d4722(0x1e2),_0x1e6a26[_0x7d4722(0x2bf)]),_0x562e3f=_0x562e3f[_0x7d4722(0x27a)](_0x7d4722(0x2be),_0x1e6a26[_0x7d4722(0x28e)]),_0x562e3f=_0x562e3f[_0x7d4722(0x27a)](_0x7d4722(0x204),_spPageContextInfo[_0x7d4722(0x2b2)]+'/Pages/ViewProjectDetails.aspx?WebAppId='+companyID+_0x7d4722(0x2a9)+_0x1e6a26['ID']+_0x7d4722(0x21a)+_0x1e6a26[_0x7d4722(0x2b1)]+'');});var _0x17b97f=_spPageContextInfo[_0x5f463c(0x207)],_0x283f02;_0x283f02={'properties':{'__metadata':{'type':'SP.Utilities.EmailProperties'},'From':_0x17b97f,'To':{'results':alluser},'Body':_0x562e3f,'Subject':_0x5a5a28}};var _0x1c2d26=_spPageContextInfo[_0x5f463c(0x226)]+'/_api/SP.Utilities.Utility.SendEmail';$['ajax']({'contentType':_0x5f463c(0x2ba),'url':_0x1c2d26,'type':_0x5f463c(0x26a),'data':JSON[_0x5f463c(0x20a)](_0x283f02),'async':![],'headers':{'Accept':'application/json;odata=verbose','content-type':'application/json;odata=verbose','X-RequestDigest':$('#__REQUESTDIGEST')[_0x5f463c(0x1d7)]()},'success':function(_0x45de72){var _0x530b0f=_0x5f463c;console['log'](_0x530b0f(0x2d4));},'error':function(_0x64ed32){var _0x4a6c4f=_0x5f463c;waitingDialog[_0x4a6c4f(0x273)](),console[_0x4a6c4f(0x27d)](_0x4a6c4f(0x292)+JSON[_0x4a6c4f(0x20a)](_0x64ed32));}});}function TaskMetadata(_0x1facdb,_0x343ad2,_0x51f768,_0x590bbc){var _0x2bfdf1=a0_0x22105c,_0x5c2efa={};return _0x5c2efa[_0x2bfdf1(0x2b1)]=_0x1facdb[_0x2bfdf1(0x2b1)]==null?'':_0x1facdb['ProjectName'],_0x5c2efa['ClientName']=_0x1facdb[_0x2bfdf1(0x1cc)]==null?'':_0x1facdb['ClientName'],_0x5c2efa['DepartmentName']=_0x1facdb[_0x2bfdf1(0x271)]==null?'':_0x1facdb['DepartmentName'],_0x5c2efa[_0x2bfdf1(0x267)]=_0x1facdb[_0x2bfdf1(0x267)]==null?'':_0x1facdb[_0x2bfdf1(0x267)],_0x5c2efa[_0x2bfdf1(0x1fc)]=_0x1facdb[_0x2bfdf1(0x1fc)]==null?'':_0x1facdb[_0x2bfdf1(0x1fc)],_0x5c2efa['ID']=_0x1facdb[_0x2bfdf1(0x1fc)]==null?'':_0x1facdb['ID'],_0x5c2efa[_0x2bfdf1(0x229)]=_0x1facdb[_0x2bfdf1(0x229)],_0x5c2efa[_0x2bfdf1(0x1f5)]=_0x343ad2,_0x5c2efa[_0x2bfdf1(0x270)]=_0x51f768,_0x5c2efa[_0x2bfdf1(0x1e5)]=_0x590bbc,_0x5c2efa['PlanedStartDate']=_0x1facdb['PlanedStartDate'],_0x5c2efa[_0x2bfdf1(0x2bf)]=new Date(_0x5c2efa[_0x2bfdf1(0x2bf)]),_0x5c2efa['PlanedStartDate']=$['datepicker'][_0x2bfdf1(0x23c)](_0x2bfdf1(0x263),_0x5c2efa[_0x2bfdf1(0x2bf)]),_0x5c2efa[_0x2bfdf1(0x28e)]=_0x1facdb['PlanedEndDate'],_0x5c2efa[_0x2bfdf1(0x28e)]=new Date(_0x5c2efa[_0x2bfdf1(0x28e)]),_0x5c2efa['PlanedEndDate']=$[_0x2bfdf1(0x2ab)][_0x2bfdf1(0x23c)](_0x2bfdf1(0x263),_0x5c2efa[_0x2bfdf1(0x28e)]),_0x5c2efa;}function getProjectRights(){var _0x596c6d=a0_0x22105c,_0x104d70=$[_0x596c6d(0x2a7)](),_0x90938a,_0x4e4890=_0x596c6d(0x27f),_0x2e26c1=titanForWork[_0x596c6d(0x21e)](_0x596c6d(0x2c3)),_0x2acdea=_spPageContextInfo['webAbsoluteUrl']+_0x596c6d(0x242)+_0x4e4890+_0x596c6d(0x2c9)+_0x2e26c1+_0x596c6d(0x1d9)+_spPageContextInfo[_0x596c6d(0x2b8)]+_0x596c6d(0x28d);return $[_0x596c6d(0x227)]({'url':_0x2acdea,'headers':{'Accept':'application/json;odata=verbose'},'async':!![],'success':function(_0x47c484){var _0x2ca775=_0x596c6d,_0x447293=_0x47c484['d'][_0x2ca775(0x2a2)];_0x447293[_0x2ca775(0x2af)]>0x0?(_0x104d70['resolve'](!![]),IsProjectAdmin=!![]):(_0x104d70[_0x2ca775(0x261)](![]),IsProjectAdmin=![]);},'eror':function(_0x381860){var _0x4b2cb0=_0x596c6d;console[_0x4b2cb0(0x27d)]($(_0x4b2cb0(0x2c6))['val']());}}),_0x104d70[_0x596c6d(0x2c1)]();}function IsMangerActive(_0xf0aea3){var _0xaed6e9=a0_0x22105c,_0x141755=titanForWork[_0xaed6e9(0x21e)](_0xaed6e9(0x2c3)),_0x76cb63='';return RestQuery=_0xaed6e9(0x200)+_0x141755+'\x20and\x20LogonNameId\x20eq\x20'+_0xf0aea3+'',$['when'](CommonFunction[_0xaed6e9(0x1cf)](_0xaed6e9(0x279),RestQuery))['done'](function(_0x1f2102){var _0x3c0601=_0xaed6e9;try{_0x1f2102[_0x3c0601(0x2a2)][_0x3c0601(0x2af)]>0x0?_0x76cb63=_0x1f2102['results'][0x0]['ID']:_0x76cb63=![];}catch(_0x1abf2d){alert(_0x1abf2d);}}),_0x76cb63;}function a0_0x4261(){var _0x38bc36=['#txtTechnology','slideToggle','error\x20:\x20Project\x20Details\x20web\x20part','</select>','target','\x27\x20and\x20ProjectName\x20eq\x20\x27','set_description','ManagerName','GET','push','&ProjectName=','getByTitle','text','dd/MM/yyyy','getQueryStringParameter','closest','{{ProjectCode}}','get_lists','<View><OrderBy><FieldRef\x20Name=\x27ID\x27\x20Ascending=\x27False\x27/></OrderBy></View>','49523890XRcMEY','<ul>','indexOf','webServerRelativeUrl','ajax','show','ProjectSiteURL','done','executeOrDelayUntilScriptLoaded','\x20/>','False','.txtActualStartDate','get_item','Project\x20site\x20created\x20successfully','keyCode','<li><input\x20type=\x22checkbox\x22\x20value=','set_webTemplate','5226120AlhVki','\x27\x20and\x20Department/ID\x20eq\x20\x27','ActualStartDate','<option\x20value=\x22','5613538raZGvC','getTime','location','set_title','formatDate','xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx','responseJSON','getEnumerator','siteAbsoluteUrl','Subject','/_api/web/lists/getbytitle(\x27','</Value></Eq></Where><OrderBy><FieldRef\x20Name=\x27Title\x27/></OrderBy></Query></View>','getItems','focus','<select\x20name=\x22officeLocation\x22\x20id=\x22officeLocationDetails\x22\x20class=\x22form-control\x22>','ProjectManagerEmployeePicker','ProjectTeamDetails','.mutliSelect\x20input[type=\x22checkbox\x22]','#ProjectStatus','get_current','ResolvePrincipalSource','-50:+50','.dropdown\x20dt\x20a','CompanySiteUrl','/_api/web/lists/getByTitle(\x27Documents\x27)/roleassignments/addroleassignment(principalid=','slice','.multiSel','bind','hasClass','when','DocumentPermission','executeQueryAsync','dt\x20a\x20span.value','[id^=\x27','5YwmyQL','MultipleStackeholder','CatogeryName','#__REQUESTDIGEST','Please\x20Fill\x20the\x20Manager','\x27)/items','click','resolve','blur','dd-M-yy','3UkWUCz','fast','\x27\x20and\x20(WebPartName\x20eq\x20\x27Project\x27)','ProjectCode','\x27\x20and\x20CompanyId\x20eq\x20\x27','</span>','POST','10048EjAxNO','forEach','</ul>','each','{{ProjectName}}','stackToUsers','DepartmentName','#txtProjectCode','hide','.ActualEndDate','</li>','.txtPlannedStartDate','application/json;odata=verbose','/_api/web/Lists/GetByTitle(\x27EmailTemplate\x27)/Items?$select=ID,Body,Subject,EmailType,Title&$filter=Title\x20eq\x20\x27','Employees','replace','ClientContext','sp.js','log','SOD','ProcessApprovers','trim','empty','Title','True','set_viewXml','{{Department}}','#TaskTeamDetails','message','json','split','SearchPrincipalSource','#clientName','dd/mm/yy','\x27\x20and\x20WebPartName\x20eq\x20\x27Project\x20Admin\x27','PlanedEndDate','#txtProjectName','i:0#.f|membership|','/Pages/ViewProjectGrid.aspx?WebAppId=','SendEmailSharedNotification\x20\x20','{{Location}}','{{ProjectManager}}','concat','set_language','/DMS/','disabled','#txtDomain','option','load','Companies','#SponsorTeam','remove','add','<View><Query><Where><And><Eq><FieldRef\x20Name=\x27CompanyID\x27\x20/><Value\x20Type=\x27Lookup\x27>','/_api/web/lists/getByTitle(\x27Documents\x27)/breakroleinheritance(copyRoleAssignments=false,\x20clearSubscopes=true)','results','<span\x20title=\x22','TeamPermission','1073741829','4284QvrjSY','Deferred','<option\x20value=\x220\x22>-Select-</option>','&ProjectID=','</Value></Eq><Eq><FieldRef\x20Name=\x27IsActive\x27\x20/><Value\x20Type=\x27Boolean\x27>1</Value></Eq></And></Where><OrderBy><FieldRef\x20Name=\x27Title\x27/></OrderBy></Query></View>','datepicker','find','.hida','ClientMaster','length','STS#0','ProjectName','webAbsoluteUrl','reject','Departments','1376664uBOaEh','#txtDescription','prop','userId','attr','application/json','yyyy','User\x20has\x20been\x20assigned\x20permission\x20.','html','{{PlannedEndDate}}','PlanedStartDate','application/json;\x20odata=verbose','promise','#clientNameDiv','CompanyId','ProjectInternalName','SP.Data.','#txtSomethingWentWrong','#select2-clientName-container','<option\x20value=\x220\x22>Select\x20Customer</option>','\x27)/items?$select=*&$filter=CompanyId\x20eq\x20\x27','get_message','#StackeholderTeam','</Value></Eq><Eq><FieldRef\x20Name=\x27OfficeLocationId\x27\x20/><Value\x20Type=\x27Text\x27>0</Value></Eq></And></Where><OrderBy><FieldRef\x20Name=\x27OfficeName\x27/></OrderBy></Query></View>','GetAllUserInfo','charCode','Body','.dropdown\x20dd\x20ul','span[title=\x22','href','Key','Message\x20has\x20been\x20sent.','100%','../Pages/Default.aspx?WebAppId=','ListItem','Employee\x20is\x20not\x20active\x20','ClientName',':checked','.dropdown\x20dd\x20ul\x20li\x20a','getItemsWithQueryItem','parents','-Select-','createDelegate','CamlQuery','get','WebCreationInformation','.mutliSelect','val','UserName','\x27\x20and\x20ContributorsId\x20eq\x20\x27','OfficeName','ready','\x27)/items?$select=*,Department/DepartmentName,Department/ID&$expand=Department&$filter=CompanyId\x20eq\x20\x27','onQuerySucceeded_CreateProjectSite','#officeLocationDetails','TeamMemberId','#departmentDiv','dateFormat','{{PlannedStartDate}}','SPClientPeoplePickerDict','keypress','sponsorToUsers','/DMS','Select\x20Customer','886854hfeIXf','#departmentDetails','moveNext','Permission\x20has\x20been\x20assigned\x20successfully!','<View><Query><Where><Eq><FieldRef\x20Name=\x27CompanyID\x27\x20/><Value\x20Type=\x27Lookup\x27>','629670fLIxEj','append','toString',',roleDefId=','.txtPlannedEndDate','#createNewProjectSite','StackeholderTeamEmployeePicker','get_web','projecttouser','.txtActualEndDate','select#officeLocationDetails\x20option:selected','\x27)/items?$select=ID,SiteURL&$filter=ID\x20eq\x20\x27','toLowerCase','User\x20has\x20been\x20assigned\x20permission.','set_url','OfficeLocation','Consultant_Comp','get_webs','SP.User','?$select=*,LogonName/EMail,LogonName/Id,LogonName/FirstName,LogonName/LastName,LogonName/EMail&$expand=LogonName\x20&$filter=\x20Status\x20eq\x20\x27Active\x27\x20and\x20Company/ID\x20eq\x20','#officeLocation','SponsorTeamEmployeePicker','Unauthorized\x20access!','{{Projectlink}}','set_useSamePermissionsAsParentSite','get_stackTrace','userEmail','MultipleSponsor','{{ProjectClientName}}','stringify','ProjectDetails','EngageDate','Project\x20code\x20or\x20Project\x20name\x20already\x20exist.','</option>','onQueryFailed_CreateProjectSite'];a0_0x4261=function(){return _0x38bc36;};return a0_0x4261();}function BreakInheritePermissionDMSLibrary(_0x31b4d2,_0x6444c6,_0x59a6b4){var _0x3ceb99=a0_0x22105c,_0x546689=titanForWork['getQueryStringParameter'](_0x3ceb99(0x24f))+'/DMS/'+_0x59a6b4,_0x2f42e1={'Accept':_0x3ceb99(0x277),'content-Type':_0x3ceb99(0x277),'X-RequestDigest':jQuery(_0x3ceb99(0x25d))['val']()},_0x1fb125=_0x546689+_0x3ceb99(0x2a1);$['ajax']({'url':_0x1fb125,'type':_0x3ceb99(0x26a),'headers':_0x2f42e1,'async':![],'dataType':_0x3ceb99(0x288),'success':function(_0x35734b){var _0x172a6c=_0x3ceb99;console['log']('Permission\x20has\x20been\x20breaked\x20successfully!'),$[_0x172a6c(0x255)](AssignPermissiononDMSLibary(_0x31b4d2,_0x6444c6,_0x59a6b4))[_0x172a6c(0x22a)](function(_0x30557d){var _0x4d4987=_0x172a6c;console[_0x4d4987(0x27d)](_0x4d4987(0x1eb));});},'error':function(_0x3bc329){var _0xf17e04=_0x3ceb99;console[_0xf17e04(0x27d)](JSON[_0xf17e04(0x20a)](_0x3bc329));}});}function AssignPermissiononDMSLibary(_0x525837,_0x3d0003,_0x427914){var _0x557510=a0_0x22105c,_0x57a236=titanForWork[_0x557510(0x21e)](_0x557510(0x24f))+_0x557510(0x297)+_0x427914,_0x2cc2c2={'Accept':_0x557510(0x277),'content-Type':'application/json;odata=verbose','X-RequestDigest':jQuery(_0x557510(0x25d))['val']()},_0x5a66a4=_0x57a236+_0x557510(0x250)+_0x525837+_0x557510(0x1f0)+_0x3d0003+')';$[_0x557510(0x227)]({'url':_0x5a66a4,'type':_0x557510(0x26a),'headers':_0x2cc2c2,'dataType':'json','async':![],'success':function(_0x934b6a){var _0x5db1c3=_0x557510;console[_0x5db1c3(0x27d)](_0x5db1c3(0x2bc));},'error':function(_0x26abe5){var _0x1a9913=_0x557510;console[_0x1a9913(0x27d)](JSON[_0x1a9913(0x20a)](_0x26abe5));}});}function AddUserToOwnerGroup(_0x45347e){var _0x21f65b=a0_0x22105c;debugger;var _0x739c81={'__metadata':{'type':_0x21f65b(0x1ff)},'LoginName':_0x45347e},_0x6ae821=_spPageContextInfo[_0x21f65b(0x2b2)]+'/_api/web/sitegroups/getbyname(\x27Owners\x27)/users';$[_0x21f65b(0x227)]({'url':_0x6ae821,'type':'POST','async':![],'headers':{'accept':'application/json;odata=verbose','X-RequestDigest':$(_0x21f65b(0x25d))[_0x21f65b(0x1d7)](),'content-Type':_0x21f65b(0x277)},'data':JSON[_0x21f65b(0x20a)](_0x739c81),'success':function(_0x3e15bd){debugger;},'error':function(_0xa63177){}});}function IsDepartmentAdmin(){var _0x15c470=a0_0x22105c,_0x222b37=titanForWork['getQueryStringParameter'](_0x15c470(0x2c3)),_0xcf6c28=Logged_DepartmentId,_0x34f873=_0x15c470(0x27f),_0x575723=_spPageContextInfo['webAbsoluteUrl']+_0x15c470(0x242)+_0x34f873+_0x15c470(0x1dc)+_0x222b37+'\x27\x20and\x20ContributorsId\x20eq\x20\x27'+_spPageContextInfo[_0x15c470(0x2b8)]+_0x15c470(0x235)+_0xcf6c28+_0x15c470(0x266);return $[_0x15c470(0x227)]({'url':_0x575723,'type':_0x15c470(0x1d4),'headers':{'Accept':_0x15c470(0x277)},'async':![],'success':function(_0x24c3c8){var _0x350376=_0x15c470,_0x1a1a73=_0x24c3c8['d'][_0x350376(0x2a2)];_0x1a1a73[_0x350376(0x2af)]>0x0?IsdeptAdmin=!![]:IsdeptAdmin=![];},'error':function(_0x13a29c){var _0xb7c23a=_0x15c470;console[_0xb7c23a(0x27d)](_0x13a29c[_0xb7c23a(0x23e)]);}}),IsdeptAdmin;}function bindProjectType(){var _0x4b7c10=a0_0x22105c;$(_0x4b7c10(0x210))[_0x4b7c10(0x281)]();var _0x45680a=_spPageContextInfo['webAbsoluteUrl']+'/_api/web/lists/getbytitle(\x27CategoryMaster\x27)/items?$select=CategoryType,CatogeryName&$filter=CategoryType\x20eq\x20\x27Project\x20Type\x27\x20and\x20Status\x20eq\x20\x27Yes\x27';$['ajax']({'url':_0x45680a,'headers':{'Accept':'application/json;odata=verbose'},'async':!![],'success':function(_0x21e29c){var _0x49f09d=_0x4b7c10;$(_0x49f09d(0x2a8))['appendTo'](_0x49f09d(0x210));for(var _0x5dcd65=0x0;_0x5dcd65<_0x21e29c['d'][_0x49f09d(0x2a2)][_0x49f09d(0x2af)];_0x5dcd65++){$('#txtTechnology')[_0x49f09d(0x1ee)]('<option\x20value=\x22'+_0x21e29c['d'][_0x49f09d(0x2a2)][_0x5dcd65][_0x49f09d(0x25c)]+'\x22>'+_0x21e29c['d']['results'][_0x5dcd65]['CatogeryName']+_0x49f09d(0x20e));}},'myError':function(_0x170b37){}});}