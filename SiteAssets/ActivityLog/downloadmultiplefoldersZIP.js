(function(_0x464052,_0x9dad3a){const _0x591320=a0_0xd53f,_0x336d68=_0x464052();while(!![]){try{const _0x3ff3b5=-parseInt(_0x591320(0xe9))/0x1+parseInt(_0x591320(0xda))/0x2+parseInt(_0x591320(0xeb))/0x3+-parseInt(_0x591320(0xdd))/0x4*(parseInt(_0x591320(0xd7))/0x5)+parseInt(_0x591320(0x100))/0x6+parseInt(_0x591320(0xee))/0x7+-parseInt(_0x591320(0xe0))/0x8;if(_0x3ff3b5===_0x9dad3a)break;else _0x336d68['push'](_0x336d68['shift']());}catch(_0x2f8923){_0x336d68['push'](_0x336d68['shift']());}}}(a0_0x2265,0x9f853));const siteUrl=_spPageContextInfo['webAbsoluteUrl'],selectedFolders=[];function a0_0x2265(){const _0x2d9ac7=['html','blob','<tr><td>','log','<input\x20type=\x27checkbox\x27\x20name=\x27files\x27\x20value=\x27','GET','Files','files','body','5325246nBDGom','getElementsByName','substring','appendChild','Folders','href','</table>','140ufljZv','\x27)?$expand=Folders,Files','file','1495204NiyNVO','download','name','24952PbdUYl','/_api/web/GetFolderByServerRelativeUrl(\x27','forEach','10391016BlzQvF','lastIndexOf','createElement','push','checkbox','createObjectURL','application/json;odata=verbose','json','ajax','242924NLVMXl','/_api/web/lists/getByTitle(\x27DemoLibrary\x27)/items?$select=FileRef&$orderby=FileLeafRef&$filter=FSObjType\x20eq\x201','999219KuPlNH','#__REQUESTDIGEST','folders.zip','2811508fWdnTr','Name','ServerRelativeUrl','value','</td><td>','FileRef','click','/_api/contextinfo','val'];a0_0x2265=function(){return _0x2d9ac7;};return a0_0x2265();}function downloadSelectedFilesAsZip(){const _0x5504e8=a0_0xd53f;var _0x284b63=document[_0x5504e8(0x101)]('files'),_0x15a50f=[];_0x284b63[_0x5504e8(0xdf)](function(_0x46a67d){const _0x5bc091=_0x5504e8;_0x46a67d['checked']&&(_0x15a50f[_0x5bc091(0xe3)](_0x46a67d[_0x5bc091(0xf1)]),selectedFolders[_0x5bc091(0xe3)](_0x46a67d[_0x5bc091(0xf1)]));}),downloadFolders();}function a0_0xd53f(_0x1ca4b8,_0x1be801){const _0x22654b=a0_0x2265();return a0_0xd53f=function(_0xd53f02,_0x8c48dd){_0xd53f02=_0xd53f02-0xd4;let _0x425ee6=_0x22654b[_0xd53f02];return _0x425ee6;},a0_0xd53f(_0x1ca4b8,_0x1be801);}async function getFolderContents(_0x527537,_0x2d27e4,_0x556e47){const _0x442cc7=a0_0xd53f;try{const _0x188755=await fetch(_0x527537+_0x442cc7(0xde)+_0x556e47+_0x442cc7(0xd8)),_0x1b909d=await _0x188755[_0x442cc7(0xe7)](),_0xd1edfd=_0x1b909d[_0x442cc7(0xfd)],_0x1c403a=_0x1b909d[_0x442cc7(0xd4)];for(const _0x30749e of _0xd1edfd){const _0x40b04e=_0x527537+'/'+_0x30749e[_0x442cc7(0xf0)],_0x5ea23d=await fetch(_0x40b04e),_0x3cd688=await _0x5ea23d[_0x442cc7(0xf8)](),_0x4a9b6b=_0x556e47+'/'+_0x30749e[_0x442cc7(0xef)];_0x2d27e4[_0x442cc7(0xd9)](_0x4a9b6b,_0x3cd688);}for(const _0x5631b6 of _0x1c403a){const _0x1dd394=_0x5631b6['Name'],_0x7fc86=_0x7fc86+'/'+_0x1dd394,_0x137285=_0x527537+'/_api/web/GetFolderByServerRelativeUrl(\x27'+_0x7fc86+'\x27)';await getFolderContents(_0x527537,_0x2d27e4,_0x7fc86);}return _0x2d27e4;}catch(_0x1b7f68){console[_0x442cc7(0xfa)](_0x1b7f68);}}async function downloadFolders(){const _0x527146=a0_0xd53f;try{const _0x23feaa=new JSZip(),_0x1ccac7=siteUrl+_0x527146(0xf5),_0x40aff3=await fetch(_0x1ccac7,{'method':'POST','headers':{'Accept':_0x527146(0xe6),'Content-Type':_0x527146(0xe6),'odata-version':'','X-RequestDigest':$(_0x527146(0xec))[_0x527146(0xf6)]()}}),_0x436ddd=await _0x40aff3[_0x527146(0xe7)](),_0x3db83c=_0x436ddd['d']['GetContextWebInformation']['FormDigestValue'];for(const _0x3189bc of selectedFolders){const _0x93c9b1=siteUrl,_0xddd4ac=_0x3189bc;await getFolderContents(_0x93c9b1,_0x23feaa,_0xddd4ac);}const _0x39f519=await _0x23feaa['generateAsync']({'type':'blob'}),_0x4ef2b3=URL[_0x527146(0xe5)](_0x39f519),_0x59e368=document[_0x527146(0xe2)]('a');_0x59e368[_0x527146(0xd5)]=_0x4ef2b3,_0x59e368[_0x527146(0xdb)]='folders.zip',document[_0x527146(0xff)]['appendChild'](_0x59e368),_0x59e368[_0x527146(0xf4)](),document['body']['removeChild'](_0x59e368);}catch(_0x2bc4bb){console['log'](_0x2bc4bb);}}const zip=new JSZip();async function addFolderToZip(_0x5c109d,_0x6af87b){const _0x33a9cc=a0_0xd53f,_0x488d2c=await retrieveFolderInfo(_0x5c109d),_0x2ceb1c=_0x488d2c[_0x33a9cc(0xef)],_0x462213=_0x6af87b['folder'](_0x2ceb1c);for(const _0xf7a86f of _0x488d2c[_0x33a9cc(0xfd)]){const _0x1eca34=_0xf7a86f[_0x33a9cc(0xef)],_0x3c6c47=await retrieveFileContents(_0xf7a86f['ServerRelativeUrl']);_0x462213[_0x33a9cc(0xd9)](_0x1eca34,_0x3c6c47);}for(const _0x2fad59 of _0x488d2c['Folders']){const _0x1a216c=_0x5c109d+'/'+_0x2fad59[_0x33a9cc(0xef)];await addFolderToZip(_0x1a216c,_0x462213);}}async function downloadSelectedFolders(){const _0x205948=a0_0xd53f,_0x271caa=[],_0x174135=document[_0x205948(0x101)](_0x205948(0xfe));for(const _0x56e1bf of _0x174135){_0x56e1bf['checked']&&_0x271caa[_0x205948(0xe3)](_0x56e1bf[_0x205948(0xf1)]);}for(const _0x1b3044 of _0x271caa){await addFolderToZip(_0x1b3044,zip);}const _0x498f83=await zip['generateAsync']({'type':_0x205948(0xf8)}),_0x542dd7=document[_0x205948(0xe2)]('a');_0x542dd7[_0x205948(0xd5)]=URL[_0x205948(0xe5)](_0x498f83),_0x542dd7['download']=_0x205948(0xed),document[_0x205948(0xff)][_0x205948(0x103)](_0x542dd7),_0x542dd7[_0x205948(0xf4)]();}function getFilesFromLibrary(_0x3d8dd6){const _0x3ef96e=a0_0xd53f;var _0x4b54da=_0x3d8dd6+_0x3ef96e(0xea);$[_0x3ef96e(0xe8)]({'url':_0x4b54da,'type':_0x3ef96e(0xfc),'headers':{'Accept':'application/json;odata=verbose'},'success':function(_0x29c503){const _0x39a5c1=_0x3ef96e;var _0x145053=_0x29c503['d']['results'],_0x33f349=[];_0x145053[_0x39a5c1(0xdf)](function(_0x87a732){const _0x2cac01=_0x39a5c1;var _0x416983=_0x87a732['FileRef'][_0x2cac01(0x102)](_0x87a732[_0x2cac01(0xf3)][_0x2cac01(0xe1)]('/')+0x1),_0xf24209={'name':_0x416983,'url':_0x87a732[_0x2cac01(0xf3)],'checkbox':_0x2cac01(0xfb)+_0x87a732[_0x2cac01(0xf3)]+'\x27>'};_0x33f349[_0x2cac01(0xe3)](_0xf24209);});var _0xdab4f8='<table>';_0xdab4f8+='<tr><th>Select</th><th>Name</th></tr>',_0x33f349[_0x39a5c1(0xdf)](function(_0x1d74d9){const _0x44cbd7=_0x39a5c1;_0xdab4f8+=_0x44cbd7(0xf9)+_0x1d74d9[_0x44cbd7(0xe4)]+_0x44cbd7(0xf2)+_0x1d74d9[_0x44cbd7(0xdc)]+'</td></tr>';}),_0xdab4f8+=_0x39a5c1(0xd6),$('#fileList')[_0x39a5c1(0xf7)](_0xdab4f8);},'error':function(_0x1fac57){const _0x2a52d1=_0x3ef96e;console[_0x2a52d1(0xfa)](_0x1fac57);}});}getFilesFromLibrary(siteUrl);