const a0_0x4488a2=a0_0x584e;(function(_0x5a001d,_0x30c3eb){const _0x1c07bf=a0_0x584e,_0x53125b=_0x5a001d();while(!![]){try{const _0x4973e4=-parseInt(_0x1c07bf(0x1da))/0x1*(-parseInt(_0x1c07bf(0x1ea))/0x2)+parseInt(_0x1c07bf(0x1f8))/0x3*(-parseInt(_0x1c07bf(0x1ee))/0x4)+parseInt(_0x1c07bf(0x1e1))/0x5*(-parseInt(_0x1c07bf(0x1d5))/0x6)+-parseInt(_0x1c07bf(0x1ec))/0x7*(parseInt(_0x1c07bf(0x20b))/0x8)+parseInt(_0x1c07bf(0x1d7))/0x9+parseInt(_0x1c07bf(0x20f))/0xa+parseInt(_0x1c07bf(0x20e))/0xb;if(_0x4973e4===_0x30c3eb)break;else _0x53125b['push'](_0x53125b['shift']());}catch(_0xdfce25){_0x53125b['push'](_0x53125b['shift']());}}}(a0_0x5af6,0xa4997),function(_0x4b9b92,_0x4a20e3){const _0x49d0de=a0_0x584e,_0x407e34=a0_0x35c4,_0x51d6bd=_0x4b9b92();while(!![]){try{const _0x2d5d80=parseInt(_0x407e34(0x9b))/0x1*(-parseInt(_0x407e34(0xc5))/0x2)+-parseInt(_0x407e34(0xae))/0x3+parseInt(_0x407e34(0xb7))/0x4+parseInt(_0x407e34(0x9d))/0x5+-parseInt(_0x407e34(0xb3))/0x6*(-parseInt(_0x407e34(0xc2))/0x7)+-parseInt(_0x407e34(0xbe))/0x8+parseInt(_0x407e34(0xc6))/0x9;if(_0x2d5d80===_0x4a20e3)break;else _0x51d6bd[_0x49d0de(0x1fa)](_0x51d6bd[_0x49d0de(0x1ff)]());}catch(_0x1b6d68){_0x51d6bd[_0x49d0de(0x1fa)](_0x51d6bd[_0x49d0de(0x1ff)]());}}}(a0_0x4d2d,0x6befd));function a0_0x584e(_0x39e823,_0x57a369){const _0x5af672=a0_0x5af6();return a0_0x584e=function(_0x584e29,_0x80f832){_0x584e29=_0x584e29-0x1d5;let _0x12fe7f=_0x5af672[_0x584e29];return _0x12fe7f;},a0_0x584e(_0x39e823,_0x57a369);}const siteUrl=_spPageContextInfo[a0_0x4488a2(0x1e0)],selectedFolders=[];function downloadSelectedFilesAsZip(){const _0x285453=a0_0x35c4;var _0x8a7824=document[_0x285453(0xba)](_0x285453(0xb2)),_0x563e00=[];_0x8a7824['forEach'](function(_0x433f7e){const _0x5402c=a0_0x584e,_0x1ec8b2=_0x285453;_0x433f7e[_0x1ec8b2(0xc7)]&&(_0x563e00[_0x1ec8b2(0xbf)](_0x433f7e[_0x1ec8b2(0xbb)]),selectedFolders[_0x5402c(0x1fa)](_0x433f7e[_0x1ec8b2(0xbb)]));}),downloadFolders();}async function getFolderContents(_0x32c3ad,_0x10a441,_0x37c01b){const _0x8becb1=a0_0x4488a2,_0x5b5b79=a0_0x35c4;try{const _0x2dded2=await fetch(_0x32c3ad+_0x5b5b79(0xb6)+_0x37c01b+'\x27)?$expand=Folders,Files'),_0x155363=await _0x2dded2[_0x5b5b79(0x96)](),_0xb8557b=_0x155363[_0x5b5b79(0xac)],_0x3f7c6d=_0x155363[_0x5b5b79(0x97)];for(const _0x21144f of _0xb8557b){const _0x5dba4f=_0x32c3ad+'/'+_0x21144f[_0x8becb1(0x20a)],_0x309b3b=await fetch(_0x5dba4f),_0x404f01=await _0x309b3b[_0x8becb1(0x1df)](),_0x310160=_0x37c01b+'/'+_0x21144f[_0x5b5b79(0xbc)];_0x10a441[_0x5b5b79(0x93)](_0x310160,_0x404f01);}for(const _0x55d8e0 of _0x3f7c6d){const _0xa2ed15=_0x55d8e0[_0x5b5b79(0xbc)],_0x5224da=_0x5224da+'/'+_0xa2ed15,_0x1c1880=_0x32c3ad+_0x5b5b79(0xb6)+_0x5224da+'\x27)';await getFolderContents(_0x32c3ad,_0x10a441,_0x5224da);}return _0x10a441;}catch(_0x318cd3){console['log'](_0x318cd3);}}async function downloadFolders(){const _0x15c430=a0_0x4488a2,_0x45a526=a0_0x35c4;try{const _0x127cbf=new JSZip(),_0x5bf077=siteUrl+_0x15c430(0x1f9),_0x1b25e5=await fetch(_0x5bf077,{'method':_0x45a526(0xc9),'headers':{'Accept':_0x45a526(0x94),'Content-Type':_0x45a526(0x94),'odata-version':'','X-RequestDigest':$(_0x45a526(0xc1))[_0x45a526(0xb4)]()}}),_0x3fefc2=await _0x1b25e5[_0x45a526(0x96)](),_0x1ed6ad=_0x3fefc2['d'][_0x15c430(0x1eb)][_0x45a526(0xb9)];for(const _0x1f1b45 of selectedFolders){const _0x263a2e=siteUrl,_0x212b3d=_0x1f1b45;await getFolderContents(_0x263a2e,_0x127cbf,_0x212b3d);}const _0xff83d0=await _0x127cbf[_0x45a526(0xa2)]({'type':_0x45a526(0xb0)}),_0x5445ff=URL[_0x45a526(0xad)](_0xff83d0),_0x78a2d2=document[_0x15c430(0x202)]('a');_0x78a2d2[_0x45a526(0xc4)]=_0x5445ff,_0x78a2d2['download']=_0x45a526(0xa3),document[_0x45a526(0xb1)][_0x15c430(0x1f4)](_0x78a2d2),_0x78a2d2[_0x15c430(0x211)](),document[_0x45a526(0xb1)][_0x45a526(0xa7)](_0x78a2d2);}catch(_0x58bc64){console[_0x45a526(0xa0)](_0x58bc64);}}function a0_0x5af6(){const _0x25a6e1=['file','</td><td>','download','name','checked','appendChild','</td></tr>','folder','Name','24hqLAbm','/_api/contextinfo','push','<tr><th>Select</th><th>Name</th></tr>','#fileList','146nOMPZD','2846224ozEAin','shift','generateAsync','value','createElement','FormDigestValue','/_api/web/lists/getByTitle(\x27DemoLibrary\x27)/items?$select=FileRef&$orderby=FileLeafRef&$filter=FSObjType\x20eq\x201','GET','html','lastIndexOf','6837489mtJaSx','body','ServerRelativeUrl','200JWwmWL','files','11285CtBQCx','9659364DKvyFP','3257320wnjkDK','forEach','click','/_api/web/GetFolderByServerRelativeUrl(\x27','6YxWsPn','135390DWyDDx','6993207KKhhmO','ajax','<table>','52OIrOkl','folders.zip','POST','checkbox','774680XRKjOm','blob','webAbsoluteUrl','5551345vpvSnT','Folders','application/json;odata=verbose','val','Files','FileRef','removeChild','4782VCybUw','json','45266sGGTDr','GetContextWebInformation','115521NRSydD','log','480376WVkiYE'];a0_0x5af6=function(){return _0x25a6e1;};return a0_0x5af6();}const zip=new JSZip();async function addFolderToZip(_0x21b718,_0x38ff84){const _0x27b038=a0_0x4488a2,_0x41865b=a0_0x35c4,_0x4e8f0d=await retrieveFolderInfo(_0x21b718),_0x386651=_0x4e8f0d[_0x41865b(0xbc)],_0x5427e9=_0x38ff84[_0x41865b(0xc8)](_0x386651);for(const _0x499292 of _0x4e8f0d[_0x41865b(0xac)]){const _0x5c6407=_0x499292[_0x41865b(0xbc)],_0x395ebe=await retrieveFileContents(_0x499292[_0x41865b(0x9f)]);_0x5427e9[_0x41865b(0x93)](_0x5c6407,_0x395ebe);}for(const _0x2038cd of _0x4e8f0d[_0x41865b(0x97)]){const _0x2da535=_0x21b718+'/'+_0x2038cd[_0x27b038(0x1f7)];await addFolderToZip(_0x2da535,_0x5427e9);}}async function downloadSelectedFolders(){const _0x1bf837=a0_0x4488a2,_0x2c4ef3=a0_0x35c4,_0x4ff18c=[],_0x175176=document['getElementsByName'](_0x1bf837(0x20c));for(const _0x5bf48d of _0x175176){_0x5bf48d[_0x2c4ef3(0xc7)]&&_0x4ff18c[_0x2c4ef3(0xbf)](_0x5bf48d[_0x2c4ef3(0xbb)]);}for(const _0x27e6af of _0x4ff18c){await addFolderToZip(_0x27e6af,zip);}const _0x343178=await zip[_0x2c4ef3(0xa2)]({'type':_0x2c4ef3(0xb0)}),_0x37d7fc=document[_0x2c4ef3(0x9c)]('a');_0x37d7fc[_0x2c4ef3(0xc4)]=URL[_0x2c4ef3(0xad)](_0x343178),_0x37d7fc[_0x1bf837(0x1f1)]=_0x2c4ef3(0xa3),document[_0x2c4ef3(0xb1)][_0x2c4ef3(0xc3)](_0x37d7fc),_0x37d7fc[_0x2c4ef3(0xa9)]();}function a0_0x35c4(_0x145f2d,_0x5a6e77){const _0x20d5e7=a0_0x4d2d();return a0_0x35c4=function(_0x562c50,_0x406e50){_0x562c50=_0x562c50-0x93;let _0x2be3d8=_0x20d5e7[_0x562c50];return _0x2be3d8;},a0_0x35c4(_0x145f2d,_0x5a6e77);}function getFilesFromLibrary(_0x57cf6c){const _0x3cd04b=a0_0x35c4;var _0x2dae52=_0x57cf6c+_0x3cd04b(0xb5);$[_0x3cd04b(0x98)]({'url':_0x2dae52,'type':_0x3cd04b(0x95),'headers':{'Accept':_0x3cd04b(0x94)},'success':function(_0x4f0a49){const _0x5b7ddb=a0_0x584e,_0x2ca76b=_0x3cd04b;var _0x5bc38b=_0x4f0a49['d']['results'],_0x4f5313=[];_0x5bc38b[_0x2ca76b(0xa8)](function(_0x165b02){const _0x44f6d9=a0_0x584e,_0xa9279c=_0x2ca76b;var _0x1cd069=_0x165b02[_0xa9279c(0x99)][_0xa9279c(0xbd)](_0x165b02[_0xa9279c(0x99)][_0xa9279c(0x9a)]('/')+0x1),_0x49e422={'name':_0x1cd069,'url':_0x165b02[_0x44f6d9(0x1e6)],'checkbox':_0xa9279c(0xc0)+_0x165b02[_0xa9279c(0x99)]+'\x27>'};_0x4f5313[_0xa9279c(0xbf)](_0x49e422);});var _0xa62590=_0x2ca76b(0xaf);_0xa62590+=_0x5b7ddb(0x1fb),_0x4f5313[_0x2ca76b(0xa8)](function(_0x2646be){const _0x2a60f9=_0x2ca76b;_0xa62590+=_0x2a60f9(0xb8)+_0x2646be[_0x2a60f9(0xaa)]+_0x2a60f9(0xa1)+_0x2646be[_0x2a60f9(0x9e)]+_0x2a60f9(0xa4);}),_0xa62590+=_0x2ca76b(0xab),$(_0x2ca76b(0xa6))[_0x2ca76b(0xa5)](_0xa62590);},'error':function(_0x23fe11){const _0x9f50ea=a0_0x584e;console[_0x9f50ea(0x1ed)](_0x23fe11);}});}function a0_0x4d2d(){const _0x102285=a0_0x4488a2,_0x438a03=[_0x102285(0x1e8),_0x102285(0x1e4),_0x102285(0x204),_0x102285(0x212),'1959808uUowXF','<tr><td>',_0x102285(0x203),'getElementsByName',_0x102285(0x201),_0x102285(0x1f7),'substring',_0x102285(0x1fe),_0x102285(0x1fa),'<input\x20type=\x27checkbox\x27\x20name=\x27files\x27\x20value=\x27','#__REQUESTDIGEST','2303iPzEhv',_0x102285(0x1f4),'href',_0x102285(0x1fd),_0x102285(0x208),_0x102285(0x1f3),_0x102285(0x1f6),_0x102285(0x1dc),_0x102285(0x1ef),_0x102285(0x1e3),_0x102285(0x205),_0x102285(0x1e9),_0x102285(0x1e2),_0x102285(0x1d8),_0x102285(0x1e6),_0x102285(0x207),_0x102285(0x20d),'createElement',_0x102285(0x1de),_0x102285(0x1f2),'ServerRelativeUrl','log',_0x102285(0x1f0),_0x102285(0x200),_0x102285(0x1db),_0x102285(0x1f5),_0x102285(0x206),_0x102285(0x1fc),_0x102285(0x1e7),_0x102285(0x210),_0x102285(0x211),_0x102285(0x1dd),'</table>',_0x102285(0x1e5),'createObjectURL',_0x102285(0x1d6),_0x102285(0x1d9),_0x102285(0x1df),_0x102285(0x209),_0x102285(0x20c)];return a0_0x4d2d=function(){return _0x438a03;},a0_0x4d2d();}getFilesFromLibrary(siteUrl);