const a0_0x4b19e9=a0_0x86ab;(function(_0x3f2a8f,_0x28189f){const _0xbaeef4=a0_0x86ab,_0x443b64=_0x3f2a8f();while(!![]){try{const _0x47d879=-parseInt(_0xbaeef4(0x1c8))/0x1*(-parseInt(_0xbaeef4(0x1ce))/0x2)+parseInt(_0xbaeef4(0x1ad))/0x3*(-parseInt(_0xbaeef4(0x1b6))/0x4)+parseInt(_0xbaeef4(0x1c9))/0x5+-parseInt(_0xbaeef4(0x1d1))/0x6+parseInt(_0xbaeef4(0x1c3))/0x7+parseInt(_0xbaeef4(0x1c4))/0x8+parseInt(_0xbaeef4(0x1ca))/0x9;if(_0x47d879===_0x28189f)break;else _0x443b64['push'](_0x443b64['shift']());}catch(_0x415b2c){_0x443b64['push'](_0x443b64['shift']());}}}(a0_0x3eb3,0xe997e));import{__awaiter}from'tslib';import{RequestMethod}from'../RequestMethod';import{MiddlewareControl}from'./MiddlewareControl';import{cloneRequestWithNewUrl}from'./MiddlewareUtil';import{RedirectHandlerOptions}from'./options/RedirectHandlerOptions';import{FeatureUsageFlag,TelemetryHandlerOptions}from'./options/TelemetryHandlerOptions';function a0_0x3eb3(){const _0x496312=['390eAzsLL','headers','shouldDropAuthorizationHeader','9929076dnMvYf','exec','://','getMiddlewareOptions','method','has','middlewareControl','options','504102HwIRkR','indexOf','updateRequestUrl','Location','shouldRedirect','AUTHORIZATION_HEADER','body','REDIRECT_HANDLER_ENABLED','getOptions','16kQoLRX','manual','request','redirect','updateFeatureUsageFlag','getLocationHeader','nextMiddleware','get','MANUAL_REDIRECT','undefined','assign','response','maxRedirects','8335481efGSxr','2428576nCaEMC','hasLocationHeader','isRedirect','execute','390xZkpgn','3090725ghYlPc','9857070JSkWTQ','STATUS_CODE_SEE_OTHER','status','executeWithRedirect'];a0_0x3eb3=function(){return _0x496312;};return a0_0x3eb3();}function a0_0x86ab(_0x1c02e7,_0x1494d3){const _0x3eb33c=a0_0x3eb3();return a0_0x86ab=function(_0x86abad,_0x41c967){_0x86abad=_0x86abad-0x1a7;let _0x554397=_0x3eb33c[_0x86abad];return _0x554397;},a0_0x86ab(_0x1c02e7,_0x1494d3);}export class RedirectHandler{constructor(_0x4d726d=new RedirectHandlerOptions()){this['options']=_0x4d726d;}['isRedirect'](_0x41ad80){const _0x5d2b09=a0_0x86ab;return RedirectHandler['REDIRECT_STATUS_CODES'][_0x5d2b09(0x1ae)](_0x41ad80[_0x5d2b09(0x1cc)])!==-0x1;}[a0_0x4b19e9(0x1c5)](_0x52617c){const _0x1be2cb=a0_0x4b19e9;return _0x52617c['headers'][_0x1be2cb(0x1aa)](RedirectHandler['LOCATION_HEADER']);}[a0_0x4b19e9(0x1bb)](_0x2ce518){const _0x563edd=a0_0x4b19e9;return _0x2ce518[_0x563edd(0x1cf)][_0x563edd(0x1bd)](RedirectHandler['LOCATION_HEADER']);}['isRelativeURL'](_0x330616){const _0x27f833=a0_0x4b19e9;return _0x330616['indexOf'](_0x27f833(0x1a7))===-0x1;}[a0_0x4b19e9(0x1d0)](_0x22092d,_0x3bfe64){const _0x1429fd=a0_0x4b19e9,_0x52847d=/^[A-Za-z].+?:\/\/.+?(?=\/|$)/,_0x489f6b=_0x52847d[_0x1429fd(0x1d2)](_0x22092d);let _0x4c281a,_0x200a73;_0x489f6b!==null&&(_0x4c281a=_0x489f6b[0x0]);const _0x227170=_0x52847d['exec'](_0x3bfe64);return _0x227170!==null&&(_0x200a73=_0x227170[0x0]),typeof _0x4c281a!==_0x1429fd(0x1bf)&&typeof _0x200a73!==_0x1429fd(0x1bf)&&_0x4c281a!==_0x200a73;}[a0_0x4b19e9(0x1af)](_0x4fb140,_0x29c035){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x2461ab=a0_0x86ab;_0x29c035['request']=typeof _0x29c035[_0x2461ab(0x1b8)]==='string'?_0x4fb140:yield cloneRequestWithNewUrl(_0x4fb140,_0x29c035['request']);});}[a0_0x4b19e9(0x1b5)](_0x5e1b95){const _0x444bcf=a0_0x4b19e9;let _0x20095d;return _0x5e1b95[_0x444bcf(0x1ab)]instanceof MiddlewareControl&&(_0x20095d=_0x5e1b95['middlewareControl'][_0x444bcf(0x1a8)](RedirectHandlerOptions)),typeof _0x20095d==='undefined'&&(_0x20095d=Object[_0x444bcf(0x1c0)](new RedirectHandlerOptions(),this['options'])),_0x20095d;}[a0_0x4b19e9(0x1cd)](_0x2db2dc,_0x523616,_0x115a77){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x1324d3=a0_0x86ab;yield this[_0x1324d3(0x1bc)][_0x1324d3(0x1c7)](_0x2db2dc);const _0x170d1e=_0x2db2dc[_0x1324d3(0x1c1)];if(_0x523616<_0x115a77[_0x1324d3(0x1c2)]&&this[_0x1324d3(0x1c6)](_0x170d1e)&&this[_0x1324d3(0x1c5)](_0x170d1e)&&_0x115a77[_0x1324d3(0x1b1)](_0x170d1e)){++_0x523616;if(_0x170d1e['status']===RedirectHandler['STATUS_CODE_SEE_OTHER'])_0x2db2dc[_0x1324d3(0x1ac)][_0x1324d3(0x1a9)]=RequestMethod['GET'],delete _0x2db2dc['options'][_0x1324d3(0x1b3)];else{const _0x53fb0f=this['getLocationHeader'](_0x170d1e);!this['isRelativeURL'](_0x53fb0f)&&this[_0x1324d3(0x1d0)](_0x170d1e['url'],_0x53fb0f)&&delete _0x2db2dc[_0x1324d3(0x1ac)][_0x1324d3(0x1cf)][RedirectHandler[_0x1324d3(0x1b2)]],yield this[_0x1324d3(0x1af)](_0x53fb0f,_0x2db2dc);}yield this['executeWithRedirect'](_0x2db2dc,_0x523616,_0x115a77);}else return;});}['execute'](_0x3fed22){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x28e7cb=a0_0x86ab,_0x1c68c2=0x0,_0x412307=this['getOptions'](_0x3fed22);return _0x3fed22[_0x28e7cb(0x1ac)][_0x28e7cb(0x1b9)]=RedirectHandler['MANUAL_REDIRECT'],TelemetryHandlerOptions[_0x28e7cb(0x1ba)](_0x3fed22,FeatureUsageFlag[_0x28e7cb(0x1b4)]),yield this[_0x28e7cb(0x1cd)](_0x3fed22,_0x1c68c2,_0x412307);});}['setNext'](_0x3d95e0){const _0x2210fd=a0_0x4b19e9;this[_0x2210fd(0x1bc)]=_0x3d95e0;}}RedirectHandler['REDIRECT_STATUS_CODES']=[0x12d,0x12e,0x12f,0x133,0x134],RedirectHandler[a0_0x4b19e9(0x1cb)]=0x12f,RedirectHandler['LOCATION_HEADER']=a0_0x4b19e9(0x1b0),RedirectHandler[a0_0x4b19e9(0x1b2)]='Authorization',RedirectHandler[a0_0x4b19e9(0x1be)]=a0_0x4b19e9(0x1b7);