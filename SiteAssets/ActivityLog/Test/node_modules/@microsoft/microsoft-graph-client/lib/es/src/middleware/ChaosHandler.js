const a0_0x20ee0a=a0_0x464f;(function(_0x5cb5fb,_0x549f8e){const _0xf9024=a0_0x464f,_0x185d29=_0x5cb5fb();while(!![]){try{const _0x5849ce=parseInt(_0xf9024(0xa2))/0x1*(-parseInt(_0xf9024(0xbc))/0x2)+parseInt(_0xf9024(0xb9))/0x3*(-parseInt(_0xf9024(0xc0))/0x4)+parseInt(_0xf9024(0xaa))/0x5*(-parseInt(_0xf9024(0xac))/0x6)+parseInt(_0xf9024(0xa7))/0x7*(parseInt(_0xf9024(0x9f))/0x8)+-parseInt(_0xf9024(0xb7))/0x9*(parseInt(_0xf9024(0xb2))/0xa)+-parseInt(_0xf9024(0xbb))/0xb+-parseInt(_0xf9024(0xb8))/0xc*(-parseInt(_0xf9024(0xc8))/0xd);if(_0x5849ce===_0x549f8e)break;else _0x185d29['push'](_0x185d29['shift']());}catch(_0x43d086){_0x185d29['push'](_0x185d29['shift']());}}}(a0_0x32f5,0xd5ee9));function a0_0x464f(_0x3446e7,_0x18ed51){const _0x32f539=a0_0x32f5();return a0_0x464f=function(_0x464f8a,_0x114e08){_0x464f8a=_0x464f8a-0x9e;let _0x27722f=_0x32f539[_0x464f8a];return _0x27722f;},a0_0x464f(_0x3446e7,_0x18ed51);}import{__awaiter}from'tslib';import{MiddlewareControl}from'./MiddlewareControl';import{generateUUID}from'./MiddlewareUtil';import{httpStatusCode,methodStatusCode}from'./options/ChaosHandlerData';function a0_0x32f5(){const _0x1998f5=['10hTvPBF','string','floor','statusMessage','getRandomStatusCode','4839183blPIwn','30335700kVprPT','8334FiVdnQ','responseBody','13598343RoZDQa','2KEouPR','setStatusCode','toString','execute','948QQttWg','request','Cache-Control','length','getOptions','append','exec','stringify','26OfVaBm','method','chaosStrategy','getRelativeURL','retry-after','Strict-Transport-Security','manualMap','createResponseBody','no-store','132728qnSPCz','headers','x-ms-ags-diagnostic','1231645Lipntj','createResponse','getMiddlewareOptions','middlewareControl','client-request-id','35JuJmjr','setNext','get','2993545sZCwYV','statusCode','6evYpiI','nextMiddleware','sendRequest','MANUAL','assign','options'];a0_0x32f5=function(){return _0x1998f5;};return a0_0x32f5();}import{ChaosHandlerOptions}from'./options/ChaosHandlerOptions';import{ChaosStrategy}from'./options/ChaosStrategy';export class ChaosHandler{constructor(_0x1935ee=new ChaosHandlerOptions(),_0x326251){const _0x7ab85=a0_0x464f;this[_0x7ab85(0xb1)]=_0x1935ee,this['manualMap']=_0x326251;}['createResponseHeaders'](_0x2db098,_0x58661c,_0x54b1e9){const _0x181e41=a0_0x464f,_0x5a8e1d=_0x2db098[_0x181e41(0xa0)]?new Headers(_0x2db098[_0x181e41(0xa0)]):new Headers();return _0x5a8e1d['append'](_0x181e41(0xc2),_0x181e41(0x9e)),_0x5a8e1d[_0x181e41(0xc5)]('request-id',_0x58661c),_0x5a8e1d[_0x181e41(0xc5)](_0x181e41(0xa6),_0x58661c),_0x5a8e1d[_0x181e41(0xc5)](_0x181e41(0xa1),''),_0x5a8e1d['append']('Date',_0x54b1e9),_0x5a8e1d[_0x181e41(0xc5)](_0x181e41(0xcd),''),_0x2db098['statusCode']===0x1ad&&_0x5a8e1d[_0x181e41(0xc5)](_0x181e41(0xcc),'3'),_0x5a8e1d;}[a0_0x20ee0a(0xcf)](_0x588f12,_0x32876c,_0x37b7ac){const _0x5c60d2=a0_0x20ee0a;if(_0x588f12[_0x5c60d2(0xba)])return _0x588f12[_0x5c60d2(0xba)];let _0x204625;if(_0x588f12[_0x5c60d2(0xab)]>=0x190){const _0x28ce28=httpStatusCode[_0x588f12[_0x5c60d2(0xab)]],_0x40b744=_0x588f12[_0x5c60d2(0xb5)];_0x204625={'error':{'code':_0x28ce28,'message':_0x40b744,'innerError':{'request-id':_0x32876c,'date':_0x37b7ac}}};}else _0x204625={};return _0x204625;}[a0_0x20ee0a(0xa3)](_0x521775,_0x10039d){const _0x27f3bc=a0_0x20ee0a,_0x23d675=_0x10039d[_0x27f3bc(0xc1)],_0x201d31=generateUUID(),_0x161a22=new Date(),_0x3a9596=this['createResponseHeaders'](_0x521775,_0x201d31,_0x161a22[_0x27f3bc(0xbe)]()),_0x1a4733=this['createResponseBody'](_0x521775,_0x201d31,_0x161a22['toString']()),_0x5d92dd={'url':_0x23d675,'status':_0x521775['statusCode'],'statusText':_0x521775[_0x27f3bc(0xb5)],'headers':_0x3a9596};_0x10039d['response']=new Response(typeof _0x1a4733===_0x27f3bc(0xb3)?_0x1a4733:JSON[_0x27f3bc(0xc7)](_0x1a4733),_0x5d92dd);}[a0_0x20ee0a(0xae)](_0x4f19a6,_0x27dd88){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x1a7b3b=a0_0x464f;this[_0x1a7b3b(0xbd)](_0x4f19a6,_0x27dd88[_0x1a7b3b(0xc1)],_0x27dd88[_0x1a7b3b(0xb1)][_0x1a7b3b(0xc9)]);if(_0x4f19a6['chaosStrategy']===ChaosStrategy[_0x1a7b3b(0xaf)]&&!this[_0x1a7b3b(0xad)]||Math['floor'](Math['random']()*0x64)<_0x4f19a6['chaosPercentage'])this[_0x1a7b3b(0xa3)](_0x4f19a6,_0x27dd88);else this[_0x1a7b3b(0xad)]&&(yield this[_0x1a7b3b(0xad)]['execute'](_0x27dd88));});}[a0_0x20ee0a(0xb6)](_0x4e415f){const _0xa3e858=a0_0x20ee0a,_0x2ff57c=methodStatusCode[_0x4e415f];return _0x2ff57c[Math[_0xa3e858(0xb4)](Math['random']()*_0x2ff57c[_0xa3e858(0xc3)])];}[a0_0x20ee0a(0xcb)](_0x4b62f){const _0x5ea70c=a0_0x20ee0a,_0x12f6f4=/https?:\/\/graph\.microsoft\.com\/[^/]+(.+?)(\?|$)/;let _0x18f620;return _0x12f6f4['exec'](_0x4b62f)!==null&&(_0x18f620=_0x12f6f4[_0x5ea70c(0xc6)](_0x4b62f)[0x1]),_0x18f620;}[a0_0x20ee0a(0xbd)](_0x5bd213,_0x118a73,_0x2e7496){const _0x4fb3a6=a0_0x20ee0a;if(_0x5bd213[_0x4fb3a6(0xca)]===ChaosStrategy[_0x4fb3a6(0xaf)]){if(_0x5bd213[_0x4fb3a6(0xab)]===undefined){const _0x4dc7b4=this[_0x4fb3a6(0xcb)](_0x118a73);this['manualMap'][_0x4fb3a6(0xa9)](_0x4dc7b4)!==undefined?this[_0x4fb3a6(0xce)][_0x4fb3a6(0xa9)](_0x4dc7b4)['get'](_0x2e7496)!==undefined&&(_0x5bd213['statusCode']=this[_0x4fb3a6(0xce)][_0x4fb3a6(0xa9)](_0x4dc7b4)[_0x4fb3a6(0xa9)](_0x2e7496)):this[_0x4fb3a6(0xce)]['forEach']((_0x39474d,_0x2426d4)=>{const _0xffbe76=_0x4fb3a6,_0x37cd65=new RegExp(_0x2426d4+'$');_0x37cd65['test'](_0x4dc7b4)&&(this['manualMap']['get'](_0x2426d4)[_0xffbe76(0xa9)](_0x2e7496)!==undefined&&(_0x5bd213[_0xffbe76(0xab)]=this[_0xffbe76(0xce)][_0xffbe76(0xa9)](_0x2426d4)[_0xffbe76(0xa9)](_0x2e7496)));});}}else _0x5bd213[_0x4fb3a6(0xab)]=this[_0x4fb3a6(0xb6)](_0x2e7496);}[a0_0x20ee0a(0xc4)](_0x4b8cff){const _0xb38977=a0_0x20ee0a;let _0x49f462;return _0x4b8cff[_0xb38977(0xa5)]instanceof MiddlewareControl&&(_0x49f462=_0x4b8cff[_0xb38977(0xa5)][_0xb38977(0xa4)](ChaosHandlerOptions)),typeof _0x49f462==='undefined'&&(_0x49f462=Object[_0xb38977(0xb0)](new ChaosHandlerOptions(),this[_0xb38977(0xb1)])),_0x49f462;}[a0_0x20ee0a(0xbf)](_0x26ec7b){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x2b420b=a0_0x464f,_0x414673=this[_0x2b420b(0xc4)](_0x26ec7b);return yield this['sendRequest'](_0x414673,_0x26ec7b);});}[a0_0x20ee0a(0xa8)](_0x2b1278){const _0x480aa1=a0_0x20ee0a;this[_0x480aa1(0xad)]=_0x2b1278;}}