const a0_0x7f8b93=a0_0x262e;(function(_0x24e5f4,_0x2cc0ab){const _0x120245=a0_0x262e,_0x3beb34=_0x24e5f4();while(!![]){try{const _0x2ad0ab=-parseInt(_0x120245(0x133))/0x1*(parseInt(_0x120245(0x138))/0x2)+parseInt(_0x120245(0x15d))/0x3*(parseInt(_0x120245(0x13b))/0x4)+-parseInt(_0x120245(0x149))/0x5+-parseInt(_0x120245(0x161))/0x6+-parseInt(_0x120245(0x151))/0x7*(parseInt(_0x120245(0x148))/0x8)+parseInt(_0x120245(0x15c))/0x9+parseInt(_0x120245(0x130))/0xa;if(_0x2ad0ab===_0x2cc0ab)break;else _0x3beb34['push'](_0x3beb34['shift']());}catch(_0x268ac1){_0x3beb34['push'](_0x3beb34['shift']());}}}(a0_0x5a76,0x8972b));import{__awaiter}from'tslib';import{MiddlewareControl}from'./MiddlewareControl';import{generateUUID}from'./MiddlewareUtil';import{httpStatusCode,methodStatusCode}from'./options/ChaosHandlerData';import{ChaosHandlerOptions}from'./options/ChaosHandlerOptions';function a0_0x5a76(){const _0x173565=['undefined','271619LrhGvY','get','Date','responseBody','Strict-Transport-Security','2OdgRnm','length','nextMiddleware','32eaqOBy','getRelativeURL','toString','statusMessage','chaosPercentage','headers','options','x-ms-ags-diagnostic','createResponse','chaosStrategy','createResponseHeaders','middlewareControl','setNext','1808xQhxeC','4775875zdsNYd','request','client-request-id','sendRequest','createResponseBody','test','MANUAL','random','4431LERyMF','forEach','retry-after','method','setStatusCode','exec','statusCode','getOptions','getMiddlewareOptions','floor','assign','88668fwxxdx','330744TxdNKH','string','manualMap','execute','1912482sDcksC','getRandomStatusCode','13597500VRDPoC','append'];a0_0x5a76=function(){return _0x173565;};return a0_0x5a76();}function a0_0x262e(_0x4b2c9e,_0x43e3cf){const _0x5a7633=a0_0x5a76();return a0_0x262e=function(_0x262e2a,_0x3128c5){_0x262e2a=_0x262e2a-0x130;let _0x4030c4=_0x5a7633[_0x262e2a];return _0x4030c4;},a0_0x262e(_0x4b2c9e,_0x43e3cf);}import{ChaosStrategy}from'./options/ChaosStrategy';export class ChaosHandler{constructor(_0x40026d=new ChaosHandlerOptions(),_0x29e4a0){const _0x59d6a5=a0_0x262e;this[_0x59d6a5(0x141)]=_0x40026d,this[_0x59d6a5(0x15f)]=_0x29e4a0;}[a0_0x7f8b93(0x145)](_0x1cf2c0,_0x582673,_0x54f13f){const _0x59f147=a0_0x7f8b93,_0x19ae89=_0x1cf2c0[_0x59f147(0x140)]?new Headers(_0x1cf2c0[_0x59f147(0x140)]):new Headers();return _0x19ae89[_0x59f147(0x131)]('Cache-Control','no-store'),_0x19ae89[_0x59f147(0x131)]('request-id',_0x582673),_0x19ae89[_0x59f147(0x131)](_0x59f147(0x14b),_0x582673),_0x19ae89[_0x59f147(0x131)](_0x59f147(0x142),''),_0x19ae89[_0x59f147(0x131)](_0x59f147(0x135),_0x54f13f),_0x19ae89['append'](_0x59f147(0x137),''),_0x1cf2c0[_0x59f147(0x157)]===0x1ad&&_0x19ae89[_0x59f147(0x131)](_0x59f147(0x153),'3'),_0x19ae89;}[a0_0x7f8b93(0x14d)](_0x38366d,_0x1c3ee9,_0x52f873){const _0x2c1275=a0_0x7f8b93;if(_0x38366d[_0x2c1275(0x136)])return _0x38366d[_0x2c1275(0x136)];let _0x2308c8;if(_0x38366d['statusCode']>=0x190){const _0x36cc25=httpStatusCode[_0x38366d[_0x2c1275(0x157)]],_0x339337=_0x38366d['statusMessage'];_0x2308c8={'error':{'code':_0x36cc25,'message':_0x339337,'innerError':{'request-id':_0x1c3ee9,'date':_0x52f873}}};}else _0x2308c8={};return _0x2308c8;}['createResponse'](_0xec236e,_0x2029c3){const _0x1074d1=a0_0x7f8b93,_0x30484c=_0x2029c3[_0x1074d1(0x14a)],_0x3f1321=generateUUID(),_0xd770d9=new Date(),_0x324873=this[_0x1074d1(0x145)](_0xec236e,_0x3f1321,_0xd770d9[_0x1074d1(0x13d)]()),_0x5c68cc=this[_0x1074d1(0x14d)](_0xec236e,_0x3f1321,_0xd770d9[_0x1074d1(0x13d)]()),_0x3f4cb1={'url':_0x30484c,'status':_0xec236e[_0x1074d1(0x157)],'statusText':_0xec236e[_0x1074d1(0x13e)],'headers':_0x324873};_0x2029c3['response']=new Response(typeof _0x5c68cc===_0x1074d1(0x15e)?_0x5c68cc:JSON['stringify'](_0x5c68cc),_0x3f4cb1);}['sendRequest'](_0x4e5f89,_0x43227b){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x5a97a1=a0_0x262e;this[_0x5a97a1(0x155)](_0x4e5f89,_0x43227b[_0x5a97a1(0x14a)],_0x43227b[_0x5a97a1(0x141)][_0x5a97a1(0x154)]);if(_0x4e5f89[_0x5a97a1(0x144)]===ChaosStrategy[_0x5a97a1(0x14f)]&&!this[_0x5a97a1(0x13a)]||Math[_0x5a97a1(0x15a)](Math['random']()*0x64)<_0x4e5f89[_0x5a97a1(0x13f)])this[_0x5a97a1(0x143)](_0x4e5f89,_0x43227b);else this[_0x5a97a1(0x13a)]&&(yield this[_0x5a97a1(0x13a)][_0x5a97a1(0x160)](_0x43227b));});}['getRandomStatusCode'](_0xd5c945){const _0x5b1444=a0_0x7f8b93,_0x25cf9c=methodStatusCode[_0xd5c945];return _0x25cf9c[Math[_0x5b1444(0x15a)](Math[_0x5b1444(0x150)]()*_0x25cf9c[_0x5b1444(0x139)])];}[a0_0x7f8b93(0x13c)](_0x183bf3){const _0x524fe5=a0_0x7f8b93,_0x380be7=/https?:\/\/graph\.microsoft\.com\/[^/]+(.+?)(\?|$)/;let _0x544a55;return _0x380be7[_0x524fe5(0x156)](_0x183bf3)!==null&&(_0x544a55=_0x380be7[_0x524fe5(0x156)](_0x183bf3)[0x1]),_0x544a55;}[a0_0x7f8b93(0x155)](_0x53a511,_0x174c4f,_0x4c658d){const _0x87e0d2=a0_0x7f8b93;if(_0x53a511['chaosStrategy']===ChaosStrategy[_0x87e0d2(0x14f)]){if(_0x53a511['statusCode']===undefined){const _0x5e8f2f=this[_0x87e0d2(0x13c)](_0x174c4f);this[_0x87e0d2(0x15f)][_0x87e0d2(0x134)](_0x5e8f2f)!==undefined?this[_0x87e0d2(0x15f)][_0x87e0d2(0x134)](_0x5e8f2f)[_0x87e0d2(0x134)](_0x4c658d)!==undefined&&(_0x53a511[_0x87e0d2(0x157)]=this['manualMap'][_0x87e0d2(0x134)](_0x5e8f2f)[_0x87e0d2(0x134)](_0x4c658d)):this['manualMap'][_0x87e0d2(0x152)]((_0x54a820,_0x846fb7)=>{const _0x56b6d3=_0x87e0d2,_0x26fc27=new RegExp(_0x846fb7+'$');_0x26fc27[_0x56b6d3(0x14e)](_0x5e8f2f)&&(this[_0x56b6d3(0x15f)][_0x56b6d3(0x134)](_0x846fb7)[_0x56b6d3(0x134)](_0x4c658d)!==undefined&&(_0x53a511['statusCode']=this[_0x56b6d3(0x15f)][_0x56b6d3(0x134)](_0x846fb7)[_0x56b6d3(0x134)](_0x4c658d)));});}}else _0x53a511[_0x87e0d2(0x157)]=this[_0x87e0d2(0x162)](_0x4c658d);}[a0_0x7f8b93(0x158)](_0x1fb459){const _0x215441=a0_0x7f8b93;let _0x55bc12;return _0x1fb459[_0x215441(0x146)]instanceof MiddlewareControl&&(_0x55bc12=_0x1fb459['middlewareControl'][_0x215441(0x159)](ChaosHandlerOptions)),typeof _0x55bc12===_0x215441(0x132)&&(_0x55bc12=Object[_0x215441(0x15b)](new ChaosHandlerOptions(),this[_0x215441(0x141)])),_0x55bc12;}[a0_0x7f8b93(0x160)](_0x59c0d5){return __awaiter(this,void 0x0,void 0x0,function*(){const _0x5d24da=a0_0x262e,_0x399cc5=this[_0x5d24da(0x158)](_0x59c0d5);return yield this[_0x5d24da(0x14c)](_0x399cc5,_0x59c0d5);});}[a0_0x7f8b93(0x147)](_0x1c10f5){this['nextMiddleware']=_0x1c10f5;}}