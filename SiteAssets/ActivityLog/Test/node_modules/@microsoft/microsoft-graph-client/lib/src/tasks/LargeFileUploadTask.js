'use strict';function a0_0x5041(){var _0x2d434b=['uploadEventHandlers','options','../ResponseType','GraphClientError','RAW','1602858MSWmaT','bytes\x20','file','label','Range','sliceFile','status','733917GWxjPx','responseType','7HpZCLT','reportProgress','cancel','post','nextExpectedRanges','UploadResult','./FileUploadTask/Range','7011444KIRpcs','CreateUploadResult','isCancelled','__esModule','progress','uploadSliceGetRawResponse','prototype','The\x20LargeFileUploadTask.sliceFile()\x20function\x20has\x20been\x20deprecated\x20and\x20moved\x20into\x20the\x20FileObject\x20interface.','content','getResponse','__generator','expiry','slice','2KwKoto','Something\x20went\x20wrong!\x20Large\x20file\x20upload\x20slice\x20response\x20is\x20null.','nextRange','upload','url','name','updateTaskStatus','../GraphResponseHandler','GraphResponseHandler','maxValue','942460PDnvUz','sent','ResponseType','926856CBBnoy','__awaiter','5JBnUug','Please\x20pass\x20the\x20FileUpload\x20object,\x20StreamUpload\x20object\x20or\x20any\x20custom\x20implementation\x20of\x20the\x20FileObject\x20interface','put','uploadUrl','parseRange','application/octet-stream','minValue','ExpirationDateTime','uploadSession','createUploadSession','resume','getStatus','api','defineProperty','rangeSize','Invalid\x20Session','getUploadSession','expirationDateTime','client','headers','size','./FileUploadTask/UploadResult','concat','isNaN','8199yJGIOR','DEFAULT_FILE_SIZE','LargeFileUploadTask','1030tfmhGq','uploadSlice','67386FYWiqX','tslib','getNextRange'];a0_0x5041=function(){return _0x2d434b;};return a0_0x5041();}var a0_0x32c3c0=a0_0x5f1c;(function(_0x24a9a3,_0x2738a3){var _0xdbe83f=a0_0x5f1c,_0x3c3810=_0x24a9a3();while(!![]){try{var _0x17b4c1=-parseInt(_0xdbe83f(0xb5))/0x1+-parseInt(_0xdbe83f(0xda))/0x2*(parseInt(_0xdbe83f(0xc4))/0x3)+parseInt(_0xdbe83f(0xe4))/0x4*(-parseInt(_0xdbe83f(0xe9))/0x5)+parseInt(_0xdbe83f(0xbd))/0x6*(parseInt(_0xdbe83f(0xc6))/0x7)+-parseInt(_0xdbe83f(0xe7))/0x8+-parseInt(_0xdbe83f(0xb0))/0x9*(parseInt(_0xdbe83f(0xb3))/0xa)+parseInt(_0xdbe83f(0xcd))/0xb;if(_0x17b4c1===_0x2738a3)break;else _0x3c3810['push'](_0x3c3810['shift']());}catch(_0xf115dd){_0x3c3810['push'](_0x3c3810['shift']());}}}(a0_0x5041,0x23f11));function a0_0x5f1c(_0x4a1998,_0xa0943f){var _0x504149=a0_0x5041();return a0_0x5f1c=function(_0x5f1cac,_0x5a326e){_0x5f1cac=_0x5f1cac-0xab;var _0x6d9a41=_0x504149[_0x5f1cac];return _0x6d9a41;},a0_0x5f1c(_0x4a1998,_0xa0943f);}Object[a0_0x32c3c0(0xf6)](exports,a0_0x32c3c0(0xd0),{'value':!![]}),exports[a0_0x32c3c0(0xb2)]=void 0x0;var tslib_1=require(a0_0x32c3c0(0xb6)),GraphClientError_1=require('../GraphClientError'),GraphResponseHandler_1=require(a0_0x32c3c0(0xe1)),ResponseType_1=require(a0_0x32c3c0(0xba)),Range_1=require(a0_0x32c3c0(0xcc)),UploadResult_1=require(a0_0x32c3c0(0xad)),LargeFileUploadTask=(function(){var _0x9869d2=a0_0x32c3c0;function _0x59a7c7(_0x19f9e6,_0x17c1dc,_0x4c24e8,_0xfb6e74){var _0x2035a7=a0_0x5f1c;_0xfb6e74===void 0x0&&(_0xfb6e74={});this[_0x2035a7(0xb1)]=0x5*0x400*0x400,this[_0x2035a7(0xfb)]=_0x19f9e6;if(!_0x17c1dc[_0x2035a7(0xc2)])throw new GraphClientError_1[(_0x2035a7(0xbb))](_0x2035a7(0xea));else this[_0x2035a7(0xbf)]=_0x17c1dc;this['file']=_0x17c1dc,!_0xfb6e74[_0x2035a7(0xf7)]&&(_0xfb6e74[_0x2035a7(0xf7)]=this[_0x2035a7(0xb1)]),this[_0x2035a7(0xb9)]=_0xfb6e74,this[_0x2035a7(0xf1)]=_0x4c24e8,this[_0x2035a7(0xdc)]=new Range_1[(_0x2035a7(0xc1))](0x0,this[_0x2035a7(0xb9)][_0x2035a7(0xf7)]-0x1);}return _0x59a7c7[_0x9869d2(0xf2)]=function(_0x2b7ddc,_0x3d5b9e,_0x345cd6,_0x1a5d09){return _0x1a5d09===void 0x0&&(_0x1a5d09={}),tslib_1['__awaiter'](this,void 0x0,void 0x0,function(){var _0x53f8b2=a0_0x5f1c,_0x198c10,_0x4378ef;return tslib_1[_0x53f8b2(0xd7)](this,function(_0x5598d3){var _0x4b24ec=_0x53f8b2;switch(_0x5598d3['label']){case 0x0:return[0x4,_0x2b7ddc[_0x4b24ec(0xf5)](_0x3d5b9e)[_0x4b24ec(0xab)](_0x1a5d09)[_0x4b24ec(0xc9)](_0x345cd6)];case 0x1:_0x198c10=_0x5598d3[_0x4b24ec(0xe5)](),_0x4378ef={'url':_0x198c10[_0x4b24ec(0xec)],'expiry':new Date(_0x198c10[_0x4b24ec(0xfa)]),'isCancelled':![]};return[0x2,_0x4378ef];}});});},_0x59a7c7[_0x9869d2(0xd3)]['parseRange']=function(_0x2ff5c8){var _0x13101d=_0x9869d2,_0x2f1533=_0x2ff5c8[0x0];if(typeof _0x2f1533==='undefined'||_0x2f1533==='')return new Range_1[(_0x13101d(0xc1))]();var _0x27cb7e=_0x2f1533['split']('-'),_0x2ae8b0=parseInt(_0x27cb7e[0x0],0xa),_0x3127ce=parseInt(_0x27cb7e[0x1],0xa);return Number[_0x13101d(0xaf)](_0x3127ce)&&(_0x3127ce=this[_0x13101d(0xbf)][_0x13101d(0xac)]-0x1),new Range_1['Range'](_0x2ae8b0,_0x3127ce);},_0x59a7c7[_0x9869d2(0xd3)][_0x9869d2(0xe0)]=function(_0x4146a9){var _0x4bdcc9=_0x9869d2;this[_0x4bdcc9(0xf1)][_0x4bdcc9(0xd8)]=new Date(_0x4146a9[_0x4bdcc9(0xfa)]),this[_0x4bdcc9(0xdc)]=this[_0x4bdcc9(0xed)](_0x4146a9[_0x4bdcc9(0xca)]);},_0x59a7c7[_0x9869d2(0xd3)][_0x9869d2(0xb7)]=function(){var _0x20f272=_0x9869d2;if(this[_0x20f272(0xdc)]['minValue']===-0x1)return this[_0x20f272(0xdc)];var _0x16c440=this[_0x20f272(0xdc)]['minValue'],_0x4df384=_0x16c440+this[_0x20f272(0xb9)][_0x20f272(0xf7)]-0x1;return _0x4df384>=this['file'][_0x20f272(0xac)]&&(_0x4df384=this[_0x20f272(0xbf)][_0x20f272(0xac)]-0x1),new Range_1[(_0x20f272(0xc1))](_0x16c440,_0x4df384);},_0x59a7c7[_0x9869d2(0xd3)]['sliceFile']=function(_0x450c31){var _0x2d0cb3=_0x9869d2;console['warn'](_0x2d0cb3(0xd4));if(this[_0x2d0cb3(0xbf)][_0x2d0cb3(0xd5)]instanceof ArrayBuffer||this[_0x2d0cb3(0xbf)][_0x2d0cb3(0xd5)]instanceof Blob||this['file'][_0x2d0cb3(0xd5)]instanceof Uint8Array)return this[_0x2d0cb3(0xbf)][_0x2d0cb3(0xd5)][_0x2d0cb3(0xd9)](_0x450c31[_0x2d0cb3(0xef)],_0x450c31[_0x2d0cb3(0xe3)]+0x1);throw new GraphClientError_1[(_0x2d0cb3(0xbb))]('The\x20LargeFileUploadTask.sliceFile()\x20function\x20expects\x20only\x20Blob,\x20ArrayBuffer\x20or\x20Uint8Array\x20file\x20content.\x20Please\x20note\x20that\x20the\x20sliceFile()\x20function\x20is\x20deprecated.');},_0x59a7c7[_0x9869d2(0xd3)][_0x9869d2(0xdd)]=function(){var _0x2bc1da=_0x9869d2;return tslib_1[_0x2bc1da(0xe8)](this,void 0x0,void 0x0,function(){var _0x475871,_0x3c989c,_0x117435,_0x50643f,_0x2e962e,_0x4f8977,_0x3a48b8;return tslib_1['__generator'](this,function(_0x5ed8c4){var _0x1cc426=a0_0x5f1c;switch(_0x5ed8c4[_0x1cc426(0xc0)]){case 0x0:_0x475871=this[_0x1cc426(0xb9)]&&this[_0x1cc426(0xb9)][_0x1cc426(0xb8)],_0x5ed8c4[_0x1cc426(0xc0)]=0x1;case 0x1:if(!!this[_0x1cc426(0xf1)][_0x1cc426(0xcf)])return[0x3,0x5];_0x3c989c=this['getNextRange']();if(_0x3c989c['maxValue']===-0x1){_0x117435=new Error('Task\x20with\x20which\x20you\x20are\x20trying\x20to\x20upload\x20is\x20already\x20completed,\x20Please\x20check\x20for\x20your\x20uploaded\x20file'),_0x117435[_0x1cc426(0xdf)]=_0x1cc426(0xf8);throw _0x117435;}return[0x4,this[_0x1cc426(0xbf)]['sliceFile'](_0x3c989c)];case 0x2:_0x50643f=_0x5ed8c4[_0x1cc426(0xe5)]();return[0x4,this[_0x1cc426(0xd2)](_0x50643f,_0x3c989c,this['file'][_0x1cc426(0xac)])];case 0x3:_0x2e962e=_0x5ed8c4[_0x1cc426(0xe5)]();if(!_0x2e962e)throw new GraphClientError_1[(_0x1cc426(0xbb))](_0x1cc426(0xdb));return[0x4,GraphResponseHandler_1[_0x1cc426(0xe2)][_0x1cc426(0xd6)](_0x2e962e)];case 0x4:_0x4f8977=_0x5ed8c4['sent']();if(_0x2e962e[_0x1cc426(0xc3)]===0xc9||_0x2e962e[_0x1cc426(0xc3)]===0xc8&&_0x4f8977['id'])return this[_0x1cc426(0xc7)](_0x475871,_0x3c989c),[0x2,UploadResult_1[_0x1cc426(0xcb)][_0x1cc426(0xce)](_0x4f8977,_0x2e962e[_0x1cc426(0xab)])];_0x3a48b8={'expirationDateTime':_0x4f8977['expirationDateTime']||_0x4f8977[_0x1cc426(0xf0)],'nextExpectedRanges':_0x4f8977['NextExpectedRanges']||_0x4f8977[_0x1cc426(0xca)]},this['updateTaskStatus'](_0x3a48b8),this['reportProgress'](_0x475871,_0x3c989c);return[0x3,0x1];case 0x5:return[0x2];}});});},_0x59a7c7[_0x9869d2(0xd3)][_0x9869d2(0xc7)]=function(_0x4cf4fd,_0x348cde){var _0x421d0b=_0x9869d2;_0x4cf4fd&&_0x4cf4fd[_0x421d0b(0xd1)]&&_0x4cf4fd[_0x421d0b(0xd1)](_0x348cde,_0x4cf4fd['extraCallbackParam']);},_0x59a7c7[_0x9869d2(0xd3)][_0x9869d2(0xb4)]=function(_0xcff2fc,_0x4d8c83,_0x330d){var _0x7da6=_0x9869d2;return tslib_1[_0x7da6(0xe8)](this,void 0x0,void 0x0,function(){var _0x537812=_0x7da6;return tslib_1[_0x537812(0xd7)](this,function(_0x41b360){var _0x1ac19e=_0x537812;switch(_0x41b360['label']){case 0x0:return[0x4,this[_0x1ac19e(0xfb)][_0x1ac19e(0xf5)](this['uploadSession'][_0x1ac19e(0xde)])[_0x1ac19e(0xab)]({'Content-Length':''['concat'](_0x4d8c83[_0x1ac19e(0xe3)]-_0x4d8c83[_0x1ac19e(0xef)]+0x1),'Content-Range':'bytes\x20'[_0x1ac19e(0xae)](_0x4d8c83[_0x1ac19e(0xef)],'-')[_0x1ac19e(0xae)](_0x4d8c83['maxValue'],'/')['concat'](_0x330d),'Content-Type':'application/octet-stream'})[_0x1ac19e(0xeb)](_0xcff2fc)];case 0x1:return[0x2,_0x41b360[_0x1ac19e(0xe5)]()];}});});},_0x59a7c7[_0x9869d2(0xd3)]['uploadSliceGetRawResponse']=function(_0x417d15,_0x454aaa,_0x47e476){var _0x160863=_0x9869d2;return tslib_1[_0x160863(0xe8)](this,void 0x0,void 0x0,function(){var _0x176efc=_0x160863;return tslib_1[_0x176efc(0xd7)](this,function(_0x2206e1){var _0x2c31d8=_0x176efc;switch(_0x2206e1[_0x2c31d8(0xc0)]){case 0x0:return[0x4,this[_0x2c31d8(0xfb)][_0x2c31d8(0xf5)](this[_0x2c31d8(0xf1)]['url'])[_0x2c31d8(0xab)]({'Content-Length':''[_0x2c31d8(0xae)](_0x454aaa[_0x2c31d8(0xe3)]-_0x454aaa['minValue']+0x1),'Content-Range':_0x2c31d8(0xbe)[_0x2c31d8(0xae)](_0x454aaa['minValue'],'-')['concat'](_0x454aaa['maxValue'],'/')['concat'](_0x47e476),'Content-Type':_0x2c31d8(0xee)})[_0x2c31d8(0xc5)](ResponseType_1['ResponseType'][_0x2c31d8(0xbc)])['put'](_0x417d15)];case 0x1:return[0x2,_0x2206e1['sent']()];}});});},_0x59a7c7[_0x9869d2(0xd3)][_0x9869d2(0xc8)]=function(){return tslib_1['__awaiter'](this,void 0x0,void 0x0,function(){var _0xa26289=a0_0x5f1c,_0x1f71e1;return tslib_1[_0xa26289(0xd7)](this,function(_0x2031b3){var _0x4ba1a3=_0xa26289;switch(_0x2031b3[_0x4ba1a3(0xc0)]){case 0x0:return[0x4,this[_0x4ba1a3(0xfb)][_0x4ba1a3(0xf5)](this['uploadSession']['url'])[_0x4ba1a3(0xc5)](ResponseType_1[_0x4ba1a3(0xe6)][_0x4ba1a3(0xbc)])['delete']()];case 0x1:_0x1f71e1=_0x2031b3[_0x4ba1a3(0xe5)]();_0x1f71e1[_0x4ba1a3(0xc3)]===0xcc&&(this['uploadSession'][_0x4ba1a3(0xcf)]=!![]);return[0x2,_0x1f71e1];}});});},_0x59a7c7[_0x9869d2(0xd3)][_0x9869d2(0xf4)]=function(){var _0x118a0e=_0x9869d2;return tslib_1[_0x118a0e(0xe8)](this,void 0x0,void 0x0,function(){var _0x44e535=_0x118a0e,_0x316941;return tslib_1[_0x44e535(0xd7)](this,function(_0x27fd8d){var _0x12b43e=_0x44e535;switch(_0x27fd8d[_0x12b43e(0xc0)]){case 0x0:return[0x4,this[_0x12b43e(0xfb)]['api'](this['uploadSession'][_0x12b43e(0xde)])['get']()];case 0x1:_0x316941=_0x27fd8d[_0x12b43e(0xe5)](),this[_0x12b43e(0xe0)](_0x316941);return[0x2,_0x316941];}});});},_0x59a7c7['prototype'][_0x9869d2(0xf3)]=function(){return tslib_1['__awaiter'](this,void 0x0,void 0x0,function(){return tslib_1['__generator'](this,function(_0x39b6a7){var _0x2107e6=a0_0x5f1c;switch(_0x39b6a7[_0x2107e6(0xc0)]){case 0x0:return[0x4,this['getStatus']()];case 0x1:_0x39b6a7[_0x2107e6(0xe5)]();return[0x4,this['upload']()];case 0x2:return[0x2,_0x39b6a7[_0x2107e6(0xe5)]()];}});});},_0x59a7c7[_0x9869d2(0xd3)][_0x9869d2(0xf9)]=function(){return this['uploadSession'];},_0x59a7c7;}());exports[a0_0x32c3c0(0xb2)]=LargeFileUploadTask;