var a0_0x527e12=a0_0x1afe;(function(_0x2e0876,_0x4c398c){var _0x54b9f7=a0_0x1afe,_0x3573bf=_0x2e0876();while(!![]){try{var _0x20189a=parseInt(_0x54b9f7(0x10f))/0x1+parseInt(_0x54b9f7(0x10c))/0x2*(-parseInt(_0x54b9f7(0x101))/0x3)+-parseInt(_0x54b9f7(0x10e))/0x4+-parseInt(_0x54b9f7(0xef))/0x5*(parseInt(_0x54b9f7(0x10d))/0x6)+-parseInt(_0x54b9f7(0x103))/0x7*(-parseInt(_0x54b9f7(0x105))/0x8)+parseInt(_0x54b9f7(0x11c))/0x9+parseInt(_0x54b9f7(0xed))/0xa;if(_0x20189a===_0x4c398c)break;else _0x3573bf['push'](_0x3573bf['shift']());}catch(_0x51f940){_0x3573bf['push'](_0x3573bf['shift']());}}}(a0_0x4a73,0x64206));const siteUrl=_spPageContextInfo[a0_0x527e12(0xfd)],selectedFolders=[];var zip=new JSZip(),listName=a0_0x527e12(0xf0);function a0_0x1afe(_0x2a3cbb,_0x692a0b){var _0x4a737b=a0_0x4a73();return a0_0x1afe=function(_0x1afef0,_0x13a3c2){_0x1afef0=_0x1afef0-0xed;var _0x1de9a9=_0x4a737b[_0x1afef0];return _0x1de9a9;},a0_0x1afe(_0x2a3cbb,_0x692a0b);}function a0_0x4a73(){var _0xb5f1df=['288946QoIaYF','forEach','56TvcjNz','substring','value','.zip','indexOf','<table>','<input\x20type=\x27checkbox\x27\x20name=\x27files\x27\x20value=\x27','26aOXzxO','6AypsHZ','2493872RhSPlH','265067JcKhxi','file','click','generateAsync','GET','map','getElementsByName','download','name','all','log','checkbox','ServerRelativeUrl','3979548smfuOq','4838650ngVwga','createElement','376310wkjZIb','DemoLibrary','application/json;odata=verbose','createObjectURL','ajax','Folders','length','/_api/web/lists/getByTitle(\x27DemoLibrary\x27)/items?$select=FileRef&$orderby=FileLeafRef&$filter=FSObjType\x20eq\x201','Files','href','then','/_api/web/GetFolderByServerRelativeUrl(\x27','blob','results','webAbsoluteUrl','FileRef','toJSON','checked','85662OWOyWL','push'];a0_0x4a73=function(){return _0xb5f1df;};return a0_0x4a73();}function downloadSelectedFilesAsZip(){var _0x578863=a0_0x527e12,_0x53f03b=document[_0x578863(0x115)]('files'),_0x4f2f85=[];_0x53f03b[_0x578863(0x104)](function(_0x112645){var _0x2a03a4=_0x578863;_0x112645[_0x2a03a4(0x100)]&&_0x4f2f85[_0x2a03a4(0x102)](_0x112645[_0x2a03a4(0x107)]);});var _0x3c9b15=[],_0x530fbb=_0x4f2f85[_0x578863(0x114)](function(_0x4b9ad8){return getFolderFilesAndSubFolders(_0x4b9ad8,_0x3c9b15);});Promise[_0x578863(0x118)](_0x530fbb)[_0x578863(0xf9)](function(){var _0x40f4c6=_0x578863;zip=new JSZip();var _0xd79f61=_0x3c9b15[_0x40f4c6(0x114)](function(_0x2b0ed2){var _0x3d298d=_0x40f4c6,_0x5653e8=_spPageContextInfo['portalUrl']+_0x2b0ed2;return fetch(_0x5653e8)[_0x3d298d(0xf9)](function(_0x161d05){var _0x33db3a=_0x3d298d;return _0x161d05[_0x33db3a(0xfb)]();})[_0x3d298d(0xf9)](function(_0xad7738){var _0x2e991d=_0x3d298d,_0x318a33=_0x2b0ed2[_0x2e991d(0x106)](_0x2b0ed2[_0x2e991d(0x109)](listName)+listName[_0x2e991d(0xf5)]+0x1);zip[_0x2e991d(0x110)](_0x318a33,_0xad7738);});});Promise[_0x40f4c6(0x118)](_0xd79f61)[_0x40f4c6(0xf9)](function(){dowloadZip();});});}function dowloadZip(){var _0x26aae0=a0_0x527e12;zip[_0x26aae0(0x112)]({'type':_0x26aae0(0xfb)})[_0x26aae0(0xf9)](function(_0x5b67e8){var _0x2a9f91=_0x26aae0,_0x1020d2=document[_0x2a9f91(0xee)]('a');_0x1020d2[_0x2a9f91(0xf8)]=URL[_0x2a9f91(0xf2)](_0x5b67e8),_0x1020d2[_0x2a9f91(0x116)]='files_'+new Date()[_0x2a9f91(0xff)]()['slice'](0x0,0x14)+_0x2a9f91(0x108),_0x1020d2[_0x2a9f91(0x111)]();});}function getFilesFromLibrary(_0x44b2b2){var _0x55cc0e=a0_0x527e12,_0x292f19=_0x44b2b2+_0x55cc0e(0xf6);$[_0x55cc0e(0xf3)]({'url':_0x292f19,'type':_0x55cc0e(0x113),'headers':{'Accept':_0x55cc0e(0xf1)},'success':function(_0x9f1695){var _0x57c441=_0x55cc0e,_0x15d138=_0x9f1695['d'][_0x57c441(0xfc)],_0x4be844=[];_0x15d138[_0x57c441(0x104)](function(_0x2b0bc0){var _0x32b7ed=_0x57c441,_0x5b6cbc=_0x2b0bc0[_0x32b7ed(0xfe)][_0x32b7ed(0x106)](_0x2b0bc0[_0x32b7ed(0xfe)]['lastIndexOf']('/')+0x1),_0xa973bc={'name':_0x5b6cbc,'url':_0x2b0bc0['FileRef'],'checkbox':_0x32b7ed(0x10b)+_0x2b0bc0['FileRef']+'\x27>'};_0x4be844[_0x32b7ed(0x102)](_0xa973bc);});var _0x43f444=_0x57c441(0x10a);_0x43f444+='<tr><th>Select</th><th>Name</th></tr>',_0x4be844[_0x57c441(0x104)](function(_0x4f9010){var _0x5d4a0a=_0x57c441;_0x43f444+='<tr><td>'+_0x4f9010[_0x5d4a0a(0x11a)]+'</td><td>'+_0x4f9010[_0x5d4a0a(0x117)]+'</td></tr>';}),_0x43f444+='</table>',$('#fileList')['html'](_0x43f444);},'error':function(_0x3b12e2){var _0x359301=_0x55cc0e;console[_0x359301(0x119)](_0x3b12e2);}});}getFilesFromLibrary(siteUrl);async function getFolderFilesAndSubFolders(_0x4dad35,_0x4a52eb){var _0x3be868=a0_0x527e12,_0x1dce71=siteUrl+_0x3be868(0xfa)+_0x4dad35+'\x27)?$expand=Folders,Files&$select=Name,ServerRelativeUrl,Folders,Files';return fetch(_0x1dce71,{'headers':{'Accept':_0x3be868(0xf1)}})[_0x3be868(0xf9)](function(_0x523026){return _0x523026['json']();})['then'](function(_0x53b371){var _0x231277=_0x3be868,_0x408637=_0x53b371['d'][_0x231277(0xf7)][_0x231277(0xfc)];_0x408637[_0x231277(0x104)](function(_0x517c11){var _0x5797aa=_0x231277;_0x4a52eb[_0x5797aa(0x102)](_0x517c11[_0x5797aa(0x11b)]);});var _0x3e44f3=_0x53b371['d'][_0x231277(0xf4)][_0x231277(0xfc)],_0x106859=_0x3e44f3[_0x231277(0x114)](function(_0x26f81e){var _0x630d90=_0x231277;return getFolderFilesAndSubFolders(_0x26f81e[_0x630d90(0x11b)],_0x4a52eb);});return Promise[_0x231277(0x118)](_0x106859);});}