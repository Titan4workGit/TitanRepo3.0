var a0_0x587e51=a0_0x5a33;(function(_0x12f31d,_0x5a69a8){var _0x4f7a07=a0_0x5a33,_0x553f02=_0x12f31d();while(!![]){try{var _0x3a3530=-parseInt(_0x4f7a07(0x130))/0x1*(-parseInt(_0x4f7a07(0x13f))/0x2)+-parseInt(_0x4f7a07(0x12a))/0x3*(parseInt(_0x4f7a07(0x142))/0x4)+-parseInt(_0x4f7a07(0x133))/0x5+parseInt(_0x4f7a07(0x11e))/0x6*(-parseInt(_0x4f7a07(0x11f))/0x7)+-parseInt(_0x4f7a07(0x120))/0x8+parseInt(_0x4f7a07(0x135))/0x9+parseInt(_0x4f7a07(0x136))/0xa;if(_0x3a3530===_0x5a69a8)break;else _0x553f02['push'](_0x553f02['shift']());}catch(_0x399fd5){_0x553f02['push'](_0x553f02['shift']());}}}(a0_0x1933,0xe4113));var a0_0x28d180=a0_0x5932;(function(_0x17aa79,_0x26a78c){var _0x418d13=a0_0x5a33,_0x5451ca=a0_0x5932,_0x30e1ce=_0x17aa79();while(!![]){try{var _0x40c5bd=parseInt(_0x5451ca(0x189))/0x1+parseInt(_0x5451ca(0x17f))/0x2*(-parseInt(_0x5451ca(0x19e))/0x3)+parseInt(_0x5451ca(0x18f))/0x4+parseInt(_0x5451ca(0x184))/0x5+parseInt(_0x5451ca(0x180))/0x6*(-parseInt(_0x5451ca(0x1a9))/0x7)+-parseInt(_0x5451ca(0x1a4))/0x8+-parseInt(_0x5451ca(0x185))/0x9*(-parseInt(_0x5451ca(0x1a6))/0xa);if(_0x40c5bd===_0x26a78c)break;else _0x30e1ce[_0x418d13(0x121)](_0x30e1ce[_0x418d13(0x12e)]());}catch(_0x5c3b89){_0x30e1ce['push'](_0x30e1ce[_0x418d13(0x12e)]());}}}(a0_0x159c,0xd0855));const siteUrl=_spPageContextInfo[a0_0x28d180(0x191)],selectedFolders=[];function a0_0x1933(){var _0x2b0eba=['396cubTTy','FileRef','762oQbofG','622324quYZoB','checkbox','application/json;odata=verbose','ServerRelativeUrl','2437497GZYXFk','.zip','generateAsync','GET','files','4261684OGYWmL','</table>','getElementsByName','length','40xkENul','files_','substring','href','1642907WxXWzZ','name','file','log','<table>','webAbsoluteUrl','indexOf','html','1903458icSoFn','7PjxyFf','14874328DrMeTM','push','forEach','slice','map','blob','value','createElement','#fileList','/_api/web/GetFolderByServerRelativeUrl(\x27','18aokKwI','then','3116975Xfqaly','10548tGHHjR','shift','results','2569LbheBa','</td><td>','toJSON','5588335gCzmlh','lastIndexOf','9172845DckcwB','36339830NrubyN','checked','10676840oFBqWV','download','<input\x20type=\x27checkbox\x27\x20name=\x27files\x27\x20value=\x27','DemoLibrary','<tr><th>Select</th><th>Name</th></tr>','json','createObjectURL'];a0_0x1933=function(){return _0x2b0eba;};return a0_0x1933();}function a0_0x159c(){var _0x18dcb8=a0_0x5a33,_0xbfb239=[_0x18dcb8(0x125),_0x18dcb8(0x128),_0x18dcb8(0x13e),_0x18dcb8(0x116),_0x18dcb8(0x139),'all',_0x18dcb8(0x144),_0x18dcb8(0x121),_0x18dcb8(0x13d),_0x18dcb8(0x10e),_0x18dcb8(0x110),_0x18dcb8(0x11b),_0x18dcb8(0x115),'\x27)?$expand=Folders,Files&$select=Name,ServerRelativeUrl,Folders,Files','<tr><td>',_0x18dcb8(0x111),_0x18dcb8(0x13c),_0x18dcb8(0x126),_0x18dcb8(0x119),'Folders',_0x18dcb8(0x10b),_0x18dcb8(0x140),_0x18dcb8(0x137),_0x18dcb8(0x123),_0x18dcb8(0x12d),_0x18dcb8(0x134),_0x18dcb8(0x11d),_0x18dcb8(0x124),'portalUrl','click',_0x18dcb8(0x138),_0x18dcb8(0x12f),_0x18dcb8(0x112),_0x18dcb8(0x122),_0x18dcb8(0x10a),'126679oVgfhI',_0x18dcb8(0x117),_0x18dcb8(0x129),_0x18dcb8(0x11c),_0x18dcb8(0x10c),_0x18dcb8(0x113),_0x18dcb8(0x143),'</td></tr>',_0x18dcb8(0x127),_0x18dcb8(0x10d),_0x18dcb8(0x141),'294RESFXU',_0x18dcb8(0x12b),_0x18dcb8(0x114),_0x18dcb8(0x132),_0x18dcb8(0x12c),_0x18dcb8(0x146)];return a0_0x159c=function(){return _0xbfb239;},a0_0x159c();}function a0_0x5932(_0x1d747b,_0x40bacb){var _0x54c28f=a0_0x159c();return a0_0x5932=function(_0x3ccab3,_0x430582){_0x3ccab3=_0x3ccab3-0x17d;var _0x3c28b3=_0x54c28f[_0x3ccab3];return _0x3c28b3;},a0_0x5932(_0x1d747b,_0x40bacb);}function a0_0x5a33(_0x2d178d,_0x27cf46){var _0x193394=a0_0x1933();return a0_0x5a33=function(_0x5a338a,_0x4c0a6d){_0x5a338a=_0x5a338a-0x10a;var _0x74274=_0x193394[_0x5a338a];return _0x74274;},a0_0x5a33(_0x2d178d,_0x27cf46);}var zip=new JSZip(),listName=a0_0x587e51(0x13b);function downloadSelectedFilesAsZip(){var _0x54700e=a0_0x28d180,_0x2bca09=document[_0x54700e(0x190)](_0x54700e(0x17e)),_0x5a94f4=[];_0x2bca09[_0x54700e(0x1a7)](function(_0x7e0dfe){var _0x49fed9=_0x54700e;_0x7e0dfe[_0x49fed9(0x19c)]&&_0x5a94f4[_0x49fed9(0x18d)](_0x7e0dfe[_0x49fed9(0x197)]);});var _0x4c8c8e=[],_0x27c8ea=_0x5a94f4[_0x54700e(0x1a1)](function(_0x2bb931){return getFolderFilesAndSubFolders(_0x2bb931,_0x4c8c8e);});Promise[_0x54700e(0x18b)](_0x27c8ea)[_0x54700e(0x181)](function(){var _0xb1a873=_0x54700e;zip=new JSZip();var _0xed4c04=_0x4c8c8e[_0xb1a873(0x1a1)](function(_0x4ff0cd){var _0x113dcf=a0_0x5a33,_0x345e7a=_0xb1a873,_0x41ae92=_spPageContextInfo[_0x345e7a(0x1a2)]+_0x4ff0cd;return fetch(_0x41ae92)[_0x345e7a(0x181)](function(_0x590a92){var _0x24dcef=_0x345e7a;return _0x590a92[_0x24dcef(0x186)]();})[_0x113dcf(0x12b)](function(_0x595a93){var _0x2a53cf=_0x113dcf,_0x571bfd=_0x345e7a,_0x2c2581=_0x4ff0cd[_0x571bfd(0x182)](_0x4ff0cd[_0x571bfd(0x1ac)](listName)+listName[_0x571bfd(0x195)]+0x1);zip[_0x2a53cf(0x118)](_0x2c2581,_0x595a93);});});Promise[_0xb1a873(0x18b)](_0xed4c04)[_0xb1a873(0x181)](function(){dowloadZip();});});}function dowloadZip(){var _0x4ea34b=a0_0x28d180;zip[_0x4ea34b(0x19a)]({'type':_0x4ea34b(0x186)})[_0x4ea34b(0x181)](function(_0x28c1f4){var _0x5ee998=_0x4ea34b,_0xe5ebfd=document[_0x5ee998(0x17d)]('a');_0xe5ebfd[_0x5ee998(0x192)]=URL[_0x5ee998(0x188)](_0x28c1f4),_0xe5ebfd[_0x5ee998(0x18a)]=_0x5ee998(0x1ae)+new Date()[_0x5ee998(0x183)]()[_0x5ee998(0x19d)](0x0,0x14)+_0x5ee998(0x1a8),_0xe5ebfd[_0x5ee998(0x1a3)]();});}function getFilesFromLibrary(_0x1cbbad){var _0x1f2554=a0_0x587e51,_0x438878=a0_0x28d180,_0x5ea060=_0x1cbbad+'/_api/web/lists/getByTitle(\x27DemoLibrary\x27)/items?$select=FileRef&$orderby=FileLeafRef&$filter=FSObjType\x20eq\x201';$['ajax']({'url':_0x5ea060,'type':_0x438878(0x1ad),'headers':{'Accept':_0x1f2554(0x144)},'success':function(_0x32cd4d){var _0x5b485e=_0x1f2554,_0x13be9a=_0x438878,_0x20d1da=_0x32cd4d['d']['results'],_0x11479f=[];_0x20d1da[_0x13be9a(0x1a7)](function(_0x3b07b7){var _0x1a73ef=a0_0x5a33,_0x53abf3=_0x13be9a,_0x3cfbfb=_0x3b07b7[_0x53abf3(0x19b)][_0x1a73ef(0x114)](_0x3b07b7[_0x53abf3(0x19b)][_0x53abf3(0x19f)]('/')+0x1),_0x2ca21a={'name':_0x3cfbfb,'url':_0x3b07b7['FileRef'],'checkbox':_0x1a73ef(0x13a)+_0x3b07b7[_0x53abf3(0x19b)]+'\x27>'};_0x11479f[_0x53abf3(0x18d)](_0x2ca21a);});var _0x20174e=_0x5b485e(0x11a);_0x20174e+=_0x13be9a(0x196),_0x11479f[_0x13be9a(0x1a7)](function(_0x5e3988){var _0x4041b1=_0x5b485e,_0x3a812f=_0x13be9a;_0x20174e+=_0x3a812f(0x194)+_0x5e3988[_0x3a812f(0x1af)]+_0x4041b1(0x131)+_0x5e3988[_0x3a812f(0x1aa)]+_0x3a812f(0x1b0);}),_0x20174e+=_0x5b485e(0x10f),$(_0x13be9a(0x187))[_0x13be9a(0x1a0)](_0x20174e);},'error':function(_0x2f3cd5){var _0x305f7f=_0x438878;console[_0x305f7f(0x198)](_0x2f3cd5);}});}getFilesFromLibrary(siteUrl);async function getFolderFilesAndSubFolders(_0x3074c1,_0x2d8910){var _0x260323=a0_0x28d180,_0x4e1495=siteUrl+_0x260323(0x1ab)+_0x3074c1+_0x260323(0x193);return fetch(_0x4e1495,{'headers':{'Accept':_0x260323(0x18c)}})[_0x260323(0x181)](function(_0x3b8f22){var _0x5f3c0b=_0x260323;return _0x3b8f22[_0x5f3c0b(0x18e)]();})[_0x260323(0x181)](function(_0x451daf){var _0x57121c=a0_0x5a33,_0x3bce22=_0x260323,_0x411a22=_0x451daf['d']['Files'][_0x3bce22(0x1a5)];_0x411a22[_0x3bce22(0x1a7)](function(_0x13de7c){var _0x1f89aa=a0_0x5a33;_0x2d8910[_0x1f89aa(0x121)](_0x13de7c[_0x1f89aa(0x145)]);});var _0xa548d2=_0x451daf['d'][_0x3bce22(0x199)][_0x57121c(0x12f)],_0x47575a=_0xa548d2[_0x3bce22(0x1a1)](function(_0x591b22){var _0x3c41db=_0x57121c;return getFolderFilesAndSubFolders(_0x591b22[_0x3c41db(0x145)],_0x2d8910);});return Promise['all'](_0x47575a);});}